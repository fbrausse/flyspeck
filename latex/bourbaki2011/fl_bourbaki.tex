\documentclass[brochure,english,12pt]{bourbaki}
\usepackage[matrix,arrow]{xy}
\usepackage{amssymb,amsfonts,amsmath,footnote}
\usepackage[francais]{babel}
%\usepackage{pxfonts}
\addressindent 100mm

\date{Avril 2011}
\bbkannee{63\`eme ann\'ee, 2010-2011}
\bbknumero{1035}
\title{The fundamental lemma and the Hitchin fibration}
\subtitle{after Ng\^o Bao Ch\^au}
\author{Thomas HALES}
\address{University of Pittsburgh\\
Department of Mathematics\\
Pittsburgh, PA 15260 -- U.S.A.}
\email{hales@pitt.edu}

\newtheorem{example}[equation]{Example}
\newtheorem{definition}[equation]{Definition}
\newtheorem{theorem}[equation]{Theorem}
\newtheorem{lemma}[equation]{Lemma}
% Math notation.
\def\op#1{{\operatorname{#1}}}
\newcommand{\ring}[1]{\mathbb{#1}}
\newcommand{\NBC}{Ng\^o Bao Ch\^au}
\def\AD{\ring{A}}
\def\so{\frak{so}}
\def\sp{\frak{sp}}
\def\gl{\frak{gl}}
\def\g{\frak{g}}
\def\b{\backslash }
%\def\mass{{\mathbf\mu}}
\def\card{\op{card}}
\def\A{{\mathcal A}}
\def\C{{\mathcal C}}
\def\M{{\mathcal M}}
\def\P{{\mathcal P}}
\def\a{{\hbox{ani}}}
\def\tA{{\tilde{\mathcal A}}}
\def\D{{\frak{D}}}
\def\R{{\frak{R}}}
\def\diamond{{\blacklozenge}}
\begin{document}
\maketitle

{

\narrower{\it The study of orbital integrals on $p$-adic groups has turned
out to be singularly difficult. -- R. P. Langlands, 19XX} % Real Igusa

}


\section{Introduction}
% 7 pages.


This report describe some identities of integrals that have
been established by \NBC.  In mathematics, we have an unlimited supply
of integrals and of identities of integrals.  Part of my task today
will be to describe why these identities took nearly 30 years to
prove, and why they have particular importance for investigations in
the theory of automorphic representations.






\subsection{Origins of the fundamental lemma}


To orient ourselves to the fundamental lemma, we give two examples of
behavior that the theory is designed to explain.


\begin{example}  We recall the definition of the holomorphic discrete series representations
of $SL_2(\ring{R})$.  For each natural number $n\ge 2$, consider the vector space $V^+_n$
of all holomorphic functions on the upper half plane ${\frak h}$ that
are square integrable:
\[
\int_{\frak h} |f|^2 y^{n-2} dx\, dy < \infty.
\]
$SL_2(\ring{R})$ acts on $V^+_n$:
\[
\begin{pmatrix} a & b \\ c & d \end{pmatrix} \cdot f(z) = 
(-b z + d ) ^{-n} f (\frac{\phantom{-}a z - c}{-b z + d}).
\]
For each $n\ge 2$, $SL_2$ also acts on the vector space $V^-_n$ of complex
conjugates of functions in $V^+_n$.
The characters of these infinite dimensional representations are represented by integrable functions
$\chi_{n,\pm}$.  In fact, $\chi_{n,+}(g)=\chi_{n,-}(g)$ except when $g$ is conjugate to a rotation
\[
t = \begin{pmatrix} \phantom{-}\cos\theta & \sin\theta \\ -\sin\theta & \cos\theta\end{pmatrix}.
\] 
When $g$ is conjugate to $t$, a remarkable character identity holds:
\[
\chi_{n,-}(t) - \chi_{n,+}(t) = 
\frac{e^{i n \theta} + e^{- i n \theta}}{e^{i\theta}-e^{-i\theta}}.
\]
It is striking that numerator of the difference of two characters of
infinite dimension representations collapses to the character of a two
dimensional representation $t\mapsto t^n$ of the group $H$ of
rotations.  Shelstad gives general characters identities of this
sort~\cite{Sh}.
\end{example}

\begin{example}
  We find another early glimpse of the theory in an exchange
  between Langlands and Singer.  Singer expressed interest to
  Langlands in a particular alternating sum of dimensions of spaces of
  cusp forms of $G=SL_2$ over a totally real extension $F$ of
  $\ring{Q}$.  In 1974, Langlands replied to Singer in a letter
  describing then unpublished joint work with
  Labesse~\cite{Singer},~\cite{LL}.  The exact details do not concern
  us here.  The important point for us is that in the formula for this
  alternating sum, there again is a collapse in complexity from the
  three dimensional group $SL_2$ to a sum indexed by one-dimensional
  groups $H$ (of norm $1$ elements of quadratic extensions of $F$).
\end{example}
%Letter to Singer 1974.

These two examples fit into a general framework that has now been the
subject of deep research for decades.  Langlands holds that methods
should be developed that are adequate for the theory of automorphic
representations in its full natural generality.  In ``full natural
generality'' means going from $SL_2$ (or even a torus) to all
reductive groups, from one local field to all local fields, from local
fields to global fields and back again, from the geometric side of the
trace formula to the spectral side and back again.  Moreover,
interconnections between different reductive groups and Galois groups
should be included, as predicted by his general principle of
functoriality.


Thus, from these early calculations of Labesse and Langlands, the
general idea developed that one should account for alternating sums
(or $\kappa$-sums as we shall call them because occasionally they
involve roots of unity other than $\pm1$) that appear in the harmonic
analysis on a reductive group $G$ in terms of the harmonic analysis on
groups $H$ of smaller dimension.  The fundamental lemma is a concrete
expression of this idea.


\subsection{stable conjugacy}

At the root of these $\kappa$-sum formulas is the distinction between
{\it ordinary conjugacy} and {\it stable conjugacy}.  
\begin{example}
In the first example of $SL_2(\ring{R})$,
a clockwise rotation and counterclockwise rotation
\[
\begin{pmatrix}\cos\theta &-\sin\theta\\\sin\theta &\cos\theta\end{pmatrix},\quad
\begin{pmatrix}\cos\theta &+\sin\theta\\-\sin\theta &\cos\theta\end{pmatrix}
\]
are conjugate by an element $\begin{pmatrix}i&0\\0&-i\end{pmatrix}\in
SL_2(\ring{C})$ (hence stably conjugate), but they are not conjugate
in $SL_2(\ring{R})$ when $\theta\not\in\ring{Z}\pi$.  Proof: if conjugate in $SL_2(\ring{R})$ they are
also conjugate in $GL_2(\ring{R})$, but a matrix calculation shows
that every element of $GL_2(\ring{R})$ carrying the rotation to a
counter-rotation has odd determinant.  
\end{example}
%For example, the diagonal
%matrix with eigenvalues $1$ and $-1$ conjugates the clockwise rotation
%to a counterclockwise rotation.  
The sign of the determinant gives an
invariant in a group of order two that distinguishes conjugacy within
stable conjugacy for $SL_2$.

\begin{definition} Let $G$ be a reductive group defined over a field
  $k$ with algebraic closure $\bar k$.  An element
  $\gamma'\in G(k)$ is {\it stably conjugate} to a given regular
  semisimple element $\gamma$ if $\gamma'$ is conjugate to $\gamma$ in
  the group $G(\bar k)$.
\end{definition}

Associated with an element $\gamma'=g\gamma' g^{-1}$, $g\in G(\bar k)$
that is stably conjugate to a regular semisimple element $\gamma$ is a
cohomological invariant, the cocycle $\sigma(g)g^{-1}\in
H^1(\op{Gal}(\bar k/k),T(\bar k))$, where $T$ is the centralizer of
$\gamma$.  The cohomology class defined by the coycle does not depend
on the choice of $g$.  This invariant is the trivial class when
$\gamma'$ is conjugate to $\gamma$.

%When $k$ is a local field, the cohomology group $H^1$ is finite.  When $k=\ring{R}$,
%it is an elementary abelian $2$-group.
%The origin of the alternating signs in Examples XX and XX is a character
%$\kappa:H^1(\bar k/k,T)\to\ring{C}$.  
%For fields $k\ne\ring{R}$, the cohomology
%group is needn't be a $2$-group, so we will henceforth refer to $\kappa$-sums rather
%than alternating sums. 

\begin{example} Let $T$ be the subgroup of $SL_2(\ring{R})$,
  consisting of all rotations.  The group $T(\ring{C})$ is isomorphic
  to $\ring{C}^\times$ with action $\sigma(t) = \bar t^{-1}$, where
  $\sigma$ is conjugation of $\ring{C}$ over $\ring{R}$.  A cocycle is
  given by an element $t_\sigma\in\ring{R}^\times$.  It is a
  coboundary if $t_\sigma >0$.  Thus
\[
H^1(\op{Gal}(\ring{C}/\ring{R}),T(\ring{C})) = \ring{R}^\times/\ring{R}^\times_+ = \ring{Z}/2\ring{Z}.
\]
\end{example}

Every function on the finite abelian group $H^1$ has an Fourier
expansion as a linear combination of characters $\kappa$ on $H^1$.
Hence by understanding individual characters $\kappa$, we can
reconstruct abitrary functions on $H^1$.
Allowing ourselves to be deliberately vague for a moment, the idea of endoscopy
is that a given Fourier mode $\kappa$ (for given $T$ and $G$) produces
oscillations that cause some of the roots of $G$ to cancel away and
become invisible.  The group $G$, when deprived of these roots,
appears from a spectral point of view identical to a group $H$ of
smaller dimension formed from the remaining visible roots.


\subsection{trace formula}

To explain the trace formula in elementary terms, assume for a moment that
$G$ is a finite group.  A function  $f:G\to \ring{C}$ is a class function if
$f(g h g^{-1}) = f$, for all $g\in G$.  A basis for the vector space of class functions
is the set of characteristic functions $\Phi_C$ of the conjugacy classes $C$ of $G$. 
The character of a representation $\pi:G\to GL(V)$ gives a class function
\[
g \mapsto \op{trace}_V \pi(g) = \chi_\pi(g).
\]
The set of characters of irreducible representations is a second basis of the vector
space of class functions.  Thus, any class function $f$ can be expanded in the two different bases:
\[
f = \sum_C a_C \Phi_C = \sum_{\pi} b_\pi \chi_\pi,
\]
for some complex coefficients $a_C$, $b_\pi$ depending on $f$.
This identity relating conjugacy classes to characters is a {\it trace formula}.

To generalize the trace formula to settings where the representations are no longer
finite dimensional, it helps to rewrite the functions $\Phi_C$, $\chi_\pi$
in the trace formula as distributions in terms of distributions rather than functions.
The distribution character of a representation $(\pi,V)$ of a locally compact group with
invariant measure $dg$ is 
\[\varphi \mapsto \op{trace}_V \int_G \varphi(g)\pi(g) dg, \quad \phi\in C_c^\infty(G)
\]
An {\it orbital integral} is the distribution associated with a conjugacy class $C$ with
invariant measure $dc$:
\[
\varphi \mapsto\int_C \varphi(c) dc  = \Phi_C(\varphi).
\]
A simple trace formula for an invariant (=class) distribution $f$ on $G$ is an identity of the
form 
\[
 \sum_C a_C \Phi_C(\varphi) = \sum_{\pi} b_\pi \chi_\pi(\varphi),\quad  \phi\in C_c^\infty(G).
\]
The left hand side containing the orbital integrals is called the
geometric side of the trace formula and the right hand side is called
the spectral side of the trace formula.

When $\Gamma$ is a discrete subgroup of a locally compact group $G$
such that $\Gamma\backslash G$ is compact, the invariant distribution
$f$ associated with the right regular action of $G$ on
$L^2(\Gamma\backslash G)$ has a trace formula of precisely this form.

XX Say what stabilization is and that the study of the cohomology of the
Shimura varieties shows that conjugacy and stable conjugacy affect the
cohomology in subtle ways.  The cohomology of Shimura varieties contains
contributions that come from $H$ rather than $G$.

For the purposes of this talk, we needn't consider anything more than
simple trace formulas.  However, as a word of warning, when the
distribution $f$ comes from the action of $G$ on a vector space of
functions on a noncompact quotient $\Gamma\backslash G$, for some
discrete subgroup $\Gamma$, the geometric side of the formula contains
{\it weighted orbital integrals} that result from a truncation and
regularization.  There may be a continuous spectrum in addition to the
discrete sum $\sum_\pi \cdots$.  There are numerous results in the
literature that describe conditions that can be imposed on $\varphi$
that kill all of the terms in the general trace formula, except the
orbital integrals and discrete spectrum.  However, killing terms can
limit the generality of the results.


\subsection{Reductions}

Over the years between the time that Langlands first conjectured the
fundamental lemma and the time that NBC gave its proof, the FL has
been transformed into simpler form.  Various reductions show that it
is enough to prove the FL for the unit element of the Hecke algebra,
for orbital integrals of elements in the Lie algebra (rather than the
group), and for nonarchimedean local fields in positive
characteristic.  Some comments about these reductions appear in
Section~\ref{XX}.  NBC relies on these reductions, giving a proof of
the FL for the unit element of the Hecke algebra, in a Lie algebra
over a field in positive characteristic (with mild restrictions on the
characteristic).


\subsection{Local and global arguments}

Let $k$ be a number field and let $k_v$ be the completion of $k$ at
place $v$.  At each nonarchimedean place, let $O_v$ be the ring of
integers.  Let $\AD_k$ be the ring of adeles of $k$, defined as the
restricted product of the rings $k_v$ with respect to the rings $O_v$.
The ring $\AD_k$ is a locally compact topological ring, with discrete
subgroup $k$, and compact quotient $\AD_k/k$.  By being a locally
compact ring that puts all completions of $k$ on equal footing, $\AD_k$
is a starting point for many applications of analysis to number
theory, such as class field theory, modular forms, automorphic
representations, and Shimura varieties.


A local problem (one about a particular completion $k_v$) can often be
embedded into a global problem (one about the full ring of adeles
$\AD_k$) and solved using analysis on $\AD_k$.  Such an approach is a
global method (for a local problem).  Conversely, using the fact that
the ring of adeles is a restricted product of local fields $k_v$, a
global problem on $\AD_k$, can often be factored into a collection of
problems indexed by the places of $v$.  This back-and-forth between
local and global arguments is part of standard repertoire of tools.
Examples of local problems solved by global methods appear in the
final section of this report.


Let $G$ be a reductive group defined over $k$ with center $Z$.  The
group $G(k)$ is a discrete subgroup of $G(\AD)$ and the quotient
$Z(\AD)G(k)\backslash G(\AD)$ has finite volume.  An automorphic
representation is an irreducible constituent of the right regular
representation of $G(\AD)$ on 
\[
L^2(Z(\AD) G(k)\backslash G(\AD)).
\]
Automorphic representation (by coming from the quotient by $G(k)$) are
those that are relevant for number theory of the field $k$.

The trace formula that is relevant for us is global, in that it is
attached to the $L^2$ space *.  The fudamental lemma involves several
zig-zags back and forth between the global and local.  The orbital
integrals in the trace formula are global (over conjugacy classes in
$G(\AD)$).  In formulating the conjectured fundamental lemma, Langlands
separated global identities into local identities over the
nonarchimedean completions $k_v$.  (Shelstad had already completed the
analysis at the archimedean places.)  To prove the local identities,
Ng\^o embedded them back into a somewhat different global setting.

Example (cusp form on $SL_2$).


\subsection{endoscopic groups}

The
smaller groups $H$ are called endoscopic groups.
Hints about how to define $H$ come from various sources.
\begin{itemize}
\item It should be constructed from $G,T,\kappa$.
\item Its roots are a subset of the roots of $G$ (although $H$ neededn't
be a subgroup of $G$).
\item Over $\ring{R}$, the presence or absence of a purely imaginary
root in $H$ is determined by whether the normalized $\kappa$-orbital
integral jumps across the hyperplane $\alpha=0$.
\item $H$ should have a Cartan subgroup $T_H\subset H$ isomorphic to
$T_G\subset G$, compatible with Weyl group actions $W_H\subset W_G$.
\item Over a nonarchimedean local field, there should be a Satake
homomorphism $f \mapsto \phi^*_Hf$, sending the spherical Hecke algebra
of $G$ to the spherical Hecke algebra of $H$.
\item It should generalize the example of Labesse and Langlands.
\end{itemize}

There are indications that the groups $H$ should be defined through  
the Langlands dual ${}^LG$ of $G$.
\begin{itemize}
\item Langlands's principle of functoriality asserts that the
  representation theory of groups should be related when their dual
  groups are related.  The examples above are relations in
  representation theory.
\item The Satake transform identifies the spherical Hecke algebra with
  a ring of regular functions on a dual object.
\item The Tate-Nakayama isomorphism identifies $H^1(Gal,T)$
with a dual object.
\end{itemize}

The groups $H$ are defined as follows.  Let $s\in \hat T$ map
to the element representing $\kappa$ under the Tate-Nakayama isomorphism.
The connected component of the centralizer of $s$ is the dual $\bar H$
of a quasi-split reductive group.  The choice of
quasi-split inner form is determined by the requirement of a naturally
defined isomorphism $T_H\to T_G$ over $F$.

For example, if $G=SL_2$, the dual is $\hat G = PSL_2$.  The If $T$ is
split, $H^1(T)=1$, and the connected centralizer of $s$ in $\hat G$ is


\subsection{geometry}

Calculations in special cases show why the fundamental lemma is
essentially geometric in nature, rather purely analytic or
combinatorial. We recall a favorite old calculation of mine of the
orbital integrals for $\so(5)$ and $\sp(4)$, the rank two odd
orthogonal and symplectic Lie algebras.  Let $F$ be a nonarchimedean
local field of residual characteristic greater than $2$.  Let $k$ be
the residue field with $q$ elements.  Let $a$ be an element of
$\so(5)\subset \gl(5)$ with eigenvalues $0,\pm t_1,\pm t_2$.  Assume
that there is an odd natural number $r$ such
\[
|\alpha(a)| = q^{-r/2},
\]
for every root $\alpha$ of $\so(5)$. 
There is an elliptic curve $E_a$ over the finite field $k$ given by
$y^2 = (1-x^2\tau_1)(1-x^2\tau_2)$, where $\tau_i$ is the image
of $t_i^2/\varpi^r$ in the residue field.  There are test functions $f$ and normalizations of
measures on the stable orbit $O(a)$ of $a$ such that
\begin{equation}\label{eqn:elliptic}
\int_{O(a)} f dg = A(q) + B(q) | E_a(k)|,
\end{equation}
for some rational functions $A,B$, depending on $f$.

Similarly, in the group $\sp(4)$, there is an element ${a_H}$ with related eigenvalues $\pm
t_1,\pm t_2$.  According to the general framework of (twisted) endoscopy, there
should be a corresponding function $f'$ on $\sp(4)$ such that the
integral over the stable orbit of ${a_H}$ in $\sp(4)$ is equal to
(\ref{eqn:elliptic}).  A calculation of the orbital integral of $f'$ gives a similar formula, with
a different elliptic curve $E'_{a_H}$, but otherwise identical to (\ref{eqn:elliptic}).
The elliptic curves $E_a$ and $E'_{a_H}$
have different $j$-invariants (which vary with $a$ and ${a_H}$).  The
proof of the desired identities of orbital integrals in this case is
obtained by producing an isogeny between $E_a$ and $E'_{a_H}$.  (The identities of orbital integrals are quite
nontrivial, even though the lie algebras $\so(5)$ and $\sp(4)$ are abstractly isomorphic.)

In a similar way in higher rank,  the spectral curves
\[
y^2 = (1-x^2 \tau_1)(1-x^2 \tau_2)\cdots (1-x^2 \tau_n).
\]
appear, for example, in calculations of orbital integrals for
$\so(2n+1)$.  When orbital integrals are computed by brute force,
these curves appear as freaks of nature.  As it turns
out, they aren't freaks at all, merely perverse.  One of the major
challenges of the proof of the fundamental lemma and one of the major
triumphs of NBC has been to find the natural geometrical setting for
orbital integrals and spectral curves.

\subsection{affine Springer fibers}



A $\kappa$-orbital integral is
\[
\sum_ {x\mapsto a} \int_{G/I} \langle\kappa,\iota(x)\rangle 1_k (\op{Ad}\, g(x)) dg,
\]
where $I$ centralizes $x$.  The value of the integrand is unchanged if
$g$ is replaced with $k g$, for $k\in G(O_v)$.  The integral thus
breaks into a discrete sum over cosets of $G(O_v)$ in $G$ modulo the
group action by $I$.  With suitable normalization of measures, each
coset $G(O_v)g$ contributes $0$ or $\langle\kappa,\iota(x)\rangle$ to
the value of the integral depending on whether $\op{Ad}g\,(a) \in
\g(O_v)$ (again modulo $I$).  This interpretation of orbital integrals
as a coset counting problem makes the fundamental lemma appear to be
combinatorial.  But purely combinatorial approaches to the FL failed.

Let $\M_v(a,k)$ be the set of cosets that meet the support and give nonzero contribution:
\[
XX.
\]


Now assume that the local field $F_v$ has positive characteristic.
Kazhan and Lusztig showed that the coset space $G(O_v)\b G$ is the set of
$k$-points of an inductive limit of schemes called the affine Grassmanian.   
Moreover, $\M_v(a,k)$ is the set of points of a locally finite union
$\M_v(a)$ of projective varieties.  This variety $\M_a$ is called the affine Springer
fiber.  Each irreducible component of $\M_a$ has the same dimension
$\delta(a)$, given by a formula conjectured by KL and later proven by Berukaznikov.

Goresky, Kottwitz, and MacPherson made an extensive investigation of
the affine Springer fibers and conjectured that their equivariant
cohomology groups are pure.  Assuming this conjecture, they prove the
fundamental lemma for elements whose centralizer is an unramified
Cartan subgroup.  They prove the purity result in particular cases by
constructing affine pavings of the Springer fibers.

LaumonXX.

NBC encounterd two major obstacles in trying to generalize the work of
Goresky, Kottwitz, and MacPherson.  Their approach computes computes
the cohomology by computing the fixed point set in $\M_a$ under the
action of a torus on $\M_a$.  Laumon and Ng\^o's proof of the
fundamental lemma for unitary groups also relies the action of a torus
on the affine Springer fibers.  (In the case of unitary groups, over
an unramified quadratic extension, each endoscopic group becomes
isomorphic to a Levi subgroup of $GL(n)$.  The torus action comes from
the center of this Levi.)  However, in general, a nontrivial torus
action on the affine Springer fiber simply doesn't exist.

The second serious obstacle comes from the purity conjecture itself.
In accordance with Deligne's work, NBC held that the task of proving
purity results should become much easier when the varieties are
combined into families rather than treated in isolation.  With this in
mind, he started to investigate families of affine Springer fibers,
varying over a base curve $X$.  This brings us back from local
geometry over the field $F$ to the global geometry of $X$.  What he
found was that the Hitchin fibration is the correct global analogue of
the affine Springer fibers and was able to use Deligne's  purity theorem in this setting.  
The Hitchin fibers will be described in
the next section.  But before moving on, we need a few more facts
about affine Springer fibers.

\subsection{mass formula}

Let ${\C}$ be a groupoid (that is, a category in which every arrow is
invertible) which has only finitely many objects up to isomorphism and
in which every object has a finite automorphism group.  Define the
mass (or groupoid cardinality) of $\C$  to be the rational
number
\[
\mu(\C)= \sum_{x\in \op{obj}(\C)/\sim} \frac{1}{\op{card}(\op{Aut}(x))}.
\]

\begin{example}
For example, if ${\C}$ is the category whose objects are the elements of a finite group $G$
and arrows are given by $x \mapsto g x g^{-1}$, for $g\in G$.  Then the set of objects up to
isomorphism is in bijection with the set of conjugacy classes, the automorphism group of $x$ is the
centralizer of $x$,  and the mass is
\[
\mu(\C) = \sum_{x/\sim} \frac{1}{\op{card}(C_G(x))} = 
\sum_{x/\sim} \frac{\op{card}(O_x)}{\card{G}} = 1.
\]
\end{example}

\begin{example}
The following less trivial example appears in NBC.  Let $P$ be the
group $\ring{G}_m\times \ring{Z}$ defined over a finite field $k$ of cardinality $q$.
Let $M = (\ring{P}^1\times\ring{Z})/\sim$, where the equivalence
relation identifies the point $(\infty,j)$ with $(0,j+1)$   for all $j$.
Thus, $M$ is an infinite string of projective lines, with the point at infinity of each line joined to the
zero point of the next line.  The group $P$ acts on $M$ by $(p_0,i)\cdot
(m_0,j) = (p_0 m_0,i+j)$, where $p_0m_0$ is given by the standard action of
$\ring{G}_m$ on $\ring{P}^1$ fixing $0$ and $\infty$.  
Let $\sigma$ be the Frobenius automorphism
of $\bar k$, and define an twisted automorphism of $P(\bar k)$ and $M(\bar k)$
by $\sigma(x_0,i) = (\sigma x_0^{-1},-i)$.  Define a category $\mathcal C$ with
objects given by pairs 
\begin{equation}
(m,p)\in M(\bar k)\times P(\bar k) \text{ such that } \sigma(m) = p
m.
\end{equation}  
Define  arrows $h\in P(\bar k)$ 
\begin{equation}
h(m,p) = (m',p'),    \text{ provided } hm = m' \text{ and } h p = p'\sigma(h).
\end{equation}  
Then it can be checked by a simple
calculation that there are two isomorphism classes of objects in this
category, representated by the objects
\[
((0,0),(1,1))\text{ and }  ((1,0),(1,0))\in M(\bar k)\times P(\bar k) = 
(\ring{P}^1\times\ring{Z}) \times (\ring{G}_m\times\ring{Z}).
\]
The group $P(\bar k)^\sigma$ of order $q+1$ acts as automorphisms of the first object,
and the group of automorphisms of the second object is trivial.  The mass of the category
is therefore
\[
\mu(\C) = \frac{1}{q+1} + 1.
\]
\end{example}

More generally, suppose there exists a function $\iota:\op{Obj}(\C)\to  A$ from the objects
of a groupoid into in a finite abelian group $A$ that
depends only on the isomorphism class of an object $x$.  Then for every
character $\kappa$ of $A$, we can define a $\kappa$-mass:
\[
\mu_\kappa(\C)= \sum_{x\in \op{obj}(\C)/\sim} \frac{\kappa(\iota(x))}{\op{card}(\op{Aut}(x))}.
\]

\begin{example}
For example, in the previous example, if $(m,p)$ is an object and $p=(p_0,j)\in \ring{G}_m\times\ring{Z}$,
then the image of $j$ in $A=\ring{Z}/2\ring{Z}$ depends only on the isomorphism class of the
object $(m,p)$.  If $\kappa$ is the nontrivial character of $A$, then the 
$\kappa$-mass of this groupoid is
\[
\mu_\kappa(\C) = -\frac{1}{q+1} + 1.
\]
\end{example}

%\begin{example}  Let $G$ be a reductive group over $F$ and $T$ a Cartan subgroup of $G$.
%Let the set of objects be the set of cosets of $T$ in $G$ that are defined over $F$ in the sense
%that $\sigma(Tg) = Tg$ for all $\sigma\in \op{Gal(\bar F/F)$.  Let arrows $h(Tg) = Tg'$ be
%given by elements $h\in G(F)$.
%\end{example}


\subsubsection{mass formula for orbital integrals}

The description of orbital integrals in terms of affine Springer
fibers takes the following form in NBC.  It is a variant of KGM, KL,
expressed in a stacky language.  We note that all geometry in NBC is
carried out in the language of stacks, as developed in
\cite{Laumon-MB}.  In regards to stacks, he makes no compromise.  In
particular, the collection of points of a stack form a groupoid (the
set of points together with isomorphisms between points marked with
arrows).

Let $\M_v(a)$ be the affine Springer fiber for the element $a$ and let
$J_a$ be its centralizer.  We write $\P_v(J_a)$ for the group of
symmetries of the affine Springer fiber.  (The notation for this group
will be explained below.)  Let $\C$ be the groupoid of $k$-points of
the quotient $[\M_v(a)/\P_v(J_a)]$ with objects $(m,p)$ and morphisms
and $h$ defined by the same formula as in Example XX.

For each character of $H^1(k,\P_v(J_a))$ we can naturally associate a
character $\kappa$ of $H^1(F_v,J_a)$ as well as a character (also
called $\kappa$) on a finite abelian group $A$ as above.

\begin{theorem}
The $\kappa$-mass of the category $\C$ is equal to the
$\kappa$-orbital integral of $a$:
\[
\mu_\kappa(\C) = c\,\, O^\kappa_a(1_{\g_v},dt_v),
\]
up to a constant $c=\op{vol}(J^0_a(O_v),dt_v)$ used to normalize measures.
\end{theorem}
% Prop 8.2.7.

Because of this result, I will use the terms ``$\kappa$-mass'' and
``$\kappa$-orbital integral'' more or less interchangeably.  Let us
write $\mu_{\kappa,v}(a)$ for this mass and $\mu_{H,v}(a_H)$ for the
mass of the affine Springer fiber of $M_{H,v}(a_H)$.

\section{Dramatis Personae}


\subsection{Chevalley}

Chevalley quotient, Kostant section, regular centralizer $J$, Hitchin, Picard.

\subsection{The Kostant section}

The characteristic polynomial

The Kostant section appears throughout the proof as a way to pick
out a natural base point.  For example, the transfer factors $\Delta$
are normalized by setting $\Delta$ to be real and positive on the
Kostant section.  The fibers of the Hitchin fibration are nonempty
because of a base point given by the Kostant section. 


The trace formula

XX Insert similar to NOTICES.

\subsection{Real groups}

Let us return to the theme of accounting for alternating sums that
appear in the harmonic analysis on a reductive group $G$ in terms of
the harmonic analysis on groups $H$ of smaller groups, by looking at
the behavior of the orbital integrals of a reductive group $G$ defined
over $\ring{R}$.  Let $T$ be a Cartan subgroup of $G$.  A {\it purely
  imaginary root $\alpha$ of $T$} is one for which the Lie algebra of $T$
acts on the root space $\alpha$ by purely imaginary scalars.
Fix an imaginary root $\alpha$ and
consider the an alternating sum of orbital integrals of the form
\[
\sum_\gamma (\pm) (1-\alpha(\gamma^{-1})) \Phi(\gamma,f)
\]
where $f$ is Schartz function on $G(\ring{R})$, the sum runs over a
set of representatives of conjugacy class in $G(\ring{R})$ that become
conjugate in $G(\ring{C})$.  The summands are naturally parametrized
by a subset of a finite abelian $2$-group $A$, and we determine signs
by a choice of character $\kappa:A\to \{ \pm1 \}$.  The integral
depends smoothly on $\gamma$ when $\gamma$ is regular semisimple.
However, as $\gamma$ moves across the wall of $T$ determined by the
root $\alpha$, the integral can make a discontinuous jump or can extend
smoothly across the wall, depending on the particular choice of signs
$\kappa$.  

\begin{definition}
(Rough definition)
An endoscopic group $H$ associated with character $\kappa$ is a group
with the properties
\begin{itemize}
\item $H$ has a Cartan subgroup $T_H$ isomorphic to $T$.
\item The roots of $H$ are in natural bijection with a subset of the roots of $G$.
\item For each imaginary root $\alpha$ of $T$ in $G$, the root
lies in the root system of $H$ exactly when the orbital integral (*)
for a generic Schwartz function has a discontinuous jump across 
the wall of $T$ determined by $\alpha$.
\end{itemize}
\end{definition}


\section{XX}
Local and Global Calculations.

The ring of adeles is a restricted direct product.  Tate's thesis,
calculations over the adeles by local calculations at each place.
Local calculations by approximation: $F$ is dense in $F_v$.


Calculations of orbital integrals.  Let us briefly review how Labesse
and Langlands rearranged the terms of trace formula for $SL_2$ to make
the quadratic extensions $E$ of $F$ appear.  Many conjugacy classes of
$SL_2(F)$ have the same characteristic polynomial.  For example, if
$F=\ring{Q}$, the

\section{Proof} % 7 pages.

XX Give $\kappa$ and $J'_a$, etc. $a_H$, $a$. $\tA$ etc.

Let $\mu_\kappa(a)$ be defined as the $\kappa$-mass of the groupoid of
$k$ points of the quotient $[\M_a/\P(J_a')]$ of the Hitchin fiber by
its Picard stack $\P_a'$ of symmetries.  This depends on the usual
data $G,X,D$.  On the endoscopic side, let $\mu_H(a_H)$ be the mass of
the of the groupoid of $k$-points of the quotient
$[\M_H(a)/\P(J'_a)]$.

\begin{lemma}  The masses satisfy a product formula over all places of $X$ in terms
of the masses of the individual affine Springer fibers:
\[
\mu_\kappa(a) =\prod_v \mu_{\kappa,v}(a), \quad \mu_H(a_H) = \prod_v \mu_{H,v}(a_H).
\]
The local factors are $1$ for almost all $v$ so that the products are in fact finite.
\end{lemma}

This is a geometric version of the factorization of $\kappa$-orbital
integrals over the adele group into a product of local
$\kappa$-orbital integrals in \cite{Debuts}.

The proof choses an open set of $X$ over which $J'_a$ is isomorphic to
$J_a$. For a given $a$, at a possibly smaller open set $U$ of $X$, the
action of $\P_a$ on $\M_a$ induces an isomorphism of $\P_a(J_a)$ with
$\M_a$.  The product in the lemma can be taken as extending over the
finite set of places $X\setminus U$.  The lemma is based on a product
formula for stacks
\[
[\M_a/\P_a(J_a)] = \prod_{X\setminus U} [\M_{v,a}/\P_{v,a}].
\]
and a similar formula for $H$.

\subsection{support theorem}



With the support theorem in hand, we describe the proof of the fundamental lemma.

Let $\A_H$ be the base of the Hitchin fibration for an endoscopic group $H$.  There
is a closed immersion $\nu:\A_H\to\A$.

\subsection{proof of the fl}

The proof relies on two different descriptions of the orbital integral:
locally as the mass of an affine Springer fiber and as a Grothendieck-Lefschetz trace.
Globally as the mass of a Hitchin fiber and as a Grothendieck-Lefschetz trace.
We erase the trace and assert the equality of semisimplifications of pure perverse sheaves.

The proof starts out with an open set of $\tA_H$ on which everything is as nice as possible.

\begin{lemma}  For $\deg(D)>2g$, 
there exists an open subset $\tA_H^{**}$ of $\tA_H$ such that the following hold:
\begin{itemize}
\item Each $\delta$-stratum is good.
\item It lies in the anisotropic locus.
\item Each  perverse sheaf for either $H$ and $(G,\kappa)$ is a pure local systems of given weight $n$.
\item Each $a_H\in \tA_H(\bar k)$ cuts the divisor $\D_{H,D}+\R^G_{H,D}$ transversally.
\end{itemize}
\end{lemma}


\begin{lemma}
Assume $\deg(D)>2g$.  There is a global identity of masses for elements of $\A_H^{\hbox{good}}$:
\[
\mu_\kappa(a) = q^{r(a_H)} \mu_H(a_H).
\]
\end{lemma}

We sketch the proof of this key results.
The proof first establishes the global identity on the open set $\A_H^{**}$.
Since everything is so nice on this open set, 
it is possible to prove that the mass formula by explict local calculations. 

By the transversality
condition on $a_H$, at any given place $v$, the local intersection
multiplicities $(d_{H,v}(a_H),r^G_{H,v}(a_H))$ must be $(0,0)$,
$(1,0)$, or $(0,1)$.  From the Bezrukanikov's dimension formula, the
dimension of the affine Springer fiber $\M_{H,v}(a_H)$ is $0$.  In
fact, the symmetry group $\P_v(J_{a_H})$ acts simply transitively on
the affine Springer fiber, and the mass of the groupoid of $k$-points
is $1$.  The transversality condition also determines the
possibilities for the local intersection multiplicities of $a$ in $G$.
The affine Springer fiber in this case is at most one and the
$\kappa$-masses of the groupoids of $[\M_v(a)/\P_v(J_a)]$ can be
computed.  In fact, Example XX is a typical example of the
computations involved.  These calculations show that for every point
$a_H$ in $\tA_H$, with image $a\in \tA$, at every place $v$, the
$\kappa$-mass of $a$ is equal to the mass of $a_H$, up to an explicit
power of $q$:
\[
\mu_{\kappa ,v}(a) = q^{\deg(v) r(v,a_H)} \mu_{H,v} (a_H), \quad \text{ for all } v.
\]
The exponents satisfy
\[
r(a_H) = \sum_v \deg(v) r(v,a_H).
\]
These two identities, together with the product formula for the global mass gives
the lemma for elements $a_H$ of $\A_H^{**}$.  

The extension from $\A_H^{**}$ to all of $\A_H^{\hbox{good}}$ is a
global argument.  Using the Grothendieck-Lefschetz trace formula, this
identity of global masses over $\tA_H^{**}$ can be expressed as an identity of alternating sums
of trace of Frobenius on local systems.  These calculations can be
repeated over all finite extensions $k'/k$ and as we vary $k'$,
Cebotarev implies that the semisimplifications of the local systems
are isomorphic on $G$ and $H$.

By the NBC support theorem and BBDG, this isomorphism of local systems
on $\A_H^{**}$ extends to an isomorphism (of their intermediate
extensions) over all of $\A_H^{\hbox{good}}$.  This isomorphism, again by Grothendieck-Lefschetz, translates
back into counting points on the Hitchin
fibration, and hence the global mass formula.


\subsection{fl}

The following theorem is equivalent to the fundamental lemma by Lemma XX which
expresses obital integrals as masses of affine Springer fibers.
By
standard descent arguments (H-Ch), we may assume that the center of
$H_w$ is anisotropic. 


\begin{theorem}[Fundamental Lemma]  (Give Hypotheses)
The following local mass formula holds for general anisotropic affine Springer fibers:
\[
\mu_{\kappa,w}(a) = q^{\deg(v) r_v}\mu_{H,w}(a'_H).
\]
\end{theorem}

The proof of the fl is a global argument based on the equality of
perverse cohomology sheaves on $\A_H^{\hbox{good}}$.  We start locally
with an endoscopic group $H_w$ of $G_w$ over a local field $F_w$.  We
pick an element $a_H\in H_w$ for which we wish to prove the FL.  By
now we are at the final stages of the proof, and we can use standard
strategies to embed the local data into a global setting.  NBC checks
that we pick a curve $X$, such that a completion of the function field
at some place $w$ is isomorphic to $F_w$.  We choose a global
endoscopic groups $H$ of a reductive group $G$, a divisor $D$ on $X$,
a global element $a'_H$ in the Hitchin base $\A_H$ of $H$.  If the
degree of $D$ is sufficiently large, then $a'_H$ lies in
$\A_H^{\hbox{good}}$.  The element $a'_H$ and its image in $a'$ are
chosen to approximate the given local elements $a_H$ and $a$ so
closely that their affine Springer fibers together with symmetry
groups are left unchanged.

The equality of perverse cohomology sheaves on the good locus now implies
that the $\kappa$-mass of $a'$ is equal to the mass of $a'_H$.  By the product formula,
each mass is a product of local masses.  
\[
\mu_\kappa(a') = \prod_v \mu_{\kappa,v}(a'),\quad
\mu(a'_H) = \prod_v\mu_{v}(a'_H).
\]

The global data is chosen so that at every
place $v$ other than the chosen place $w$, the transversality conditions hold, so that
the calculations of the previous section show that $\kappa$-mass of $a'$ at $v$ is
equal to the mass of $a'_H$ at $v$:
\[
\mu_{\kappa,v}(\iota_G(a)) = q^{r_v}\mu_{H,v}(a),\quad v\ne w.
\]  
These masses are nonzero and  can be canceled from
the product formula.  What remains is a single term:
\[
\mu_{\kappa,w}(a') = q^{r_v}\mu_{w}(a'_H).
\]
By the mass formula for orbital integrals, this is precisely the fundamental lemma.
Q.E.D.



\section{Uses of the Fundamental Lemma}  
% 6 pages.

The name ``lemma'' is also misleading because it went decades
without a proof, and its depth goes far beyond what would ordinarily be
called a lemma.  

Yet the name FL is apt both because it is fundamental and
because it is expected to be used widely as an intermediate result in
proving many different results.  This section mentions some major
theorems that have been proved recently that contain the FL as an
intermediate result.  These are all major theorems in their own right,
requiring various major ideas, but in all cases, the FL appears to be
an unavoidable ingredient.

Before going into recent uses of the FL, we might also mention various
special cases of the FL have been known for years.  These special
cases of the FL already give abundant evidence of the usefulness of
the lemma.  For example, Langlands proves the fundamental lemma for
stable base change for $GL(2)$ in his book \cite[Lemma~5.10]{BC}.
From there, base change enters into the proof of the tetrahedral and
octahedral cases of the Artin conjecture (Langlands-Tunnell theorem),
which in turn is used by Wiles in the proof of Fermat's Last theorem.
Waldspurger's proof of the FL for $SL(n)$ is taken up by HH in their
proof of automorphic induction for $GL(n)$, which becomes part of the
proof of the proof of the local Langlands correspondence for $GL(n)$
in Harris and Taylor.  An early application of the fundamental lemma
for $U(3)$ are formulas expressing the zeta function of Picard modular
varieties as products of automorphic $L$-functions~\cite{Pic}.

Let's turn to more recent uses of the FL.   For most applications to date,
the FL for unitary groups is used as well as the twisted FL between $GL(n)$
and unitary groups.  Applications of the trace formula to Shimura varieties often rely on
a  base change FL because of Kottwitz's description of points on Shimura
varieties in terms of twisted orbital integrals~\cite{Kottwitz}.

% Kottwitz R.: Shimura varieties and $\lambda$-adic representations, in Automor- 
% phic forms, Shimura varieties, and L-functions, Vol. I 161--209, Perspect. Math., 10, Academic Press, Boston, MA, 1990. 


\subsubsection{Sato-Tate conjecture}

The original proof of the Sato-Tate conjecture for elliptic curves over
$\ring{Q}$ was restricted to elliptic curves with non-integral
$j$-invariants.  (Clozel, Harris, Sheppard-Baron, Taylor \cite{XX}).
With the advent of the general FL is has become possible to remove
the non-integrality assumption and to greatly extend the theorem, in particular 
to all elliptic modular forms of positive weight \cite{Barnet-Lamb}, etc.


% Carayol's Bourbaki:
% http://www.mathematik.hu-berlin.de/gradkoll/Carayol_Exp.977.H.C4.pdf
% Harris's survey
%http://www.math.unipd.it/~algant/IHP_SMF.pdf

\subsubsection{Shimura varieties}

Shim and Morel use the FL in their recent work on the cohomology of Shimura varieties and associated
Galois representations.

\subsubsection{Iwasawa main conjecture for $GL(2)$}

Skinner-Urban have proved the Iwasawa-Greenberg main conjecture for
many modular forms and in particular for the newforms associated with
many elliptic curves over $\ring{Q}$~\cite{SU}.  Their work ultimately
relies on the work of Shin and Morel and on the FL to prove the
existence of certain Galois representations.  It uses the FL for unitary
groups, the twisted FL relating $GL(n)$ to unitary groups, and some
base change identitites.

\subsubsection{average ranks of elliptic curves}

Last year, Bhargava and Shankar proved the following remarkable result~\cite{BS}:

\begin{theorem} When elliptic curves $E$ over $\ring{Q}$ are ordered
  by height, a positive fraction of them satisfy the Birch and
  Swinnerton-Dyer conjecture.  Specifically, a positive fraction of them
  have rank $0$ and analytic rank $0$.
\end{theorem}

First they construct a set (of positive
density) of elliptic curves with rank $0$.  Second, they construct a
subset (again of positive density) of the rank $0$ set, consisting of
elliptic curves with analytic rank $0$.  This second step relies on
conditions in Skinner-Urban for the analytic rank to be zero, and hence
indirectly on the FL~\cite[Theorem~2]{SU}.

\subsubsection{local Langlands for unitary groups}

Moeglin classifies the discrete series representations of unitary
groups over a nonarchimedean local field.  Again, this relies on the
FL for unitary groups and twisted FL for $GL(n)$.

% Classification et Changement de base pour les  s\'eries discr\`etes des groupes unitaires p-adiques, Pacific Journal of Math, 233-1, Novembre, 2007, pp 159-204

\subsubsection{classification of automorphic representations of classical groups}

Arthur

\subsection{potential automorphy}

Taylor, Harris.






\section{Reductions and Supplementary Results}

Langlands first expressed the fundamental lemma in these words:
``Mais m\^eme apr\`es avoir
v\'erifi\'e que les facteurs de
transfert existent, il reste \`a v\'erifier ce que j'appelle le
lemme fondamental, qui affirme que pour des $G$, $H$ et $\phi_H$
non-ramifi\'es, on a $f\mapsto c\, \phi_H^*(f)$ [pour toute fonction $f\in {\mathcal H}_G$].''
 -- p.49 (Les deb.)  \cite[p.49]{Debuts}

In Langlands's notation $\phi_H^*$ is the homomorphism given by the
Satake transform, from the spherical Hecke algebra ${\mathcal H}_G$ on
$G$ to the spherical Hecke algebra on $H$.  The arrow $f\mapsto
c\,\phi_H^*(f)$ is his assertion of the transfer of orbital integrals
between such functions.

This final section describes some theorems related to the fundamental
lemma that transform it from the form in which it was originally
conjectured, to the form in which it was proved by NBC.  Waldspurger's
work has been particularly significant.  The first step in this
direction was to define the transfer factors explicitly rather to
conjecture the existence.  This was given in \cite{LS}.


%Twisted Fundamental Lemma, Lie algebra, Weighted Fundamental Lemma,
%Reduction to Units, Smooth transfer, descent, transfer to char 0.

\subsection{Descent to the Lie algebra.}

A lemma of Harish-Chandra's asserts the transfer of an orbital
integral on $G$ near a singular semisimple element $z\gamma_0$, with
$z$ central, to an orbital integral on $C_G(\gamma_0)$, the
centralizer of $\gamma_0$.  This is called the descent of orbital
integrals.  Langlands and Shelstad made hard calculations in
Galois cohomology to prove that the transfer factors are compatible
with Harish-Chandra's descent of orbital integrals.  The purpose of
their calculations was to make it possible to prove results about
orbital integrals by induction on the dimension of the group, and
thereby reduce smooth transfer and the fundamental lemma to identities
in a neighborhood of $\gamma_0=1$.  In a neighborhood of $\gamma_0=1$,
identities can be pushed to the Lie algebra, using the exponential map.

The original fundamental lemma has been supplemented by a twisted
fundamental lemma, conjectured by Kottwitz and Shelstad, where the
data is twisted by a nontrivial outer automorphism $\theta$ of the
group $G$.  In the untwisted case, the centralizer of an element fails
to give a group of smaller dimension precisely when the element is
central.  By contrast, a twisted centralizer (with respect to a
nontrivial outer automorphism) always has dimension less than $G$.  As
a consequence, descent always {\it untwists} the twisted fundamental
lemma into identities of ordinary orbital integrals.  If the
(standard) fundamental lemma is then applied, each $\kappa$-orbital
integral can be replaced with a stable orbital integral.  By combining both
descent and stabilization, the twisted FL of Kottwitz and Shelstad
takes the form of identities of stable orbital integrals on the Lie
algebra (from which the automorphism and the character $\kappa$ have
entirely vanished) \cite{twisted-h}.  The corresponding long calculations in Galois
cohomology that establish descent properties of the transfer factors
for the twisted fundamental lemma have been carried out by
Waldspurger \cite{twisted-w}.  NBC proves the general twisted fundamental lemma in
its untwisted stable form on the Lie algebra.



\subsection{The Hecke algebra}

%The fundamental lemma as originally formulated by Langlands
%is a statement about the transfer of all
%functions in the spherical Hecke algebra. 
 A global argument based on
the trace formula shows that the fundamental lemma holds for the full
Hecke algebra for an arbitrary nonarchimedean local field of
characteristic zero, provided it holds for the unit element of the
Hecke algebra for local fields of sufficiently large residual
characteristic (and for groups of smaller dimension).  
The idea of the proof is to choose suitable global
functions for which the comparison of stable trace formulas yields an
obstruction to the fundamental lemma.  This obstruction, which comes from the
spectral side of the trace formula, takes the form
of a set of linear functionals  
\[
L:{\mathcal H}\to\ring{C},\quad L(f) = \sum_\pi a(\pi) \op{trace}\pi(f),
\]
on the local spherical Hecke
algebra ${\mathcal H}$ of the reductive group $G$, each given by a finite sum over
irreducible admissible representations with an Iwahori fixed vector.
By purely local arguments, it
can be shown that no nonzero linear map $L$ exists of the form
prescribed by the global theory. 
By the vanishing of the obstruction,
the fundamental lemma is shown to hold on the full spherical Hecke algebra.


\subsection{Smooth Transfer}

Langlands's book on the stabilization of the trace formula contains
two separate conjectures.  The first is the transfer of smooth
functions.  The second is the fundamental lemma.  An important result
of Waldspurger links the two conjectures, by proving that the
fundamental lemma implies the transfer of smooth functions.  
His key local lemma shows how to obtain simultaneous control over the
orbital integrals of test functions $f$ and the orbital integrals of
their Fourier transform $\hat f$~\cite[Prop.~8.2]{W}.  
In view of the uncertainty principle, it is a remarkable feat to
control both $f$ and $\hat f$ as he does.
% push up against the limits imposed by the
%uncertainty principle.
%is generally deemed nearly impossible by the
% Prop 8.2, p198.
His proof is a global argument, based on a stable Poisson summation trace
formula.  The key local lemma allows Waldspurger to pick global test
functions for which the comparison of trace formulas asserts a
local identity: the Fourier transform of a semisimple
$\kappa$-orbit on $G$ equals the Fourier transform of the corresponding
stable orbit on $H$.  By a purely local argument, this identity of Fourier
transforms of orbits implies smooth transfer.

\subsection{Weighted orbital integrals}

\subsection{Transfer to Characteristic Zero}

The fundamental lemma for nonarchimedean local fields in
characteristic zero can be deduced from the fundamental lemma in
positive characteristic [Wald], [CHL].  Cluckers and Loeser develop a
general abstract theory of integration as a sequence of primitive
operations such as taking the volume of a ball of given radius,
enumerating points on a variety over the residue field, summing a
hypergeometric $q$-series, and making a change of variables.  Since each
of the primitive operations manifestly depends only on the residue
field rather than the field itself, their theory allows many identities
of integrals to be transfered from one field to another with the same
residue field.  The FL lemma is a collection of identities that fall
within the scope of this theory.

\section{secondary literature}

I recommend Ben-Zvi's lecture for mathematicians in other fields who
want a one hour presentation of the big ideas of the proof.
Drinfeld's lecture notes contain many worked examples and exercises
that are helpful in learning the basic ideas geometric of the Hitchin
fibration.  Nadler's survey is for the non-specialist who wants to
learn what the general idea of the stable trace formula, the statement
of the fundamental lemma, and the main ideas of the proof.  My lecture
at a summer school for graduate students at the Field's Institute
gives a statement of the fundamental lemma, including necessary
background material, without going into the proof.  See also
\cite{Hales}.  Casselman describes the fundamental lemma for $SL_2$ in
detail, motivating it with examples in representation theory and
history going back to Hecke.  Arthur's laudation describes NBC's work
in the context of the trace formula.  Langlands's review describes the
origins of the fundamental lemma in the theory of Shimura varieties
and the harmonic analysis over real groups.  His review speculates
that ``an exposition [of the fundamental lemma] genuinely accessible
not alone to someone of my generation, but to mathematicians of all
ages eager to contribute to the arithmetic theory of automorphic
representations, would be, perhaps, \ldots close to 700 pages.''


Much more is available in French, starting with NBC's primary article,
which is superb, both as mathematics and as exposition!  Although they
can be read independently, the ideas develop more naturally if it is
read with his earlier paper.  He has several secondary accounts in
English \cite{XX}.  We mention in particular, several articles in the
Book Project \cite{Harris}, particularly the articles \cite{Dat}
and NBC.

While there have been numerous applications that quote the fundamental
lemma as a finished product, Yuan, Chaudouard, and Laumon are
noteworthy in following Ng\^o in using the Hitchin fibration directly to
prove new results in harmonic analysis.

I wish to thank M. Bhargava, M. Harris, NBC, and C. Skinner for comments that
have helped me to prepare this and my earlier report~\cite{XX}.

\section{Cut}



\bigskip

``For other problems the correspondence is not given by a function, and the notions of 
stabilization and endoscopy necessary to circumvent the attendant difficulties are perhaps 
the most startling that the trace formula has suggested to harmonic analysis,'' 

from p21 Eisenstein series, the trace formula, and the modern theory of automorphic forms, http://publications.ias.edu/sites/default/files/eisen6-ps.pdf

"Le but le plus profond du principe de fonctorialit\'e ... est de remplacer chaque fonction L avec une partie galoisienne, par exemple chaque fonction L d'Artin, par une fonction L enti\`erement automorphe.'' Les deb. p 1.

``At the same 
time, there was a severe technical difficulty that caused me, and others, to despair: the fun- 
damental lemma. It was a simply stated general combinatorial lemma and I expected that as 
such I would be able to prove it with time. Matters turned out quite differently. ''  Langlands, Shaw Prize, page 6,
http://publications.ias.edu/sites/default/files/reflexionsshell.pdf

``I also had occasion to listen to lectures of Ngo (supplemented by the report of J-F., Dat [11] 
and to try to understand them. In particular, I had to attach for myself some meaning to the 
notion of stack and algebraic stack. It was a revelation. I discovered that I had been thinking 
for decades of orbital integrals in an incorrect way. I had separated the local from a global 
part.'' Langlands, Shaw Prize, page 7.



``The study of orbital integrals on p-adic groups has turned out to be singularly difficult,'' Langlands, 
http://publications.ias.edu/sites/default/files/igusa-ps.pdf,
page 1.

% Mathematical influence of Grothendieck, Kolmogorov, and Harish-Chandra.
% http://publications.ias.edu/sites/default/files/photoshell.pdf


\end{document}