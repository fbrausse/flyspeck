(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     48469,       1398]
NotebookOptionsPosition[     45447,       1299]
NotebookOutlinePosition[     45837,       1316]
CellTagsIndexPosition[     45794,       1313]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Supplement I: Functions and Constants",
 FontSize->30]], "Title",
 CellChangeTimes->{{3.4272817971632967`*^9, 3.4272817982062674`*^9}, {
  3.455758431246827*^9, 3.455758432827648*^9}, {3.456204503394163*^9, 
  3.456204506390107*^9}, {3.45620470179817*^9, 3.456204713635921*^9}, {
  3.456361666779344*^9, 3.45636167767971*^9}},
 TextAlignment->Center],

Cell[CellGroupData[{

Cell["Author", "Subsection"],

Cell["\<\
Sean Mclaughlin and Thomas Hales
July 9, 2009\
\>", "Text",
 CellChangeTimes->{{3.42728183209755*^9, 3.427281847119432*^9}, {
  3.456361695101665*^9, 3.4563617102971067`*^9}}],

Cell["\<\
Many of the following definitions also occur in the proof of the Kepler \
Conjecture.  SPI refers to 
Thomas C. Hales: Sphere Packings, I. Discrete & Computational Geometry 17(1): \
1-51 (1997).\
\>", "Text",
 CellChangeTimes->{{3.4272818589040947`*^9, 3.4272819364189177`*^9}, {
   3.427281966852703*^9, 3.427282101897623*^9}, {3.427282551843113*^9, 
   3.4272825601387787`*^9}, {3.45575843601289*^9, 3.4557584376429996`*^9}, {
   3.455759319377877*^9, 3.455759319816763*^9}, {3.455763586605908*^9, 
   3.4557635907950697`*^9}, {3.455766248733367*^9, 3.455766277556199*^9}, {
   3.455766364190014*^9, 3.4557663661458197`*^9}, 3.456130128478044*^9, {
   3.456204585965722*^9, 3.45620468072392*^9}, {3.456361721325979*^9, 
   3.456361725617058*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta] ", "Section",
 CellChangeTimes->{{3.427282906577384*^9, 3.427282916044179*^9}}],

Cell["\<\
\[Delta] is related to the volume of a tetrahedron with edges x1 .. x6.  See \
SPI, p.32.  \
\>", "Text",
 CellChangeTimes->{{3.455758944756756*^9, 3.455759006961914*^9}, {
  3.4557591197984943`*^9, 3.455759143110366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeltaX", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "*", "x4", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "-", "x4", "+", "x5", "+",
          "x6"}], ")"}]}], "+", 
      RowBox[{"x2", "*", "x5", "*", 
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4", "-", "x5", "+", "x6"}],
         ")"}]}], "+", 
      RowBox[{"x3", "*", "x6", "*", 
       RowBox[{"(", 
        RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4", "+", "x5", "-", "x6"}],
         ")"}]}], "-", 
      RowBox[{"(", 
       RowBox[{"x2", "*", "x3", "*", "x4"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"x1", "*", "x3", "*", "x5"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"x1", "*", "x2", "*", "x6"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"x4", "*", "x5", "*", "x6"}], ")"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4272822591922617`*^9, 3.427282264409326*^9}, {
  3.427282323290263*^9, 3.427282448276803*^9}, {3.427282740889399*^9, 
  3.427282741209147*^9}, {3.427283459818851*^9, 3.427283469401617*^9}, {
  3.427287755441818*^9, 3.427287756058011*^9}, {3.427287819632512*^9, 
  3.427287821096611*^9}, {3.455759832028606*^9, 3.455759833474597*^9}}],

Cell["\<\
The derivative of \[Delta] with respect to the fourth argument comes up \
below.\
\>", "Text",
 CellChangeTimes->{{3.427283092509802*^9, 3.42728309905368*^9}, {
  3.4557591693902283`*^9, 3.455759223736348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DeltaX4", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"x1", "*", "x4"}], ")"}]}], "-", 
      RowBox[{"(", 
       RowBox[{"x2", "*", "x3"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"x2", "*", "x5"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"x3", "*", "x6"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"x5", "*", "x6"}], ")"}], "+", 
      RowBox[{"x1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "-", "x4", "+", "x5", "+",
          "x6"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.427282648214349*^9, {3.42728277434464*^9, 3.4272827799212923`*^9}, {
   3.427282859683003*^9, 3.427282884979663*^9}, 3.427283077161023*^9, {
   3.4272834629218597`*^9, 3.4272834658818808`*^9}, {3.427287824415539*^9, 
   3.427287827855104*^9}, 3.455759153395179*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"DeltaX", "[", 
      RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
      "]"}], ",", " ", "x4"}], "]"}], " ", "-", " ", 
   RowBox[{"DeltaX4", "[", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
    "]"}]}], " ", "\[Equal]", " ", "0"}]], "Input",
 CellChangeTimes->{{3.4272831229509153`*^9, 3.427283124126498*^9}, {
  3.427287646200778*^9, 3.4272876630574827`*^9}, {3.4272878305183573`*^9, 
  3.4272878335495777`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.427283080987162*^9, 3.4272831246700087`*^9, {3.427287668837886*^9, 
   3.427287713251829*^9}, 3.427287763237414*^9, 3.427287833848974*^9, 
   3.430739827532324*^9, 3.455763522161171*^9, 3.455763703992364*^9, {
   3.4557638974017572`*^9, 3.455763925110647*^9}, 3.4557641002868843`*^9, {
   3.455765078990903*^9, 3.455765099854178*^9}, 3.4557653807243147`*^9, 
   3.456362244735381*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Dihedral angles\
\>", "Section",
 CellChangeTimes->{{3.42728315375775*^9, 3.42728317837717*^9}}],

Cell["The dihedral of a simplex with respect to x1, x2 an x3.", "Text",
 CellChangeTimes->{{3.4557592631565104`*^9, 3.455759299784417*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DihX", "[", "xs__", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dx4", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dx4", "=", 
        RowBox[{"DeltaX4", "[", "xs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"DeltaX", "[", "xs", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "+", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"4", "*", 
            RowBox[{
             RowBox[{"{", "xs", "}"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", "d"}], "]"}], ",", 
          RowBox[{"-", "dx4"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dih2X", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DihX", "[", 
       RowBox[{"x2", ",", "x1", ",", "x3", ",", "x5", ",", "x4", ",", "x6"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dih3X", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"DihX", "[", 
      RowBox[{"x3", ",", "x1", ",", "x2", ",", "x6", ",", "x4", ",", "x5"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.4272832048782597`*^9, {3.427283294863119*^9, 3.42728330245198*^9}, {
   3.4272833543689203`*^9, 3.4272833579094257`*^9}, {3.4272834161963263`*^9, 
   3.427283495999647*^9}, {3.427285274869433*^9, 3.427285275414454*^9}, 
   3.427287841338294*^9, {3.4272880111925697`*^9, 3.427288017005622*^9}, {
   3.427288261259635*^9, 3.427288261891773*^9}, {3.455759863085511*^9, 
   3.455759910902875*^9}, {3.455763909361223*^9, 3.4557639150377617`*^9}, {
   3.4557640781888866`*^9, 3.455764080028409*^9}, {3.455765287320992*^9, 
   3.4557652979766607`*^9}, {3.455765413782845*^9, 3.4557654322513027`*^9}, {
   3.455765988767576*^9, 3.45576602823694*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solid angles", "Section",
 CellChangeTimes->{{3.427283530608307*^9, 3.427283533239293*^9}, {
  3.427288269086288*^9, 3.42728827021342*^9}}],

Cell["\<\
Solid angles of a simplex.  The intuitive but inefficient definition is\
\>", "Text",
 CellChangeTimes->{{3.427283606983448*^9, 3.427283618170068*^9}, {
  3.4557593283222637`*^9, 3.455759342489468*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SlowSolX", "[", "xs__", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DihX", "@", "xs"}], "+", 
      RowBox[{"Dih2X", "@", "xs"}], "+", 
      RowBox[{"Dih3X", "@", "xs"}], "-", "Pi"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4272835729456797`*^9, 3.4272835980280046`*^9}, 
   3.4557593738689957`*^9, {3.455763623716898*^9, 3.455763637063113*^9}, 
   3.455763875280643*^9, {3.455764085615203*^9, 3.4557640888718157`*^9}, {
   3.455765258806819*^9, 3.455765262569932*^9}}],

Cell["\<\
This definition is inefficient in practice because of three separate calls to \
DihX.  An efficient version is\
\>", "Text",
 CellChangeTimes->{{3.4272836270631227`*^9, 3.427283630993517*^9}, {
  3.455759346209476*^9, 3.455759367026176*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SolAux", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"x1", " ", "x2", " ", "x3"}], "]"}], "+", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Sqrt", "[", "x1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"x2", "+", "x3", "-", "x4"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Sqrt", "[", "x2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"x1", "+", "x3", "-", "x5"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Sqrt", "[", "x3", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"x1", "+", "x2", "-", "x6"}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolX", "[", "xs__", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"SolAux", "[", "xs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"DeltaX", "[", "xs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"2", " ", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"2", " ", "a"}], ",", 
         RowBox[{"Sqrt", "[", "d", "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4272838848812923`*^9, 3.4272839552209177`*^9}, {
   3.427285270183867*^9, 3.427285270591053*^9}, {3.4272882955564117`*^9, 
   3.427288312332452*^9}, {3.455763644502234*^9, 3.4557636777043324`*^9}, 
   3.455763880258855*^9, {3.4557640948932247`*^9, 3.455764095980197*^9}, {
   3.455765212964978*^9, 3.455765214716477*^9}, {3.4557661276885033`*^9, 
   3.4557661332388763`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Volume", "Section",
 CellChangeTimes->{{3.427284191840541*^9, 3.427284192686326*^9}}],

Cell["\<\
Volume of a Voronoi polyhedron contained within a tetrahedron.  The \
derivation comes from SPI.\
\>", "Text",
 CellChangeTimes->{{3.455766201771153*^9, 3.4557662423322563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UpsX", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", "^", "2"}], "+", 
         RowBox[{"x2", "^", "2"}], "+", 
         RowBox[{"x3", "^", "2"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x1", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x2", " ", "x3"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284310275169*^9, 3.4272843160201178`*^9}, 
   3.427284458399171*^9, {3.427288325257948*^9, 3.427288338193761*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FpsX", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", " ", 
       RowBox[{"(", 
        RowBox[{"x2", "+", "x3", "-", "x1"}], ")"}]}], "+", 
      RowBox[{"x2", " ", 
       RowBox[{"(", 
        RowBox[{"x1", "+", "x3", "-", "x2"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284335459656*^9, 3.4272843391919603`*^9}, {
  3.42728445612803*^9, 3.427284456486512*^9}, {3.427288342034206*^9, 
  3.427288350833538*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChiX", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "x1"}], " ", 
       RowBox[{"x4", "^", "2"}]}], "+", 
      RowBox[{"x1", " ", "x4", " ", "x5"}], "+", 
      RowBox[{"x2", " ", "x4", " ", "x5"}], "-", 
      RowBox[{"x2", " ", 
       RowBox[{"x5", "^", "2"}]}], "+", 
      RowBox[{"x1", " ", "x4", " ", "x6"}], "+", 
      RowBox[{"x3", " ", "x4", " ", "x6"}], "+", 
      RowBox[{"x2", " ", "x5", " ", "x6"}], "+", 
      RowBox[{"x3", " ", "x5", " ", "x6"}], "-", 
      RowBox[{"2", " ", "x4", " ", "x5", " ", "x6"}], "-", 
      RowBox[{"x3", " ", 
       RowBox[{"x6", "^", "2"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.427284354981287*^9, 3.427284451679294*^9}, {
  3.427285264643035*^9, 3.4272852660237427`*^9}, {3.4272878120252333`*^9, 
  3.4272878139125233`*^9}, {3.427288354829039*^9, 3.427288372744142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VolumeX", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", "u1", ",", "u2", ",", "u3", ",", "f1", ",", "f2", ",", "f3", 
       ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"DeltaX", "[", 
         RowBox[{
         "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u1", "=", 
       RowBox[{"UpsX", "[", 
        RowBox[{"x1", ",", " ", "x2", ",", " ", "x6"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"u2", "=", 
       RowBox[{"UpsX", "[", 
        RowBox[{"x2", ",", "x3", ",", "x4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"u3", "=", 
       RowBox[{"UpsX", "[", 
        RowBox[{"x1", ",", "x3", ",", "x5"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", "=", 
       RowBox[{"FpsX", "[", 
        RowBox[{"x1", ",", "x2", ",", "x6"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f2", "=", 
       RowBox[{"FpsX", "[", 
        RowBox[{"x2", ",", "x3", ",", "x4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f3", "=", 
       RowBox[{"FpsX", "[", 
        RowBox[{"x1", ",", "x3", ",", "x5"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c1", "=", 
       RowBox[{"ChiX", "[", 
        RowBox[{"x4", ",", "x5", ",", "x3", ",", "x1", ",", "x2", ",", "x6"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{"ChiX", "[", 
        RowBox[{"x6", ",", "x5", ",", "x1", ",", "x3", ",", "x2", ",", "x4"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c3", "=", 
       RowBox[{"ChiX", "[", 
        RowBox[{"x4", ",", "x6", ",", "x2", ",", "x1", ",", "x3", ",", "x5"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"48", " ", "d"}], ")"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f1", "*", 
          RowBox[{"c1", "/", "u1"}]}], "+", 
         RowBox[{"f2", "*", 
          RowBox[{"c2", "/", "u2"}]}], "+", 
         RowBox[{"f3", "*", 
          RowBox[{"c3", "/", "u3"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427288375192774*^9, 3.427288477362544*^9}, 
   3.455766389027298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Truncation", "Section",
 CellChangeTimes->{{3.427285088538274*^9, 3.427285090448674*^9}, {
  3.455758862825202*^9, 3.455758864030719*^9}}],

Cell[TextData[{
 "Truncation of the Voronoi polyhedron occurs at the circumradius of a \
regular dodecahedron of inradius 1.  The actual number, \n",
 Cell[BoxData[
  FormBox[
   SqrtBox["3"], TraditionalForm]]],
 "Tan[\[Pi]/5] is irrational.  For computation purposes we truncate at a \
rational number just slightly larger, called DodecTrunc.  This is the \
constant ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", "dod"], TraditionalForm]]],
 " of the JAMS paper, section 2.1.  The following functions are discussed in \
the paper, Section 5.1."
}], "Text",
 CellChangeTimes->{{3.455758553929476*^9, 3.455758702195972*^9}, {
  3.455758739303595*^9, 3.455758739538426*^9}, {3.455758906736158*^9, 
  3.455758910559485*^9}, {3.4561301796450768`*^9, 3.456130267619507*^9}, {
  3.456185002544074*^9, 3.456185031505773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RealTrunc", " ", "=", " ", 
   RowBox[{
    SqrtBox["3"], 
    RowBox[{"Tan", "[", 
     RowBox[{"\[Pi]", "/", "5"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.455758709043345*^9, 3.455758763605459*^9}, {
  3.455758807872498*^9, 3.45575884331281*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"RealTrunc", ",", " ", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.4557588218854647`*^9, 3.455758834935465*^9}}],

Cell[BoxData["1.25840857236481896970575670353712941808`10.000000000000004"], \
"Output",
 CellChangeTimes->{
  3.455758835430533*^9, 3.455763521980139*^9, 3.4557637038244953`*^9, {
   3.455763897321226*^9, 3.4557639250125227`*^9}, 3.455764100205078*^9, {
   3.4557650789133377`*^9, 3.455765099737249*^9}, 3.456362245117779*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DodecTrunc", "=", 
   RowBox[{"125841", "/", "100000"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.455758494845393*^9, 3.455758518111405*^9}, 
   3.4557587055241823`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quoins", "Section",
 CellChangeTimes->{{3.427284583507354*^9, 3.427284585871975*^9}}],

Cell["\<\
Quoins arise in the calculation of the volume of the truncated Voronoi \
polyhedron contained in a simplex.  See SPI.\
\>", "Text",
 CellChangeTimes->{{3.455766396943164*^9, 3.4557664672261257`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Doct", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Pi", "-", 
      RowBox[{"(", 
       RowBox[{"2", "/", "Zeta1"}], ")"}]}], ")"}], "/", 
    RowBox[{"Sqrt", "[", "8", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zeta1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], "/", "5"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.4557665208282013`*^9, 3.455766521308468*^9}}],

Cell["The circumradius of a face.", "Text",
 CellChangeTimes->{{3.455766821714706*^9, 3.455766829380663*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EtaX", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1", " ", "x2", " ", "x3"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"UpsX", "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}], "]"}], 
        ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284616310601*^9, 3.427284688486863*^9}, {
  3.427288509965837*^9, 3.427288511261561*^9}}],

Cell["\<\
Modified arctangent function with better asymptotic behavior.\
\>", "Text",
 CellChangeTimes->{{3.4557667895040207`*^9, 3.4557668171275463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matan", "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       RowBox[{"Sqrt", "[", "x", "]"}], "]"}], "-", 
      RowBox[{"Sqrt", "[", "x", "]"}], "+", 
      RowBox[{
       RowBox[{"x", "^", 
        RowBox[{"(", 
         RowBox[{"3", "/", "2"}], ")"}]}], "/", "3"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284690679796*^9, 3.4272847045324574`*^9}}],

Cell["The volume of a Rogers simplex.", "Text",
 CellChangeTimes->{{3.455766765846674*^9, 3.4557667761552553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Rogers", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"x", "^", "3"}], "*", 
       RowBox[{"y", "^", "2"}]}], "-", 
      RowBox[{"3", "*", "x", "*", 
       RowBox[{"y", "^", "4"}]}], "+", 
      RowBox[{"8", "*", 
       RowBox[{"x", "^", "3"}], "*", "y", "*", "z"}], "-", 
      RowBox[{"12", "*", "x", "*", 
       RowBox[{"y", "^", "3"}], "*", "z"}], "+", 
      RowBox[{"8", "*", 
       RowBox[{"x", "^", "3"}], "*", 
       RowBox[{"z", "^", "2"}]}], "-", 
      RowBox[{"12", "*", "x", "*", 
       RowBox[{"y", "^", "2"}], "*", 
       RowBox[{"z", "^", "2"}]}], "+", 
      RowBox[{"6", "*", 
       RowBox[{"x", "^", "2"}], "*", 
       RowBox[{"z", "^", "3"}]}], "-", 
      RowBox[{"12", "*", "x", "*", "y", "*", 
       RowBox[{"z", "^", "3"}]}], "+", 
      RowBox[{"8", "*", 
       RowBox[{"y", "^", "2"}], "*", 
       RowBox[{"z", "^", "3"}]}], "-", 
      RowBox[{"3", "*", "x", "*", 
       RowBox[{"z", "^", "4"}]}], "+", 
      RowBox[{"8", "*", "y", "*", 
       RowBox[{"z", "^", "4"}]}], "+", 
      RowBox[{"2", "*", 
       RowBox[{"z", "^", "5"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.427284728690291*^9, 3.427284752547236*^9}, {
  3.427288517520772*^9, 3.427288518736206*^9}}],

Cell["UncheckedQuoin assumes a < b < c", "Text",
 CellChangeTimes->{{3.427284759997241*^9, 3.427284769817522*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UncheckedQuoin", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "u2", ",", "atu", ",", "g1", ",", "quo", ",", "fh", ",", "g2", ",", "z",
        ",", "g3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "^", "2"}], "-", 
          RowBox[{"b", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", "^", "2"}], "-", 
          RowBox[{"a", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"atu", "=", 
       RowBox[{"Matan", "[", "u2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", "-", "a"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "^", "2"}], "+", 
          RowBox[{"a", "*", "c"}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"c", "^", "2"}]}]}], ")"}], "*", "atu"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quo", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", "^", "2"}], "-", 
          RowBox[{"a", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "+", "c"}], ")"}], "^", "4"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fh", "=", 
       RowBox[{"u2", "^", 
        RowBox[{"(", 
         RowBox[{"5", "/", "2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g2", "=", 
       RowBox[{"quo", "*", "fh", "*", 
        RowBox[{"Rogers", "@", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "b"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"b", "-", "a"}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"b", "+", "c"}], ")"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g3", "=", 
       RowBox[{"4", " ", 
        RowBox[{"c", "^", "3"}], "*", 
        RowBox[{"Matan", "[", "z", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "6"}], "*", 
       RowBox[{"(", 
        RowBox[{"g1", "+", "g2", "+", "g3"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284756770967*^9, 3.427284797420898*^9}, {
  3.427284841472872*^9, 3.4272848423332376`*^9}, {3.4272885230836067`*^9, 
  3.427288524219698*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Quoin", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{"b", "\[LessEqual]", "a"}], ",", 
         RowBox[{"c", "\[LessEqual]", "b"}]}], "]"}], ",", "0", ",", 
       RowBox[{"UncheckedQuoin", "@", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}]}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.427285288699965*^9, 3.427285289351506*^9}, {
  3.427288529055119*^9, 3.4272885301420918`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QX", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", " ", "x2_", ",", " ", "x3_"}], "}"}]}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Quoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "x1", "]"}], "/", "2"}], ",", 
        RowBox[{"EtaX", "[", 
         RowBox[{"x1", ",", " ", "x2", ",", "x3"}], "]"}], ",", "t"}], "}"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427284902009779*^9, 3.4272849176577253`*^9}, {
  3.427284977707459*^9, 3.427285022588673*^9}, {3.427288532335223*^9, 
  3.427288556926807*^9}, {3.427288657624831*^9, 3.4272886592895412`*^9}}],

Cell["Volume of all 6 quoins of a tetrahedron.", "Text",
 CellChangeTimes->{{3.455766858669235*^9, 3.455766867123928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuoinsX", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "4"}], " ", "Doct", "*", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", " ", "x2", ",", "x6"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x1", ",", "x6"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "x3", ",", "x4"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x3", ",", "x2", ",", "x4"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "x3", ",", "x5"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"QX", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"x3", ",", "x1", ",", "x5"}], "}"}]}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427285029772208*^9, 3.427285074609727*^9}, {
  3.4272852459439087`*^9, 3.427285246332856*^9}, {3.427285327663212*^9, 
  3.427285327936612*^9}, {3.427288566283248*^9, 3.427288603010895*^9}, {
  3.42728866604508*^9, 3.427288703208272*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Truncated Volume", "Section",
 CellChangeTimes->{{3.42728531038183*^9, 3.4272853225305347`*^9}}],

Cell["The volume of a truncated Voronoi polyhedron.  See SPI.", "Text",
 CellChangeTimes->{{3.4557668807473793`*^9, 3.4557669112902613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "[", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "t_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"Doct", "*", "h", "*", "t", "*", 
          RowBox[{"(", 
           RowBox[{"h", "+", "t"}], ")"}]}]}], ")"}], "/", "3"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4272853826934958`*^9, 3.427285385844404*^9}, {
  3.427286279136269*^9, 3.427286281796198*^9}}],

Cell["UncheckedVorstarFactor assumes h <= t", "Text",
 CellChangeTimes->{{3.427286287630261*^9, 3.427286302704257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UncheckedVorstarFactor", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "h_", ",", "t_", ",", "phi0_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"a", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"h", "/", "t"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Phi", "@", 
         RowBox[{"{", 
          RowBox[{"h", ",", "t"}], "}"}]}], "-", "phi0"}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.427286315706451*^9, 3.427286338842393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VorstarFactor", "[", "args__", "]"}], ":=", "\[IndentingNewLine]",
    
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"args", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
        RowBox[{"args", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"UncheckedVorstarFactor", "@", "args"}], ",", "0"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4272863411178493`*^9, 3.427286422749506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vorstar", "[", 
     RowBox[{"{", 
      RowBox[{"t_", ",", 
       RowBox[{"{", 
        RowBox[{
        "h1_", ",", "h2_", ",", "h3_", ",", "a1_", ",", "a2_", ",", "a3_"}], 
        "}"}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "phi0", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phi0", "=", 
        RowBox[{"Phi", "@", 
         RowBox[{"{", 
          RowBox[{"t", ",", "t"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VorstarFactor", "@", 
         RowBox[{"{", 
          RowBox[{"a1", ",", "h1", ",", "t", ",", "phi0"}], "}"}]}], "+", 
        RowBox[{"VorstarFactor", "@", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "h2", ",", "t", ",", "phi0"}], "}"}]}], "+", 
        RowBox[{"VorstarFactor", "@", 
         RowBox[{"{", 
          RowBox[{"a3", ",", "h3", ",", "t", ",", "phi0"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a1", "+", "a2", "+", "a3", "-", "Pi"}], ")"}], "*", 
         "phi0"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VortNoQuoinsX", "[", 
     RowBox[{"{", 
      RowBox[{"t_", ",", 
       RowBox[{"{", 
        RowBox[{
        "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
        "}"}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h1", ",", "h2", ",", "h3", ",", "a1", ",", "a2", ",", "a3"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h1", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", "x1", "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"h2", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", "x2", "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"h3", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", "x3", "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{"DihX", "@", "xs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a2", "=", 
        RowBox[{"Dih2X", "@", "xs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a3", "=", 
        RowBox[{"Dih3X", "@", "xs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Vorstar", "@", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{
           "h1", ",", "h2", ",", "h3", ",", "a1", ",", "a2", ",", "a3"}], 
           "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VortX", "[", 
     RowBox[{"{", 
      RowBox[{"t_", ",", "xs__"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VortNoQuoinsX", "@", 
        RowBox[{"{", 
         RowBox[{"t", ",", "xs"}], "}"}]}], "+", 
       RowBox[{"QuoinsX", "@", 
        RowBox[{"{", 
         RowBox[{"t", ",", "xs"}], "}"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VorDodecX", "[", "xs__", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"VortX", "@", 
       RowBox[{"{", 
        RowBox[{"DodecTrunc", ",", "xs"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TruncatedVolumeX", "[", "xs__", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VorDodecX", "@", "xs"}], "-", 
        RowBox[{
         RowBox[{"4", "/", "3"}], "*", 
         RowBox[{"SolX", "@", "xs"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "Doct"}], ")"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.427286435131048*^9, 3.427286601842058*^9}, {
   3.427286845429657*^9, 3.427286845740409*^9}, 3.456362348402432*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Omega]", "Section",
 CellChangeTimes->{{3.4292331003363733`*^9, 3.429233101517926*^9}, {
  3.429233136227614*^9, 3.4292331417379313`*^9}, {3.45576667241191*^9, 
  3.455766672412848*^9}}],

Cell["\<\
\[Omega], the principle volume function in the dodecahedral conjecture, is \
defined by case analysis on the circumradii of the faces of a terahedron.  If \
any of the circumradii are greater than Sqrt[2] then we used the truncated \
volume function.  Otherwise the volume is untruncated.\
\>", "Text",
 CellChangeTimes->{{3.429233151463757*^9, 3.429233246077745*^9}, {
  3.4557666772271*^9, 3.455766704896896*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OmegaX", "[", 
    RowBox[{
    "x1_", ",", " ", "x2_", ",", " ", "x3_", ",", " ", "x4_", ",", " ", "x5_",
      ",", " ", "x6_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"EtaX", "[", 
          RowBox[{"x1", ",", " ", "x2", ",", " ", "x6"}], "]"}], " ", ">", 
         " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"EtaX", "[", 
          RowBox[{"x1", ",", " ", "x3", ",", " ", "x5"}], "]"}], " ", ">", 
         " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"EtaX", "[", 
          RowBox[{"x2", ",", " ", "x3", ",", " ", "x4"}], "]"}], " ", ">", 
         " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"EtaX", "[", 
          RowBox[{"x4", ",", " ", "x5", ",", " ", "x6"}], "]"}], " ", ">", 
         " ", 
         RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TruncatedVolumeX", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VolumeX", "[", 
        RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}],
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.429233249885613*^9, 3.429233412037093*^9}, {
  3.456362328152927*^9, 3.456362333975779*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross diagonal of a quad cluster", "Section",
 CellChangeTimes->{{3.427286623215075*^9, 3.427286628879731*^9}}],

Cell["\<\
Given 2 tetrahedra that share a face, the cross diagonal is the distance \
between the 2 points that are not on the face. \
\>", "Text",
 CellChangeTimes->{{3.455766562864156*^9, 3.455766647847088*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dist", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", " ", "y1_", ",", " ", "z1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2_", ",", "y2_", ",", " ", "z2_"}], "}"}]}], "}"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y2", "-", "y1"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z2", "-", "z1"}], ")"}], "^", "2"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindPoint", "[", 
     RowBox[{"{", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "y4_", ",", "v31_", ",", "v32_", ",", 
       "sgn_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y5", ",", "w1", ",", "w2", ",", "w3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y5", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"v31", "*", "v31"}], "+", 
          RowBox[{"v32", "*", "v32"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"w1", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "a"}], "+", 
           RowBox[{"y4", "*", "y4"}], "-", 
           RowBox[{"b", "*", "b"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "y4"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "*", "a"}], "+", 
           RowBox[{"y5", "*", "y5"}], "-", 
           RowBox[{"c", "*", "c"}], "-", 
           RowBox[{"2", "*", "w1", "*", "v31"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "v32"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"w3", "=", 
        RowBox[{"sgn", "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a", "*", "a"}], "-", 
           RowBox[{"w1", "*", "w1"}], "-", 
           RowBox[{"w2", "*", "w2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
        
       RowBox[{"{", 
        RowBox[{"w1", ",", "w2", ",", "w3"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Enclosed", "[", 
     RowBox[{"{", 
      RowBox[{
      "y1_", ",", "y2_", ",", "y3_", ",", "y4_", ",", "y5_", ",", "y6_", ",", 
       "z1_", ",", "z2_", ",", "z3_"}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "v4", ",", "v5"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y5", "*", "y5"}], "+", 
           RowBox[{"y4", "*", "y4"}], "-", 
           RowBox[{"y6", "*", "y6"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "y4"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"y5", "*", "y5"}], "-", 
          RowBox[{"a", "*", "a"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v4", "=", 
        RowBox[{"FindPoint", "@", 
         RowBox[{"{", 
          RowBox[{
          "y3", ",", "y2", ",", "y1", ",", "y4", ",", "a", ",", "b", ",", 
           "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v5", "=", 
        RowBox[{"FindPoint", "@", 
         RowBox[{"{", 
          RowBox[{
          "z3", ",", "z2", ",", "z1", ",", "y4", ",", "a", ",", "b", ",", 
           RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Dist", "[", 
        RowBox[{"{", 
         RowBox[{"v4", ",", "v5"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CrossDiagY", "[", 
     RowBox[{"{", 
      RowBox[{
      "y1_", ",", "y2_", ",", "y3_", ",", "y4_", ",", "y5_", ",", "y6_", ",", 
       "y7_", ",", "y8_", ",", "y9_"}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Enclosed", "[", 
       RowBox[{"{", 
        RowBox[{
        "y1", ",", "y5", ",", "y6", ",", "y4", ",", "y2", ",", "y3", ",", 
         "y7", ",", "y8", ",", "y9"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CrossDiagX", "[", "xs__", "]"}], ":=", 
   RowBox[{"CrossDiagY", "@", 
    RowBox[{"Sqrt", "[", "xs", "]"}]}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.427286640926284*^9, 3.427286790753196*^9}, {
  3.4272868276797333`*^9, 3.4272868343952303`*^9}, {3.45636230205053*^9, 
  3.456362323192458*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{950, 732},
WindowMargins->{{89, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"6.0 for Mac OS X x86 (32-bit) (March 13, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 374, 6, 70, "Title"],
Cell[CellGroupData[{
Cell[989, 33, 28, 0, 34, "Subsection"],
Cell[1020, 35, 185, 5, 41, "Text"],
Cell[1208, 42, 758, 13, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2003, 60, 94, 1, 67, "Section"],
Cell[2100, 63, 232, 5, 26, "Text"],
Cell[2335, 70, 1526, 37, 88, "Input"],
Cell[3864, 109, 220, 5, 26, "Text"],
Cell[4087, 116, 1172, 32, 73, "Input"],
Cell[CellGroupData[{
Cell[5284, 152, 558, 13, 27, "Input"],
Cell[5845, 167, 440, 7, 27, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6334, 180, 107, 4, 89, "Section"],
Cell[6444, 186, 139, 1, 26, "Text"],
Cell[6586, 189, 2486, 60, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9109, 254, 145, 2, 67, "Section"],
Cell[9257, 258, 212, 4, 26, "Text"],
Cell[9472, 264, 671, 15, 73, "Input"],
Cell[10146, 281, 251, 5, 26, "Text"],
Cell[10400, 288, 2113, 54, 178, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12550, 347, 91, 1, 67, "Section"],
Cell[12644, 350, 188, 4, 26, "Text"],
Cell[12835, 356, 837, 24, 73, "Input"],
Cell[13675, 382, 686, 19, 73, "Input"],
Cell[14364, 403, 1145, 28, 73, "Input"],
Cell[15512, 433, 2652, 71, 223, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18201, 509, 144, 2, 67, "Section"],
Cell[18348, 513, 823, 18, 63, "Text"],
Cell[19174, 533, 294, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[19493, 545, 159, 3, 27, "Input"],
Cell[19655, 550, 327, 5, 27, "Output"]
}, Open  ]],
Cell[19997, 558, 204, 5, 27, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20238, 568, 91, 1, 67, "Section"],
Cell[20332, 571, 209, 4, 26, "Text"],
Cell[20544, 577, 560, 18, 43, "Input"],
Cell[21107, 597, 109, 1, 26, "Text"],
Cell[21219, 600, 698, 19, 73, "Input"],
Cell[21920, 621, 155, 3, 26, "Text"],
Cell[22078, 626, 582, 16, 73, "Input"],
Cell[22663, 644, 115, 1, 26, "Text"],
Cell[22781, 647, 1490, 41, 88, "Input"],
Cell[24274, 690, 114, 1, 26, "Text"],
Cell[24391, 693, 2914, 85, 193, "Input"],
Cell[27308, 780, 663, 19, 27, "Input"],
Cell[27974, 801, 830, 21, 73, "Input"],
Cell[28807, 824, 122, 1, 26, "Text"],
Cell[28932, 827, 1852, 49, 163, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30821, 881, 102, 1, 67, "Section"],
Cell[30926, 884, 141, 1, 26, "Text"],
Cell[31070, 887, 649, 18, 73, "Input"],
Cell[31722, 907, 119, 1, 26, "Text"],
Cell[31844, 910, 690, 20, 73, "Input"],
Cell[32537, 932, 634, 17, 73, "Input"],
Cell[33174, 951, 4353, 124, 493, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37564, 1080, 194, 3, 67, "Section"],
Cell[37761, 1085, 425, 7, 41, "Text"],
Cell[38189, 1094, 1636, 40, 118, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39862, 1139, 117, 1, 67, "Section"],
Cell[39982, 1142, 212, 4, 26, "Text"],
Cell[40197, 1148, 5222, 147, 463, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
