% 
% Author: Thomas C. Hales
% Affiliation: University of Pittsburgh
% email: hales@pitt.edu
%
% latex format

% History.  File started Sep 12, 2011
%% 

% XX Issues:
% proof of strong hex. inequality.
% aD bD don't agree with Dense Sphere Packings
% figures.

\documentclass{llncs}
\pagestyle{headings} 
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amscd}
\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{alltt}
\usepackage{rotating}
\usepackage{floatpag}
 \rotfloatpagestyle{empty}
\usepackage{graphicx}
\usepackage{multind}\ProvidesPackage{multind}
\usepackage{times}

% my additions
\usepackage{verbatim}
\usepackage{latexsym}
\usepackage{crop}
\usepackage{txfonts}
\usepackage[hyphens]{url}
\usepackage{setspace}
\usepackage{ellipsis} % 
% http://www.ctan.org/tex-archive/macros/latex/contrib/ellipsis/ellipsis.pdf 

% fonts
\usepackage[mathscr]{euscript} % powerset.
\usepackage{pifont} %ding
\usepackage[displaymath]{lineno}
\usepackage{rotating}


%tikz graphics
\usepackage{xcolor}
\usepackage{tikz}
\usetikzlibrary{chains,shapes,arrows,trees,matrix,positioning,decorations,backgrounds,fit}


% automatically generate revision number by
% svn propset svn:keywords "LastChangedRevision" sdodec.tex
\def\svninfo{{\tt
  filename: sdodec.tex\hfill\break
  PDF generated from LaTeX sources on \today; \hfill\break
  Repository Root: https://flyspeck.googlecode.com/svn \hfill\break
  SVN $LastChangedRevision$
  }
  }
%-%

% Math notation.
%\def\op#1{{\hbox{#1}}} 
\def\tc{\hbox{:}}
%\newcommand{\ring}[1]{\mathbb{#1}}
\def\amp{\text{\&}}
\def\bq{\text{\tt {`}\,}}
\def\true{\text{true}}
\def\false{\text{false}}
\def\princ#1{\smallskip\hfill\break\smallskip\centerline{\it #1\hfill}}
\def\area{\op{area}}
% Flags

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title{The Strong Dodecahedral Conjecture and\\ Fejes T\'oth's Contact Conjecture}
\author{Thomas C. Hales\thanks{{Research supported in part by 
NSF grant 0804189 and the Benter Foundation.}}}
\institute{University of Pittsburgh\\
\email{hales@pitt.edu}}
\maketitle


\begin{abstract} This article sketches the proof of two theorems in
  the theory of sphere packings in Euclidean $3$-space.  The first is
  K. Bezdek's strong dodecahedral conjecture: the surface area of
  every bounded Voronoi cell in a packing of balls of radius $1$ is at least
  that of a regular dodecahedron of inradius $1$.  The second theorem
  is L. Fejes T\'oth's contact conjecture, which asserts that in
  $3$-space, any packing of congruent balls such that each ball is
  touched by twelve others consists of hexagonal layers.  Both proofs
  are computer assisted.  Complete proofs of these theorems
  appear in the author's forthcoming book ``Dense Sphere Packings.''
\end{abstract}

\input {../../kepler_tex/kepmacros.tex}

\section{The strong hexagonal conjecture}

To describe methods, we begin with a  proof of the following elementary computer-assisted
theorem in $\ring{R}^2$.  

\begin{theorem}  The perimeter of any bounded Voronoi cell of a packing of congruent balls of radius $1$
in $\ring{R}^2$ is at least $4\sqrt{3}$, the perimeter of a regular hexagon with inradius $1$.
\end{theorem}

If we adopt the convention that the perimeter of an unbounded Voronoi cell is infinite, then
the boundedness hypothesis can be dropped from the theorem.

\begin{proof} Fix a bounded Voronoi cell of in a packing of congruent
  balls of radius $1$ and fix a coordinate system with the center of
  the Voronoi cell at the origin.  The intersection of the Voronoi
  cell with a disk of radius $\sqrt2$ at the origin is convex disk
  whose boundary $C$ consists of circular arcs and straight line
  segments.  The length of $C$ is no greater than the original
  perimeter of the Voronoi cell.  It suffices to show that the length
  of $C$ is at least $4\sqrt{3}$.



The boundary $C$ is determined by the set of centers $V$ of balls at
distance less than $\sqrt8$ from the origin, excluding the ball
centered at the origin.

The following function arises in the proof of the dodecahedral
conjecture in three-dimensions.  We will return to it later.
\begin{equation}
L(h) = \begin{cases} 
   (h_0-h)/(h_0-1),& \text{if } h \le h_0,\\
  0,&\text{ otherwise},
 \end{cases}
\end{equation}
where $h_0 = 1.26$. 

Let $\u_1,\u_2\in V$ be distinct points such that
$T=\{\orz,\u_1,\u_2\}$ has circumradius less than $\sqrt2$.  Let
$\ell(\u_1,\u_2)$ be the part of $C$ contained in the convex hull of
$T$, and let $\theta$ be the angle at $\orz$ between $\u_1$ and
$\u_2$. 
The following inequality has been verified by computer using interval
arithmetic.
\begin{equation}\label{eqn:ineq}
\ell(\u_1,\u_2) - b \theta(\u_1,\u_2) - c L(\normo{\u_1}/2) - c L(\normo{\u_2}/2)) \ge 0,
\end{equation}
where $b=4/3$ and $c=\sqrt3/3 - 2\pi/9 \approx -0.12$.
Equality holds when $T$ is an equilateral triangle with side $2$.

\begin{remark}
Let $\u_1(t)$ and $\u_2(t)$ be points such  that
\[
\normo{\u_1(t)}=\normo{\u_2(t)}=2,\quad \norm{\u_1(t)}{\u_2(t)}=t,
\]
that is a triangle at the origin with sides $2,2,t$.   The constants $b$ and $c$ are the unique choice
of constants that give the left-hand side of (\ref{eqn:ineq}) a local minimum with value
$0$ at $t=2$.
\end{remark}

The entire boundary $C$ can be partitioned into finitely many (a) pieces lying in convex hulls
of triangles $T$,  (b) arcs of circles of radius $2$, and (c)  linear segments
 from $\u/2$, where $\u\in V$, to a point on the circle of radius $\sqrt2$ centered at the origin.

We extend the inequality (\ref{eqn:ineq}) to boundary arcs of type (b) in the form
\begin{equation}\label{eqn:ineq2}
\ell - b \theta \ge 0
\end{equation}
where $\ell$ is the length of the circular arc and $\theta$ is the subtended angle.
This inequality is obvious, because $\ell = \sqrt2\,\theta$, and $\sqrt2>b = 4/3$.
We extend the inequality (\ref{eqn:ineq}) to segments of type (c) in the form
\begin{equation}\label{eqn:ineq3}
\ell(\v) - b\theta(\v) - c L(h) \ge 0,
\end{equation}
where $h =\normo{\v}/2$, $\theta$ is the subtended angle at the origin, and $\ell = \sqrt{2-h^2}$
is the length of the the segment.  
When $h\le h_0$,  inequality (\ref{eqn:ineq3}) is a consequence of inequality (\ref{eqn:ineq}), because
the segment can be reflected through a mirror to form the two segments in (\ref{eqn:ineq}).
When $h\ge h_0$, the term $L(h)$ is zero.  In this case, basic calculus gives the inequality.

Let $\ell_C$ be the length of $C$.
We sum the inequalities over the boundary pieces of $C$ of types (a), (b), and (c),
using inequalities (\ref{eqn:ineq}), (\ref{eqn:ineq2}), and (\ref{eqn:ineq3}):
\[
\ell_C - b (2\pi) - 2 c \sum_{\v\in V} L(\normo{\v}/2) \ge 0.
\]
The function $L$ is zero on $\{h \mid h\ge h_0\}$.  We drop such terms from the sum.
By Lemma~\ref{lemma:L} this gives
\[
\ell_C \ge 2 \pi b + 12 c = 4\sqrt3.
\]
This proves the theorem.
\end{proof}

The following lemma is used in the proof

\begin{lemma}\label{lemma:L}
  Let $V$ be a set of points contained in a closed annulus at the
  origin of inner radius $2$ and outer radius $2h_0$.  Assume that
  the mutual separation of points in $V$ is at least $2$.  Then
\[
\sum_{\v\in V} L(\normo{\v}/2) \le 6.
\]
Equality is obtained uniquely when $V$ is the set of extreme points of a regular hexagon
of circumradius $2$.
\end{lemma}

\begin{proof}
In case $\card(V)\le 6$,
by the inequality $L(\normo{\v}/2)\le 1$,
 it is clear that the sum is at most $6$, with equality uniquely
obtained for the regular hexagon of circumradius $2$.  
An easy estimate shows that the angles at the origin between $\u,\v\in V$ is greater than
$\pi/4$, so that $\card(V)\le 7$.  We may therefore assume without loss of generality 
that $\card(V)=7$.

We index the $7$ points $\v_i$ by $i\in\ring{Z}/7\ring{Z}$ in their
natural cyclic order around the annulus.  Let $\theta_i$ be the angle
subtended at the origin between $\v_i$ and $\v_{i+1}$.  Let 
\[
\alpha_i = \arccos(\normo{\v}/4) - \pi/6.
\]
We have the following inequality
\begin{equation}\label{eqn:theta-alpha}
\theta_i \ge \alpha_i + \alpha_{i+1},\quad i\in \ring{Z}/7\ring{Z},
\end{equation}
which is proved by basic calculus: it follows from the intermediate
value theorem and from an explicit analytic formula for the terms in
the inequality~\cite{DSP}.
Further, we have
\begin{equation}\label{eqn:alpha}
  \alpha_i - 0.16\, L(\normo{\v_i}/2) - 0.32 \ge0
\end{equation}
which is also proved by basic calculus: by a second derivative test the left-hand side
is concave as a function of  $\normo{\v_i}$ so that the inequality holds if it holds at the
endpoints $\normo{\v_i}=2,2.52$, which is easily checked.

Summing $\theta_i$ over $i$ we get
\[
2\pi  = \sum_i \theta_i \ge 2\sum_i \alpha_i \ge 2 (0.16) (\sum_i L(\normo{\v_i}/2)) + 14 (0.32).
\]
Computing constants, we get
\[
6 > \sum_i L(\normo{\v_i}/2).
\]
\end{proof}

\begin{remark}
The proof has been carried out in two stages.  In the first stage the perimeter problem is
converted into an estimate of $\sum L(\cdot)$.  In the second stage the estimate 
of $\sum L(\cdot)$ is established.
\end{remark}


\section{Marchal cells}

In this section, we give details of the partition of the boundary $C$
into segments.  The partition is based on the partition of Euclidean
space into Marchal cells~\cite{marchal:2009}.

Figure~\ref{fig:mar} shows a set $V$ of six points.  We use the
constant $\sqrt2$ to partition the plane into levels $0,\ldots,3$.
Every point has level $\ge 0$.
For every $\v\in V$, we form a closed disk of radius $\sqrt2$.  A
point at level $\ge1$ is one that lies inside these disks.  We form a
closed rhombus of side $\sqrt2$ for every pair of distinct points in
$V$ whose separation is less than $\sqrt8$.  A point of level $\ge2$
is a point that lies in these rhombi.  We form a closed triangle
for every triple of distinct points in $V$ whose circumradius is less
than $\sqrt2$.  A point of level $3$ is a point that lies inside
these triangles.  A point of level $k$
is a point of level $\ge k$ that does not have level $\ge k+1$.

The points of a given level can be further partitioned using the
Rogers partition of the plane into simplices.  For each
$k=0,\ldots,3$, Rogers simplices that meet the set of level $k$ can be naturally grouped
into collections of $k!$ simplices.  If $P$ is the union of the $k!$ simplices. The
set of points of level $k$ in $P$ is called a Marchal $k$-cell $P_k$.

The construction can be generalized to three or more dimensions,
again using the parameter $\sqrt2$   In $n$ dimensions, the levels extend
from $0$ to $n+1$ in an analogous manner.  Let $S\subset V$ be a set of
cardinality $k+1$ whose circumradius is less than $\sqrt2$.
The shapes used to define level sets are the convex hulls of
\[
S \cup X_S
\]
where $X_S$ is the set of points at equidistance $\sqrt2$ from every
point of $S$.  When $n=3$, the shapes are balls of radius $\sqrt2$,
bi-cones, bi-pyramids, and tetrahedra (Figure~\ref{fig:mar3}).  Again
in higher dimensions, the Rogers simplices can be grouped into
collections of $k!$ simplices, giving Marchal $k$-cells $P_k$, at each
level $k$.

\begin{remark}  Marchal introduced cells to show that the Kepler conjecture in three-dimensions
can
be reduced to an inequality of the form
\[
\sum_{\v\in V} M(\normo{\v}) \le 12,
\]
where $M$ is a certain quartic polynomial, and $V$ is a finite packing in three dimensions
that is a subset of a closed annulus of inner radius $2$ and outer
radius $\sqrt8$.  
\end{remark}

\begin{remark}
The book~\cite{DSP} strengthens Marchal's argument to reduce
the Kepler conjecture to the inequality
\begin{equation}\label{eqn:L12}
\sum_{\v \in V} L(\normo{\v}/2) \le 12,
\end{equation}
where $L$ is the function defined above, and $V$ is a packing in the
annulus with inner radius $2$ and outer radius $2h_0$.  (In adapting
this inequality from dimension two to dimension three, the
two-dimensional kissing number $6$ is replaced with the
three-dimensional kissing number $12$.) The book also gives a
computer-assisted proof of the inequality (\ref{eqn:L12}), to obtain a
new proof of the Kepler conjecture.  This article shows how to deduce
the strong dodecahedral conjecture and Fejes T\'oth's contact
conjecture from (\ref{eqn:L12}). An old conjecture by L. Fejes
T\'oth~\cite[p.~178]{Toth:1972:Lagerungen} asserts that the minimum of
\begin{equation}\label{eqn:FT}
\sum_{\v\in V} \normo{\v},
\end{equation}
is $24+ 14/\sqrt{27}\approx 26.69$
as $V$ runs over packings of cardinality $13$ contained in a closed
annulus with inner radius $2$ and outer radius $\sqrt8$.  The
inequality (\ref{eqn:L12}) implies that
\begin{equation}\label{eqn:FT}
\sum_{\v\in V} \normo{\v}\ge 24 + 2 h_0 = 26.52.
\end{equation}
The inequality (\ref{eqn:L12}) also gives upper bounds for the Tammes
problem when $\card(V)=13,14,15$, but these upper bounds are weaker
than those known by semi-definite programming~\cite{BV08}.
\end{remark}

\section{Strong Dodecahedral Conjecture}

This section sketches a proof of the strong dodecahedral conjecture:

\begin{theorem}
The surface area of every  bounded Voronoi cell in a packing of balls of radius $1$ is
at least the surface area of a regular dodecahedron of inradius $1$.  Equality is
obtained exactly when the bounded Voronoi cell is itself a regular dodecahedron.
\end{theorem}

\begin{remark} Fejes T\'oth's classical dodecahedral conjecture is the
  same statement, replacing {\it surface area} with {\it volume}.  To
  deduce the volume statement from the surface area statement, it is
  enough to note that if a face of the Voronoi cell has area $B$ and
  if the distance from the affine hull of the face from the origin is
  $h$, then the volume of the cone over a face is $B h/3 \ge B/3$.
  Hence a lower bound on the surface area gives a lower bound on the
  volume as well.
\end{remark}

\begin{proof}
We pick coordinates so that the center of a chosen bounded is is at the origin.
As in the two-dimensional case, we may intersect the Voronoi cell with a ball of radius
$\sqrt2$.  The  boundary $C$ after truncation is no greater than before.
Let $V$ be the set of centers of the packing in the annulus with inner radius $2$ and
outer radius $\sqrt8$.

There is a partition $C\cap P_k$ of  $C$ associated with the set of
Marchal $k$-cells $P_k$ associated with  Rogers simplices at the origin. 
Write 
\[
\area(C) = \sum_{P_k} \area(C\cap P_k),
\]
for the areas of the various contributions.
Write $\sol(P_k)$ for the solid angle of the Marchal cell at the origin, and write
$\dih(P_k,\v)$ for the dihedral angle of a Marchal cell $P_k$ along the edge through
the line through $\{\orz,\v\}$.  

As a reference cell, we let $P_{D,4}$ be a Marchal $4$-cell of the packing giving the
regular dodecahedron
of inradius $1$.  There exist constants $a_D$ and $b_D>0$ such
that
\begin{equation}\label{eqn:dodec}
\area(C\cap P_k) +  a_D \sol(P_k) + b_D \sum_{\v\in P_k\cap V} L(\normo{\v}/2)\dih(P_k,\v) \ge0,
\end{equation}
for all $k$-cells $P_k$ and for all $V$.  The constants $a_D$ and
$b_D$ are uniquely determined if we insist that equality is attained
when $P_k = P_{D,4}$.  This inequality has been proved by computer by
interval arithmetic.  In more detail, the constants $a_D$ and $b_D$
are determined by considering a $1$-dimensional family $P_4(t)$ of
tetrahedra with sides $2,2,2,t,t,t$, for $t\in \ring{R}$ where the
three edges of length $2$ meet at the origin.  When $t=t_D\approx
2.1029$ (the separation of balls in the arrangement giving the regular
dodecahedron), $P_4(t_D)$ is congruent to $P_{D,4}$.  Forcing the
equality to be exact and the derivative to vanish when $t=t_D$, we
obtain two linear equations in two unknowns that determine $a_D$ and
$b_D$.

If we sum (\ref{eqn:dodec}) over all cells, the solid angles sum to $4\pi$, dihedral
angles sum to $2\pi$, and $L$ sums to at most $12$ by Ineq. (\ref{eqn:L12}), giving
\[
\area(C) = \sum_{P_k}\area(C\cap P_k) \ge -a_D 4\pi - b_D (2\pi) (12).
\]
By the choice of $a_D$ and $b_D$, equality is obtained for the boundary
$C_D$ of the regular dodecahedron, 
\[
\area(C_D) = -a_D 4\pi - b_D (2\pi) (12).
\]
Hence $\area(C)\ge \area(C_D)$. This is the desired conclusion.  Tracing through
the case of equality, inequality (\ref{eqn:dodec}) is an equality exactly when the cell
has measure zero or is congruent to $P_{D,4}$.
\end{proof}


\section{Fejes T\'oth's Contact Conjecture}


L. Fejes T\'oth conjectured the following result in
1969~\cite{Fejes-Toth:69},~\cite{Fejes-Toth:89}. 

\begin{theorem}
  In $3$-space any packing of equal ball such that each ball is touched
  by twelve others consists of hexagonal layers.
\end{theorem}

The proof of this theorem is much longer than the proof of the strong
dodecahedral conjecture.  This section describes the proof strategy.
The details are found in~\cite{DSP}.

It is enough to prove that the contact pattern of every ball is the hexagonal-close
packing (HCP) or face-centered cubic (FCC) kissing arrangement, because these can only be
extended in hexagonal layers.

\begin{lemma} Let $V$ be a packing in which every ball touches twelve others.
Then for all distinct $\u,\v\in V$, either $\norm{\u}{\v}=2$ or $\norm{\u}{\v}\ge 2h_0$.
\end{lemma}

\begin{proof}
Let $ \u_1,\ldots, \u_{12}$ be the twelve kissing points
  around $\u$.  Assume that $\v\ne \u_i,\u$.  By
  Inequality~(\ref{eqn:L12}),
\[
   L(h( \u, \v))  + 12 
  =  L(h( \u, \v)) + \sum_{i=1}^{12} L(h( \u, \u_i))  \le 12.
\]
This implies that $L(h( \u, \v))\le 0$, so $\norm{ \u}{ \v}\ge 2h_0$.
\end{proof}

\begin{definition}
  Let $S^2$ be the sphere of radius $2$, centered at $\orz$.  Let
  $\CalV$ be the set of packings $V\subset \ring{R}^3$ such that
\begin{enumerate}
\item $\card(V) = 12$,
\item $V\subset S^2$.
\item $\norm{\u}{\v} \in \{0,2\}\cup
  \leftclosed2.52,4\rightclosed$ for all $\u,\v\in V$.
\end{enumerate}
For each $V\in \CalV$, let $E_{ctc}$ be the contact graph on vertex set $V$;
that is, the set of $\{\u,\v\}\subset V$ such that $\norm{\u}{\v}=2$.
\end{definition}

It is well-known that $(V,E_{ctc})$ is a planar graph for all $V\in \CalV$.
The complement in $\ring{R}^3$ of the union of cones
\[
\{ s \u + t \v \mid s\ge0,~ t\ge 0\},   \quad \{\u,\v\}\in E_{ctc},
\]
is the union of finitely many  connected components $U_F$.  We write
$\sol(U_F)$ for the solid angle of $U_F$ at the origin. Their solid angles sum to $4\pi$:
\[
4\pi = \sum_{U_F} \sol(U_F).
\]

When $V\in \CalV$, each $U_F$ is bounded by a finite number $k(U_F)\in\ring{N}$ of
cones.  Write
\[
\tau(V,E_{ctc},F) = \sol(U_F) + (2 - k(U_F))\sol_0,
\]
where $\sol_0$ is the solid angle of an equilateral spherical triangle
on the unit sphere of side $\pi/3$.

Using Lexell theorem, we obtain
lower bounds on the function $\tau(V,E_{ctc},F)$ as a function of
$k(F)$.  This is used to constrain the combinatorial possibilities of
the graph.  A computer search is made of all planar graphs satisfying
the combinatorial properties obtained from the study of $\tau$.  As it
turns out, there are only eight possibilities.  Two of the eight
possibilities are the HCP and FCC.  Five of the six are subsequently eliminated
with linear programming inequalities.

The final case is the graph shown in Figure~\ref{fig:fthex}.  It is
eliminated with the following observations.  The perimeter of a
hexagon with sides $\pi/3$ is $2\pi$.  However, the hexagons in the graph are
nonreflexive, and $2\pi$ is a strict upper bound on the perimeter of a
nonreflexive hexagon.  Thus, this case does not admit a geometric realization
as a contact graph.   Fejes T\'oth's contact
conjecture ensues.


\tikzfig{fthex}
{This planar graph is not a contact graph.}
{
[scale=0.004]
% java render/Gentikz "125913905253 14 6 0 1 2 3 4 5 3 0 5 6 3 6 5 7 3 7 5 4 3 7 4 8 3 8 4 3 3 8 3 9 3 9 3 2 3 9 2 10 3 10 2 1 3 10 1 11 3 11 1 0 3 11 0 6 6 6 7 8 9 10 11 "
%tikz format auto generated by Gentikz, then hand edited.
%in LaTeX file, enclose code in tikzpicture environment
% invariant: 125913905253
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {};
\path (60:400)  node (P1) {};
\path (120:400) node (P2) {};
\path ( -400,0) node (P3) {};
\path ( -200,-346) node (P4) {};
\path ( 200,-346) node (P5) {};
\path (330:220) node (P6) {};
\path (270:220) node (P7) {};
\path(210:220) node (P8) {};
\path (30:220) node (P11) {};
\path (150:220) node (P9) {};
\path (90:220) node (P10) {}; 
%Draw edges:
\draw
  (P0) -- (P5)
  (P0) -- (P1)
  (P0) -- (P11)
  (P0) -- (P6)
  (P1) -- (P2)
  (P1) -- (P10)
  (P1) -- (P11)
  (P2) -- (P3)
  (P2) -- (P9)
  (P2) -- (P10)
  (P3) -- (P4)
  (P3) -- (P8)
  (P3) -- (P9)
  (P4) -- (P5)
  (P4) -- (P7)
  (P4) -- (P8)
  (P5) -- (P6)
  (P5) -- (P7)
  (P6) -- (P11)
  (P6) -- (P7)
  (P7) -- (P8)
  (P8) -- (P9)
  (P9) -- (P10)
  (P10) -- (P11)
;
}

\raggedright
\bibliographystyle{amsalpha} % was plain %plainnat
\bibliography{/Users/thomashales/Desktop/googlecode/flyspeck/latex/bibliography/all}


\bigskip
\noindent
\svninfo
\smallskip

\smallskip
(Draft: do not circulate) % XX





\end{document}

