% 
% Author: Thomas C. Hales
% Affiliation: University of Pittsburgh
% email: hales@pitt.edu
%
% latex format

% History.  File started May 3, 2012 
% from deleted chapter of "Dense Sphere Packings"
%

% qed box missing.

\documentclass{llncs}
\pagestyle{headings} 
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amscd}
\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{alltt}
\usepackage{rotating}
\usepackage{floatpag}
 \rotfloatpagestyle{empty}
\usepackage{graphicx}
\usepackage{multind}\ProvidesPackage{multind}
\usepackage{times}

% my additions
\usepackage{verbatim}
\usepackage{latexsym}
\usepackage{crop}
\usepackage{txfonts}
\usepackage[hyphens]{url}
\usepackage{setspace}
\usepackage{ellipsis} % 
% http://www.ctan.org/tex-archive/macros/latex/contrib/ellipsis/ellipsis.pdf 

\usepackage{amsfonts}
\usepackage{amsmath}
%tikz graphics
%\usepackage{xcolor} % to remove color.
\usepackage{tikz} % Needs pgf version >= 2.10.
\usetikzlibrary{chains,shapes,arrows,shadings,trees,matrix,positioning,intersections,decorations,
  decorations.markings,backgrounds,fit,calc,fadings,decorations.pathreplacing}
% fonts

% fonts
\usepackage[mathscr]{euscript} % powerset.
\usepackage{pifont} %ding
\usepackage[displaymath]{lineno}
\usepackage{rotating}

% automatically generate revision number by
% svn propset svn:keywords "LastChangedRevision" exercises.tex
\def\svninfo{{\tt
  filename: turing.tex\hfill\break
  PDF generated from LaTeX sources on \today; \hfill\break
  Repository Root: https://flyspeck.googlecode.com/svn \hfill\break
  SVN $LastChangedRevision$
  }
  }
%-%

%\def\endnote{{\tt   XX Graphics and table permissions pending}}


% Math notation.
\def\op#1{{\hbox{#1}}} 
\def\tc{\hbox{:}}
%\newcommand{\ring}[1]{\mathbb{#1}}
\def\amp{\text{\&}}
\def\bq{\text{\tt {`}\,}}
\def\true{\text{true}}
\def\false{\text{false}}
\def\princ#1{\smallskip\hfill\break\smallskip\centerline{\it #1\hfill}}
% Flags

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\input{../../kepler_tex/flag}
\input{../../kepler_tex/kepmacros}

% svn propset svn:keywords "LastChangedRevision" kepmacros.tex
\def\svninfo{%
  \noindent
  Document TeXed on \today. \hfill\break
  Repository Root: http://flyspeck.googlecode.com/svn \hfill\break
  SVN $LastChangedRevision$\hfill\break
  %PGF version: $\pgftypesetversion$
  }


\begin{document}

\title{A proof of Fejes T\'oth's  Conjecture on Sphere Packings with
kissing number twelve}
\author{Thomas C. Hales\thanks{{Research supported in part by 
NSF grant 0804189 and the Benter Foundation.}}}
\institute{University of Pittsburgh\\
\email{hales@pitt.edu}}
\maketitle


\section{Fejes T\'oth's Conjecture}


On December 26, 1994, L. Fejes T\'oth wrote to me, ``I suppose that
you will be interested in the following conjecture: In $3$-space any
packing of equal balls such that each ball is touched by twelve others
consists of hexagonal layers.  In the enclosed papers a strategy is
described to prove this conjecture''~\cite{Fejes-Toth:89},
~\cite{Fejes-Toth:69}.  This article verifies Fejes-T\'oth's
conjecture.\footnote{The results of this article were presented at the
  Fields Institute, September 2011.}


A packing of balls in this article is identified with its set of
centers.  We adopt the convention that balls in a packing have unit
radius.  Formally, a \newterm{packing} is a set $V\subset\ring{R}^3$
for which $\norm{\v}{\w} < 2$ implies $\v=\w$,
for every $\v,\w\in V$.  It is known that the kissing number
in three dimensions is twelve~\cite{Leech:1956:MG}.  Call a nonempty
packing $V$ in $\ring{R}^3$ in which every $\v\in V$ has distance $2$
from twelve other $\w\in V$ a \newterm{packing with kissing number twelve
}.  

Two examples of packings consisting of hexagonal layers in which each
ball is touched by twelve others are the face-centered cubic packing
(FCC) and the hexagonal-close packing (HCP).  In the FCC packing, the
arrangement of twelve other balls around each ball is identical.  We
call this particular arrangement of twelve balls the FCC pattern.
Similarly, in the HCP packing, the arrangement of twelve around each
ball is identical, and we call this particular arrangement the HCP
pattern.

It is well known that if the arrangement around each ball is either
the FCC or HCP pattern, then the packing consists of hexagonal
layers~\cite[Sec.~1.3]{DSP}.  Hence the following theorem, which is
the main result of this article, is enough to guarantee that a packing
with kissing number twelve consists of hexagonal layers.

\indy{Notation}{V@$V$ (packing)}%


\begin{theorem}[Packings with kissing number twelve]\guid{BDEDUTL}\label{thm:fc} 
  Let $V$ be a packing with kissing number twelve.  Then for every point $\u\in
  V$, the set of twelve around that point is arranged in the pattern
  of the HCP or FCC packing.
\end{theorem}
\indy{Index}{HCP}%
\indy{Index}{FCC}%
\indy{Index}{kissing configuration}%

The truncation parameter $h_0=1.26$ will be used throughout this article.
The following estimate is one of the main results of~\cite{DSP}.  Its proof
is omitted.

\begin{lemma}\label{lemma:dsp}
Let $V$ be a finite packing.  Assume that $2\le \normo{\v}\le 2h_0$ for
every $\v\in V$.  Let $L(h) = (h-h_0)/(h_0-1)$.  Then
\[
\sum_{\v\in V} L(\normo{\v}/2) \le 12.
\]
\end{lemma}

\begin{lemma}\guid{LIHVTRE} \label{lemma:gap}
  Let $V$ be any packing with kissing number twelve and let $\u\ne\v\in V$.
  Then $\norm{\u}{\v}=2$ or $\norm{\u}{\v} \ge 2h_0$.
\end{lemma}


\begin{proof} Let $ \u_1,\ldots, \u_{12}$ be the twelve kissing points
  around $\u$; that is, $\norm{\u_i}{\u}=2$.  
By translating $V$, we may assume without
loss of generality that $\u=\orz$.  Assume that $\v\ne \u_i,\orz$ is in $V$.   
By Lemma~\ref{lemma:dsp},
\[
   L(\normo{\v}/2)  + 12 
  =  L(\normo{\v}/2) + \sum_{i=1}^{12} L(\normo{\u_i}/2)  \le 12.
\]
This implies that $L(\normo{\v}/2)\le 0$, so $\normo{ \v}\ge 2h_0$.
\end{proof}

A packing $V$ may always be translated so that $\orz\in V$.  We study
the structure of a kissing configuration centered at the origin that
has the separation property of Lemma~\ref{lemma:gap}.

\begin{definition}[$S^2(2)$,~$\CalV$]
  Let $S^2(2)$ be the sphere of radius $2$, centered at the origin.  Let
  $\CalV$ be the set of packings $V\subset \ring{R}^3$ such that
\begin{enumerate}\wasitemize 
\item $\card(V) = 12$,
\item $V\subset S^2(2)$,
\item For all $\u,\v\in V$, we have $\u=\v$, $\norm{\u}{\v}=2$,
or $\norm{\u}{\v}\ge 2h_0$.
\end{enumerate}\wasitemize 
\indy{Notation}{V4@$\CalV$ (twelve sphere configurations)}%
\indy{Notation}{S@$S^2(r)$ (sphere of radius $r$)}%
\end{definition}

If $V\in \CalV$, set 
\[
E_2(V)=\{\{\v,\w\} \mid \norm{\v}{\w}=2\},
\]
the set of {\it contact} edges.




\section{Definitions and Review}

We follow the general approach to sphere packing problems described in
\cite{DSP}.  We use a number of definitions given there.  In
particular, we have the following.

\begin{definition}[affine]\guid{BYFLKYM}\label{def:aff} 
  If $S = \{\v_1,\v_2,\ldots,\v_k\}$ and $S'=\{\v_{k+1},\ldots,\v_n\}$
  are finite subsets of $\ring{R}^N$, then set
	\begin{align*}
\op{aff}_{\pm} (S,S') &= \{t_1 \v_1 +\cdots t_n \v_n \mid
	t_1 +\cdots+t_n = 1,~ \pm t_j \ge 0, \text{ for } j>k\},\\
\op{aff}^0_{\pm} (S,S') &= \{t_1 \v_1 +\cdots t_n \v_n \mid
	t_1 +\cdots+t_n = 1,~ \pm t_j > 0, \text{ for } j>k\}.
%\op{aff}\, S &= \op{aff}_\pm(S,\emptyset).\\
		\end{align*}
To lighten the notation for singleton sets, abbreviate
$\op{aff}_\pm(\{\v\},S')$ to $\op{aff}_\pm(\v,S')$.
\indy{Notation}{aff2@$\op{aff}_{\pm}$, $\op{aff}^0_{\pm}$}%
\indy{Index}{affine}%
\indy{Notation}{S@$S\subset\ring{R}^n$}%
\end{definition}

This notation is general enough to describe rays, lines, open and closed intervals,
convex hulls, and affine hulls.


If $S\subset\ring{R}^3$ is a finite set of points,
abbreviate
\begin{align*}
C_\pm(S) &= \op{aff}_\pm(\orz,S),\\
C^0_\pm(S) &= \op{aff}^0_\pm(\orz,S).\\
\end{align*}
When the subscript is absent, the subscript $+$ is implied: $C_+(S)
= C(S)$, and so forth.  The parentheses around the set are frequently
omitted without change in meaning:
\[ C^0\{\v,\w\}=C^0_+(\{\v,\w\}) =
\op{aff}^0_+(\{\orz\},\{\v,\w\}) = \op{aff}_+^0(\orz,\{\v,\w\}).\] 



\begin{definition}[fan,~blade]\label{def:fan}
Let $(V,E)$ be a pair consisting of a set $V\subset \ring{R}^3$ and
a set $E$ of unordered pairs of distinct elements of $V$.  The pair
is said to be a \newterm{fan\/} if the following properties hold.
\begin{enumerate}
\item \firstcase{cardinality} $V$ is finite and  nonempty.
\item \firstcase{origin} $\orz\not\in V$.
\item \firstcase{nonparallel} If $\{\v,\w\} \in E$, then the set
$\{\orz,\v,\w\}$ is not collinear.
\item \firstcase{intersection}
For all $\ee ,\ee '\in E \cup \{\{\v\}\mid \v\in V\}$, 
\[ C(\ee )\cap C(\ee ') = C(\ee \cap \ee
').\] 
\end{enumerate}
When $\ee\in E$, call $C^0(\ee)$ or $C(\ee)$ a \newterm{blade}
of the fan.  
\end{definition}

Basic properties of fans are developed in \cite[Ch.~5]{DSP}.
Every fan is graph with vertex set $V$ and edge set $E$.
We use the terminology of graph theory to describe fans.  For example,
we say that $\v,\w$ are \newterm{adjacent} if $\{\v,\w\}\in E$.


\begin{definition}[hypermap]   A \newterm{hypermap} is a finite set $D$, together with three functions
  $e,n,f:D\to D$ that compose to the identity
  \[ 
e\ocirc n\ocirc f = I_D.
\]  The
elements of $D$ are called \fullterm{darts}{dart}.  The functions $e,n$ and
$f$ are called the \fullterm{edge map}{edge!map}, the \fullterm{node map}{node!map}, and
the \fullterm{face map}{face!map}, respectively. 
The orbits of the set of darts under the edge map, node map, and face map are called edges, faces, and nodes of the hypermap.
\end{definition}

\begin{example}[dihedral]\label{ex:D2k} 
\formaldef{$\op{Dih}_{2k}$}{cyclic\_hypermap}
There is a hypermap $\op{Dih}_{2k}$ with a dart set of cardinality $2k$.
The permutations $f,n,e$ have  orders $k$, $2$, and $2$ respectively, and 
$e n f = I$.
The set of darts is given by
\[ 
\{x, f x,f^2 x,\ldots,f^{k-1} x\}\cup \{n x, n f x, n f^2 x,\ldots, n f^{k-1} x\}
\] 
for any dart $x$.
If a hypermap is isomorphic to $\op{Dih}_{2k}$ for
some $k$, then it is \newterm{dihedral}.
(The three permutations generate the dihedral
group of order $2k$, acting on a set of $2k$ darts under the left action of the group upon itself.) 
\indy{Index}{hypermap!dihedral}%
\end{example}

Basic properties of hypermaps are developed in \cite[Ch.~4]{DSP}.  An
\newterm{isomorphism of hypermaps} is a bijection $\phi:D\mapsto D'$
such that $\phi(i x) = i'\phi x$, for all $x\in D$ and all structure
permutations $(i,i')=(e,e'),(f,f'),(n,n')$.


For each $\v\in V$ such that $\card(E(\v))>1$, we define a cyclic
permutation $\sigma(\v):E(\v)\to E(\v)$ as follows.  Choose
$\pi_\v:\ring{R}^3\to\ring{C}$, a real-linear surjective map, with
$\v\in \op{ker}\pi_\v$, chosen so that
$(\pi^{-1}_\v(1),\pi^{-1}_\v(\sqrt{-1}),\v/\normo{\v})$ is a
positively oriented orthonormal basis of $\ring{R}^3$.  Define the
permutation $\sigma(\v)$ by pulling back the counterclockwise cyclic
permutation of the points
\[
\{\pi_\v(\w)/\normo{\pi_\v(\w)} \mid \w\in E(\v)\}
\]
Write $\sigma(\v,\w)$ for $\sigma(\v)(\w)\in E(\v)$.  on the unit
circle.  Let $\op{arg}(r e^{i\theta}) =\theta\in[0,2\pi]$ be the
argument of a complex number, and set
\[
\op{azim}(\orz,\v,\u\w) = \op{arg}(\pi_\v(\w)/\pi_\v(\u)).
\]
If $x=(\v,\w)\in D_1$, then set 
\[
 \op{azim}(x) = \op{azim}(\orz,\v,\w,\sigma(\v,\w)).
\]
Also, set
\[
 \Wdart(x) = \{\u \mid 0 < 
 \azim(\orz,\v,\w,\u) < \azim(\orz,\v,\w,\sigma(\v,\w)) \}.
\]

We may associate a hypermap with a fan by the following
construction.  Let $(V,E)$ be a fan.  Define a set of darts $D$ to be
the disjoint union of two sets $D_1,D_2$:
\begin{align*}
D_1 &= \{(\v,\w)\mid \{\v,\w\}\in E\},\\
D_2 &= \{(\v,\v) \mid \v\in V,\ \ E(\v) = \emptyset\},\textand \\
D\phantom{_2}   &= D_1\cup D_2,
\end{align*}
where $E(\v)=\{\w \mid \{\v,\w\}\in E\}$, the set of darts adjacent to $\v$.
Darts in $D_2$ are said to be \newterm{isolated} and darts in
$D_1$ are \fullterm{nonisolated}{isolated}.
%
Define permutations $n$, $e$, and $f$ on $D_1$ by
\begin{align*}n(\v,\w) &= (\v,\sigma(\v,\w)),\\
f (\v,\w) &= (\w,\sigma(\w)^{-1} \v),\\
e (\v,\w) &= (\w,\v).
\end{align*}
Define permutations $n,e,f$ on $D_2$ by making them degenerate on $D_2$:
\[ 
n (\v) = e(\v) = f(\v) = \v.
\] 
Set %$\op{hyp}_r(V,E)=(D_1,e,n,f)$ and 
$\op{hyp}(V,E)=(D,e,n,f)$. 
If $(V,E)$ is a fan, 
then it is known that $\op{hy}(V,E)$ is a hypermap~\cite{DSP}.


If $(V,E)$ is a hypermap, then we
define $X(V,E)$ to be the union of the sets $C(\ee)$, for $\ee\in E$,
and $Y(V,E) = \ring{R}^3 \setminus X(V,E)$ to be its complement.  There is
a well-defined mapping from the set of faces of $\op{hyp}(V,E)$ to the set of 
topological
connected components of $Y(V,E)$.  We write $U_F$ for the topological
component associated with a face $F$.  We write $\op{sol}(U_F)$ for the solid
angle of $U_F$ at $\orz$.  The sum of the solid angles of the topological components
of $Y(V,E)$ is $4\pi$.

\begin{definition}[local fan]\guid{FTNGOGF} \label{def:convex-local}
A triple $(V,E,F)$ is a \newterm{local fan} if the following conditions hold.
\begin{enumerate} 
\item \firstcase{fan} $(V,E)$ is a fan.
\item \firstcase{face} $F$ is a face of $H = \op{hyp}(V,E)$.
\item \firstcase{dihedral} $H$ is isomorphic to $\op{Dih}_{2k}$, where $k =
\card(F)$.
\end{enumerate}
A local fan $(V,E,F)$ is said to be \newterm{nonreflexive}\footnote{An angle
greater than $\pi$ is a \newterm{reflex angle}.} if the following
additional conditions hold.
\begin{enumerate}
\setcounter{enumi}{3}
\item %\setcounter{enumi}{4} 
\firstcase{angle} $\op{azim}(x)\le \pi$ for all darts $x\in F$.
\item \firstcase{wedge} $V\subset \Wdart(x)$ for all $x\in F$.
% \item If $\{\v,\w\}\in E$, then $\{\orz,\v,\w\}$ is not
%   collinear. %% part of def of fan.
\end{enumerate}
\end{definition}
\indy{Index}{fan!local}%

\section{strategies}

The strategy of the proof is to classify the hypermaps of contact
fans $(V,E_{2})$ for $V\in \CalV$ and to show that there are only two
possibilities: the contact hypermaps of the FCC and the HCP.  From
this, the proof of Fejes T\'oth's conjecture ensues.

The classification result is analogous to the one that we have 
obtained for tame hypermaps in \cite{DSP}.  
This suggests developing a proof along
exactly the same lines.  We define a 
collection of hypermaps with properties that are analogous to those
defining a tame hypermap and call them hypermaps with 
\fullterm{tame
  contact}{tame!contact}.  A computer generated classification of these hypermaps
gives only a few possibilities.  Those other than the FCC and
HCP hypermaps are eliminated by linear programming methods.


\begin{remark}[Lexell's theorem]
According to Lexell's theorem, for any two distinct non-antipodal points $\u,\v\in S^2(2)$,
the locus of points $\w\in S^2(2)$, along which
the spherical triangle with vertices $\u,\v,\w$ has given fixed area, is a circular arc
%The circle is centered on the bisector of $\u$ and $\v$, and 
with endpoints at the antipodes of $\u$ and $\v$.

Lexell's theorem is an aid in finding the minimum of
  $\sol(U_F)$.
  It is a consequence of Lexell's theorem that the area of a spherical
  triangle (viewed as a function of its edge lengths) does not have a
  interior point local minimum, when the edge lengths are
  constrained to lie in given intervals.  For the spherical triangle of minimal area,
each  edge length is extremal.
%
\indy{Index}{Lexell's theorem}%
\end{remark}

\begin{remark}[Leech's solution of the Newton--Gregory problem]
During a famous discussion with Gregory, Newton asserted that 
if $V\subset S^2(2)$ is any packing, then $\card(V)\le 12$. That is, at most
twelve nonoverlapping balls can touch a fixed central ball.  
%
\indy{Index}{Newton--Gregory problem}%
\indy{Index}{Leech}%
\indy{Index}{thirteen-spheres problem}%
%\indy{Index}{13@$13$ spheres problem}%
  
 Leech's proof of Newton's assertion is
noteworthy~\cite{Leech:1956:MG}.  Assuming the existence of a packing
$V\subset S^2(2)$ of cardinality thirteen, Leech associates a planar graph
$(V,E)$ with $V$, which is similar to our standard fan.  In
our notation, he estimates the solid angle of each topological
component $U_F$.  These solid angle estimamtes can be verified with Lexell's theorem.
Next, he classifies the planar graphs $(V,E)$ that satisfy various
combinatorial constraints obtained from the solid angle estimates. He
finds that no such planar graph exists, in confirmation of Newton's
assertion.
\end{remark}

\section{main estimate}

Let $(V,E)$ be a fan.
When $x=(\v,\w)$ is a dart in $\op{hyp}(V,E)$, define $h(x) = \normo{\v}/2$.
Define the weight function
\begin{align}
  \tau(V,E,F) &=\sum_{x\in F} \op{azim}(x) 
  + \left(\pi+{\sol_0}\right) (2- k(F))\qquad\phantom{t}\vspace{6pt}\nonumber\\
  &= \sol(U_F) + (2- k(F))\sol_0 \vspace{6pt}\\
\label{eqn:tau-sol}
\end{align}
where $\sol_0=3\arccos(1/3)-\pi\approx 0.55$ is the solid angle of a
spherical equilateral triangle with a side of arclength $\pi/3$, and
$k(F)$ is the cardinality of $F$.
% 
These formulas are equivalent by Girard's formula for solid angle.

%Under the 
%special conditions that 
%$V$ is a packing, $(V,E)$ is a \newterm{biconnected} graph, and
%$V\subset S^2(2)$, we have 
%\[
%\tau(V,E,F) = \sol(U_F) + (2-k(F)) \sol_0.
%\]
%We estimate $\tau$ by estimating $\sol(U_F)$ with Lexell's theorem.


The next theorem is the main estimate for packings with kissing number twelve.
(Compare~\cite[Th.~]{DSP}.)  
%It is similar to the main
%estimate in Leech's proof of the problem of thirteen spheres~\cite{Leech:1956:MG}.  
%


\begin{theorem}[main estimate]\guid{VGJDQJV}\label{lemma:main-estimate-12}
  Let $V$ be a packing in $S^2(2)$, $E$ a set of edges, and $F$ a face
  of $\op{hyp}(V,E)$ such that $(V,E,F)$ is a local fan (but not
  necessarily nonreflexive).  Let
  $S$ be a subset of $E$ such that the length of every edge in $S$ is
  at least $2h_0$.   Let $r=\card(E\setminus S)$ and $s = \card(S)$.
 Let $U=U_F$ be the topological component of
  $Y(V,E)$ corresponding to $F$. 
   %Assume that
  %$(V,E)$ is a biconnected graph.  %% redundant for local fan, which is a Dihedral grp.
\begin{enumerate}
\item  Assume that $F$ has at least three
  darts. 
\item Assume that every edge in $E$ has length at most $3.26$; that is for all $\{\v,\w\}\in E$,
we have $\norm{\v}{\w}\le 3.26$.
\item Assume that if $\{\u,\v\}\subset V$
  with $C^0\{\u,\v\}\subset U$, then % and $2\le\norm{\u}{\v} \le 2h_0$, then
 % $\{\u,\v\}\in E$.  
  $\norm{\u}{\v}\ge 2h_0$.
\item Assume that if $\card(E)=3$ and if 
the length of two of the edges of $E$ is at most $2h_0$, then the third has
length at most $3$.
 \end{enumerate}
Then
\begin{equation}\label{eqn:tau-tgt}
\tau(V,E,F) \ge \min(d(r,s),\op{tgt}),
\end{equation}
where 
\[ d(r,s) = 
\begin{cases}
0.103 (2-s) + 0.2759 (r+2s-4), & r + 2s > 3\\
0, & r + 2s \le 3.\\
\end{cases}
\] 
and
$\op{tgt}=1.541$.
%\[
%d(r,s) = 0.103 (2-s) + 0.277 (r+2s-4),\ \ 
%s = \card(S),\textand  r = \card(E)-\card(S).
%\]
\end{theorem}
\indy{Notation}{s@$s=\card(S)$}%
\indy{Notation}{tgt@$\op{tgt}=1.541$}%

\begin{definition}[special]
We say that  $\{\u,\v\}\subset V$ is \newterm{special}, 
if 
\[
3 \le \norm{\u}{\v} \le 3.26
\]
and if 
there exists $\w\in V$ that is adjacent to both $\u$ and $\v$,
whose distance from both $\u$ and $\v$ is at most $2h_0$.
\end{definition}

\begin{proof} This proof imitates the proof of the main estimate from
  \cite{Hales:2006:DCG}.   (Compare~\cite{DSP}.)


  For a contradiction, let the data $(V,E,F,S)$ satisfy the conditions of the theorem and violate the 
  Inequality \eqref{eqn:tau-tgt}.  Among all counterexamples to the theorem, we may assume
  that $(V,E,F,S)$ is a counterexample that minimizes $k=r+s$.  Let
  $k_{min}$ be the smallest value attained.

We make a series of claims about the structure of a countexample.


  \claim{There exists a counterexample that minimizes
\begin{equation}\label{eqn:td}
\tau(V,E,F)-\min(d(r,s),\op{tgt})
\end{equation}
among all counterexamples that have parameter
$k=k_{min}$.}  Indeed, a compactness argument shows that a sequence
tending to the minimum value has a convergent subsequence.  (Compare
Lemma~\ref{lemma:compact-fan} and Lemma~\ref{lemma:compact:bs}.)
We assume that the counterexample $(V,E,F,S)$ is minimal
in this sense.  The limit of fans satisfying these metric conditions
is again a fan because of the calculation
\[
\Delta(4,4,4,3.26^2,4,4)>0,
\]
where $\Delta$ is the polynomial of \cite{DSP} whose positivity implies
nondegeneracy of simplices.


\claim{In a minimal counterexample, we may assume that all edges of length at least
  $2h_0$ belong to $S$.}  Indeed, $d(r-1,s+1)>d(r,s)$.

\claim{A minimal counterexample $(V,E,F,S)$ does not have any set
  $\{\u,\v\}\subset V$, satisfying $C^0\{\u,\v\}\subset U$ and
  $\norm{\u}{\v}\le 3.26$, unless $\{\u,\v\}$ is special.}
Otherwise, $\{\u,\v\}$ may be added to the edge
set of the fan to slice $F$ into two faces $F_1$ and $F_2$.
The constants $d(r,s)$ are additive under slicing
For some constants $d_1$
and $d_2$,
\begin{align}\label{eqn:drs}
d(r,s) &= d_1 (2 - s) + d_2 (r + 2 s-4) \nonumber\\
&= d_1 (2-s') + d_2 (r'+2 s'-4) + d_1 (2-s'') + d_2 (r''+2s''-4)\nonumber\\
&= d(r',s') + d(r'',s'').
\end{align}
Because of this additivity, one of the two faces $F_1$ or $F_2$ is a
counterexample as well with a smaller parameter:
$k(F_1),k(F_2)<k_{min}=k(F)$.  This is contrary to the assumed
minimality of $k$.  The exception for special diagonals comes from the
particular assumptions made in the statement of the main estimate,
which prevents slicing $F$ when particular metric conditions hold.

\claim{A minimal counterexample $(V,E,F,S)$ does not have any set
$\{\u,\v\}\subset V$, satisfying $C^0\{\u,\v\}\subset U$, }
\[
\norm{\u}{\u}\le 3.
\]
This claim follows from additivity of constants $d(r,s)$ in the same way.


Call a node $\v\in V$ of a local fan \fullterm{reflexive}{reflexive!node} 
or \fullterm{nonreflexive}{nonreflexive!node}, according
to whether $\op{azim}(x)\ge\pi$ or $\op{azim}(x)<\pi$, where $x$ is
the dart of $F$ at $\v$. 



\claim{In a minimal counterexample $(V,E,F)$, if $\v\in V$ is a
  reflexive node, then both edges of $E$ at $\v$ have length $3.26$.}  


In the original proof of the Kepler conjecture 
  various geometrical subtleties appear in this part of the
  proof.  None of these subtleties appear here.  In fact, the
  deformation remains a packing because in the notation of~\cite{Hales:2006:DCG},
 we have
\[
{\mathcal E}(2,2,2,2,2,2,2,2,2)> 3.26
\]
Once it is established that the edges at a reflexive node $\v$ have length $3.26$, it
follows that all the nodes in the wedge
\[
W(\orz,\v,\rho\v,\rho^{-1}\v)\cap (V\setminus\{\v\})
\]
have distance at least $3$ from $\v$.  It follows that a half-disk
of radius $\arc(2,2,3)$ fits inside the region.  Indeed, since
$\arc(2,2,3)>\pi/2$, the edges of the fan bow away from the reflexive node, so
that the point on the boundary of $U_F$ closest to the node is another
node.  
A nonreflexive node adjacent to the reflexive node has angle $>\pi/2$
because of dihedral angle estimates $\dih(2,2,2,3,3,2)>\pi/2$, and
so forth.  

Returning to the claim, indeed, 
if both edges at $\v$ have length less than $3$, there
exists a deformation of the local fan $(V,E,F)$ that fixes every node
except $\v$ and decreases the solid angle $U_F$ by a contraction of $U_F$.  
This cannot be a
minimizing counterexample.  Now assume that one of the edges
$\{\v,\u\}$ has length $3$.  Let $\{\v,\w\}\in E$ be the other edge.
%By minimality it has extremal length $2,2h_0$, or $3$.  
%Let $y=\norm{\u}{\w}$.  
We check by a symbolic
\cc{8649676161}{\newterm{Mathematica}. } that
\begin{align}\label{eqn:dsol}
\Delta(4,4,4,y_1^2,y_2^2,y_3^2)^{1/2}\dfrac{\partial\,\op{soly}(2,2,2,y_1,y_2,y_3)}{\partial y_1} &= 
% for 3.2: \dfrac{4t(256 - 25t^2 + 25y^2)}{25(16 - t^2)} >0,
\dfrac{4 y_1 (y_2^2 + y_3^2- y_1^2)}{16- y_1^2}.
\end{align}
 Recall that $\Delta>0$.
The right-hand side is positive
when $y_1\le3$, $y_2\ge 2$, and $y_3=3$. 
Hence, the region
$\op{aff}^0_+(\orz,\{\u,\v,\w\})$ of greatest
solid angle occurs when $y_1=\norm{\v}{\w}=3$.  This solid angle is greatest when
when the solid angle of $U_F$ is least because  the two regions are complementary.


\claim{In a minimal counterexample, some node is reflexive.}  Otherwise,
every node is nonreflexive.  Each edge arclength at least
$\arc(2,2,2)=\pi/3$.  By Lemma~\ref{lemma:convex-hyp}, the cardinality
$k$ of $E$ satisfies $(\pi/3)k < 2\pi$, so $k<6$.  (The perimeter inequality is
strict for a generic fan.)  By Lexell's theorem, the each edge has
extremal length;  that is, every edge in $S$ has length $2h_0$ or
$3$ and every edge in $E\setminus S$ has length $2$.  In fact, derivative
arguments \eqref{eqn:dsol} show that the smaller area always
corresponds to the shorter edge length.  The only
remaining degrees of freedom are the lengths of the diagonals.  As the
polygon has at most five sides, we have reduced the claim  to a
finite \cc{ZVLLGZK} % old:9267276091. 
{The triangle case is done in Mathematica.} of dimension at
most two, which is executed without difficulty.

\claim{In a minimal counterexample some node of the local fan
  $(V,E,F)$ is nonreflexive.}  Otherwise, the region that is complementary
to $U_F$ is nonreflexive.  The perimeter estimate for nonreflexive regions again
gives $k<6$.  The complementary region lies in a hemisphere.  Thus,
the solid angle of $U_F$ is at least that of the other hemisphere,
$2\pi$.
%
%One
%half of $\op{rcone}(\orz,\v,\cos\theta)$, where
%$\theta=\arc(2,2,3)\approx ?$ fits inside the region.  The
%half-cone has solid angle
%\[
%\sol=\pi(1-\cos\theta)\approx 4.02.
%\]
This gives
\[
\tau(V,E,F) = \sol(U_F) + (2-k)\sol_0 \ge 2\pi - 3\sol_0 > \op{tgt}.
\]


\claim{In a minimal counterexample, there cannot be both a reflexive
and a nonreflexive  node.} 
The nonreflexive node adjacent to a reflexive node $\v$ has interior angle greater
than $\pi/2$ and can be deformed by decreasing the distance between it
and $\v$ in order to decrease the solid angle of $U$.  This shows that the
function $\tau$ has no local minimum among such arrangements.


The various claims show that no minimal counterexample exists.  This
completes the proof.
\end{proof}

\section{biconnected fans}


We may create  fans that are biconnected graphs in the same way as in
\cite{Hales:2006:DCG}.  Here is a review
of the construction.

\begin{definition}[$\CalV'$,~$E^+(V)$]\guid{ZTONFGU}
  Write
$E^+(V)$ for the set of pairs $\{\u,\v\}\subset V$
  such that $2\le\norm{\u}{\v} <\sqrt8$.
Let $\CalV'\subset\CalV$ be the subset of packings $V\in\CalV$ that
satisfy the following two properties. 
\begin{enumerate}
\item  $(V,E^+(V))$ is a fan.
\item The graph $(V,E^+(V))$ is biconnected.
\end{enumerate}
\end{definition}
\indy{Notation}{V4@$\CalV'$ (twelve sphere configurations)}%
\indy{Notation}{E2@$E^+(V)$}%



\begin{lemma}\guid{NJFWRPQ}\label{lemma:V'-bi} 
Let $V\in \CalV$.  Then there exists $V'\in \CalV'$ and a bijection 
 $\phi:V'\mapsto V$ that induces a bijection
  of contact graphs:
\[
\phi_*:(V,E_{2}) \cong (V',E'_{2}).
\]
\end{lemma}


\begin{proof}
  Begin with the contact fan $(V,E_{2})$.  

  \claim{We claim that $(V,E^+(V))$ is a fan.} Indeed, it is checked by
  \cite[Lemma~4.30]{Hales:2006:DCG} that the blades satisfy the
  intersection property of fans, except possibly when two new blades
  are the diagonals of a quadrilateral face in $(V,E_{2})$.  (The
  cited lemma uses the constant $2.51$ instead of $2h_0$, but this
  does not affect the reasoning of the lemma.)  The diagonals of a quadrilateral face
  in $(V,E_{2})$ is a spherical rhombus and one of its diagonals is
  necessarily at least $\sqrt8$ (with extreme case a square of side
  $2$).  The other fan properties are easily checked.

  If the hypermap $\op{hyp}(V,E^+(V))$ is not connected,
  the set of nodes $V_1\subset V$ in one combinatorial component can
  be moved closer to another combinatorial component until a new edge
  is formed.  This can be done in a way that the deformation of $V$
  remains in $\CalV$ and no new edges of length at most $2h_0$ are formed.
  Continuing in this fashion, a connected hypermap is obtained.

A biconnected hypermap is produced by  further
 deformations of the fan around each \newterm{articulation node}  (that is, a node 
whose deletion increases the number of combinatorial components).
\end{proof}





\begin{definition}[$D_U$,~$m_U$,~$r_U$,~$s_U$,~$k_U$,~$\tau(U)$]
  Let $V\in \CalV$.  Let $U$ be a topological component of
  $Y(V,E_{2})$ and let $D_U$ be the set of all darts of $\op{hyp}(V,E_{2})$
 that lead into
  $U$.   For each
  $x\in D_U$, let $m(x) >0$ be the smallest natural number such that
  $f^{m} x$ and $x$ lie at the same node.  Let $m_U$ be the maximum of
  $m(x)$  as $x$ runs over $D_U$.  The constant $m_U$ can be viewed as
  a \newterm{simplified face size}.  
Let $r_U$ be the number of nonisolated darts in $D_U$, and let $2+s_U$ be twice the
  number of combinatorial components of $\op{hyp}(V,E_{2})$ that
  meet $D_U$.  Let $k_U=r_U+s_U$.  Overloading the symbol $\tau$, we
  set $\tau(U) = \sol(U) +  (2-k_U)\sol_0$.   (If a single  face $F$ leads into
  $U$ and if the face is simple, then the overloaded notation is consistent
with the earlier notation: $\tau(U) = \tau(V,E_{2},F)$.)
%
  \indy{Index}{fan}%
  \indy{Notation}{m@$m_U$ (simplified face size)}%
  \indy{Notation}{s@$s_U$ (integer invariant of component)}%
  \indy{Notation}{r@$r_U$ (integer invariant of component)}%
  \indy{Notation}{k@$k_U$ (integer invariant of component)}%
  \indy{Notation}{D@$D_U$ (the set of darts leading into $U$)}%
\end{definition}

\begin{lemma}\guid{NOKWBKT}\label{lemma:tauU'}
  Let $V\in \CalV'$.
Let $U$ be a topological component of
  $Y(V,E_{2})$.   Then $\tau(U)\ge \min(d(r_U,s_U),\op{tgt})$.
\end{lemma}

\begin{proof}
Up to a null set (given by the finite union of blades $C^0(\ee)$ for
$\ee\in E^+(V)\setminus E_{2}$), the region $U$ is the union of topological
components $U_F$ of $Y(V,E^+(V))$, which are in bijection with the faces
$F$ of $\op{hyp}(V,E^+(V))$.  The function $\tau(U)$ is additive:
\begin{equation}\label{eqn:tau-additive}
\tau(U) = \sum_{U_F\subset U} \tau(V,E^+(V),F).
\end{equation}
By the biconnectedness of $(V,E^+(V))$, each value $\tau(V,E^+(V),F)$ is the
same before and after localization.
Lemma~\ref{lemma:main-estimate-12} gives a lower bound on the
constants $\tau(V,E^+(V),F)$.  The constants $d(r_U,s_U)$ are superadditive:
\[
d(r_U,s_U) \le \sum_{U_F\subset U} d(r(F),s(F)),
\]
where $s(F)$ is the cardinality of the set of edges of $E^+(V)\setminus
E_{2}$ that meet $F$, and $r(F) = \card(F)-s(F)$.  Thus, the 
lower bound on $\tau(U)$ follows from the main estimate
(Lemma~\ref{lemma:main-estimate-12}).
\end{proof}

\begin{lemma}\guid{UCEUZYO} Let $V\in \CalV'$.  Then
\[
\sum_{U\in [Y(V,E_{2})]} \tau(U) = (4\pi - 20\sol_0).
\]
\end{lemma}

\indy{Notation}{L1@$\CalL(V)$ (estimation of a packing)}%
\begin{proof} For a packing of twelve points $V\subset S^2(2)$, we have
$12=\CalL(V)$.   From this equality, following~\eqref{eqn:delta0}, we have
\[
  \sum_F \tau (V,E^+(V),F) = (4\pi - 20\sol_0). 
\]
The result follows by additivity~\eqref{eqn:tau-additive}.
\end{proof}

Recall from Remark~\ref{rem:tgt} that the constant $\op{tgt}$ is slightly
larger than $(4\pi-20\sol_0)$.  The constants $d(r_U,s_U)$ are nonnegative, so that
$\tau(U)$ is as well.  This means that for every subset
$A$ of $[Y(V,E_{2})]$, we have
\begin{equation}\label{eqn:subtgt}
\sum_{U\in A} \tau(U) < \op{tgt}.
\end{equation}



\begin{lemma}[biconnected]\guid{BTZPFMU}\label{lemma:biconnected}
  Let $V\in \CalV$.  Then $\op{hyp}(V,E_{2})$ is biconnected.
\end{lemma}

\begin{proof}
  By Lemma~\ref{lemma:V'-bi}, we may replace $V$ with a new set in
  $\CalV$ if necessary so that $(V,E^+(V))$ is a biconnected fan.
   We  show that the smaller
  fan $(V,E_{2})$ is also biconnected.

  Let $U$ be a topological component of $Y(V,E_{2})$.  Lemma~\ref{lemma:tauU'}
   implies that $\tau(U)\ge \min(d(r_U,s_U),\op{tgt})$.

   \claim{If $m_U\le 5$, then $D_U$ is a simple face.} Otherwise,
   either $D_U$ is a face that is not simple, or it consists of more than
   one face.  Either way, some node $\v$ lies in the interior to the
   $m_U$-gon.  Let $\u,\w$ be consecutive nodes around the $m_U$-gon.
   By a \cc{6621965370}% old: 6621965370  derivative calculation number.
  {(Mathematica)} the angles
   $\op{azim}(\orz,\v,\u,\w)$ are each less than $2\pi/5$. The angles
   around $\v$ cannot sum to $2\pi$ as required.

   \claim{We claim that $D_U$ is a simple face.}  Otherwise, assume
   for a contradiction that $D_U$ is not simple, $m_U\ge 6$, and
   $d(r_U,s_U)<\op{tgt}$.  From the classification of
   \cite[p.~126,~Fig.~12.1]{Hales:2006:DCG}, and the inequalities
   $d(9,0) > \op{tgt}$, $d(6,2) > \op{tgt}$, it follows that 
    $m_U=6$ and $\tau(U)\ge d(8,0)$.  The set $D_U$ meets seven
   nodes: the six nodes counted by $m_U$ and a node in the interior of
   the hexagonal arrangement.  At each node there is a face of the
   hypermap $\op{hyp}(V,E_{2})$ that is not a triangle, because
   $2\pi$ is not an integer multiple of the dihedral angle of a
   regular tetrahedron.  As the packing has twelve nodes in all, five
   nodes remain, each meeting a nontriangular topological component of
   $Y(V,E_{2})$.  Thus, by counting nodes, the hypermap has at least
   one pentagon or two quadrilaterals.  We find that $\sum_{U}
   \tau(U)$ is at least
\[
d(8,0) + d(5,0) > \op{tgt}, \text{ or }\quad d(8,0) + 2 d(4,0) > \op{tgt},
\]
which is contrary to~\eqref{eqn:subtgt}.
Thus, $D_U$ is a simple face.
\indy{Index}{weight!total}%
\indy{Index}{weight}%

\claim{The hypermap is biconnected.}  Otherwise, if the hypermap is
not connected, then we can find two faces of the hypermap that lead
into the same topological component of $Y(V,E_{2})$.  If the
hypermap is connected but not biconnected, then some face of the
hypermap is not simple.  Both possibilities contradict the fact that
$D_U$ is a simple face.
\end{proof}



\section{tame contact}

This subsection modifies the notion of tameness to cover hypermaps
that arise as the contact fan of a packing with kissing number twelve.  In the
definition of tame hypermap in \cite{DSP}, a function $b$
is used.  In this section we use a similar function,  which is
again called $b$.   Recall that $\op{tgt}=1.541$.  \indy{Index}{tame}%
\indy{Index}{hypermap!tame}%

\begin{definition}[b]\guid{IHRZTPV}
  Define $b:\ring{N}\times \ring{N}\to \ring{R}$ by
  $b\pqr{(p,q)}=\op{tgt}$, except for the following values:
\[
b(0,3)=b(1,3)=0.618,\quad b(2,2)=0.412.
\]
\end{definition}
\indy{Notation}{b@$b$ (contact weight parameter)}%

\begin{definition}[d]\guid{VUJQZCG}
Define $d:\ring{N}\to \ring{R}$ by
\[d(k) = \begin{cases}
0, & k\le 3, \\
%0.206 + 0.277 (k-4),& k=4,\ldots,8,\\ changed 5/18/2010.
0.206 + 0.2759 (k-4),& k=4,\ldots,8,\\
%0.206 & k=4, \\
%0.483 & k=5, \\
%0.760 & k=6, \\
%1.037 & k=7, \\
%1.314 & k=8,\\
\op{tgt},& k>8.\\
\end{cases}
\]
%(In particular, $d(k) = 
\end{definition}
\indy{Notation}{d@$d$ (real parameter)}%

The function $d$ is related to the two-variable function in
Lemma~\ref{lemma:main-estimate-12}: $d(k) = d(k,0)$, when $4\le k\le
8$.

\indy{Index}{weight!contact assignment}%
  \indy{Index}{contact!weight assignment}%
\indy{Notation}{zzt@$\tau$ (weight assignment)}%
%  \indy{Notation}{zzt@$\tau$ (weight assignment)}%
\begin{definition}[weight~assignment]\guid{GLIQSFM}
%
  Recall that a \fullterm{weight assignment\/}{weight!assignment} 
on a hypermap $H$ is a
  function $\tau$ on the set of faces of $H$ taking values in the set
  of nonnegative real numbers. A weight assignment $\tau$
is a \newterm{contact}
  weight assignment if the following two properties hold.
%
\begin{enumerate}
\item If the face $F$ has cardinality $k$, then
$\tau(F) \ge d(k)$.
\item If a node $\v$ has type $(p,q,0)$, then
  \[\sum_{F:\,\v\cap F\ne\emptyset} \tau(F) \ge
    b{\pqr{(p,q)}}.\]
\end{enumerate}
The sum $\sum_F \tau(F)$ is called the \fullterm{total weight}{weight!total} of $\tau$.
\end{definition}
\indy{Index}{total weight|see{weight}}%

\begin{definition}[tame contact]\guid{XJPQTIV}
  A hypermap has \fullterm{tame contact}{tame!contact} if it satisfies the following 
  conditions.
%
\indy{Index}{tame!contact}%
\indy{Index}{contact!tame}%
\indy{Index}{planar}%
\indy{Index}{biconnected}%
\indy{Index}{nondegenerate}%
\indy{Index}{loop}%
\indy{Index}{double join}%
%
\begin{enumerate}
%\label{definition:tame}
%1
\item \firstcase{planar} The hypermap is plain and planar.
\item \firstcase{biconnected} The hypermap is biconnected.  In particular,
  each face meets each node in at most one dart.
\item \firstcase{nondegenerate} The edge map $e$ has no fixed points.
\item \firstcase{no loops} The two darts of each edge lie in different
  nodes.
\item \firstcase{no double join} At most one edge meets any two given
  nodes.
\item \firstcase{face count} The hypermap has at least two faces.
\item \firstcase{face size} The cardinality of each face is at least three
  and at most eight.
%\label{definition:tame:length}
\item \firstcase{node count} The hypermap has twelve nodes.
\item \firstcase{node size} The cardinality of every node is at least two  and at most four.
%\label{definition:tame:degree}
%    \item \case{node} {\tt NO CONDITION}
%\label{definition:tame:degreeE}
\item \firstcase{weights} There exists a contact weight assignment of total
  weight less than $\op{tgt}$.
%\label{definition:tame:squander}
\end{enumerate}
%
\end{definition}


%\subsection{tame contact}

\begin{theorem}\guid{ZXZSVPH} The contact hypermap of a 
  packing $V\in \CalV$ is a hypermap with tame contact.
\end{theorem}
\indy{Index}{hypermap!tame}%
\indy{Index}{hypermap!contact}%
\indy{Index}{hypermap}%

\begin{proof} It is enough to go through the list of properties that
  define a tame contact hypermap and to verify that the contact
  hypermap satisfies each one.  We use the weight assignment $F\mapsto
  \tau(V,E_{2},F)$.

\begin{enumerate}
\item \case{planar} The contact hypermap is plain and planar by the
  general properties of fans.\footnote{The book \cite{DSP} gives a long
    discussion of planarity.  In this article, we are not attempting
    to give a formal proof, so we relax our standards and
    regard planarity as an obvious feature of fans.}
\item \case{biconnected} The hypermap is biconnected by
  Lemma~\ref{lemma:biconnected}.
\item \case{nondegenerate} The
  edge map has no fixed points by the general properties of fans.
\item \case{no loops} 
  There are no loops by the general properties of
  fans.
\item \case{no double join} This is also a general property of fans.
\item \case{face count} Each node has at least two darts by
  biconnectedness. Each face is simple; so the two darts at a node lie
  in different faces.  Thus, the hypermap has at least two faces.
\item \case{face size} The cardinality of each face is at least three
  because the hypermap has no loops or double joins (Lemma~\ref{lemma:dj}).
  The cardinality of a face is at most eight because of the estimate
  $d(9,0)>\op{tgt}$.
\item \case{node count} There are twelve nodes by the definition of a
  packing with kissing number twelve.
\item \case{node size} We have already established that the cardinality
  of each node is at least two.  The proof that the cardinality is
  never  greater than four appears in Lemma~\ref{lemma:no-5}.
\item \case{weights} Theorem~\ref{lemma:main-estimate-12} establishes 
 the inequality $\tau(V,E_{2},F)\ge d(k)$.
   \indy{Notation}{zzt@$\tau(V,E,F)$}%
%\indy{Notation}{zzt@$\tau$ (weight assignment)}%
  The total weight of the weight assignment is given by
  equation~\eqref{eqn:delta0}:
\[
  \sum_F \tau(V,E_{2},F) = (4\pi - 20\sol_0) < \op{tgt}.
\]
\indy{Index}{weight!total}%
Let $\v$ be a node of type $(p,q,0)$.  
%Let $A$ be the set of faces
%that meet the node $\v$. 
Then
\[
\sum_{F\mid F\cap \v\ne\emptyset}\tau(V,E_{2},F) > d(4)~q.
\]
This gives the nonzero entries in the table of bounds $b(p,q)$.  The
remaining entries follow from Lemma~\ref{lemma:no-5}.
\end{enumerate}
\end{proof}




\begin{lemma}\guid{CQRHDZE}\label{lemma:no-5} 
  Let $V\in \CalV$.  Every node of $(V,E_{2})$ has degree at most
  four.  Furthermore, suppose the type of a node is $(p,q,0)$.  Then
  $(p,q)$ must be
\[
(0,3),~(1,3),~\text{ or}~~(2,2).
\]
\end{lemma}

\begin{proof} The interior angles of a spherical polygon in the
  contact graph have the following lower $\alpha_k$ and upper bounds
  $\beta_k$, as a function of the number of sides $k$.
\begin{equation}
\begin{array}{lllll}
  \phantom{\ge}k~~&\alpha_k & \beta_k\\
  \phantom{\ge}3~~&\op{dih}(2,2,2,2,2,2)  &\op{dih}(2,2,2,2,2,2)\\
  \phantom{\ge}4~~&\op{dih}(2,2,2,2h_0,2,2) &2\,\op{dih}(2,2,2,2,2h_0,2)\\
  {\ge}5~~& \op{dih}(2,2,2,2h_0,2,2) ~~~& 2\pi.
\end{array}
\end{equation}
Thus,
\[
  p\,\alpha_3 + q\,\alpha_4 +r\, \alpha_5 
\le 2\pi \le p\,\beta_3 + q\,\beta_4 + r \,\beta_5.
\]
There are no solutions for
$(p,q,r)$ in natural numbers when $p+q+r\ge 5$ and
 only the three given solutions in $(p,q,r)$ with $r=0$.
\end{proof}



\section{classification}

The website for the computer code  contains a list of eight hypermaps
that have been obtained by running the classification algorithm with
the tame contact parameters~\cite{website:FlyspeckProject}.

\begin{lemma}[tame hypermap classification]\guid{AZYOJBE}\cutrate{}
  \label{lemma:contact-classification} Every hypermap with tame
  contact is isomorphic to a hypermap in the given list of eight
  hypermaps, or is isomorphic to the opposite of a hypermap in the
  list.  \indy{Index}{isomorphism!tame contact classification}%
\end{lemma}

\begin{proof}
  By a \cc{PYWHMHQ}{}, % fejesToth.properties file with output fejesToth.txt}, 
 the set of all hypermaps has been classified by the same
  algorithm described in \cite{DSP}.
  \indy{Index}{contact!tame}%
  \indy{Index}{hypermap}%
  \indy{Index}{hypermap!tame}%
\end{proof}



\begin{lemma}\guid{MWWSZTX}\label{lemma:fcc-ft} Let $V\in \CalV$.
  Suppose that $H=\op{hyp}(V,E_{2})$ is a hypermap with tame
  contact.  Then $H$ is the FCC or HCP contact hypermap.
\end{lemma}

\begin{proof} The explicit enumeration of hypermaps with tame
  contact has eight cases.  Two are the hypermaps of the
  FCC and HCP.  The remaining six must be eliminated.  
A geometrical argument  eliminates one of these cases and linear programming
eliminates the other five.

\claim{One case with a hexagon cannot be realized geometrically as a contact fan
(Figure~\ref{fig:fthex}).}  Indeed, the perimeter of a hexagon with sides $\pi/3$
is $2\pi$.  However, the hexagons are nonreflexive, and $2\pi$ is a strict upper bound on the perimeter of a nonreflexive
hexagon.  Thus, this case does not exist.

%% XX reinsert.
% \figCXFENOK % fig:fthex


There are some linear
  programming constraints that are immediately available to us.
\begin{enumerate}\wasitemize 
\item The angles around each node sum to $2\pi$.
\item Each angle of a triangle is $\alpha_3$.
\item Each angle of each rhombus lies between $\alpha_4$ and $\beta_4$.
\item The opposite angles of each rhombus are equal.
% not needed
%\item The sum of two adjacent angles of a rhombus lies between
%\[
%  \alpha_4 + \beta_4 \text{~~and~~} 2\,\op{dih}(2,2,2,\sqrt8,2,2).
%\]
\end{enumerate}\wasitemize 
By a linear programming \cc{JKJNYAA}{},
% See the glpk directory at the code repository.},
these systems of constraints are infeasible in the remaining five cases.
\end{proof}


\begin{lemma}\guid{YRTPQXK}\label{lemma:kiss-fcc}
  Let $V\in \CalV$ be a packing such that $\op{hyp}(V,E_{2})$ is
  isomorphic to the FCC or HCP contact hypermap.  Then $V$ is
  congruent to the FCC or HCP configuration in $S^2(2)$.
\end{lemma}
\indy{Index}{HCP}%
\indy{Index}{FCC}%
\indy{Index}{kissing configuration}%
\indy{Index}{hypermap}%

\begin{proof} Every face of the hypermap of $(V,E_{2})$ is a
  triangle or quadrilateral.  The eight triangles in the FCC or HCP
  contact hypermap determine eight equilateral triangles in $V$ of
  edge length $2$.  The eight triangles rigidly determine $V$ up to
  congruence.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:fc}]  %[Packings with Full
  % Contact]
  The contact hypermap of a packing with kissing number twelve has tame
  contact.  By Theorem~\ref{lemma:fcc-ft}, this hypermap is that of
  the FCC or HCP.  By Lemma~\ref{lemma:kiss-fcc}, the kissing
  configuration of the packing is congruent to the FCC or HCP.  As the
  center of the packing may be chosen at an arbitrary point in the
  packing, every point in the packing is congruent to one of these two
  arrangements.  The result ensues.
\end{proof}



%Here is a proposed fix.  Fix ID: 8626513861.

Extend cutoff from $3$ to $3.26$, except when it creates a
{\it special node} in the sense of the 1998 proof of Kepler.
Deal with special node by dragging them along in the sense of the 1998 proof.


\begin{verbatim}
Enclosed[2,2,2,2,2,2,2,2,2] = 3.26...
\end{verbatim}
We need this parameter to keep deformations at the reflex nodes to avoid
bad self-crossings.

Introduce truncated corner cells (tcc) on everything other than specials.
Use cutoff $3.26/2 = 1.63$.  Let $w(y_1,y_2)$ be the area of the tcc
for the simplex $(2,2,2,3.26,y_1,y_2)$.  Let $wt$ be the area of the tcc
with dihedral angle $\pi$ and parameters $(2,2,2,*,3.26,3.26)$.
Numerically, it seems that the min
occurs at $(y_1,y_2)=(2,3.26)$.  Pick $\sigma$ so that 
\[
w(y_1,y_2)\ge \sigma,
\]
then 
reparametrize $\tau$ 
\[
\tau(V,E,F,\sigma) = \sol(U_F) + (2-k(F)) \sigma.
\]
Then
\[
\sum_F\tau(V,E,F,\sigma) = 4\pi - 20\sigma.
\]
Now presumably, it is possible to limit the number of reflexive nodes,
and the total number of nodes by summing $\tau$.

Once these quantities are bounded, it should be possible to resume the
main flow of the proof.  I have a few scanned notes on these calculations.




\raggedright
\bibliographystyle{amsalpha} % was plain %plainnat
\bibliography{/Users/thomashales/Desktop/googlecode/flyspeck/latex/bibliography/all}


\newpage
\bigskip
\noindent
\svninfo
\smallskip

\noindent
\endnote





\end{document}

