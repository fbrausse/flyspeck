% (c) Christoph Lange 2007
\documentclass{llncs}

% Draft?
\newif\ifdraft
\drafttrue
%\draftfalse

% \usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{textcomp}

\ifdraft
\usepackage[show]{ed}
%\usepackage{pdfsync}
\else
\usepackage[hide]{ed}
\usepackage{microtype}
\fi


% \usepackage{a4wide}
% \usepackage{amsmath}
% \usepackage{amsfonts}
% \usepackage{amstext}
% \usepackage{array}
% \usepackage{graphicx}
% \usepackage{ifthen}
% \usepackage[savemem]{listings}
% \usepackage{lstpatch}
% \usepackage{lstomdoc}
% \usepackage{makeidx}
% \usepackage{scrpage2}
% \usepackage[binary,squaren]{SIunits}
% \usepackage{supertabular}
% \usepackage{tabularx}
% \usepackage{thm2e}
% \usepackage[normalem]{ulem}
% \usepackage{wrapfig}
% \usepackage[svgnames]{xcolor}

% \usepackage{tikz}

% % Symbol fonts
% \let\RealRightarrow=\Rightarrow
% \usepackage{marvosym}
% \renewcommand{\Rightarrow}{\RealRightarrow}
% \usepackage{wasysym}

% KWARC packages
\usepackage{acronyms,myindex,semantic-markup}
% \let\Realstex=\stex
% \usepackage{paths}
% \renewcommand{\stex}{\Realstex}

% ... and adjustments
\def\omdocni{{\sc OMDoc}} % non-indexed OMDoc
\def\swimni{{\sc SWiM}} % non-indexed SWiM

\def\thetitle{Flyspeck in a Wiki -- Collaborating on a Huge Mathematical Proof}

% load this last
% \definecolor{NavyBlue}{cmyk}{0.94,0.54,0,0.3}
% \usepackage[pdftex,pdfstartview=FitV,plainpages=false,pdfpagelabels,colorlinks=true,linkcolor=NavyBlue,citecolor=NavyBlue,urlcolor=NavyBlue,hypertexnames=true]{hyperref}
% \hypersetup{
%     pdfauthor = {Christoph Lange},
%     pdftitle = {\thetitle},
%     pdfkeywords = {Semantic Wiki OMDoc Ontology Services Science Mathematical
% Knowledge Management Mathematics}
% }
\usepackage{url}

% local packages (my legacy)
% \input{../macros/mathe}

\hyphenation{name-space}
\hyphenation{Me-dia-Wi-ki}

% \hypersetup{bookmarksdepth=4}

% % Page styles
% \pagestyle{scrheadings}
% \clearscrheadfoot
% \ohead{\headmark}
% \ofoot[\pagemark]{\pagemark}
% \setheadsepline{0.3pt}[\color{gray}]
% \setkomafont{pagehead}{\normalfont\small\sffamily\slshape}
% \setkomafont{pagenumber}{\normalfont\small\sffamily\slshape}
%
% % Listing styles
% \lstset{float=htb,columns=flexible,frame=lines,language=[omdoc]XML,basicstyle=\scriptsize,
%         indexstyle=\indextt,indexstyle=[1]\indexelement,indexstyle=[2]\indexattribute,
%         numbers=left,stepnumber=5,numberstyle=\tiny,showstringspaces=false}
% \lstset{basicstyle=\ttfamily,basewidth=.5em}
%
% % Array setup
% \newcolumntype{v}[1]{>{\raggedright\arraybackslash\hspace{0pt}}p{#1}}

% % TikZ setup
% \usetikzlibrary{arrows}
% \tikzstyle{default}=[font=\sffamily,>=triangle 60]
% \tikzstyle concept=[font=\sffamily\bfseries,draw,minimum height=3.5ex,rounded corners]

% Local abbreviations
\def\abSMW{\product{Semantic MediaWiki}}

\title{\thetitle}
\author{Christoph Lange\inst{1} \and Sean McLaughlin\inst{2} \and Florian Rabe\inst{3}}
\institute{Computer Science, Jacobs University Bremen\thanks{formerly
International University Bremen}, \email{\{ch.lange,f.rabe\}@jacobs-university.de} \and
School of Computer Science, Carnegie Mellon University, Pittsburgh}

\begin{document}

\maketitle

\begin{abstract}
  \begin{todo}{@Sean: In one sentence, explain that this is a HUGE proof, also touching
      many areas of maths.}
    The purpose of the Flyspeck project is to develop a formally verifiable proof of
    Kepler's century-old conjecture about packing balls in three-dimensional space.
    Hales' original proof from 1998 heavily relies on computer calculations and thus
    requires more formalization in order to be verifiable.
  \end{todo}
  
  Flyspeck is scheduled as a long-term project\ednote{@Sean: How many years do you
    estimate? --CL} that will require a lot of manpower.  In order to get a community
  involved with formalizing sub-problems, we have started to publish and document them in
  a semantic wiki, exploiting the inherent structure of the proof for browsing and
  collaboration services.

  This paper introduces the use case and establishes requirements for a system that
  supports collaboration on the Kepler proof, and it presents a first system
  implementation based on Semantic MediaWiki.  With lessons learned from this pre-study,
  we develop ideas how the project can be supported even better by a semantic wiki
  specifically tailored to the needs of mathematicians.
\end{abstract}

@Sean, I inserted this auto-generated message. Have you ever written something together
with Florian? Then you probably know our ednote macros. Anyway, this is just FYI, and
after having read it, you may delete it :-) --Christoph
\hrule
\edexplanation
\hrule
\section{The Flyspeck Project (Sean)}
\label{sec:flyspeck}

Kepler conjecture (probably with a nice drawing?) -- one of the greatest problems of
mankind

Hales' original proof -- its enormous size (mention number of areas of mathematics
covered) and why it's not been accepted

Flyspeck project\cite{hales:DSP:2006:432}

Idea to get the community involved -- give them a wiki (leading the way to Christoph's
part: As we want to exploit certain structural properties of the proof, we'd like to have
a \emph{semantic} wiki that is capable of handling them)

\begin{enumerate}
\item make the whole extent of the proof graspable
\item make the workflows manageable
\item later maybe support proof development/proof validation right in the
  wiki?\ednote{@Sean, is this an issue? --CL}
\end{enumerate}

\begin{todo}{@Christoph}
  Motivate this with the principles of wikinomics \url{http://www.wikinomics.com}: If a
  smart but poor boy in Africa with is OLPC accesses our homepage\ldots
\end{todo}

\section{State of the Art}
\label{sec:sota}

\subsection{Mathematical Knowledge Management (Christoph/Florian?)}
\label{sec:mkm}

Project before the age of computer-supported MKM: classification of the final groups

Theorem provers and their libraries (all with a central repository and a repository
viewer): Mizar, Coq, PVS

formal and informal aspects of mathematical knowledge, content markup; OMDoc covering both
formal and informal aspects.  Actually, we're now interested in semi-formal
knowledge:
\begin{itemize}
\item documenting formal knowledge (the proof, or the theorems to be proved, resp.)
\item from informal ideas (how to prove sth.) to formal proofs\ednote{@Sean, Florian: Is
    this right? Are we interested in that?}
\end{itemize}

\subsection{Wikis for Mathematics (Christoph)}
\label{sec:math-wiki}

\subsubsection{Semantic Wikis}
\label{sec:semwiki}

Semantic wikis~\cite{semwiki06} are wikis enhanced by semantic annotations.  Although many
ways of semantically enhancing wikis have been investigated, a modelling approach prevails
where one resource (in the RDF\ednote{FYI: RDF can be assumed as known in this community;
  for the MKM, we'd have to explain it. --CL} sense) --- e.\,g.\ one mathematical theorem
--- is represented by one wiki page and relations between resources by links between
pages.  Both pages and links can be typed with terms from
ontologies~\cite{OrDeMoVoHa06:annotation-navigation-semwiki}, which are either preloaded
into the wiki or modelled ad-hoc~\cite{KrSchVr:semwiki-reasoning07}\ednote{@Christoph: Use
  this later: The Flyspeck wiki will support both kinds of ontologies: The OMDoc document
  ontology is preloaded, while other annotations can be added at will.}.  Semantic wikis
commonly offer enhanced navigation capabilities by displaying a summary of all typed
links, grouped by type, with each page.  Most of them allow to search for pages by type or
by them being subject or object of any RDF triple (= typed link), while it depends on the
reasoner used by the wiki whether only explicit RDF triples or also inferred ones are
considered~\cite{KrSchVr:semwiki-reasoning07}.  Such queries can usually be executed
interactively via a special search form, or in an automated way as \emph{inline} queries
embedded into the content of a page.

\subsubsection{Informal Knowledge Collections}
\label{sec:math-knowledge-collections}

Current collaborative projects for managing \emph{informal} mathematical knowledge range
from comprehensive encyclopediæ like the mathematical sections of
\product{Wikipedia}~\cite{wikipedia} or the courseware repository and content management
system \product{Connexions}~\cite{CNX:whitepaper} to projects specially focused on
mathematics like \product{PlanetMath}~\cite{krowne03:collaborative-math-libraries}, which
is powered by a highly customized wiki-like system.  The pages in these systems are
categorized and searchable in full-text, with additional metadata records in the case of
\product{PlanetMath}.  Neither of these systems is a \emph{semantic} wiki, and thus they
fail to solve the following two problems, which are essential for MKM:

\begin{enumerate}
\item\label{item:formula-search-usecase} In \product{Wikipedia} and \product{PlanetMath},
  formulæ are given in presentation-oriented {\LaTeX}.  Imagine a wiki page about the
  Pythagorean Theorem, stated as $a^2 + b^2 = c^2$, and a user searching for the
  equivalent formula $x^2 + y^2 = z^2$ (or even $c=\sqrt{a^2+b^2}$!) --- The system would
  not find the theorem.
\item Neither could ``all theorems about triangles for which a
  proof exists'' be searched for, as the link from a proof to the theorem it proves is not
  typed.
\end{enumerate}

\product{Connexions}, on the other hand, could in principle cope with these two problems,
but in practice it does not: Formulæ are written in the content-oriented sublanguage of
{\mathml}~\cite{CarlisleEd:MathML07}, and the CNXML markup language used for larger
structures allows for annotating texts as mathematical statements like lemmas, but this
structural information is not yet \emph{used} by the system.  Moreover, none of the
systems mentioned so far supports an easy navigation from the occurrence of a mathematical
symbol in a formula to the declaration or definition of this symbol, if it is defined in
some other place of the wiki; instead, the author has to provide links he considers
relevant in the text surrounding the formula.

\subsubsection{Domain-Specific Semantics}
\label{sec:domain-semantics}

Note that general-purpose semantic wikis do not support the above-mentioned use case
(\ref{item:formula-search-usecase}) either, as they neither have a sufficient notion of
equality nor understand mathematical content markup.  If we assume ``semantic'' not just
to mean RDF or description logics, but any kind of (higher-order) logic required for
specific domains\ednote{@Florian: This is quite superficial, can we write it in a more
  sophisticated way?} and employ domain-specific ways of knowledge representation we can
imagine semantic wikis specifically supporting mathematics.  For use case
(\ref{item:formula-search-usecase}), we could have the wiki pages crawled by a formula
search engine like MathWebSearch~\cite{KohSuc:asemf06}, which applies substitution tree
indexing to mathematical formulae.  Even more formal approaches integrate automated
theorem provers into wikis (see section~\ref{sec:related}).

\section{Supporting Flyspeck in a Semantic Wiki (Christoph)}

\begin{todo}{@Christoph: Elaborate on this discussion with Florian}
  OMDoc is agnostic towards logics -- that could be a benefit as long as we do not yet
  have a proof object. Work in progress, nodes without content, loosely coupled: Ideal
  setting for a wiki!  Wiki as a means of information for the collaborators about the
  progress of the \emph{whole} project.  Make a proof that's \emph{so} complex
  comprehensible in some way, show open issues/problems to potential collaborators.
  There's a whole book containing the informal outline of the proof; link the wiki to the
  book.  Probably also import the book via sTeX to the wiki.\\
  Make the whole project publicly viewable (e.g. for a progress report), make it
  manageable.\\
  Analogy: from software documentation to literate programming
\end{todo}

\subsection{Requirements}
\label{sec:req}

\issue{@Sean: What problem do we want to solve/What does Flyspeck need? --CL}

\begin{todo}{@Christoph: Contribution to the semantic web community}
  Where's the ``semantics'' in Flyspeck+Wiki? (Utilize certain \emph{structures} of the
  given knowledge for navigation and other services!)
\end{todo}

\begin{todo}{@Christoph/Florian: Contribution to the MKM community; but a bit less of that
    for the semantic web paper}
  Stress the fact that we also want to collect informal annotations/comments about the
  parts of the proof.  Otherwise, our implementation wouldn't offer anything beyond the
  state of the art defined by other collaborative/wikified proof assistants (see related
  work).
\end{todo}

\begin{newpart}{Let me try to describe the requirements as I understood them}
  We envisage the work flow as follows\ednote{@Christoph, create a diagram!}:
  \begin{enumerate}
  \item The proof is maintained in one large Twelf file, which allows for checking
    everything at once.\issue{@Sean, what's the deeper reason? Are there just so many
      interdependencies that we could not handle otherwise? Any performance reasons for
      doing this check offline, or should we aim at integrating this into the wiki as
      well? --CL}
  \item The individual sections of this file (technically, all these are type
    declarations) are imported into the wiki to form separate wiki pages.
  \item On each page, a human-readable rendering is given (e.\,g.\ \LaTeX\ or MathML)
  \item There are some overview pages, like a list of theorems unproven so
    far\ednote{@Christoph: develop some ideas about which dynamic queries are
      relevant. Check Matthias' BSc thesis. --CL}\ednote{@Sean: What else would people
      like to know?}
  \item In general: give the visitor/reader an impression of the enormous size of the
    proof and of its specialization into various fields of science.  Questions: ``What do
    I need to learn in order to understand this sub-theorem?'' ($\to$ dependency graph,
    tutorial, math encyclopedia)
  \item There is a space for annotations.  Annotations can be:
    \begin{enumerate}
    \item Categorizations (e.\,g.\ field of mathematics\issue{Would MSC help here?})
    \item Project-organization metadata (proven/worked off)
    \item Linking (what kinds of links make sense?)
    \item Discussion posts
    \end{enumerate}
  \item Note that some annotations (e.\,g.\ logical dependencies) can be auto-generated
    from the Twelf source upon import!
  \item Volunteers/collaborators can download/export single theorems (and their
    dependencies, to make it self-contained!) in their favorite theorem-proving language
    (e.\,g.\ Isabelle\ednote{@Sean/Florian: What others are likely to be used? --CL})
  \item They work out a proof and submit it back\issue{@Sean: How??? Upload to the wiki,
      auto-conversion back to Twelf, or to a human maintainer who manually integrates it
      into the ``one big Twelf file''? --CL}
  \end{enumerate}
\end{newpart}

\subsection{Pre-Study in Semantic MediaWiki (Christoph)}
\label{sec:smw-study}

Why Semantic MediaWiki\cite{KrSchVr:semwiki-reasoning07}?
\begin{itemize}
\item rapid prototyping (PHP)
\item well-documented extension/plugin API
\item math support (well, \TeX)
\item powerful and flexible templates/includes
\item Pragmatic reasons\issue{Mention, or rather conceal?}:
  \begin{itemize}
  \item SWiM not yet ready for Flyspeck requirements
  \item we had an installation available (MathWeb)
  \end{itemize}
\end{itemize}

\begin{todo}{@Christoph: describe the current implementation with a few
    screenshots/mockups}
  \begin{itemize}
  \item import the one large Twelf file
  \item break it down into declarations, add annotations gained from the symbol IDs
    (e.\,g.\ ``instanceOf Lemma'')\issue{@Sean, can we also gain sth.\ valuable from the
      Twelf declarations themselves, without too much effort? --CL}
  \item declarations go to individual wiki pages
  \item Twelf presented as \LaTeX, also broken down into fragments
  \item Aggregate each pair of Twelf/\LaTeX\ fragment to one wiki page that includes both
    and offers space for annotations
  \item Users can make formal or informal annotations: e.\,g.\ plain-text comments, or
    further semantic links or categorizations
  \item Show the potential of inline queries: all unproven lemmas in the area of graph
    theory
  \end{itemize}
\end{todo}

\subsection{SWiM, a Semantic Wiki for Mathematical Knowledge Management (Christoph)}
\label{sec:swim}

short intro: OMDoc~\cite{Kohlhase:omdoc1.2}, SWiM~\cite{Lange:swmkm-tr07}, document
ontology, envisaged services

We have developed {\swim}, a semantic wiki for mathematics~\cite{Lange:swmkm-tr07}, which
is an enhanced \product{IkeWiki}~\cite{KrSchVr:semwiki-reasoning07} with {\omdoc} as its
page format.

\subsection{Outlook: Towards Full Flyspeck Support in SWiM (mostly Christoph)}
\label{sec:flyspeck-swim}

first lessons learned from the pre-study

use OMDoc as universal exchange format between ATP languages; every ATP system so far is
an island; OMDoc makes ATP scale to the web

Features that rely on \emph{mathematical} structures are quite kludgy in a PHP/text/regexp
way.  Mathematical content markup for formulae (OMDoc/OpenMath) would be better.  Example:
Linking symbols to their declarations has already been done for OMDoc.

\issue{@Florian, do you think we could make use of MathWebSearch for certain services?
  (@Sean, that's our semantic math formula search engine.)  Now that I've mentioned the
  Pythagoras example, we could think about it. --CL}

\section{Related Work (all)}
\label{sec:related}

\ednote{Again, I'll concentrate on wiki-like collaborative systems.  Is there any related
  work from the pure theorem-proving point of view?  Is there any proof comparable to
  Kepler's? --CL}

\begin{todo}{It will be some effort to distance our approach from ProofWiki or Logiweb,
  to explain why we're not doing it their way. Actually, the Semantic Web community might
  not care, as they do not know our competitors, but the MKM community will
  care.\\
  @Christoph: check the claims made here!  Find out whether such systems have already
  been used in Flyspeck-like scenarios, i.\,e.\ collaboratively proving something.\\
  @Florian: You've also heard these talks at MKM -- I might need your help to justify why
  we're going a different way.}  Recent wikis with integrated proof assistance do not yet
exploit structural semantics of the mathematical knowledge other than what they feed to
the proof assistant or the theorem prover.

  Logiweb~\cite{Grue:Logiweb07} is an open source, distributed system for publication of
  machine checked mathematics.  While the author does not call his system a ``wiki'', it
  is actually similar in spirit\ednote{@CL: in what way? --CL}.

  Arguments against\issue{@Sean/Florian: I need your help with this.  Actually, I just
    started doing the Flyspeck wiki my way, without considering such possible
    alternatives. --CL}:
  \begin{itemize}
  \item uses presentational {\TeX} for output (but hyperlinked symbols are at least nice
    to have for Flyspeck)
  \item no internal support for hyperlinks (required for browsing the Flyspeck)
  \item no query/search/retrieval (essential for Flyspeck)
  \item no import/export features $\Rightarrow$ not connectable to external theorem
    provers (essential for Flyspeck!), calculi and proof tactics need to be defined in the
    system itself.  Would be a nice idea to run Flyspeck this way, but we're not going to
    do that\issue{@Sean/Florian: Why? Or should we? --CL}
  \end{itemize}

  ProofWiki~\cite{CorKal:CoopReposFormalProofs07}\ednote{FYI, see also
    \url{http://homepages.inf.ed.ac.uk/rpollack/mathWiki/slides/Corbineau.pdf}}:
  wiki-aware web interface for proof assistants

  Pros:
  \begin{itemize}
  \item symbols linked to their definition
  \item import/export is possible
  \item auto-generates index pages (e.\,g.\ all definitions, all theorems)
  \item Could probably be combined with Semantic MediaWiki extension?  (Because it's also
    based on MediaWiki)
  \end{itemize}

  Cons:
  \begin{itemize}
  \item not a semantic wiki in the sense that the wiki system \emph{itself} uses a
    semantic representation of the wiki pages: just text search and rather static index
    pages, more flexible queries not supported (at least they have identified this as a
    problem)
  \item except for hyperlinks, no advanced browsing support.  With a semantic wiki
    (e.\,g.\ flexibly inferred dependencies), we can do better.  They just use
    dependencies for exporting proof scripts.
  \item no place for free-form wiki text \emph{on the same page} with a proof script, as
    wiki pages are entirely replaced by proof script editor $\Rightarrow$ can only use
    proof script comments for annotations, or separate wiki pages for informal-only text
    (Is this actually a disadvantage?)
  \item Only supports Coq so far.  They suggest how other provers could be integrated, but
    this looks like a \emph{lot} of work.  We can do better, with OMDoc as a universal
    exchange language.
  \end{itemize}
\end{todo}

\section{Conclusion}
\label{sec:conc}

\ednote{Is there anything we could already conclude? --CL}

\paragraph{Acknowledgments}
\label{sec:ack}

\begin{itemize}
\item Michael Kohlhase
\item Immanuel Normann
\item Robert J.\ Simmons
\end{itemize}

\bibliographystyle{abbrv}
% load crossrefs last when using modular bib files
\bibliography{kwarc}

% \printindex

\ednotemessage
\end{document}

% vim:tw=80:autoindent: 
%%% Local Variables: 
%%% mode: latex
%%% fill-column: 90
%%% End: 
