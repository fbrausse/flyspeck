
let ORDER_FINITE_REAL_HAS_SIZE = prove_by_refinement(
  `!n s. ((s:real->bool) HAS_SIZE n)  ==> (?f.
    IMAGE f {i | i < CARD s} SUBSET s /\ (!i (j:num). (i< j) /\ (j< CARD s) ==> (f i < f j)))`,
  (* {{{ proof *)
[
INDUCT_TAC;
REWRITE_TAC [HAS_SIZE_0];
REPEAT STRIP_TAC ;
ASM_REWRITE_TAC [CARD_CLAUSES;IMAGE_CLAUSES;LT;EMPTY_GSPEC;EMPTY_SUBSET];
REPEAT STRIP_TAC ;
ABBREV_TAC `r = sup s`;
HASH_RULE_TAC 9804  (SPEC `s DELETE (r:real)`);
MP_TAC (SPEC `(s:real->bool)` SUP_FINITE);
ASM_REWRITE_TAC [];
HASH_KILL_TAC 4079 ;
REWRITE_TAC [IMAGE;SUBSET;IN_ELIM_THM;IN];
ANTS_TAC;
ASM_MESON_TAC [HAS_SIZE;HAS_SIZE_0;ARITH_RULE `~(SUC  n = 0)`];
STRIP_TAC ;
SUBGOAL_THEN `(s DELETE r:real) HAS_SIZE n` ASSUME_TAC;
HASH_RULE_TAC 6639 (REWRITE_RULE[HAS_SIZE_SUC]);
  DISCH_THEN (fun t-> MATCH_MP_TAC (CONJUNCT2 t));
ASM_MESON_TAC [IN];
ASM_REWRITE_TAC [];
HASH_RULE_TAC 799 (REWRITE_RULE[HAS_SIZE]);
DISCH_THEN (fun t -> SUBST1_TAC (CONJUNCT2 t));
HASH_RULE_TAC 6639 (REWRITE_RULE[HAS_SIZE]);
DISCH_THEN (fun t -> SUBST1_TAC (CONJUNCT2 t));
REWRITE_TAC [DELETE;IN_ELIM_THM;IN];
REPEAT STRIP_TAC ;
ABBREV_TAC `g = \i. if (n <= i:num) then (r:real) else (f i)`;
EXISTS_TAC `g:num->real`;
SUBGOAL_THEN `r = (g:num->real) n` (fun t -> REPEAT (POP_ASSUM MP_TAC) THEN (SUBST1_TAC t) THEN REPEAT DISCH_TAC);
EXPAND_TAC "g";
REWRITE_TAC [ARITH_RULE `n<= (n:num)`];
SUBGOAL_THEN  `!(i:num). (i < n) ==> g i = (f:num->real) i` ASSUME_TAC;
EXPAND_TAC "g";
MESON_TAC [ARITH_RULE `(i < (n:num) ==> ~(n <= i))`];
HASH_KILL_TAC 9577 ;
REPEAT STRIP_TAC ;
ASM_MESON_TAC [ARITH_RULE `(x' < SUC n) ==> (x' < n) \/ (x' = n)`];
MP_TAC (ARITH_RULE `(j < SUC n ==> ((j < n) \/ (j = n)))`);
ASM_REWRITE_TAC [];
DISCH_THEN DISJ_CASES_TAC;
ASM_MESON_TAC [ARITH_RULE `(i < j /\ j < SUC n ==> i < n)`];
HASH_KILL_TAC 6747 ;
HASH_RULE_TAC 6432  (SPEC `(g:num->real) i`);
HASH_RULE_TAC 4968  (SPEC `(g:num->real) i`);
REWRITE_TAC [REAL_ARITH `x <= (y:real) <=> (x < y \/ x = y)`];
ASM_MESON_TAC [ARITH_RULE ` (i < j /\ j < SUC n ==> i < n)`]
]
);;
  (* }}} *)

let ORDER_FINITE_REAL = prove_by_refinement(
  `!s. (FINITE (s:real->bool))  ==> (?f.
    IMAGE f {i | i < CARD s} SUBSET s /\ (!i (j:num). (i< j) /\ (j< CARD s) ==> (f i < f j)))`,
  (* {{{ proof *)
[
REPEAT STRIP_TAC ;
MATCH_MP_TAC ORDER_FINITE_REAL_HAS_SIZE;
REWRITE_TAC [HAS_SIZE];
ASM_MESON_TAC []
]);;
  (* }}} *)
