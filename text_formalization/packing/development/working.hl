


let KY_CHEAT_TAC = MP_TAC (mk_thm([],`F`)) THEN SET_TAC[];;

list of axioms;;




(* ================================================== *)
(* ======================================================================== *)

g KIZHLTL1_concl;;  
e (GEN_TAC);;
e (ASM_CASES_TAC `saturated V /\ packing (V:real^3->bool)`);;
e (UP_ASM_TAC THEN STRIP_TAC);;


e (NEW_GOAL `!r. &1 <= r
         ==> sum {X | X SUBSET ball (vec 0,r) /\ mcell_set V X} vol <= 
             vol (ball (vec 0, r))`);;
e (REPEAT STRIP_TAC);;
e (ABBREV_TAC `S = {X | X SUBSET ball (vec 0,r) /\ mcell_set V X}`);;
e (REWRITE_WITH `sum S vol = vol (UNIONS S)`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (MATCH_MP_TAC MEASURE_NEGLIGIBLE_UNIONS);;
e (REPEAT STRIP_TAC);;
e (KY_CHEAT_TAC);;
e (REWRITE_TAC[GSYM HAS_MEASURE_MEASURE]);;
e (KY_CHEAT_TAC);;
e (ASM_CASES_TAC `~NULLSET (s INTER t)`);;
e (NEW_GOAL `F`);;
e (KY_CHEAT_TAC);;
e (ASM_MESON_TAC[]);;
e (UP_ASM_TAC THEN MESON_TAC[]);;
e (MATCH_MP_TAC MEASURE_SUBSET);;
e (REWRITE_TAC[MEASURABLE_BALL]);;
e (REPEAT STRIP_TAC);;
e (EXPAND_TAC "S" THEN MATCH_MP_TAC MEASURABLE_UNIONS);;
e (REPEAT STRIP_TAC);;
e (KY_CHEAT_TAC);;
e (UP_ASM_TAC THEN REWRITE_TAC[IN;IN_ELIM_THM; mcell_set]);;
e (REPEAT STRIP_TAC);;
e (ASM_SIMP_TAC[MEASURABLE_MCELL]);;

e (EXPAND_TAC "S" THEN SET_TAC[]);;

(* ----------------------------------------------------------------------- *)

e (NEW_GOAL `?c. !r. &1 <= r
         ==> vol (ball (vec 0, r)) + c * r pow 2 <= 
            sum (V INTER ball (vec 0,r)) (\u:real^3. vol (voronoi_open V u))`);;
e (EXISTS_TAC `c:real`);;
e (REPEAT STRIP_TAC);;
e (ABBREV_TAC `S:real^3->bool = V INTER ball (vec 0, r)`);;
e (ABBREV_TAC `g = (\t:real^3. voronoi_open V t)`);;

e (REWRITE_WITH `sum S (\u:real^3. vol (voronoi_open V u)) = sum S (\t. vol (g t))`);;
e (EXPAND_TAC "g" THEN REWRITE_TAC[]);;
e (REWRITE_WITH `sum S (\t:real^3. vol (g t)) = measure (UNIONS (IMAGE g S))`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (MATCH_MP_TAC MEASURE_NEGLIGIBLE_UNIONS_IMAGE);;
e (ASM_REWRITE_TAC[] THEN EXPAND_TAC "g");;
e (REPEAT STRIP_TAC);;
e (EXPAND_TAC "S");;
e (KY_CHEAT_TAC);;
e (MATCH_MP_TAC Pack1.measurable_voronoi);;
e (ASM_REWRITE_TAC[]);;
e (REWRITE_WITH `(voronoi_open V (t:real^3) INTER voronoi_open V y = {})`);;
e (KY_CHEAT_TAC);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;
e (EXPAND_TAC "g" THEN REWRITE_TAC[IMAGE]);;
e (KY_CHEAT_TAC);;
e (UP_ASM_TAC THEN STRIP_TAC);;

e (EXISTS_TAC `c:real`);;
e (REPEAT STRIP_TAC);;

e (NEW_GOAL `sum {X | X SUBSET ball (vec 0,r) /\ mcell_set V X} vol <=
              vol (ball (vec 0,r))`);;
e (ASM_SIMP_TAC[]);;

e (NEW_GOAL `vol (ball (vec 0,r)) + c * r pow 2 <=
            sum (V INTER ball (vec 0,r)) (\u:real^3. vol (voronoi_open V u))`);;
e (ASM_SIMP_TAC[]);;
e (ABBREV_TAC `a1 = sum {X | X SUBSET ball (vec 0,r) /\ mcell_set V X} vol`);;
e (ABBREV_TAC `a2 = vol (ball ((vec 0):real^3,r))`);;
e (ABBREV_TAC `a3 = sum (V INTER ball (vec 0,r)) (\u:real^3. vol (voronoi_open V u))`);;
e (ASM_REAL_ARITH_TAC);;

e (EXISTS_TAC `&0`);;
e (REPEAT STRIP_TAC);;
e (NEW_GOAL `F`);;
e (ASM_MESON_TAC[]);;
e (ASM_MESON_TAC[]);;

(* ------------------------------------------------------------------------ *)
(* ============= Finished the lemma here ================================== *)
(* ------------------------------------------------------------------------ *)


open Rogers;;
open Vukhacky_tactics;;
open Pack_defs;;
open Pack_concl;; 
open Pack1;;
open Sphere;; 
open Marchal_cells;;
open Emnwuus;;
open Marchal_cells_2_new;;
open Lepjbdj;;
open Hdtfnfz;;
open Urrphbz1;;
open Sltstlo;;
open Qzksykg;;
open Rvfxzbu;;
open Ddzuphj;;
open Urrphbz2;;
open Ajripqn;;
open Qzyzmjc;;

#use "/home/vu/flyspeck/working/UPFZBZM_support_lemmas.hl";;
open Upfzbzm_support_lemmas;;

let KY_CHEAT_TAC = MP_TAC (mk_thm([],`F`)) THEN SET_TAC[];;

(* ========================================================================== *)


#use "/home/vu/flyspeck/working/marchal_cells_3.hl";;

[KY_CHEAT_TAC]);;





let GRUTOTI1_concl = 
`!V u0 u1 e.
     saturated V /\
     packing V /\
     u0 IN V /\
     u1 IN V /\
     hl [u0;u1] < sqrt (&2) /\
     e = {u0, u1}
     ==> sum {X | e IN edgeX V X} (\t. dihX V t (u0,u1)) = &2 * pi`;;



g GRUTOTI1_concl;;
e (REPEAT STRIP_TAC);;




e (NEW_GOAL `barV V 1 [u0;u1:real^3]`);;
e (REWRITE_TAC[BARV; LENGTH; ARITH_RULE `SUC (SUC 0) = 1 + 1`]);;
e (REPEAT STRIP_TAC);;
e (ASM_CASES_TAC `LENGTH (vl:(real^3)list) = 1`);;
e (NEW_GOAL `initial_sublist vl [u0; u1:real^3] /\ LENGTH vl = 0 + 1`);;
e (ASM_REWRITE_TAC[] THEN ARITH_TAC);;
e (UP_ASM_TAC THEN REWRITE_WITH 
   `initial_sublist vl [u0; u1:real^3] /\ LENGTH vl = 0 + 1 <=>
    truncate_simplex 0 [u0;u1] = vl /\ 0 + 1 <= LENGTH [u0;u1:real^3]`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REWRITE_TAC[Packing3.TRUNCATE_SIMPLEX_INITIAL_SUBLIST]);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REPEAT STRIP_TAC);;
e (ASM_REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_0]);;
e (REWRITE_TAC[VORONOI_NONDG; VORONOI_LIST; VORONOI_SET; set_of_list; LENGTH;
   SET_RULE `INTERS {voronoi_closed V v | v IN {u0}} = voronoi_closed V u0`]);;
e (ASM_SIMP_TAC[Packing3.AFF_DIM_VORONOI_CLOSED]);;
e (KY_CHEAT_TAC);;  (* trivial *)


e (ASM_CASES_TAC `LENGTH (vl:(real^3)list) = 2`);;
e (NEW_GOAL `initial_sublist vl [u0; u1:real^3] /\ LENGTH vl = 1 + 1`);;
e (ASM_REWRITE_TAC[] THEN ARITH_TAC);;
e (UP_ASM_TAC THEN REWRITE_WITH 
   `initial_sublist vl [u0; u1:real^3] /\ LENGTH vl = 1 + 1 <=>
    truncate_simplex 1 [u0;u1] = vl /\ 1 + 1 <= LENGTH [u0;u1:real^3]`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REWRITE_TAC[Packing3.TRUNCATE_SIMPLEX_INITIAL_SUBLIST]);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REPEAT STRIP_TAC);;
e (ASM_REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_1]);;
e (REWRITE_TAC[VORONOI_NONDG; VORONOI_LIST; VORONOI_SET; set_of_list; LENGTH;
  SET_RULE `INTERS {voronoi_closed V v | v IN {u,s}} = 
  voronoi_closed V u INTER voronoi_closed V s`]);;
e (ASM_SIMP_TAC[Packing3.AFF_DIM_VORONOI_CLOSED]);;
e (REPEAT STRIP_TAC);;
e (ARITH_TAC);;
e (ASM_SET_TAC[]);;
e (NEW_GOAL 
 `aff_dim (voronoi_closed V (u0:real^3) INTER voronoi_closed V u1) < &3`);;
e (KY_CHEAT_TAC);; 
    (* Pack2.NEGLIGIBLE_INTER_VORONOI_CLOSED *)
e (ASM_CASES_TAC
 `aff_dim (voronoi_closed V (u0:real^3) INTER voronoi_closed V u1) <= &1`);;
e (KY_CHEAT_TAC);;
  (* su dung dinh nghia aff_dim, 
     xet tat ca cac diem co khoang cach sqrt 2 den ca u0 va v0 *)
e (ASM_ARITH_TAC);;
e (NEW_GOAL `F`);;
e (NEW_GOAL `initial_sublist vl [u0; u1:real^3] /\ 
             LENGTH vl = (LENGTH vl - 1) + 1`);;
e (ASM_REWRITE_TAC[] THEN ASM_ARITH_TAC);;
e (UP_ASM_TAC THEN REWRITE_WITH 
   `initial_sublist vl [u0; u1:real^3] /\ LENGTH vl = (LENGTH vl - 1) + 1 <=>
    truncate_simplex (LENGTH vl - 1) [u0;u1] = vl /\ 
    (LENGTH vl - 1) + 1 <= LENGTH [u0;u1:real^3]`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REWRITE_TAC[Packing3.TRUNCATE_SIMPLEX_INITIAL_SUBLIST]);;
e (REWRITE_TAC[LENGTH]);;
e (REPEAT STRIP_TAC);;
e (ASM_ARITH_TAC);;
e (ASM_MESON_TAC[]);;

(* seem not necessary *)
(*
e (NEW_GOAL `?vl. barV V (SUC 1) vl /\ truncate_simplex 1 vl = [u0;u1]`);;
e (MATCH_MP_TAC Rogers.BARV_EXISTS);;
e (ASM_REWRITE_TAC[] THEN ARITH_TAC);;
e (UP_ASM_TAC THEN REWRITE_TAC[ARITH_RULE `SUC 1 = 2`] THEN STRIP_TAC);;
e (NEW_GOAL `?zl. barV V (SUC 2) zl /\ truncate_simplex 2 zl = vl`);;
e (MATCH_MP_TAC Rogers.BARV_EXISTS);;
e (ASM_REWRITE_TAC[] THEN ARITH_TAC);;
e (UP_ASM_TAC THEN REWRITE_TAC[ARITH_RULE `SUC 2 = 3`] THEN STRIP_TAC);;
*)

e (NEW_GOAL 
`?r a.
     let C = ball (u0,r) INTER rcone_ge u0 u1 a in
     (!X. mcell_set V X /\ ~NULLSET (X INTER C)
     ==> (?k vl.
              2 <= k /\
              barV V 3 vl /\
              X = mcell k V vl /\
              truncate_simplex 1 vl = [u0; u1]))`);;
e (EXISTS_TAC `r:real`);;  (* choose appropriately later *)
e (EXISTS_TAC `a:real`);;  (* choose appropriately later *)
e (REWRITE_TAC[mcell_set; IN_ELIM_THM]);;
e (LET_TAC THEN REPEAT STRIP_TAC);;
e (ASM_CASES_TAC `i = 0`);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `X = mcell i V ul`);;
e (ASM_REWRITE_TAC[MCELL_EXPLICIT; mcell0]);;
e (STRIP_TAC);;
e (NEW_GOAL `X:real^3->bool INTER C = {}`);;
e (ASM_REWRITE_TAC[] THEN EXPAND_TAC "C");;




e (EXISTS_TAC `i:num`);;
e (EXISTS_TAC `zl:(real^3)list`);;





SEARCH 


dihX;;
cell_params_d;;
dihu2;;
dihu3;;
dihu4;;

edgeX;;
VX;;
p();;

search [`?ul:(real^3)list. P ul`];;

b();;

search [`NULLSET (A INTER B)`];;
b();;

p();;

RVFXZBU;;
AJRIPQN;;
p();;

search [`mcell i V ul = mcell j V vl`];;

e (NEW_GOAL `?v0 v1 v2 v3. ul = [v0;v1;v2;v3:real^3]`);;
e (MATCH_MP_TAC BARV_3_EXPLICIT);;
e (EXISTS_TAC `V:real^3->bool` THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (EXISTS_TAC `i:num`);;



e (KY_CHEAT_TAC);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (UP_ASM_TAC THEN LET_TAC THEN STRIP_TAC);;

e (NEW_GOAL `2 <= k /\
                   barV V 3 ul /\
                   X = mcell k V ul ==> X INTER C = C INTER aff_ge {u0,u1} {v, w}`

mcell2;;



(* ========================================================================= *)




(* ========================================================================= *)

g `!u v V X. dihX V X (u,v) = dihX V X (v,u)`;; 
e (REPEAT STRIP_TAC);;
e (REWRITE_TAC[dihX; dihu2; dihu3;dihu4]);;
e (REPEAT LET_TAC);;
e (COND_CASES_TAC);;
e (COND_CASES_TAC);;
e (REFL_TAC);;
e (UP_ASM_TAC THEN MESON_TAC[]);;
e (COND_CASES_TAC);;
e (COND_CASES_TAC);;
e (UP_ASM_TAC THEN MESON_TAC[]);;
e (COND_CASES_TAC);;




dihu2;;
dihu3;;
dihu4;;
Pack1.inj_map3;;
Vol1.bdt7_finiteness;;
Vol1.bdt6_finiteness;;
Vol1.bdt5_finiteness;;
int_ball;;
map3;;
floor;;
int_ball;;
INJ;;

search [`FINITE`; `packing`; `ball`];;
type_of `cell_params`;;


