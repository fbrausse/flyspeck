
g `!u0:real^3 u1 w1 w2 r a.
    &0 < r /\ a < &1 /\ &0 <= a /\ ~coplanar {u0, u1, w1, w2} ==>
    vol (conic_cap u0 u1 r a INTER convex hull {u0, u1, w1, w2}) > &0`;;

e (REPEAT STRIP_TAC);;
e (NEW_GOAL `measurable 
            (conic_cap u0 u1 r a INTER convex hull {u0, u1, w1, w2:real^3})`);;
e (MATCH_MP_TAC MEASURABLE_INTER);;
e (REWRITE_TAC[MEASURABLE_CONIC_CAP; MEASURABLE_CONVEX_HULL]);;
e (SIMP_TAC[MEASURABLE_CONVEX_HULL;FINITE_IMP_BOUNDED;Geomdetail.FINITE6]);;
e (REWRITE_TAC[REAL_ARITH `a > &0 <=> &0 <= a /\ ~(a = &0)`]);;
e (ASM_SIMP_TAC[MEASURE_POS_LE]);;
e (REWRITE_WITH 
     `vol (conic_cap u0 u1 r a INTER convex hull {u0, u1, w1, w2}) = &0 <=>
      NULLSET (conic_cap u0 u1 r a INTER convex hull {u0, u1, w1, w2})`);;
e (ASM_SIMP_TAC[MEASURABLE_MEASURE_EQ_0]);;
e (REPEAT STRIP_TAC);;

e (NEW_GOAL `?r1 a1. &0 < r1 /\ a1 < &1 /\ 
                conic_cap u0 u1 r1 a1 INTER aff_ge {u0, u1} {w1, w2:real^3} =
                conic_cap u0 u1 r1 a1 INTER convex hull {u0, u1,w1, w2} /\
                conic_cap u0 u1 r1 a1 SUBSET conic_cap u0 u1 r a`);;
e (ABBREV_TAC `s = closest_point (affine hull {u1, w1, w2:real^3}) u0`);;
e (ABBREV_TAC `r2 = dist (u0:real^3, s)`);;
e (ABBREV_TAC `r1 = min r2 r`);;
e (ABBREV_TAC `s2 = smallest_angle_line w1 (w2:real^3) u0 u1`);;
e (ABBREV_TAC 
   `a2 = ((s - u0:real^3) dot (u1 - u0)) /(norm (s - u0) * norm (u1 - u0))`);;
e (ABBREV_TAC `a1 = max a2 a`);;
e (EXISTS_TAC `r1:real` THEN EXISTS_TAC `a1:real`);;
e (NEW_GOAL `&0 < r1 /\ a1 < &1`);;
e (EXPAND_TAC "r1" THEN EXPAND_TAC "a1");;
e (REWRITE_TAC[REAL_ARITH `&0 < min a b <=> &0 < a /\ &0 < b`;
               REAL_ARITH `max a b < &1 <=> a < &1 /\ b < &1`;]);;
e (ASM_REWRITE_TAC[]);;
e (STRIP_TAC);;
e (EXPAND_TAC "r2");;
e (MATCH_MP_TAC DIST_POS_LT);;
e (STRIP_TAC);;

e (NEW_GOAL `u0 IN affine hull {u1, w1, w2:real^3}`);;
e (ASM_REWRITE_TAC[]);;
e (DEL_TAC THEN EXPAND_TAC "s");;
e (MATCH_MP_TAC CLOSEST_POINT_IN_SET);;
e (REWRITE_TAC[CLOSED_AFFINE_HULL; AFFINE_HULL_EQ_EMPTY] THEN SET_TAC[]);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_TAC[]);;
e (ONCE_REWRITE_TAC[GSYM COPLANAR_AFFINE_HULL_COPLANAR]);;
e (REWRITE_WITH `affine hull {u0, u1, w1, w2} = 
                 affine hull {u1:real^3, w1, w2}`);;
e (MATCH_MP_TAC AFFINE_HULL_3_INSERT);;
e (ASM_REWRITE_TAC[]);;
e (REWRITE_TAC[COPLANAR_AFFINE_HULL_COPLANAR; COPLANAR_3]);;

e (EXPAND_TAC "a2");;
e (MATCH_MP_TAC REAL_DIV_LT_1_TACTICS);;
e (STRIP_TAC);;
e (MATCH_MP_TAC REAL_LT_MUL);;
e (ASM_REWRITE_TAC[NORM_POS_LT; VECTOR_ARITH `a - b = vec 0 <=> a = b`]);;

e (REPEAT STRIP_TAC);;


e (NEW_GOAL `s IN affine hull {u1, w1, w2:real^3}`);;
e (DEL_TAC THEN EXPAND_TAC "s");;
e (MATCH_MP_TAC CLOSEST_POINT_IN_SET);;
e (REWRITE_TAC[CLOSED_AFFINE_HULL; AFFINE_HULL_EQ_EMPTY] THEN SET_TAC[]);;
e (UP_ASM_TAC THEN REWRITE_TAC[ASSUME `s:real^3 = u0`] THEN STRIP_TAC);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_TAC[]);;
e (ONCE_REWRITE_TAC[GSYM COPLANAR_AFFINE_HULL_COPLANAR]);;
e (REWRITE_WITH `affine hull {u0, u1, w1, w2} = 
                 affine hull {u1:real^3, w1, w2}`);;
e (MATCH_MP_TAC AFFINE_HULL_3_INSERT);;
e (ASM_REWRITE_TAC[]);;
e (REWRITE_TAC[COPLANAR_AFFINE_HULL_COPLANAR; COPLANAR_3]);;

e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_WITH `{u0, u1, w1, w2:real^3} = {u0, w1, w2:real^3}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[COPLANAR_3]);;

e (REWRITE_TAC[REAL_ARITH `a < b <=> (a <= b) /\ ~(a = b)`]);;
e (STRIP_TAC);;
e (REWRITE_TAC[NORM_CAUCHY_SCHWARZ]);;
e (REWRITE_TAC[NORM_CAUCHY_SCHWARZ_EQ]);;

e (KY_CHEAT_TAC);;
e (NEW_GOAL `conic_cap (u0:real^3) u1 r1 a1 SUBSET conic_cap u0 u1 r a`);;
e (REWRITE_TAC[conic_cap; NORMBALL_BALL] THEN MATCH_MP_TAC 
  (SET_RULE `a SUBSET b /\ c SUBSET d ==> a INTER c SUBSET b INTER d`));;
e (STRIP_TAC);;
e (MATCH_MP_TAC SUBSET_BALL);;
e (EXPAND_TAC "r1" THEN REAL_ARITH_TAC);;
e (MATCH_MP_TAC RCONE_GT_SUBSET);;
e (EXPAND_TAC "a1" THEN REAL_ARITH_TAC);;

e (ASM_REWRITE_TAC[]);;


e (REWRITE_TAC[SET_RULE `b = a <=> a SUBSET b /\ b SUBSET a`]);;
e (STRIP_TAC);;
e (MATCH_MP_TAC (SET_RULE `a SUBSET b ==> x INTER a SUBSET x INTER b`));;
e (REWRITE_TAC[Marchal_cells_2_new.CONVEX_HULL_4_SUBSET_AFF_GE_2_2]);;
e (REWRITE_TAC[SUBSET; IN_INTER]);;
e (REPEAT STRIP_TAC);;
e (ASM_REWRITE_TAC[]);;

e (UP_ASM_TAC);;
e (NEW_GOAL `DISJOINT {u0, u1:real^3} {w1, w2}`);;
e (REWRITE_TAC[DISJOINT]);;
e (ASM_CASES_TAC `w1 IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_WITH `{u0, u1, w1, w2:real^3} = {u0, u1, w2:real^3}`);;
e (UP_ASM_TAC THEN SET_TAC[]);;
e (REWRITE_TAC[COPLANAR_3]);;
e (UP_ASM_TAC THEN SET_TAC[]);;
e (ASM_CASES_TAC `w2 IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_WITH `{u0, u1, w1, w2:real^3} = {u0, u1, w1:real^3}`);;
e (UP_ASM_TAC THEN SET_TAC[]);;
e (REWRITE_TAC[COPLANAR_3]);;
e (UP_ASM_TAC THEN SET_TAC[]);;
e (ASM_SET_TAC[]);;

e (ASM_SIMP_TAC[Marchal_cells_2.AFF_GE_2_2; CONVEX_HULL_4; IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;
e (EXISTS_TAC `t1:real` THEN EXISTS_TAC `t2:real` THEN 
   EXISTS_TAC `t3:real` THEN EXISTS_TAC `t4:real`);;
e (ASM_REWRITE_TAC[]);;
e (STRIP_TAC);;

e (REWRITE_TAC[REAL_ARITH `&0 <= t <=> ~(t < &0)`] THEN STRIP_TAC);;
e (NEW_GOAL `!x. x IN affine hull {u1, w1, w2} ==> 
                 dist (u0,s:real^3) <= dist (u0,x:real^3)`);;
e (REPEAT STRIP_TAC THEN EXPAND_TAC "s");;
e (MATCH_MP_TAC CLOSEST_POINT_LE);;
e (ASM_REWRITE_TAC[CLOSED_AFFINE_HULL]);;

e (NEW_GOAL `&1 < t2 + t3+ t4`);;
e (ASM_REAL_ARITH_TAC);;
e (NEW_GOAL `~(t2 + t3+ t4 = &0)`);;
e (ASM_REAL_ARITH_TAC);;

e (ABBREV_TAC `y = t2 / (t2 + t3 + t4) % u1 + t3 / (t2 + t3 + t4) % w1 + 
                   t4 / (t2 + t3 + t4) % w2:real^3`);;
e (NEW_GOAL `x = t1 % u0 + (t2 + t3 + t4) % (y:real^3)`);;
e (ASM_REWRITE_TAC[] THEN EXPAND_TAC "y");;
e (REWRITE_TAC[VECTOR_ARITH 
 `t1 % u0 + t2 % u1 + t3 % w1 + t4 % w2 = 
  t1 % u0 + t % (t2 / t % u1 + t3 / t % w1 + t4 / t % w2) <=> 
  t2 % u1 + t3 % w1 + t4 % w2 = t / t % (t2 % u1 + t3 % w1 + t4 % w2)`]);;
e (REWRITE_WITH `(t2 + t3 + t4) / (t2 + t3 + t4) = &1`);;
e (ASM_SIMP_TAC[REAL_DIV_REFL]);;
e (VECTOR_ARITH_TAC);;

e (NEW_GOAL `y IN affine hull {u1, w1, w2:real^3}`);;
e (REWRITE_TAC[AFFINE_HULL_3; IN; IN_ELIM_THM]);;
e (EXISTS_TAC `t2 / (t2 + t3 + t4)` THEN 
   EXISTS_TAC `t3 / (t2 + t3 + t4)` THEN EXISTS_TAC `t4 / (t2 + t3 + t4)`);;
e (ASM_REWRITE_TAC[REAL_ARITH `a/x + b/ x + c/ x = (a+b+c) / x`]);;
e (ASM_SIMP_TAC[REAL_DIV_REFL]);;

e (NEW_GOAL `dist (u0, s:real^3) <= dist (u0, y:real^3)`);;
e (ASM_SIMP_TAC[]);;
e (NEW_GOAL `dist (u0, s) <= dist (u0, x:real^3)`);;
e (REWRITE_TAC[ASSUME `x = t1 % u0 + (t2 + t3 + t4) % y:real^3`; dist]);;
e (REWRITE_WITH `u0 - (t1 % u0 + (t2 + t3 + t4) % y) = 
  (t1 + t2 + t3 + t4) % u0 - (t1 % u0 + (t2 + t3 + t4) % y:real^3)`);;
e (ASM_REWRITE_TAC[] THEN VECTOR_ARITH_TAC);;
e (REWRITE_TAC[VECTOR_ARITH 
  `(t1 + t) % u0 - (t1 % u0 + t % y) = t % (u0 - y)`; NORM_MUL]);;
e (REWRITE_WITH `abs (t2 + t3 + t4) = t2 + t3 + t4`);;
e (REWRITE_TAC[REAL_ABS_REFL] THEN ASM_REAL_ARITH_TAC);;
e (REWRITE_TAC[GSYM dist]);;
e (NEW_GOAL `dist (u0, y:real^3) <= (t2 + t3 + t4) * dist (u0, y)`);;
e (REWRITE_TAC[REAL_ARITH `a <= b * a <=> &0 <= (b - &1) * a`]);;
e (MATCH_MP_TAC REAL_LE_MUL);;
e (REWRITE_TAC[DIST_POS_LE]);;
e (ASM_REAL_ARITH_TAC);;
e (ASM_REAL_ARITH_TAC);;

e (NEW_GOAL `x IN ball (u0:real^3, r1)`);;
e (UNDISCH_TAC `x IN conic_cap u0 (u1:real^3) r1 a1`);;
e (REWRITE_TAC[conic_cap; NORMBALL_BALL] THEN SET_TAC[]);;
e (UP_ASM_TAC THEN REWRITE_TAC[IN_BALL]);;
e (EXPAND_TAC "r1" THEN EXPAND_TAC "r2");;
e (UP_ASM_TAC THEN REAL_ARITH_TAC);;









e (REWRITE_TAC[REAL_ARITH `&0 <= t <=> ~(t < &0)`] THEN STRIP_TAC);;
e (NEW_GOAL `!y. y IN convex hull {w1, w2:real^3}
         ==> ((y - u0) dot (u1 - u0)) / (norm (y - u0) * norm (u1 - u0)) <=
             ((s2 - u0) dot (u1 - u0)) / (norm (s2 - u0) * norm (u1 - u0))`);;
e (REPEAT STRIP_TAC);;
e (MATCH_MP_TAC SMALLEST_ANGLE_LINE_PROPERTY);;
e (EXISTS_TAC `w1:real^3` THEN EXISTS_TAC `w2:real^3`);;
e (ASM_REWRITE_TAC[]);;
e (REPEAT STRIP_TAC);;

e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_WITH `{u0, u1, w1, w2:real^3} = {u1, w1, w2:real^3}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[COPLANAR_3]);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_TAC[]);;
e (ONCE_REWRITE_TAC[GSYM COPLANAR_AFFINE_HULL_COPLANAR]);;
e (REWRITE_WITH `affine hull {u0, u1, w1, w2} = 
                 affine hull {u1:real^3, w1, w2}`);;
e (MATCH_MP_TAC AFFINE_HULL_3_INSERT);;
e (NEW_GOAL `convex hull {w1, w2:real^3} SUBSET affine hull {u1,w1, w2}`);;
e (NEW_GOAL `convex hull {w1, w2:real^3} SUBSET affine hull {w1, w2}`);;
e (REWRITE_TAC[CONVEX_HULL_SUBSET_AFFINE_HULL]);;
e (NEW_GOAL `affine hull {w1, w2:real^3} SUBSET affine hull {u1,w1, w2}`);;
e (MATCH_MP_TAC Marchal_cells_2_new.AFFINE_SUBSET_KY_LEMMA THEN SET_TAC[]);;
e (ASM_SET_TAC[]);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[COPLANAR_AFFINE_HULL_COPLANAR; COPLANAR_3]);;

e (NEW_GOAL `~(t3+ t4 = &0)`);;
e (STRIP_TAC);;
e (NEW_GOAL `t3 = &0 /\ t4 = &0`);;
e (ASM_REAL_ARITH_TAC);;
e (NEW_GOAL `F`);;

e (NEW_GOAL `x = t1 % u0 + t2 % u1:real^3`);;
e (ASM_REWRITE_TAC[] THEN VECTOR_ARITH_TAC);;
e (NEW_GOAL `x:real^3 IN rcone_gt u0 u1 a1`);;
e (UNDISCH_TAC `x:real^3 IN conic_cap u0 u1 r1 a1`);;
e (REWRITE_TAC[conic_cap] THEN SET_TAC[conic_cap]);;
e (UP_ASM_TAC THEN REWRITE_TAC[rcone_gt; rconesgn; IN; IN_ELIM_THM] THEN STRIP_TAC);;

e (NEW_GOAL `(x - u0) dot (u1 - u0:real^3) <= &0`);;
e (REWRITE_TAC[ASSUME `x = t1 % u0 + t2 % u1:real^3`]);;
e (REWRITE_WITH `(t1 % u0 + t2 % u1) - u0 = 
  (t1 % u0 + t2 % u1) - (t1 + t2 + t3 + t4) % u0:real^3`);;
e (ASM_REWRITE_TAC[] THEN VECTOR_ARITH_TAC);;
e (REWRITE_TAC[ASSUME `t3 = &0 /\ t4 = &0`; VECTOR_ARITH 
  `(t1 % u0 + t2 % u1) - (t1 + t2 + &0 + &0) % u0 = t2 % (u1 - u0)`; DOT_LMUL;      REAL_ARITH `a * b <= &0 <=> &0 <= (--a) * b`]);;
e (MATCH_MP_TAC REAL_LE_MUL);;
e (REWRITE_TAC[DOT_POS_LE] THEN ASM_REAL_ARITH_TAC);;
e (NEW_GOAL `&0 <= dist (x,u0) * dist (u1,u0:real^3) * a1`);;
e (MATCH_MP_TAC REAL_LE_MUL);;
e (REWRITE_TAC[DIST_POS_LE]);;
e (MATCH_MP_TAC REAL_LE_MUL);;
e (REWRITE_TAC[DIST_POS_LE]);;
e (ASM_REAL_ARITH_TAC);;
e (ASM_REAL_ARITH_TAC);;
e (ASM_MESON_TAC[]);;


e (ABBREV_TAC `y = t3 / (t3 + t4) % w1 + t4 / (t3 + t4) % w2:real^3`);;
e (NEW_GOAL `x = t1 % u0 + t2 % u1 + (t3 + t4) % (y:real^3)`);;
e (ASM_REWRITE_TAC[] THEN EXPAND_TAC "y");;
e (REWRITE_TAC[VECTOR_ARITH 
 `t1 % u0 + t2 % u1 + t3 % w1 + t4 % w2 = 
  t1 % u0 + t2 % u1 + t % (t3 / t % w1 + t4 / t % w2) <=> 
  t3 % w1 + t4 % w2 = t / t % (t3 % w1 + t4 % w2)`]);;
e (REWRITE_WITH `(t3 + t4) / (t3 + t4) = &1`);;
e (ASM_SIMP_TAC[REAL_DIV_REFL]);;
e (VECTOR_ARITH_TAC);;

e (NEW_GOAL `y IN convex hull {w1, w2:real^3}`);;
e (REWRITE_TAC[CONVEX_HULL_2; IN; IN_ELIM_THM]);;
e (EXISTS_TAC `t3 / (t3 + t4)` THEN EXISTS_TAC `t4 / (t3 + t4)`);;
e (ASM_REWRITE_TAC[REAL_ARITH `a / x + b / x = (a + b) / x`]);;
e (REPEAT STRIP_TAC);;
e (MATCH_MP_TAC REAL_LE_DIV);;
e (ASM_REAL_ARITH_TAC);;
e (MATCH_MP_TAC REAL_LE_DIV);;
e (ASM_REAL_ARITH_TAC);;
e (ASM_SIMP_TAC[REAL_DIV_REFL]);;

e (ABBREV_TAC `f = (\y:real^3. 
  ((y - u0) dot (u1 - u0)) / (norm (y - u0:real^3) * norm (u1 - u0)))`);;
e (NEW_GOAL `(f:real^3->real) y <= f s2`);;
e (EXPAND_TAC "f");;
e (ASM_SIMP_TAC[]);;

e (NEW_GOAL `&1 < t1 + t3+ t4`);;
e (ASM_REAL_ARITH_TAC);;
e (NEW_GOAL `~(t1 + t3+ t4 = &0)`);;
e (ASM_REAL_ARITH_TAC);;

e (ABBREV_TAC `w = t1 / (t1 + t3 + t4) % u0 + t3 / (t1 + t3 + t4) % w1 + 
                   t4 / (t1 + t3 + t4) % w2:real^3`);;

e (NEW_GOAL `(f:real^3->real) y = f w`);;
e (EXPAND_TAC "f");;

e (REWRITE_WITH `y:real^3 - u0 = 
                &1 / (t3 + t4) % (t3 % w1 + t4 % w2 - (t3 + t4) % u0)`);;
e (EXPAND_TAC "y");;
e (REWRITE_TAC[VECTOR_ARITH 
  `(t3 / (t3 + t4) % u2 + t4 / (t3 + t4) % u3) - u0 =
   &1 / (t3 + t4) % (t3 % u2 + t4 % u3 - (t3 + t4) % u0) <=> 
   (t3 + t4) / (t3 + t4) % u0 = u0`]);;
e (REWRITE_WITH `(t3 + t4) / (t3 + t4) = &1`);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (ASM_REWRITE_TAC[]);;
e (VECTOR_ARITH_TAC);;
e (REWRITE_TAC[NORM_MUL; DOT_LMUL]);;

e (REWRITE_WITH `w:real^3 - u0 = 
                &1 / (t1 + t3 + t4) % (t3 % w1 + t4 % w2 - (t3 + t4) % u0)`);;
e (EXPAND_TAC "w");;
e (REWRITE_TAC[VECTOR_ARITH 
   `(t1 / (t1 + t3 + t4) % u0 +
    t3 / (t1 + t3 + t4) % u2 + t4 / (t1 + t3 + t4) % u3) - u0 =
    &1 / (t1 + t3 + t4) % (t3 % u2 + t4 % u3 - (t3 + t4) % u0) <=> 
    (t1 + t3 + t4) / (t1 + t3 + t4) % u0 = u0`]);;
e (REWRITE_WITH `(t1 + t3 + t4) / (t1 + t3 + t4) = &1`);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (ASM_REWRITE_TAC[]);;
e (VECTOR_ARITH_TAC);;
e (REWRITE_TAC[NORM_MUL; DOT_LMUL]);;
e (REWRITE_WITH `abs (&1 / (t3 + t4)) = &1 / (t3 + t4)`);;
e (REWRITE_TAC[REAL_ABS_REFL]);;
e (ASM_SIMP_TAC[REAL_LE_DIV;REAL_LE_ADD; REAL_ARITH `&0 <= &1`]);;
e (REWRITE_WITH `abs (&1 / (t1 + t3 + t4)) = &1 / (t1 + t3 + t4)`);;
e (REWRITE_TAC[REAL_ABS_REFL]);;
e (MATCH_MP_TAC REAL_LE_DIV THEN REWRITE_TAC[REAL_ARITH `&0 <= &1`]);;
e (UNDISCH_TAC `t2 < &0` THEN UNDISCH_TAC `t1 + t2 + t3 + t4 = &1` 
   THEN REAL_ARITH_TAC);;
e (REWRITE_TAC[REAL_ARITH `(a * x) / ((a * y) * z) = 
                           (a * x) / (a * (y * z))`]);;
e (ABBREV_TAC 
  `b1 = norm (t3 % w1 + t4 % w2 - (t3 + t4) % u0) * norm (u1 - u0:real^3)`);;
e (NEW_GOAL `~(b1 = &0)`);;
e (EXPAND_TAC "b1" THEN ASM_REWRITE_TAC[REAL_ENTIRE; NORM_EQ_0; 
   VECTOR_ARITH `(a - b = vec 0 <=> a = b)/\(a + b-c = vec 0 <=> a + b = c)`]);;
e (STRIP_TAC);;

e (KY_CHEAT_TAC);;
e (KY_CHEAT_TAC);;


e (NEW_GOAL `~(&1 / (t3 + t4) = &0)`);;
e (MATCH_MP_TAC Trigonometry2.NOT_EQ0_IMP_NEITHER_INVERT);;
e (ASM_REWRITE_TAC[]);;

e (REWRITE_WITH 
 `(&1 / (t3 + t4) * ((t3 % w1 + t4 % w2 - (t3 + t4) % u0) dot (u1 - u0))) /
  (&1 / (t3 + t4) * b1) = 
  ((t3 % w1 + t4 % w2 - (t3 + t4) % u0) dot (u1 - u0:real^3)) / b1`);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN MESON_TAC[Trigonometry1.REAL_DIV_MUL2]);;

e (NEW_GOAL `~(&1 / (t1 + t3 + t4) = &0)`);;
e (MATCH_MP_TAC Trigonometry2.NOT_EQ0_IMP_NEITHER_INVERT);;
e (ASM_REWRITE_TAC[]);;

e (REWRITE_WITH 
 `(&1 / (t1 + t3 + t4) * ((t3 % w1 + t4 % w2 - (t3 + t4) % u0) dot (u1 - u0))) /
  (&1 / (t1 + t3 + t4) * b1) = 
  ((t3 % w1 + t4 % w2 - (t3 + t4) % u0) dot (u1 - u0:real^3)) / b1`);;
e (UP_ASM_TAC THEN UNDISCH_TAC `~(b1 = &0)` THEN
   MESON_TAC[Trigonometry1.REAL_DIV_MUL2]);;












e (NEW_GOAL `(f:real^3->real) x <= f w`);;
e (EXPAND_TAC "f");;

e (REWRITE_WITH 
  `((x - u0) dot (u1 - u0:real^3)) / (norm (x - u0) * norm (u1 - u0)) <=
  ((w - u0) dot (u1 - u0)) / (norm (w - u0) * norm (u1 - u0)) <=>
  ((x - u0) dot (u1 - u0)) * (norm (w - u0) * norm (u1 - u0)) <= 
  ((w - u0) dot (u1 - u0)) * (norm (x - u0) * norm (u1 - u0))`);;
e (MATCH_MP_TAC RAT_LEMMA4);;
e (STRIP_TAC);;
e (MATCH_MP_TAC REAL_LT_MUL);;
e (ASM_REWRITE_TAC[NORM_POS_LT; VECTOR_ARITH `x - b = vec 0 <=> x = b`]);;
e (REPEAT STRIP_TAC);;

e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}` THEN REWRITE_TAC[]);;
e (REWRITE_TAC[coplanar]);;
e (EXISTS_TAC `u0:real^3` THEN EXISTS_TAC `w1:real^3` THEN 
   EXISTS_TAC `w2:real^3`);;
e (ONCE_REWRITE_TAC[SET_RULE `{u0, u1, u2, u3} = {u1, u0, u2, u3}`]);;
e (MATCH_MP_TAC (SET_RULE `u0 IN S /\ b SUBSET S ==> (u0 INSERT b) SUBSET S`));;
e (REWRITE_TAC[SET_SUBSET_AFFINE_HULL]);;
e (REWRITE_TAC[AFFINE_HULL_3; IN; IN_ELIM_THM]);;
e (EXISTS_TAC `(t2 + t3 + t4) / t2` THEN EXISTS_TAC `(--t3) / t2` 
   THEN EXISTS_TAC `(--t4) / t2`);;
e (REPEAT STRIP_TAC);;
e (REWRITE_TAC[REAL_ARITH 
   `(t2 + t3 + t4) / t2 + --t3 / t2 + --t4 / t2 = t2 / t2`]);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (UNDISCH_TAC `t2 < &0` THEN REAL_ARITH_TAC);;
e (REWRITE_WITH `(t2 + t3 + t4) = &1 - t1`);;
e (UNDISCH_TAC `t1 + t2 + t3 + t4 = &1` THEN REAL_ARITH_TAC);;
e (NEW_GOAL `u0 - t1 % u0 - t3 % w1 - t4 % w2:real^3 = t2 % u1`);;
e (UP_ASM_TAC THEN VECTOR_ARITH_TAC);;
e (ASM_REWRITE_TAC[VECTOR_ARITH 
   `(&1 - t1) / t2 % u0 + --t3 / t2 % u2 + --t4 / t2 % u3 = 
    (&1 / t2) % (u0 - t1 % u0 - t3 % u2 - t4 % u3)`]);;
e (REWRITE_TAC[VECTOR_MUL_ASSOC; REAL_ARITH `&1 / a * a = a / a`]);;
e (REWRITE_WITH `t2 / t2 = &1`);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (UNDISCH_TAC `t2 < &0` THEN REAL_ARITH_TAC);;
e (VECTOR_ARITH_TAC);;

e (KY_CHEAT_TAC);;

e (MATCH_MP_TAC REAL_LT_MUL);;
e (ASM_REWRITE_TAC[NORM_POS_LT; VECTOR_ARITH `x - b = vec 0 <=> x = b`]);;
e (STRIP_TAC);;

e (EXPAND_TAC "w" THEN STRIP_TAC);;
e (UNDISCH_TAC `~coplanar {u0, u1, w1, w2:real^3}`);;
e (REWRITE_TAC[coplanar]);;
e (EXISTS_TAC `u1:real^3` THEN EXISTS_TAC `w1:real^3` THEN 
   EXISTS_TAC `w2:real^3`);;
e (MATCH_MP_TAC (SET_RULE `u0 IN S /\ b SUBSET S ==> (u0 INSERT b) SUBSET S`));;
e (REWRITE_TAC[SET_SUBSET_AFFINE_HULL]);;
e (REWRITE_TAC[AFFINE_HULL_3; IN; IN_ELIM_THM]);;

e (EXISTS_TAC `&0` THEN EXISTS_TAC `t3 / (t3 + t4)` 
   THEN EXISTS_TAC `t4 / (t3 + t4)`);;
e (REPEAT STRIP_TAC);;
e (REWRITE_TAC[REAL_ARITH `&0 + t3 / (t3 + t4) + t4 / (t3 + t4) = 
                          (t3 + t4) / (t3 + t4)`]);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (ASM_REWRITE_TAC[]);;
e (ASM_REWRITE_TAC[VECTOR_ARITH 
   `&0 % u1 + t3 / (t3 + t4) % u2 + t4 / (t3 + t4) % u3 = 
    (&1 / (t3 + t4)) % (t3 % u2 + t4 % u3)`]);;
e (UP_ASM_TAC THEN REWRITE_TAC[VECTOR_ARITH 
   `t1 / x % u0 + t3 / x % u2 + t4 / x % u3 = 
    (&1 / x) % (t1 % u0 + t3 % u2 + t4 % u3)`]);;
e (REWRITE_WITH `&1 / (t1 + t3 + t4) % (t1 % u0 + t3 % w1 + t4 % w2) = u0 <=> 
                 t1 % u0 + t3 % w1 + t4 % w2 = (t1 + t3 + t4) % u0:real^3`);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (MATCH_MP_TAC Collect_geom.CHANGE_SIDE);;
e (UNDISCH_TAC `t2 < &0` THEN UNDISCH_TAC `t1 + t2 +t3 + t4 = &1` THEN 
   REAL_ARITH_TAC);;

e (REWRITE_TAC[VECTOR_ARITH `t1 % u0 + t3 % u2 + t4 % u3 = (t1 + t3 + t4) % u0
   <=> t3 % u2 + t4 % u3 = (t3 + t4) % u0`]);;
e (STRIP_TAC THEN ASM_REWRITE_TAC[]);;
e (REWRITE_TAC[VECTOR_MUL_ASSOC; REAL_ARITH `&1 / a * a = a / a`]);;
e (REWRITE_WITH `(t3 + t4) / (t3 + t4) = &1`);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (UNDISCH_TAC `&0 < t3 + t4` THEN REAL_ARITH_TAC);;
e (VECTOR_ARITH_TAC);;
e (SET_TAC[]);;




e (NEW_GOAL `dist (u0, s) <= dist (u0, x:real^3)`);;
e (REWRITE_TAC[ASSUME `x = t1 % u0 + (t2 + t3 + t4) % y:real^3`; dist]);;
e (REWRITE_WITH `u0 - (t1 % u0 + (t2 + t3 + t4) % y) = 
  (t1 + t2 + t3 + t4) % u0 - (t1 % u0 + (t2 + t3 + t4) % y:real^3)`);;
e (ASM_REWRITE_TAC[] THEN VECTOR_ARITH_TAC);;
e (REWRITE_TAC[VECTOR_ARITH 
  `(t1 + t) % u0 - (t1 % u0 + t % y) = t % (u0 - y)`; NORM_MUL]);;
e (REWRITE_WITH `abs (t2 + t3 + t4) = t2 + t3 + t4`);;
e (REWRITE_TAC[REAL_ABS_REFL] THEN ASM_REAL_ARITH_TAC);;
e (REWRITE_TAC[GSYM dist]);;
e (NEW_GOAL `dist (u0, y:real^3) <= (t2 + t3 + t4) * dist (u0, y)`);;
e (REWRITE_TAC[REAL_ARITH `a <= b * a <=> &0 <= (b - &1) * a`]);;
e (MATCH_MP_TAC REAL_LE_MUL);;
e (REWRITE_TAC[DIST_POS_LE]);;
e (ASM_REAL_ARITH_TAC);;
e (ASM_REAL_ARITH_TAC);;

e (NEW_GOAL `x IN ball (u0:real^3, r1)`);;
e (UNDISCH_TAC `x IN conic_cap u0 (u1:real^3) r1 a1`);;
e (REWRITE_TAC[conic_cap; NORMBALL_BALL] THEN SET_TAC[]);;
e (UP_ASM_TAC THEN REWRITE_TAC[IN_BALL]);;
e (EXPAND_TAC "r1" THEN UP_ASM_TAC THEN REAL_ARITH_TAC);;




b();;

b();;

REAL_DIV_REFL;;
b();;

seans_fn();;


b();;
b();;
search [`closest_point`];;

smallest_angle_line;;
smallest_angle_set;;


e (ABBREV_TAC `P1 = { (f1:(real^3)list->real) ul |ul | barV V 3 ul /\
                                 ~NULLSET (mcell 3 V ul INTER C) /\
                                  truncate_simplex 1 ul = [u0; u1]}`);;

e (NEW_GOAL `~(P1 = {}) ==> (?b:real. b IN P1 /\ (!x. x IN P1 ==> b <= x))`);;
e (STRIP_TAC);;
e (MATCH_MP_TAC INF_FINITE_LEMMA);;
e (ASM_REWRITE_TAC[]);;
e (EXPAND_TAC "P1");;
e (ONCE_REWRITE_TAC [SET_RULE `{f x| x | P x} = {f x | x IN {y | P y}}`]);;
e (ONCE_REWRITE_TAC [SET_RULE `{f x| x IN s} = {y | ?x. x IN s /\ y = f x}`]);;
e (MATCH_MP_TAC FINITE_IMAGE_EXPAND);;
e (MATCH_MP_TAC FINITE_SUBSET);;
e (EXISTS_TAC `{y | ?v0:real^3 v1 u2 u3.
                      v0 IN (V INTER ball (u0:real^3, &4)) /\
                      v1 IN (V INTER ball (u0, &4)) /\
                      u2 IN (V INTER ball (u0, &4)) /\
                      u3 IN (V INTER ball (u0, &4)) /\
                      y = [v0; v1; u2; u3]}`);;
e (STRIP_TAC);;
e (MATCH_MP_TAC FINITE_SET_LIST_LEMMA);;
e (ASM_SIMP_TAC[FINITE_PACK_LEMMA]);;
e (REWRITE_TAC[SUBSET] THEN ONCE_REWRITE_TAC[IN] THEN REWRITE_TAC[IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;
e (NEW_GOAL `?v0 v1 u2 u3. x = [v0; v1; u2; u3:real^3]`);;
e (MATCH_MP_TAC BARV_3_EXPLICIT);;
e (EXISTS_TAC `V:real^3->bool` THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (EXISTS_TAC `v0:real^3` THEN EXISTS_TAC `v1:real^3` THEN     
   EXISTS_TAC `u2:real^3` THEN EXISTS_TAC `u3:real^3`);;
e (ASM_REWRITE_TAC[]);;
e (NEW_GOAL `v0 = u0:real^3`);;
e (REWRITE_WITH `v0 = HD (x:(real^3)list)`);;
e (ASM_REWRITE_TAC[HD]);;
e (REWRITE_WITH `u0 = HD (truncate_simplex 1 (x:(real^3)list))`);;
e (ASM_REWRITE_TAC[HD]);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ] THEN MATCH_MP_TAC Packing3.HD_TRUNCATE_SIMPLEX);;
e (ASM_REWRITE_TAC[LENGTH] THEN ARITH_TAC);;
e (NEW_GOAL `set_of_list x SUBSET ball (u0:real^3,&4)`);;
e (MATCH_MP_TAC Qzyzmjc.BARV_3_IMP_FINITE_lemma2);;
e (EXISTS_TAC `V:real^3->bool`);;
e (ASM_REWRITE_TAC[set_of_list]);;
e (SET_TAC[]);;
e (NEW_GOAL `set_of_list x SUBSET V:real^3->bool`);;
e (MATCH_MP_TAC Packing3.BARV_SUBSET);;
e (EXISTS_TAC `3` THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN ASM_REWRITE_TAC[set_of_list]);;
e (SET_TAC[]);;

e (ABBREV_TAC `r1 = (if (P1 = {}:real->bool) then &1 
                    else (@b. b IN P1 /\ (!x. x IN P1 ==> b <= x)))`);;
e (NEW_GOAL `&0 < r1`);;
e (EXPAND_TAC "r1");;
e (COND_CASES_TAC);;
e (REAL_ARITH_TAC);;
e (NEW_GOAL `?b:real. b IN P1 /\ (!x. x IN P1 ==> b <= x)`);;
e (ASM_SIMP_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (ABBREV_TAC `P  = (\b:real. b IN P1 /\ (!x. x IN P1 ==> b <= x))`);;
e (ABBREV_TAC `zz = (@) (P:real->bool)`);;
e (NEW_GOAL `(P:real->bool) zz`);;
e (EXPAND_TAC "zz");;
e (MATCH_MP_TAC SELECT_AX);;
e (EXISTS_TAC `b':real`);;
e (EXPAND_TAC "P" THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN EXPAND_TAC "P" THEN REWRITE_TAC[]);;
e (EXPAND_TAC "P1" THEN REWRITE_TAC[IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;
e (ASM_REWRITE_TAC[]);;
e (EXPAND_TAC "f1");;
e (MATCH_MP_TAC DIST_POS_LT);;
e (ONCE_REWRITE_TAC[EQ_SYM_EQ]);;
e (REWRITE_WITH `closest_point (affine hull {u1, EL 2 ul, mxi V ul}) u0 = u0
  <=> u0 IN (affine hull {u1:real^3, EL 2 ul, mxi V ul})`);;
e (MATCH_MP_TAC CLOSEST_POINT_REFL);;
e (REWRITE_TAC[CLOSED_AFFINE_HULL]);;
e (REWRITE_TAC[AFFINE_HULL_EQ_EMPTY] THEN SET_TAC[]);;
e (STRIP_TAC);;
e (UNDISCH_TAC `~NULLSET (mcell 3 V ul INTER C)`);;
e (REWRITE_TAC[] THEN MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `mcell 3 V ul`);;
e (REWRITE_TAC[SET_RULE `A INTER B SUBSET A`]);;
e (REWRITE_TAC[MCELL_EXPLICIT; mcell3]);;
e (COND_CASES_TAC);;

e (NEW_GOAL `?v0 v1 v2 v3. ul = [v0;v1;v2;v3:real^3]`);;
e (MATCH_MP_TAC Marchal_cells.BARV_3_EXPLICIT);;
e (EXISTS_TAC `V:real^3->bool` THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (ASM_REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list]);;

e (REWRITE_WITH `v0 = u0:real^3`);;
e (NEW_GOAL `HD (truncate_simplex 1 ul) = u0:real^3`);;
e (ASM_REWRITE_TAC[HD]);;
e (NEW_GOAL `HD (truncate_simplex 1 ul) = v0:real^3`);;
e (REWRITE_TAC[ASSUME `ul = [v0; v1; v2; v3:real^3]`;  
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD]);;
e (ASM_MESON_TAC[]);;

e (REWRITE_WITH `v1 = u1:real^3`);;
e (NEW_GOAL `HD (TL(truncate_simplex 1 ul)) = u1:real^3`);;
e (ASM_REWRITE_TAC[HD; TL]);;
e (NEW_GOAL `HD (TL(truncate_simplex 1 ul)) = v1:real^3`);;
e (REWRITE_TAC[ASSUME `ul = [v0; v1; v2; v3:real^3]`;  
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD; TL]);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN MESON_TAC[]);;
e (REWRITE_TAC[SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;

e (MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `affine hull {u0, u1, v2, mxi V [u0; u1; v2; v3]}`);;
e (REWRITE_TAC[CONVEX_HULL_SUBSET_AFFINE_HULL]);;
e (REWRITE_WITH `affine hull {u0, u1, v2, mxi V [u0; u1; v2; v3]} = 
                 affine hull {u1, v2, mxi V [u0; u1; v2; v3]}`);;
e (MATCH_MP_TAC AFFINE_HULL_3_INSERT);;
e (REWRITE_WITH `affine hull {u1, v2, mxi V [u0; u1; v2; v3]} = 
                 affine hull {u1, EL 2 ul, mxi V ul}`);;
e (ASM_REWRITE_TAC[EL; ARITH_RULE `2 = SUC 1 /\ 1 = SUC 0`; HD; TL]);;

e (REWRITE_WITH `v0 = u0:real^3`);;
e (NEW_GOAL `HD (truncate_simplex 1 ul) = u0:real^3`);;
e (ASM_REWRITE_TAC[HD]);;
e (NEW_GOAL `HD (truncate_simplex 1 ul) = v0:real^3`);;
e (REWRITE_TAC[ASSUME `ul = [v0; v1; v2; v3:real^3]`;  
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD]);;
e (ASM_MESON_TAC[]);;

e (REWRITE_WITH `v1 = u1:real^3`);;
e (NEW_GOAL `HD (TL(truncate_simplex 1 ul)) = u1:real^3`);;
e (ASM_REWRITE_TAC[HD; TL]);;
e (NEW_GOAL `HD (TL(truncate_simplex 1 ul)) = v1:real^3`);;
e (REWRITE_TAC[ASSUME `ul = [v0; v1; v2; v3:real^3]`;  
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD; TL]);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN MESON_TAC[]);;
e (ASM_REWRITE_TAC[]);;
e (REWRITE_TAC[NEGLIGIBLE_AFFINE_HULL_3]);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;



b();;

search [`measure s = &0`];;


search [`FINITE {a,b,c,d}`];;









#use "/home/ky/flyspeck/working/GRUTOTI.hl";;
#use "/home/ky/flyspeck/working/empty.hl";;

p();;
search [`s INTER convex hull {a,b,c,d}`];;

p


(* ========================================================================= *)
(* ========================================================================= *)

e (UP_ASM_TAC);;
e (ABBREV_TAC `t ={X | mcell_set V X /\ edgeX V X e /\ ~NULLSET (X INTER D)}`);;

e (REWRITE_WITH `sum s (\t. vol (t INTER D)) = 
                 sum t (\t. vol (t INTER D))`);;
e (MATCH_MP_TAC SUM_SUPERSET);;
e (EXPAND_TAC "s" THEN EXPAND_TAC "t" THEN REPEAT STRIP_TAC);;
e (SET_TAC[]);;
e (MATCH_MP_TAC MEASURE_EQ_0);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN REWRITE_TAC[IN; IN_ELIM_THM] );;
e (MESON_TAC[]);;


e (REWRITE_WITH `sum s (\t. dihX V t (u0,u1)) = 
                 sum t (\t. dihX V t (u0,u1))`);;
e (MATCH_MP_TAC SUM_SUPERSET);;
e (EXPAND_TAC "s" THEN EXPAND_TAC "t" THEN REPEAT STRIP_TAC);;
e (SET_TAC[]);;

e (NEW_GOAL `NULLSET (x INTER D)`);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN REWRITE_TAC[IN; IN_ELIM_THM] );;
e (MESON_TAC[]);;

e (NEW_GOAL `mcell_set V x /\ edgeX V x e`);;
e (UNDISCH_TAC `x IN {X | mcell_set V X /\ edgeX V X e}`);;
e (REWRITE_TAC[IN; IN_ELIM_THM]);;
e (UP_ASM_TAC THEN REWRITE_TAC[mcell_set_2; IN_ELIM_THM;IN] THEN STRIP_TAC);;

e (NEW_GOAL `~NULLSET x`);;
e (UP_ASM_TAC THEN REWRITE_TAC[edgeX; VX; IN_ELIM_THM]);;
e (COND_CASES_TAC THEN REPEAT STRIP_TAC);;
e (UNDISCH_TAC `{} (u:real^3)` THEN REWRITE_TAC[MESON[IN] `{} x <=> x IN {}`]);;
e (SET_TAC[]);;

e (NEW_GOAL `VX V x = V INTER (x:real^3->bool)`);;
e (MATCH_MP_TAC Hdtfnfz.HDTFNFZ);;
e (EXISTS_TAC `ul:(real^3)list` THEN EXISTS_TAC `i:num`);;
e (ASM_REWRITE_TAC[]);;

e (NEW_GOAL `V INTER (x:real^3->bool) = 
             set_of_list (truncate_simplex (i - 1) ul)`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC Lepjbdj.LEPJBDJ);;
e (ASM_REWRITE_TAC[]);;
e (STRIP_TAC);;
e (ASM_CASES_TAC `i = 0`);;
e (NEW_GOAL `V INTER (x:real^3->bool) = {}`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC Lepjbdj.LEPJBDJ_0);;
e (ASM_REWRITE_TAC[]);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `edgeX V x e` THEN REWRITE_TAC[edgeX; IN_ELIM_THM]);;
e (STRIP_TAC);;
e (UNDISCH_TAC `VX V x u` THEN ASM_REWRITE_TAC[MESON[IN] `{} x <=> x IN {}`]);;
e (SET_TAC[]);;
e (UP_ASM_TAC THEN MESON_TAC[]);;
e (UP_ASM_TAC THEN ARITH_TAC);;
e (REWRITE_TAC[GSYM (ASSUME `x = mcell i V ul`)] THEN STRIP_TAC);;
e (UNDISCH_TAC `~NULLSET x` THEN REWRITE_TAC[ASSUME `x:real^3->bool = {}`;
   NEGLIGIBLE_EMPTY]);;

e (NEW_GOAL `(u0:real^3) IN VX V x /\ u1 IN VX V x`);;
e (UNDISCH_TAC `edgeX V x e` THEN REWRITE_TAC[edgeX; IN_ELIM_THM; 
   ASSUME `e = {u0, u1:real^3}`]);;
e (STRIP_TAC);;
e (UP_ASM_TAC THEN UP_ASM_TAC THEN UP_ASM_TAC THEN UP_ASM_TAC THEN SET_TAC[]);;






;;

b();;

p();;

search [`a pow n = &0`];;
search
VOLUME_CONIC_CAP_WEDGE;;






p();;

b();;


search [`&0 <= pi`];;

b();;


_TAC);;

WEDGE_LUNE

search [`azim v0 v1 w1 w2 = &0`];;

cyclic_set;;

search [`wedge`; `aff_gt`];;

b();;

;;

search []
search [`V INTER X = set_of_list ul`];;
p();;
search [`vol (conic_cap a b c d INTER s)`];;
zim v0 v1 w1 w2
search [`azim v0 v1 w1 w2  = &0`];;


b();;







b();;




e (NEW_GOAL `F`);;



e (NEW_GOAL `2 <= i`);;
e (KY_CHEAT_TAC);;

b();;

(* ========================================================================= *)
(* ========================================================================= *)
(* ========================================================================= *)
(* ========================================================================= *)
(* ========================================================================= *)
(* ========================================================================= *)
(* ========================================================================= *)




b();;



dihu2;;
dihV;;
p();;


dihX;;


p();;

dihX;;
dihu2;;


e (MATCH_MP_TAC MEASURE_EQ_0);;


b();;

dihX;;
p();;
b();;

search [`negligible `; `measure s`];;

search [`sum s f = sum t f`];;


e (REWRITE_WITH `sum s (\t. vol (t INTER D)) = 
                 sum s (\t. vol D * dihX V t (u0,u1) / (&2 * pi))`);;
e (MATCH_MP_TAC SUM_EQ);;
e (REWRITE_TAC[]);;
e (EXPAND_TAC "s" THEN REWRITE_TAC[IN; IN_ELIM_THM] THEN REPEAT STRIP_TAC);;
e (

e (FIRST_ASSUM MATCH_MP_TAC);;
e (ASM_REWRITE_TAC[]);;



b();;

search [`CARD`; `LENGTH`];;
search [`set_of_list a SUBSET set_of_list b`];;



b();;

NEGLIGIBLE_SUBSET;;

b();;






search [`V INTER B = set_of_list ul`];;







b();;

e (EXISTS_TAC `x:real^3->bool INTER D`);;
e (STRIP_TAC);;
e (EXISTS_TAC `x:real^3->bool`);;
e (REWRITE_TAC[]);;

e (NEW_GOAL `?k xl.
                   2 <= k /\
                   barV V 3 xl /\
                   X = mcell k V xl /\
                   truncate_simplex 1 xl = [u0; u1]`);;
e (FIRST_ASSUM MATCH_MP_TAC);;
e (REWRITE_TAC[mcell_set]);;

b();;


e (ASM_SIMP_TAC[]);;








e (STRIP_TAC);;
e (EXISTS_TAC `i:num` THEN EXISTS_TAC `vl:(real^3)list` 
   THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN MESON_TAC[]);;


seans_fn();;

b();;


e (ASM_REWRITE_TAC[]);;
b();;


search [``]

b();;




b();;


b();;


MEASURE_NEGLIGIBLE_UNIONS_IMAGE;;


b();;




search [`NULLSET (a INTER b)`; `mcell`];;


e (KY_CHEAT_TAC);;


e (EXPAND_TAC "f" THEN REWRITE_TAC[IMAGE]);;



search [`VX`];;
p();;

b();;

edgeX;;
VX;;

p();;
search [`FINITE`; `edgeX`];;

SUM_CONST;;


p();;


(* checkpointed *)
needs "/home/ky/flyspeck/working/marchal_cells_3.hl";; 
#use "/home/ky/flyspeck/working/GRUTOTI.hl";;
(* checkpointed *)
let KY_CHEAT_TAC = MP_TAC (mk_fthm([],`F`)) THEN MESON_TAC[];;

p();;
search [`hl ul < sqrt (&2)`; `packing`];;
Rogers.OMEGA_LIST_N_IN_CONVEX_HULL;;

search [`mcell i V ul`; `?!x. P x`];;
search [`aff_ge {a, b} {c, d}`; `packing V`];;
search [`aff_ge`];;

aff_ge_def;;

Marchal_cells_2_new.AFF_GE_BREAK_KY_LEMMA;;
p();;
search [`conic_cap`; `convex hull s`];;
conic_cap;;
p();;
search [`affine hull {a, b,c}`; `dist (x, y)`];;





b();;
 
search [`(a + b) % c = d`];;
b();;

b();;

type_of `conic_cap`;;

b();;




AFF_GE_2_2;;

e (REPEAT STRIP_TAC);;


b();;

CONVEX_HULL_SUBSET_AFF_GE;;

search [`convex hull s SUBSET aff_ge t q` ];;

p();;
b();;

seans_fn();;

b();;

search [`rogers V ul= rogers V vl`];;

Rogers.DUUNHOR;;


p();;


e (REWRITE_WITH `vol (X INTER C) = vol (L INTER C)`);;
e (AP_TERM_TAC);;

e (NEW_GOAL `X INTER C SUBSET C INTER rogers V vl`);;



p();;
b();;

e (ASM_REWRITE_TAC[MCELL_EXPLICIT; mcell3]);;
e (COND_CASES_TAC);;
e (REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list; 
   SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (REWRITE_WITH `mxi V [u0; u1; u2; u3] = m`);;
e (ASM_MESON_TAC[]);;

e (EXPAND_TAC "L");;
e (MATCH_MP_TAC (SET_RULE `A SUBSET B /\ (!x. x IN B /\ x IN C ==> x IN A) ==>
  (A INTER C = B INTER C)`));;
e (REWRITE_TAC[Marchal_cells_2_new.CONVEX_HULL_4_SUBSET_AFF_GE_2_2]);;

e (NEW_GOAL `DISJOINT {u0, u1} {u2, m:real^3}`);;
e (REWRITE_TAC[DISJOINT]);;
e (ASM_CASES_TAC `u2 IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;

e (UNDISCH_TAC `~NULLSET (X INTER C)`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `mcell 3 V [u0; u1; u2; u3]`);;
e (STRIP_TAC);;
e (REWRITE_TAC[MCELL_EXPLICIT; mcell3; TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list;    SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (COND_CASES_TAC);;
e (REWRITE_WITH `{u0, u1, u2, mxi V [u0; u1; u2; u3]} = 
                 {u0, u1, mxi V [u0; u1; u2; u3]}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[NEGLIGIBLE_CONVEX_HULL_3]);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;
e (SET_TAC[]);;
e (ASM_MESON_TAC[]);;


e (ASM_CASES_TAC `m IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `~NULLSET (X INTER C)`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `mcell 3 V [u0; u1; u2; u3]`);;
e (STRIP_TAC);;
e (REWRITE_TAC[MCELL_EXPLICIT; mcell3; TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list;    SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (COND_CASES_TAC);;
e (REWRITE_WITH `{u0, u1, u2, mxi V [u0; u1; u2; u3]} = 
                 {u0, u1, u2}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[NEGLIGIBLE_CONVEX_HULL_3]);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;
e (SET_TAC[]);;
e (ASM_MESON_TAC[]);;

e (UP_ASM_TAC THEN UP_ASM_TAC THEN SET_TAC[]);;
e (SIMP_TAC[Marchal_cells_2_new.AFF_GE_2_2; 
   ASSUME `DISJOINT {u0, u1} {u2, m:real^3}`]);;
e (REWRITE_TAC[CONVEX_HULL_4; IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;




(* ========================================================================== *)
(* Continue GRUTOTI *)


(* ========================================================================= *)
(*  Case k = 3                                                               *)
(* ========================================================================= *)

e (ASM_CASES_TAC `k = 3`);;
e (ABBREV_TAC `m = mxi V vl`);;
e (NEW_GOAL `?u2 u3. vl = [u0; u1;u2;u3:real^3]`);;
e (NEW_GOAL `?v0 v1 u2 u3. vl = [v0; v1;u2;u3:real^3]`);;
e (MATCH_MP_TAC BARV_3_EXPLICIT);;
e (EXISTS_TAC `V:real^3->bool` THEN ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;
e (EXISTS_TAC `u2:real^3` THEN EXISTS_TAC `u3:real^3`);;

e (REWRITE_WITH `u0 = v0:real^3`);;
e (REWRITE_WITH `v0:real^3 = HD (truncate_simplex 1 vl)`);;
e (REWRITE_TAC[ASSUME `vl = [v0;v1;u2;u3:real^3]`; 
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD]);;
e (ASM_REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_1; HD]);;

e (REWRITE_WITH `u1 = v1:real^3`);;
e (REWRITE_WITH `v1:real^3 = HD (TL (truncate_simplex 1 vl))`);;
e (REWRITE_TAC[ASSUME `vl = [v0;v1;u2;u3:real^3]`; 
   TRUNCATE_SIMPLEX_EXPLICIT_1; HD; TL]);;
e (ASM_REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_1; HD; TL]);;
e (ASM_REWRITE_TAC[]);;
e (UP_ASM_TAC THEN STRIP_TAC);;

e (ABBREV_TAC `L = aff_ge{u0, u1} {u2, m:real^3}`);;
e (REWRITE_WITH `vol (X INTER C) = vol (L INTER C)`);;
e (AP_TERM_TAC);;
e (ASM_REWRITE_TAC[MCELL_EXPLICIT; mcell3]);;
e (COND_CASES_TAC);;
e (REWRITE_TAC[TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list; 
   SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (REWRITE_WITH `mxi V [u0; u1; u2; u3] = m`);;
e (ASM_MESON_TAC[]);;

e (EXPAND_TAC "L");;
e (MATCH_MP_TAC (SET_RULE `A SUBSET B /\ (!x. x IN B /\ x IN C ==> x IN A) ==>
  (A INTER C = B INTER C)`));;
e (REWRITE_TAC[Marchal_cells_2_new.CONVEX_HULL_4_SUBSET_AFF_GE_2_2]);;

e (NEW_GOAL `DISJOINT {u0, u1} {u2, m:real^3}`);;
e (REWRITE_TAC[DISJOINT]);;
e (ASM_CASES_TAC `u2 IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;

e (UNDISCH_TAC `~NULLSET (X INTER C)`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `mcell 3 V [u0; u1; u2; u3]`);;
e (STRIP_TAC);;
e (REWRITE_TAC[MCELL_EXPLICIT; mcell3; TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list;    SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (COND_CASES_TAC);;
e (REWRITE_WITH `{u0, u1, u2, mxi V [u0; u1; u2; u3]} = 
                 {u0, u1, mxi V [u0; u1; u2; u3]}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[NEGLIGIBLE_CONVEX_HULL_3]);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;
e (SET_TAC[]);;
e (ASM_MESON_TAC[]);;


e (ASM_CASES_TAC `m IN {u0, u1:real^3}`);;
e (NEW_GOAL `F`);;
e (UNDISCH_TAC `~NULLSET (X INTER C)`);;
e (ASM_REWRITE_TAC[]);;
e (MATCH_MP_TAC NEGLIGIBLE_SUBSET);;
e (EXISTS_TAC `mcell 3 V [u0; u1; u2; u3]`);;
e (STRIP_TAC);;
e (REWRITE_TAC[MCELL_EXPLICIT; mcell3; TRUNCATE_SIMPLEX_EXPLICIT_2; set_of_list;    SET_RULE `{a,b,c} UNION {d} = {a,b,c,d}`]);;
e (COND_CASES_TAC);;
e (REWRITE_WITH `{u0, u1, u2, mxi V [u0; u1; u2; u3]} = 
                 {u0, u1, u2}`);;
e (ASM_SET_TAC[]);;
e (REWRITE_TAC[NEGLIGIBLE_CONVEX_HULL_3]);;
e (REWRITE_TAC[NEGLIGIBLE_EMPTY]);;
e (SET_TAC[]);;
e (ASM_MESON_TAC[]);;

e (UP_ASM_TAC THEN UP_ASM_TAC THEN SET_TAC[]);;
e (SIMP_TAC[Marchal_cells_2_new.AFF_GE_2_2; 
   ASSUME `DISJOINT {u0, u1} {u2, m:real^3}`]);;
e (REWRITE_TAC[CONVEX_HULL_4; IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;

e (ASM_CASES_TAC `t1 < &0`);;
e (NEW_GOAL `F`);;




KY_CHEAT_TAC;;







Rogers.WAUFCHE2;;

search [`hl ul <= dist (a, b)`]
;;
search [`a * b = &0 <=> s`];;

b();;


search [`dist (a,b) pow 2 = dist (c, d) pow 2`];;

search [`HD `; `set_of_list`];;

b();;


b();;

b();;

search [`x IN s ==> x IN affine hull s`];;



search [`voronoi_list V zl`; `omega_list_n`];;

b();;

search [`LENGTH (truncate_simplex k ul)`];;


Rogers.HL_PROPERTIES;;
Rogers.WAUFCHE2;;
Rogers.XNHPWAB1;;
Rogers.WAUFCHE1;;







e (NEW_GOAL `!w:real^3. w IN set_of_list xl
                  ==> dist (circumcenter (set_of_list xl),w) = hl xl`);;
e (MATCH_MP_TAC Rogers.HL_PROPERTIES);;
e (EXISTS_TAC `V:real^3->bool` THEN EXISTS_TAC `2`);;
e (ASM_REWRITE_TAC[] THEN EXPAND_TAC "xl");;

search [`barV V k (truncate_simplex k ul)`];;


Rogers.HL_PROPERTIES;;
Rogers.WAUFCHE2;;
Rogers.XNHPWAB1;;
Rogers.WAUFCHE1;;


p();;
mcell2;;
p();;

search [`dist `; `hl`];;

e (KY_CHEAT_TAC);;
e (KY_CHEAT_TAC);;

b();;

e (SET_TAC[]);;





search 
p();;
b();;
dihu2;;
dihX;;


mcell2;;
mcell3;;
mcell4;;

dihV;;

arcV;;

aff_ge [``]
p();;
b();;
mxi;;

search [`mxi`];;
Packing3.CONVEX_HULL_EQ_EQ_SET_EQ;;

search [`mcell i V ul`];;
b();;
Qzksykg.QZKSYKG2;;
p();;

search [`rogers V ul = rogers V vl`];;
Njiutiu.NJIUTIU;;


search [`omega_list_n V ul i = t `];;

dihu2;;
dihX;;
p();;

search [`rogers V ul = rogers V vl`];;

e (KY_CHEAT_TAC);;
e (KY_CHEAT_TAC);;

p();;
dihu2;;
dihu3;;
dihu4;;

mcell3;;
mcell4;;


cell_params_d;;
SELECT_EXISTS;;
p();;

search [`?y. P y `; `(@x. P x)`];;

VOLUME_CONIC_CAP;;


p();;
p();;

seans_fn();;
search [` vol (conic_cap u0 u1 r c)`];;

b();;
AZIM_DIVH;;
p();;

 ``


b();;



dihu2;;
AZIM_EQ_0_PI_IMP_COPLANAR;;
VOLUME_CONIC_CAP_WEDGE;;
AZIM_DIVH;;
AZIM_DIHV_SAME;;
AZIM_DIHV_EQ_PI;;
AZIM_EQ_PI_SYM;;
Trigonometry.YVREJIS;;
VOLUME_CONIC_CAP_COMPL;;
VOLUME_CONIC_CAP_WEDGE_WEAK;;
AZIM_COMPL;;
vol_conic_cap_wedge;;

sol;;
dihV;;
conic_cap;;
p();;

b();;


















let KY_CHEAT_TAC = MP_TAC (mk_thm([],`F`)) THEN SET_TAC[];;

open Upfzbzm_support_lemmas;;
#use "/home/vu/flyspeck/working/marchal_cells_3;;
#use "/home/vu/flyspeck/working/KIZHLTL;;
#use "/home/vu/flyspeck/working/UPFZBZM_2011;;

(* ========================================================================== *)

g KIZHLTL3_new_concl;;
e (REPEAT STRIP_TAC);;
e (ASM_CASES_TAC `saturated V /\ packing V`);;

(* ------------------------------------------------------------------------- *)
e (EXISTS_TAC `c:real`);;
e (REPEAT STRIP_TAC);;
e (KY_CHEAT_TAC);;

edgeX;;
lmfun;;

(* ------------------------------------------------------------------------- *)
e (EXISTS_TAC `&0` THEN REPEAT STRIP_TAC);;
e (NEW_GOAL `F`);;
e (ASM_MESON_TAC[]);;
e (ASM_MESON_TAC[]);;

let KIZHLTL3 = top_thm();;






(*      The following lemma is to be proved by computer calculations         *)

let TSKAJXY_concl = 
`!V X. saturated V /\ packing V /\ mcell_set V X /\ critical_edgeX V X  = {} 
   ==> gammaX V X lmfun >= &0`;;

let KY_CHEAT_TAC = MP_TAC (mk_thm([],`F`)) THEN SET_TAC[];;
let TSKAJXY = prove (TSKAJXY_concl, KY_CHEAT_TAC);;

(* ========================================================================== *)
(*               Continue back up of complementary lemmas                     *)
(* ========================================================================== *)

let SUM_GAMMAX_LMFUN_ESTIMATE_concl = 
  `!V. ?c. !r. saturated V /\ packing V /\ &1 <= r /\ 
               cell_cluster_estimate V /\ marchal_inequality /\
               lmfun_inequality V ==> 
    c * r pow 2 <=  sum {X | X SUBSET ball (vec 0, r)  /\ mcell_set V X} 
    (\X. gammaX V X lmfun)`;;

(* ----------------------  We prove it below ------------------------------- *)

g SUM_GAMMAX_LMFUN_ESTIMATE_concl;;
e (GEN_TAC);;
e (EXISTS_TAC `c:real`);;
e (REPEAT STRIP_TAC);;
e (NEW_GOAL `!X. mcell_set V X /\ critical_edgeX V X  = {} ==> 
                 gammaX V X lmfun >= &0`);;
e (ASM_MESON_TAC[TSKAJXY]);;

(* ------------------------------------------------------------------------ *)

e (ABBREV_TAC `B = {X | X SUBSET ball (vec 0, r)  /\ mcell_set V X}`);;
e (ABBREV_TAC `B0 = {X | X SUBSET ball (vec 0,r) /\ mcell_set V X /\
                         critical_edgeX V X = {}}`);;
e (ABBREV_TAC `B1 = {X | X SUBSET ball (vec 0,r) /\ mcell_set V X /\
                         ~(critical_edgeX V X = {})}`);;
e (REWRITE_WITH `B = B0 UNION B1:(real^3->bool)->bool`);;
e (EXPAND_TAC "B" THEN EXPAND_TAC "B1" THEN EXPAND_TAC "B0");;
e (SET_TAC[]);;
e (REWRITE_WITH `sum (B0 UNION B1) (\X. gammaX V X lmfun) = 
   sum B0 (\X. gammaX V X lmfun) + sum B1 (\X. gammaX V X lmfun)`);;
e (MATCH_MP_TAC SUM_UNION);;
e (REPEAT STRIP_TAC);;
e (EXPAND_TAC "B0");;
e (MATCH_MP_TAC FINITE_SUBSET);;
e (EXISTS_TAC `{X | X SUBSET ball (vec 0,r) /\ mcell_set V X}`);;
e (STRIP_TAC);;
e (ASM_SIMP_TAC[FINITE_MCELL_SET_LEMMA]);;
e (SET_TAC[]);;
e (EXPAND_TAC "B1");;
e (MATCH_MP_TAC FINITE_SUBSET);;
e (EXISTS_TAC `{X | X SUBSET ball (vec 0,r) /\ mcell_set V X}`);;
e (STRIP_TAC);;
e (ASM_SIMP_TAC[FINITE_MCELL_SET_LEMMA]);;
e (SET_TAC[]);;
e (EXPAND_TAC "B1" THEN EXPAND_TAC "B0");;
e (SET_TAC[]);;
e (MATCH_MP_TAC (REAL_ARITH `&0 <= b /\ a <= c ==> a <= b + c`));;
e (STRIP_TAC);;
e (MATCH_MP_TAC SUM_POS_LE);;
e (STRIP_TAC);;
e (EXPAND_TAC "B0");;
e (MATCH_MP_TAC FINITE_SUBSET);;
e (EXISTS_TAC `{X | X SUBSET ball (vec 0,r) /\ mcell_set V X}`);;
e (STRIP_TAC);;
e (ASM_SIMP_TAC[FINITE_MCELL_SET_LEMMA]);;
e (SET_TAC[]);;
e (REWRITE_TAC[BETA_THM; REAL_ARITH `&0 <= a <=> a >= &0`]);;
e (EXPAND_TAC "B0" THEN REWRITE_TAC[IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;
e (ASM_SIMP_TAC[]);;


e (REWRITE_WITH 
  `sum B1 (\X. gammaX V X lmfun) = 
   sum B1 (\X. (gammaX V X lmfun) * 
                sum (critical_edgeX V X) (\e. critical_weight V X))`);;
e (MATCH_MP_TAC SUM_EQ);;
e (EXPAND_TAC "B1" THEN REWRITE_TAC[IN; IN_ELIM_THM]);;
e (REPEAT STRIP_TAC);;
e (REWRITE_TAC[critical_weight]);;
e (REWRITE_WITH 
  `sum (critical_edgeX V x) (\e. &1 / &(CARD (critical_edgeX V x))) = 
   &(CARD (critical_edgeX V x)) * (&1 / &(CARD (critical_edgeX V x)))`);;
e (MATCH_MP_TAC SUM_CONST);;
e (REWRITE_TAC[FINITE_critical_edgeX]);;
e (REWRITE_TAC[REAL_ARITH `a * &1 / a = a / a`]);;
e (REWRITE_WITH `&(CARD (critical_edgeX V x)) / &(CARD (critical_edgeX V x)) = &1`);;
e (MATCH_MP_TAC REAL_DIV_REFL);;
e (REWRITE_TAC[REAL_OF_NUM_EQ]);;
e (REWRITE_WITH `CARD (critical_edgeX V x) = 0 <=> critical_edgeX V x = {}`);;
e (MATCH_MP_TAC CARD_EQ_0);;
e (REWRITE_TAC[FINITE_critical_edgeX]);;
e (ASM_REWRITE_TAC[]);;
e (REAL_ARITH_TAC);;




















