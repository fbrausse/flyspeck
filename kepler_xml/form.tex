%% INTRO TO FORM




\label{part:form}
\chapter{The Top-Level Structure of the Proof}

%\section{Overview}
\label{sec:overview}

This \chap\ describes the structure of the proof of the
\index{Kepler conjecture} Kepler conjecture.


\section{Statement of Theorems}\label{sec:statement}


\begin{theorem}[The Kepler Conjecture]
\label{theorem:kepler}   No packing of congruent balls in
Euclidean three space has density greater than that of the
face-centered cubic packing.
\end{theorem}

\begin{remark}
This density is $\pi/\sqrt{18}\approx 0.74.$  There are other
packings, such as the hexagonal close packing, that attain this
same density.
\end{remark}

The proof of this result is presented in this \paper. Here, we
describe the top-level outline of the proof and give references to
the sources of the details of the proof.

By a {\it packing}, we mean an arrangement of congruent balls that
are nonoverlapping in the sense that the interiors of the balls are
pairwise disjoint. Consider a \index{packing} packing of congruent
balls in Euclidean three space. There is no harm in assuming that
all the balls have unit radius. 

%The density of a packing does not
%decrease when balls are added to the packing. Thus, to answer a
%question about the greatest possible density we may add
%nonoverlapping balls until there is no room to add further balls.
%Such a packing will be said to be {\it saturated}.
%
% \index{saturated}
% \index{overlap}

Let $\Lambda$ be the set of centers of the balls in a
%\index{saturated} saturated 
packing. Our choice of radius for the
balls implies that any two points in $\Lambda$ have distance at
least $2$ from each other. We call the points of $\Lambda$ {\it
\index{vertex} vertices}.
%A bijection
%$\varph:\ring{N}\to\Lambda$ is called an {\it enumerated\/}
%packing.

%\begin{lemma} A saturated packing $\Lambda$ is countably infinite.  Hence,
%there exists a bijection $\varphi:\ring{N}\to\Lambda$.
%\end{lemma}

%\begin{proof}  If $\Lambda$ is finite, there is room to add a ball
%far from the finite cluster $\Lambda$, so $\Lambda$ is not
%saturated.

%The map $\Lambda\to\ring{Z}^3$, $$(x,y,z)\mapsto (\lfloor 2x
%\rfloor, \lfloor 2y \rfloor, \lfloor 2z \rfloor)$$ is a one-one
%map from $\Lambda$ into a countable set.  Hence $\Lambda$ is
%countable.
%\end{proof}


  Let $B(x,r)$ denote the open ball in
Euclidean three space at center $x$ and radius $r$.  The open ball
is measurable, with measure $4\pi r^3/3$.



Let $\delta(x,r,\Lambda)$ be the finite density, defined as the
ratio of the volume of $B(x,r,\Lambda)$ to the volume of $B(x,r)$,
where $B(x,r,\Lambda)$ is defined as the intersection with
$B(x,r)$ of the union of all balls in the packing. Set
$\Lambda(x,r) = \Lambda \cap
B(x,r)$.\index{ZZdelta@$\delta(x,r,\Lambda)$}

\begin{lemma}\label{lemma:Lambda-finite}
Let $\Lambda$ be a packing and let $p\in\ring{R}^3$.
Then the set $\Lambda(p,r)$ is finite.
\end{lemma}

\begin{proof}  Let $p = (p_x,p_y,p_z)$. The map
$$v=(v_x,v_y,v_z)\mapsto (\lfloor 2(v_x-p_x)
\rfloor, \lfloor 2(v_y-p_y) \rfloor, \lfloor 2(v_z-p_z) \rfloor)$$
is a one-one map from $\Lambda$ into the set $\ring{Z}^3\cap B(0,2
r
 + 1)$.  By Lemma~\ref{lemma:Zcount}, this gives a one-to-one map
 into a finite set, hence $\Lambda(p,r)$ is finite.
\end{proof}

\begin{definition}\label{def:voronoi}\index{Voronoi cell} Voronoi cell
$\Omega(v)=\Omega(v,\Lambda)$\index{ZZzomega@$\Omega(v)$} around a
vertex $v\in \Lambda$ is the set of points closer to $v$ than to
any other ball center.  Let $\Omega_t(v,\Lambda) = \Omega(v,\Lambda)
\cap B(v,t)$ be the truncated Voronoi cell at radius $t$.
\end{definition}

\begin{lemma} Let $\Lambda$ be a saturated packing and let $t>0$.
Each Voronoi cell $\Omega_t(v,\Lambda)$, for $v\in\Lambda$, is
convex, open, bounded, and measurable.
\end{lemma}

\begin{proof}  This is elementary.
\end{proof}

\begin{definition}\label{def:negligible}
Let $A:\Lambda\to\R$ be a function.  We say that $A$\index{Az@$A$}
is
  {\it negligible\/}\index{negligible}
if there is a constant $C_1$ such that for all $r\ge1$ and all
$x\in\ring{R}^3$,
   $$\sum_{v\in\Lambda(x,r)} A(v) \le C_1 r^2.$$
We say that the function $A:\Lambda\to\R$ is
  {\it fcc-compatible\/}\index{fcc-compatible}
if for all $v\in\Lambda$ we have the inequality
$$\sqrt{32}\le \op{vol}(\Omega_2(v)) + A(v).$$
\end{definition}





\begin{remark}
The value $\op{vol}(\Omega_2(v)) + A(v)$ may be interpreted as a
{\it corrected\/} volume\index{corrected volume} of the Voronoi
cell. Fcc-compatibility asserts that the corrected volume of the
Voronoi cell is always at least the volume of the Voronoi cells in
the face-centered cubic and hexagonal-close packings.
\end{remark}

\begin{remark} In \cite{DCG}, the full Voronoi cell $\Omega(v)$
is used, rather than $\Omega_2(v)$.  The truncation at radius $2$
is just a matter of convenience to guarantee the boundedness
and hence the finite volume of the (truncated) Voronoi cell.
In \cite{DCG}, the same effect was achieved by requiring all packings
to be saturated.  We have dropped the assumption of saturation
on $\Lambda$.
\end{remark}


\begin{lemma}
\label{lemma:deltabound} If there exists a \index{negligible}
negligible \index{fcc-compatible} fcc-compatible function
$A:\Lambda\to\R$ for a 
%saturated 
packing $\Lambda$, then there
exists a constant $C$ such that for all $r\ge1$ and all
$x\in\ring{R}^3$,
    $$
    \delta(x,r,\Lambda)
    \le \pi/\sqrt{18} + C/r.
    $$
The constant $C$ depends on $\Lambda$ only through the constant
$C_1$ of Definition~\ref{def:negligible}.
\end{lemma}



\begin{proof}
The numerator $\op{vol}\, B(x,r,\Lambda)$ of $\delta(x,r,\Lambda)$
is at most the product of the volume of a ball $4\pi/3$ with the
number $|\Lambda(x,r+1)|$ of balls intersecting $B(x,r)$.  Hence
    \begin{equation}
    \op{vol}\, B(x,r,\Lambda) \le |\Lambda(x,r+1)| 4\pi/3.
    \label{eqn:Abound}
    \end{equation}

%In a %saturated packing 
Each truncated Voronoi cell is contained in a ball of
radius $2$ centered at the {\it center} of the cell.  The volume
of the ball $B(x,r+3)$ is at least the combined volume of 
truncated Voronoi
cells whose center lies in the ball $B(x,r+1)$. This observation,
combined with fcc-compatibility and negligibility, gives
    \begin{equation}
    \begin{split}
    \sqrt{32}|\Lambda(x,r+1)|
    &\le \sum_{v\in\Lambda(x,r+1)} (A(v) +
    \op{vol}(\Omega_2(v))) \\
    &\le C_1 (r+1)^2 + \op{vol}\,B(x,r+3) \\
    &\le C_1 (r+1)^2 + (1+3/r)^3 \op{vol}\,B(x,r)
    \label{eqn:Bbound}
    \end{split}.
    \end{equation}
Recall that $\delta(x,r,\Lambda)=
\op{vol}\,B(x,r,\Lambda)/\op{vol}\,B(x,r)$. Divide Inequality
\ref{eqn:Abound} through by $\op{vol}\,B(x,r)$.  Use
Inequality~\ref{eqn:Bbound} to eliminate $|\Lambda(x,r+1)|$ from the
resulting inequality.  This gives
    $$\delta(x,r,\Lambda)
        \le \frac{\pi}{\sqrt{18}} (1+3/r)^3 + C_1 \frac{(r+1)^2}{r^3\sqrt{32}}.
    $$
The result follows for an appropriately chosen constant $C$.
\end{proof}

\begin{remark} \label{remark:precise}
We take the precise meaning of the Kepler conjecture to be the
bound $\delta(x,r,\Lambda) \le \pi/\sqrt{18} + C/r$ of the lemma.
Thus, the Kepler conjecture follows, provided a negligible
fcc-compatible function can be found. The strategy will be to
define a negligible function, and then to solve an optimization
problem in finitely many variables to establish that it is
fcc-compatible.
\end{remark}

If $\Lambda$ is a %saturated 
packing, we have an ordered pair
$(v,\Lambda)$ for each vertex $v\in\Lambda$.  The pairs
$(v,\Lambda)$ are called {\it centered packings}, and the
set of all centered packings is precisely $\op{CP}$.
\index{centered packing} 
%Section~\ref{sec:cell-ds} shows that the
%data in a centered packing are sufficient to determine a Voronoi
%cell\index{Voronoi cell} $\Omega(v,\Lmambda)$\index{ZZzomega@$\Omega(D)$}
%for each $D\in\op{CP}$. The same section shows that the Voronoi
%cell attached to $D$ is related to the Voronoi cell of $v$ in the
%packing by relation
%   $$\op{vol}\,\Omega(v,\Lambda) = \op{vol}\,\Omega(D(v,\Lambda)).$$
%
\Chap~\ref{sec:scoring} defines a function
$A_0:\op{CP}\to\ring{R}$ that assigns a ``weight'' to each
centered packing.

\begin{theorem}\label{lemma:negligible'}
For each centered packing $(v,\Lambda)\in\op{CP}$, the
function $A:\Lambda\to\ring{R}$ defined by
   $$A(v)= A_0(v,\Lambda)$$
is negligible for $\Lambda$.
\end{theorem}

This is proved as Theorem~\ref{lemma:negligible}.  The main object
of the proof is then to show that the function $A$ is
fcc-compatible. This is implied by the inequality
      \begin{equation}
      \sqrt{32}\le\op{vol}\,\Omega_2(v,\Lambda)+ A_0(v,\Lambda),
      \label{eqn:32}
      \end{equation}
for all $(v,\Lambda)\in\op{CP}$.

In the proof it is convenient to reframe this optimization problem
by composing it with a linear function.  The resulting continuous
function $\sigma:\op{CP}\to\ring{R}$ is called the
  {\it scoring function}, or {\it score}.
  \index{scoring function}\index{score}

\begin{definition}\label{def:dtet}  We define the following
constants.  The constant $\doct$ is defined by the second formula.
    $$\begin{array}{lll}
      \dtet &= \sqrt{8} \arctan(\sqrt{2}/5)\\
      \\
      \frac{\pi}{\sqrt{18}} &= \frac{\dtet}{3} + \frac{2
      \doct}{3}\\
      \\
      \doct & \approx 0.72.
      \end{array}
    $$
\end{definition}

\begin{remark}  The constants $\dtet$ and $\doct$ has the
following interpretation:  $\dtet$\index{ZZdeltatet@$\dtet$} is
the packing density of a regular tetrahedron. That is, let $S$ be
a regular tetrahedron of edge length $2$.  Let $B$ be the part of
$S$ that lies within distance $1$ of some vertex. Then $\dtet$ is
the ratio of the volume of $B$ to the volume of $S$.

Let $\doct$\index{ZZdeltaoct@$\doct$} is the packing density of a
regular octahedron of edge length $2$, again constructed as the
ratio of the volume of points within distance $1$ of a vertex to
the volume of the octahedron.
\end{remark}

\begin{remark}
The defining relation for $\doct$ asserts that the density of the
face-centered cubic packing is a weighted average of these two
ratios
    $$\frac{\pi}{\sqrt{18}} = \frac{\dtet}{3} + \frac{2 \doct}{3}.$$
\end{remark}

In terms of these quantities,
\begin{equation}
    \sigma(v,\Lambda) = -4 \doct (\op{vol}(\Omega_2(v,\Lambda)) + A_0(v,\Lambda)) +
    \frac{16\pi}{3}.
\end{equation}

\begin{definition}\label{def:pt}
We define\index{point}\index{pt} the constant
   $$\pt = 4\arctan(\sqr2/5) - \pi/3.$$
Its value is approximately $pt \approx 0.05537.$  Equivalent
expressions for $\pt$ are
    $$
    \pt = \sqrt2 \dtet - \frac{\pi}{3} = -2 (\sqrt2 \doct -
    \frac{\pi}{3}).
    $$
\end{definition}

In terms of the scoring function $\sigma$, the optimization
problem (Inequality~\ref{eqn:32}) takes the following form. The
proof of this inequality is a central concern in this paper.

\begin{theorem}\label{theorem:sigma}
The maximum of $\sigma$ on the set $\op{CP}$ of all centered
packings is the constant $8\,\pt\approx 0.442989$.
\end{theorem}



\subsection{Basic Concepts in the Proof}
\label{sec:outline}

To prove Theorems~\ref{theorem:kepler} and \ref{theorem:sigma}, we
wish to show that there is no counterexample.  In particular, we
wish to show that there is no centered packing $(v,\Lambda)$ with value
$\sigma(v,\Lambda)
> 8\,\pt$.  We reason by contradiction, assuming the existence of
such a centered packing.  With this in mind, we call $(v,\Lambda)$ a {\it
contravening centered packing},\index{contravening} if
    $$\sigma(v,\Lambda)\ge 8\,\pt - \epsilon_0, \quad \text{with }\epsilon_0 = 10^{-12}.$$
We have inserted a small epsilon to strengthen the main
conclusions.  In much of what follows we will tacitly assume that
every centered packing under discussion is a contravening one.
Thus, when we say that no centered packings exist with a given
property, it should be interpreted as saying that no such
contravening centered packings exist.\index{centered
packing!contravening}

To each contravening centered packing $(v,\Lambda)$, we associate a hypermap
$G(v,\Lambda)$.   Assume, for the moment, the existence of this hypermap.
A restrictive list of properties of hypermaps is described in
Section~\ref{sec:graphproperty}. Any hypermap satisfying these
properties is said to be {\it tame}. All \index{tame} tame
hypermaps have been classified. There are several thousand, up to
isomorphism.  The list appears in \cite{web}.  We refer to this
list as the {\it archival list}\index{archival list of hypermaps}
of hypermaps.

A few of the tame hypermaps are of particular interest. Every
centered packing attached to the face-centered cubic packing gives
the same hypermap (up to isomorphism).  Call it $G_{fcc}$.
Likewise, every centered packing attached to the hexagonal-close
packing gives the same planar hypermap $G_{hcp}$.


\subsection{Logical Skeleton of the Proof}
\label{sec:logic}

Consider the following six claims.  Eventually we will give a
proof of all six statements.  First, we draw out some of their
consequences.  The main results (Theorems~\ref{theorem:kepler} and
\ref{theorem:sigma}) follow from these claims.

\begin{claim}\label{claim-A}
If the maximum of the function $\sigma$ on $\op{CP}$ is $8\,\pt$,
then for every %saturated 
packing $\Lambda$ there exists a
negligible fcc-compatible function $A$.
\end{claim}

\begin{claim}\label{claim-B}
Let $(v,\Lambda)$ be a contravening centered packing. Then its hypermap
$G(v,\Lambda)$ is tame.
\end{claim} %\ref{theorem:contravene} in kepler.tex

\begin{claim}\label{claim-C}
If a hypermap is tame, then it is isomorphic to one of the several
thousand hypermaps that appear in the archival list of hypermaps.
\end{claim} %\ref{theorem:classification} in kepler.tex

\begin{claim}\label{claim-D}
If the hypermap of a contravening centered packing is isomorphic
to one in the archival list of hypermaps, then it is isomorphic to
one of the following two hypermaps:  $G_{hcp}$ or $G_{fcc}$.
\end{claim} %\label{lemma:fcc-hcp-pent} in linprog.tex

%% claim-E (Ferguson deleted.  We fold it in.)

\begin{claim}\label{claim-F}
Contravening centered packings $(v,\Lambda)$ exist such that
$\sigma(v,\Lambda)=8\pt$. If $(v,\Lambda)$ is a contravening centered packing, and
if the hypermap of $(v,\Lambda)$ is isomorphic to $G_{fcc}$ or $G_{hcp}$,
then $\sigma(v,\Lambda) \le 8\,\pt$.
\end{claim} %\label{lemma:local-optimality} in local_opt.tex

Next, we state some of the consequences of these claims.

\begin{lemma}\label{lemma:claim-fcc-graph}
Assume Claims~\ref{claim-B}, \ref{claim-C}, and \ref{claim-D}. If
$(v,\Lambda)$ is a contravening centered packing, then its hypermap $G(v,\Lambda)$
is isomorphic to $G_{hcp}$ or $G_{fcc}$.
\end{lemma}

\begin{proof} Assume that $(v,\Lambda)$ is a contravening centered packing.  Then its hypermap is tame, and consequently appears on the
archival list of hypermaps.  Thus, it must be isomorphic to one of
$G_{fcc}$ or $G_{hcp}$.
\end{proof}

\begin{lemma}\label{lemma:claim-sigma}
Assume Claims~\ref{claim-B}, \ref{claim-C}, \ref{claim-D}, and
\ref{claim-F}. Then Theorem~\ref{theorem:sigma} holds.
\end{lemma}

\begin{proof}
By Claim~\ref{claim-F} and Lemma~\ref{lemma:claim-fcc-graph}, the
value $8\,\pt$ lies in the range of the function $\sigma$ on
$\op{CP}$.   Assume for a contradiction that there exists a
centered packing $(v,\Lambda)\in \op{CP}$ that has $\sigma(v,\Lambda)>8\,\pt$. By
definition, this is a contravening centered packing. By
Lemma~\ref{lemma:claim-fcc-graph}, its hypermap is isomorphic to
$G_{hcp}$ or $G_{fcc}$.  By Claim~\ref{claim-F}, $\sigma(v,\Lambda)\le
8\,\pt$, in contradiction with $\sigma(v,\Lambda)>8\,\pt$.
\end{proof}


\begin{lemma}
Assume Claims~\ref{claim-A}--\ref{claim-F}. Then the Kepler
conjecture (Theorem~\ref{theorem:kepler}) holds.
\end{lemma}

\begin{proof} As pointed out in Remark~\ref{remark:precise}, the precise
meaning of the Kepler conjecture is for every %saturated 
packing
$\Lambda$, there exists a constant $C$ such that for all $r\ge 1$,
we have
    $$\delta(x,r,\Lambda)\le\pi/\sqrt{18} + C/r.$$

Let $\Lambda$ be the set of centers of a %saturated 
packing.  Let
$A:\Lambda \to \ring{R}$ be the negligible, fcc-compatible
function provided by Claim~\ref{claim-A} (and
Lemma~\ref{lemma:claim-sigma}). By Lemma~\ref{lemma:deltabound},
the function $A$ leads to a constant $C$ such that for all $r\ge
1$ and all $x\in \ring{R}^3$, the density $\delta(x,r,\Lambda)$
satisfies
   $$\delta(x,r,\Lambda) \le \pi/\sqrt{18} + C/r.$$
\end{proof}

\begin{remark}
One other theorem (Theorem~\ref{lemma:negligible'}) was stated
without proof in Section~\ref{sec:statement}.  This result was
placed there to motivate the other results.  However, it is not an
immediate consequence of Claims~\ref{claim-A}--\ref{claim-F}.  Its
proof appears in Theorem~\ref{lemma:negligible}.
\end{remark}

\subsection{Proofs of the Central Claims}

The previous section showed that the main results in the
introduction (Theorems~\ref{theorem:kepler}, \ref{theorem:sigma})
follow from six claims. This section indicates where each of these
claims is proved, and mentions a few facts about the proofs.

Claim~\ref{claim-A} is proved in Theorem~\ref{lemma:exista}.
Claim~\ref{claim-B} is proved in Theorem~\ref{theorem:contravene}.
Claim~\ref{claim-C}, the classification of tame hypermaps, is
proved in Theorem~\ref{theorem:classification}. By the
classification of such hypermaps, this reduces the proof of the
Kepler conjecture to the analysis of the centered packings
attached to the finite explicit list of tame hypermaps.  We will
return to Claim~\ref{claim-D} in a moment.

Claim~\ref{claim-F} is the local optimality of the face-centered
cubic and hexagonal close packings.   In
\Chap~\ref{sec:local-opt}, the necessary local analysis is carried
out to prove Claim~\ref{claim-F} as
Corollary~\ref{XX}.

Now we return to Claim~\ref{claim-D}. This claim is proved as
Theorem~\ref{XX}.  The idea of the proof is the
following.  Let $(v,\Lambda)$ be a contravening centered packing with
hypermap $G(v,\Lambda)$. We assume that the hypermap $G(v,\Lambda)$ is not
isomorphic to $G_{fcc}$, $G_{hcp}$, $G_{pent}$ and then prove that
$(v,\Lambda)$ is not contravening. This is a case-by-case argument, based on
the explicit archival list of hypermaps.

To eliminate these remaining cases, more-or-less generic arguments
can be used.  A linear program is attached to each tame hypermap
$G$. The linear program can be viewed as a linear relaxation of
the nonlinear optimization problem of maximizing $\sigma$ over all
centered packings with a given tame hypermap $G$. Because it is
obtained by relaxing the constraints on the nonlinear problem, the
maximum of the linear problem is an upper bound on the maximum of
the original nonlinear problem. Whenever the linear programming
maximum is less than $8\,\pt$, it can be concluded that there is
no contravening centered packing with the given tame hypermap $G$.
This linear programming approach eliminates most tame hypermaps.

When a single linear program fails to give the desired bound, it
is broken into a series of linear programming bounds, by branch
and bound techniques.  For every tame hypermap $G$ other than
$G_{hcp}$, $G_{fcc}$, and $G_{pent}$,\index{pentahedral prism} we
produce a series of linear programs that establish that there is
no contravening centered packing with hypermap $G$.

The \paper~is organized in the following way.
\Chaps~\ref{sec:construction} through \ref{sec:scoring} introduce
the basic definitions.  \Chap~\ref{sec:scoring} gives a proof of
Claim~\ref{claim-A}. \Chap~\ref{sec:local-opt} proves
Claim~\ref{claim-F}. \Chaps~\ref{sec:fine} through \ref{sec:fb}
present the fundamental estimates. \Chaps~\ref{XX}
through \ref{sec:proof-classification} give a proof of
Claim~\ref{claim-C}. \Chaps~\ref{sec:startame} through
\ref{sec:weight} give a proof of Claim~\ref{claim-B}.
\Chaps~\ref{XX} through \ref{XX} give
a proof of Claim~\ref{claim-D}.


\section{Partitioning Space}





It is useful to separate the parts of space of relatively high
packing density from the parts of space with relatively low
packing density.  The $Q$-system, which is developed in this
\chap, is a crude way of marking off the parts of space where the
density is potentially high.  The $Q$-system is a collection of
simplices whose vertices are points of the packing $\Lambda$. The
$Q$-system is reminiscent of the Delaunay decomposition, in the
sense of being a collection of simplices with vertices in
$\Lambda$.  In fact, the $Q$-system is the remnant of an earlier
approach to the Kepler conjecture that was based entirely on the
Delaunay decomposition.  However, the $Q$-system differs from the
Delaunay decomposition in crucial respects.  The most fundamental
difference is that the $Q$-system, while consisting of
nonoverlapping simplices, does not partition all of space.

This \chap\ defines the set of simplices in the $Q$-system and
proves that their interiors do not meet.  In order to prove this,
we develop a long series of lemmas that study the geometry of
intersections of various edges and simplices.  At the end of this
\chap, we give the proof that the interiors of simplices in the
$Q$-system do not meet.


\subsection{Description of the Q-system}
\label{sec:Q-describe}
\label{sec:construction}



Fix a packing of balls of radius $1$. We identify the packing with
the set $\Lambda$ of its centers.  A packing is thus a subset
$\Lambda$ of $\ring{R}^3$ such that for all $v,w\in\Lambda$,
$|v-w|<2$ implies $v=w$. The centers of the balls are called {\it
\index{vertex} vertices}. The term `vertex' will be reserved for
this technical usage.  

%A packing is said to be {\it
%\index{saturated} saturated\/} if for every $x\in\ring{R}^3$,
%there is some $v\in\Lambda$ such that $|x-v|<2$. Any packing is a
%subset of a saturated packing. We assume that $\Lambda$ is
%saturated. The set $\Lambda$ is countably infinite.

\begin{definition}  We define the {\it truncation parameter}
\index{truncation parameter ($t_0=1.255$)} to be the constant
$t_0=1.255$ ($2t_0 = 2.51$). It is used throughout this \paper as
a truncation parameter.
\end{definition}

\bigskip



Precise constructions that rely on the truncation parameter $t_0$
will appear below.  We will regularly intersect Voronoi cells with
balls of radius $t_0$ to obtain lower bounds on their volumes.  We
will regularly disregard vertices of the packing that lie at
distance greater than $2t_0$ from a fixed $v\in\Lambda$ to obtain
a finite subset of $\Lambda$ (a finite cluster of balls in the
packing) that is easier to analyze than the full packing
$\Lambda$.

The truncation parameter is the first of many decimal constants
that appear. Each decimal constant is an exact rational value,
e.g. $2t_0 = 251/100$.  They are not to be regarded as
approximations of some other value.

\begin{definition}
A {\it quasi-regular\/} triangle\index{quasi-regular triangle} is
a set $T\subset \Lambda$ of three vertices such that if $v,w\in T$
then $|w-v|\le2t_0$. \end{definition}

\begin{definition}
A \index{simplex} simplex\index{simplex} is a set of four
vertices.
%The
%edge-lengths of a simplex $S$ are the lengths $|w-v|$ for $w,v\in
%S$ and $w\ne v$.
A {\it quasi-regular\/} tetrahedron is a simplex $S$ such that if
$v,w\in S$ then $|w-v|\le 2t_0$. A {\it quarter\/} is a simplex
whose edge lengths $y_1,\ldots,y_6$ can be ordered to satisfy
$2t_0\le y_1\le\sqr8$, $2\le y_i\le 2t_0$, $i=2,\ldots,6$. If a
quarter satisfies the strict inequalities $2t_0< y_1< \sqrt8$,
then we say that it is a strict quarter. We call the longest edge
$\{v,w\}$ of a quarter its {\it \index{diagonal} diagonal\/}. When
the quarter is strict, we also say that its diagonal is strict.
When the quarter has a distinguished vertex, the quarter is {\it
upright\/} if the distinguished vertex is an endpoint of the
diagonal, and {\it flat\/} otherwise.
\end{definition}
\index{quarter!strict} \index{quarter!upright}
\index{quarter!flat} \index{quasi-regular}
\index{quasi-regular!triangle} \index{quasi-regular!tetrahedron}


%At times, we identify a simplex with its convex hull. We will say,
%for example, that the circumcenter of a simplex is contained in
%the simplex to mean that the circumcenter is contained in the
%convex hull of the four vertices.  Similar remarks apply to
%triangles, quasi-regular tetrahedra, quarters, and so forth.  We
%will write $\op{conv}(S)$ for the convex hull of $S$ when we wish to be
%explicit about the distinction between $\op{conv}(S)$ and its set of
%extreme points. 
%%%  [WW avoid doing this.]

When we wish to give an order on an edge, triangle, simplex, etc.
we present the object as an ordered tuple rather than a set. Thus,
we refer to both $(v_1,\ldots,v_4)$ and $\{v_1,\ldots,v_4\}$ as
simplices, depending on the needs of the given context.

%\begin{definition}\index{overlap} def:overlap
%Two manifolds with boundary {\it overlap\/} if their interiors
%intersect.
%\end{definition}


\begin{definition}  A $6$-tuple $(v,w,v_1,v_2,v_3,v_4)$ of vertices is
called a {\it quartered \index{octahedron} octahedron}, if the
following conditions hold:
    \begin{itemize}
    \item The vertices $v,w,v_1,\ldots,v_4$ are all distinct.
    \item $S_i = \{v,w,v_i,v_{i+1}\}$ (indices mod $4$) is a
    strict quarter with diagonal $\{v,w\}$, for $i=1,\ldots,4$.
    \item $\op{conv}^0(S_i)$ does not meet $\op{conv}^0(S_j)$, for $i\ne j$.
    \end{itemize}
(A quartered octahedron is literally a octahedron that has been
partitioned into four quarters.)
\end{definition}

\begin{remark}\label{def:oct-order}
It may be possible to order a set of six vertices in essentially
different ways to form a quartered octahedron.  That is, different
diagonals may be possible.    The choice of diagonal has no
particular importance.
%
Nevertheless, to make things canonical, we
pick the diagonal of length less than $\sqrt8$ with an endpoint of
smallest possible value with respect to the lexicographical
ordering on coordinates; that is, with respect to the ordering
$(y_1,y_2,y_3) < (y_1',y_2',y_3')$, if $y_i=y'_i$, for
$i=1,\ldots,k$, and $y_{k+1}<y'_{k+1}$.  
%This selection rule for
%diagonals is fully translation invariant in the sense that if one
%octahedron is a translate of another (whether or not they belong
%to the same packing), then the selected diagonal of one
%is a translate of the selected diagonal of the other.
%
We do not distinguish the quartered octahedron
$(v,w,v_1,v_2,v_3,v_4)$ from $(v',w',v_1',v_2',v_3',v_4')$, when
$\{v,w\} = \{v',w'\}$ and the $(v_1',v_2',v_3',v_4')$ is obtained
from $(v_1,v_2,v_3,v_4)$ by a dihedral permutation.
\end{remark}




\begin{definition}\label{def:adj-pair}\label{def:corner}
An {\it adjacent pair\index{adjacent pair}} is a tuple
$(v,\{v_1,v_3\},\{v_2,v_4\})$ where $Q=\{v,v_1,v_3,v_2\}$ is a
strict quarter with diagonal $\{v_1,v_3\}$ and
$Q'=\{v,v_1,v_3,v_4\}$ is a strict quarter also with diagonal
$\{v_1,v_3\}$ and such that the interiors of $Q$ and $Q'$ are
disjoint.  The common vertex $v$ that does not lie on the diagonal
is called the {\it base point\/} of the adjacent pair.   The other
four vertices $\{v_1,v_2,v_3,v_4\}$ are called the {\it corners\/}
of the configuration.
%
 \index{base point}
 \index{corner}
\end{definition}


\begin{definition}\label{def:conflicting-diag} An adjacent pair
$(v,\{v_1,v_3\},\{v_2,v_4\})$ has a {\it conflicting
diagonal\index{conflicting diagonal}} if
$(v,\{v_2,v_4\},\{v_1,v_3\})$ is also an adjacent pair.
Specifically, $\{v_2,v_4\}$ and $\{v_1,v_3\}$ are called
conflicting diagonals.
\end{definition}

\begin{definition}\label{def:interior-position}  We say
that an adjacent pair $(v,\{v_1,v_3\},\{v_2,v_4\})$ is in {\it
interior position}, if it has a conflicting diagonal and if the
segment $\op{conv}\{v_1,v_3\}$ meets
$\op{conv}^0\{v,v_2,v_4\}$. \index{interior position}
\end{definition}

\begin{definition}
A quarter is said to be {\it isolated}\index{isolated} if it is
not part of an adjacent pair.  Two isolated quarters that meet at
a point that is interior to both are said to form an {\it isolated
pair}.\index{pair!isolated}
%
\end{definition}


\begin{definition} \label{def:anchor}
If $\{v_1,v_2\}$ is an edge of length between $2t_0$ and $\sqr8$,
we say that a vertex $v$ $(\ne v_1,v_2)$ is an {\it \index{anchor}
anchor\/} of $\{v_1,v_2\}$ if its distances to $v_1$ and $v_2$ are
at most $2t_0$.
%
\end{definition}

The two vertices of a quarter that are not on the diagonal are
anchors of the diagonal, and the diagonal may have other anchors
as well.

\begin{definition}\label{def:q-system}  Let
$\Lambda$ be a packing. Let $\CalQ=\CalQ(\Lambda)$ be the set of
quasi-regular tetrahedra and strict quarters, enumerated as
follows. This set is called the $Q$-system.  (The $Q$ stands for
quarters and quasi-regular tetrahedra.)
%
  \index{Q-system@$Q$-system}


\begin{enumerate}
   \item All quasi-regular tetrahedra.
   \item Every strict quarter such that none of the quarters along
   its diagonal has an interior point that is interior to any other
   quasi-regular tetrahedron or strict quarter.
   \item Every strict quarter whose diagonal has four or more
   anchors, as long as there are not exactly four anchors arranged
   as a quartered
   octahedron.
   \item The fixed choice of four strict quarters in each
   quartered octahedron.
   \item Let $(v,\{v_1,v_3\},\{v_2,v_4\})$ be an adjacent pair in interior
   position.  Assume that the diagonal $\{v_2,v_4\}$ has exactly three anchors:
    $v,v_1,v_3$.  Assume that the diagonal $\{v_1,v_3\}$ has exactly three anchors:
    $v,v_2,v_4$.  The two quarters $\{v,v_1,v_2,v_3\}$ and $\{v,v_1,v_3,v_4\}$ are
    in the $Q$-system.
\end{enumerate}
No other quasi-regular tetrahedra or strict quarters are included
in the $Q$-system $\CalQ$.
\end{definition}


\begin{claim}\label{thm:nonoverlap}
Distinct simplices in the $Q$-system (of a %saturated 
packing) have
disjoint interiors.
\end{claim}

% XX where is the proof of this claim?

We state the following small lemma. It is an immediate consequence
of the definitions, but is nonetheless useful in the \chaps\ that
follow.

\begin{lemma} \label{lemma:diags-engulf}
If one quarter along a diagonal lies in the $Q$-system, then all
quarters along the diagonal lie in the $Q$-system.
\end{lemma}

\begin{proof} This is true by construction.  Each of the defining properties
of a quarter in the $Q$-system is true for one quarter along a
diagonal if and only if  it is true of all quarters along the
diagonal.
\end{proof}



\begin{lemma}\label{lemma:Q-divide}
Let $Q\in\CalQ$. Suppose that $x\in \op{conv}^0(Q)$.
If $x$
does not lie on the perpendicular bisector of any edge of $Q$,
then it lies in the $V$-cell of the closest vertex of $Q$.
\end{lemma}

\begin{proof} The segment to any other vertex $v$ crosses a face of the
simplex. Such faces are barriers so that $v$ is obstructed at $x$.
Thus, the vertices of $Q$ are the only vertices that are not
obstructed at $x$.
\end{proof}



\subsection{Cells}
\label{sec:cells} \label{sec:vcells}

In the proof of the Kepler conjecture we make use of two quite
different structures in space.  The first structure is the
$Q$-system, which was defined in the previous \chap.  It is
inspired by the Delaunay decomposition of space and consists of a
nonoverlapping collection of simplices that have their vertices at
the points of $\Lambda$.  Historically, the construction of the
nonoverlapping simplices of the $Q$-system grew out of a detailed
investigation of the Delaunay decomposition.

The second structure is inspired by the Voronoi decomposition of
space. In the Voronoi decomposition, the vertices of $\Lambda$ are
the centers of the cells.  It is well known that the Voronoi
decomposition and Delaunay decomposition are dual to one another.
Our modification of Voronoi cells will be called $V$-cells.

In general, it is not true that a Delaunay simplex is contained in
the union of the Voronoi cells at its four vertices.  This
incompatibility of structures adds a few complications to Rogers's
elegant proof of a sphere packing bound \cite{Rog58}. In this
\chap, we show that $V$-cells are compatible with the $Q$-system
in the sense that each simplex in the  $Q$-system is contained in
the union of the $V$-cells at its four vertices
(Lemma~\ref{lemma:Q-divide}). A second compatibility result
between these two structures is proved in
Lemma~\ref{lemma:V-cell-local}.

The purpose of this \chap\ is to define $V$-cells and to prove the
compatibility results just mentioned.  In the proof of the Kepler
conjecture it will be important to keep both structures (the
$Q$-system and the $V$-cells) continually at hand. We will
frequently jump back and forth between these dual descriptions of
space in the course of the proof.  In \Chap~\ref{sec:compact}, we
define a geometric object (called the centered packing) around a
vertex that encodes both structures.  The centered packing will
become our primary object of analysis.



\begin{definition}\label{def:barrier}
We construct a set of triangles $\CalB$ in the packing.  The
triangles in this set will be called {\it barriers}.\index{barrier}
A triangle $\{v_1,v_2,v_3\}$ with vertices in the packing belongs to
$\CalB$ if and only if  one or more of the following properties
hold.
\begin{enumerate}
    \item The triangle is a
    quasi-regular, or\index{quasi-regular!triangle}
    \item The triangle is a face of a simplex in the $Q$-system.
\end{enumerate}
\end{definition}

\begin{lemma}\label{lemma:barrier-no-overlap} %DCG p43.
 If $b,b'\in \CalB$, then
$\op{conv}^0(b)$ does not meet $\op{conv}^0(b')$, unless $b=b'$.
\end{lemma}

\begin{proof} If there is overlap, an edge $\op{conv}\{w_1,w_2\}$ 
of one triangle meets $\op{conv}^0\{v_1,v_2,v_3\}$.  Since
$|w_1-w_2|<\sqrt8$,  we have that the circumradius of
$\{v_1,v_2,v_3\}$ is at least $\sqrt2$ by
Lemma~\ref{lemma:no-pass-sqrt2} and that the length $|w_1-w_2|$ is
greater than $2t_0$ by Lemma~\ref{lemma:2t0-doesnt-pass-through}.
If the edge $\{w_1,w_2\}$ belongs to a simplex in the $Q$-system,
the simplex must be a strict quarter.  If $\{v_1,v_2,v_3\}$ has
edge lengths at most $2t_0$, then
Lemma~\ref{lemma:qrtet-pair-pass} implies that $|w_i-v_j|\le2.2$
for $i=1,2$ and $j=1,2,3$.   The simplices $\{v_1,v_2,v_3,w_1\}$
and $\{v_1,v_2,v_3,w_2\}$ form a pair of quasi-regular tetrahedra.
We conclude that $\{v_1,v_2,v_3\}$ is a face of a quarter in the
$Q$-system. Since, the simplices in the $Q$-system do not overlap,
the edge $\{w_1,w_2\}$ does not belong to a simplex in the
$Q$-system. The result follows.
\end{proof}



\begin{definition} \label{def:obstructed}
We say that a point $y$ is {\it obstructed\/} at $x\in\ring{R}^3$
if $\op{conv}^0\{x,y\}$ meets $\op{conv}(b)$ for some 
$b\in\CalB$. Otherwise, $y$ is unobstructed
at $x$.  The `obstruction' relation between $x$ and $y$ is clearly
symmetric.\index{obstructed}
\end{definition}

\begin{definition}\label{def:trash-phi}
Let $\infty$ be a symbol such that $\infty\not\in\Lambda$,
where $\Lambda$ is a 
%saturated 
packing. We define a map
$\phi:\R\to\Lambda\cup\{\infty\}$.   (Points of $\ring{R}^3$ that
map to $\infty$ should be viewed as ``trash'' that will not be
used anywhere in an essential way.)  If $x\in \R$, let
   $$\Lambda_x = 
   \{w\in\Lambda : |w-x|<2 \quad \text{$w$ is unobstructed at $x$}\}.$$
If there exists a unique $v\in\Lambda_x$ closest to $x$, then set
$\phi(x) = v$. Otherwise, set $\phi(x) = \infty$.
\end{definition}

\begin{definition}\label{def:vcell}
For $v\in\Lambda\cup\{\infty\}$, 
let $\op{VC}(v)=\phi^{-1}(v)\subset\ring{R}^3$.
We call it the {\it $V$-cell\/} at
$v$.\index{V-cell}\index{VZ@$VC(v)$ ($V$-cell)}
%
\end{definition}

We have decomposed $\ring{R}^3$ into a disjoint union:
    $$
    \ring{R}^3 = \op{VC}(\infty)\coprod_{v\in\Lambda}\op{VC}(v).
    $$

\begin{remark}\label{remark:pathology}
At the moment, we do not claim any particular properties for the
$V$-cells.  Later, we will identify some measurable subsets of the
$V$-cell that will become important for the proof.  The trash cell
$\op{VC}(\infty)$ includes points equidistant from two or more
non-obstructed vertices.  It includes points obstructed from all
vertices.  It includes all points that have distance at least $2$
from every vertex.
\end{remark}


\label{sec:indexing} \label{sec:compact}

\begin{definition}\label{def:U}
Let $U(v,\Lambda)$
 \index{UZ@$U(v,\Lambda)$}
be the set of vertices in $\Lambda$ at nonzero distance at most
$2t_0$ from $v$.  
\end{definition}


\begin{remark} In \cite{DCG}, we gave a compact topological
space of decomposition stars.  This involved truncating our current
definition of $\op{CP}$ so that it involved only finitely many
vertices around $0$.  The compact version of the set of centered
packings leads to a somewhat stronger uniqueness statement for the
optimality of the face-centered cubic and hexagonal-close
packings.  (See \cite{DCG}.)
\end{remark}




%\section{Centered Packings}





%%\begin{definition}  A centered packing is a
%saturated packing $\Lambda$ with $0\in\Lambda$. Let $\op{CP}$ be
%the set of centered packings.  If $\Lambda$ is any saturated
%packing, and if $v\in\Lambda$, then we define the centered packing
%$D=D(v,\Lambda)$ to be the translated lattice $\Lambda-v$.
%  \index{centered packing}
%  \index{DZS@$\op{CP}$}
%  \index{DZ@$D(v,\Lambda)$}
%\end{definition}
%

%\section{Cells attached to Centered Packings}\label{sec:cell-ds}
%
%To each centered packing, we can associate a $V$-cell centered at
%$0$ by a direct application of Definition~\ref{def:vcell}. Since
%the definitions of $V$-cell and Voronoi cells are compatible with
%translations of a packing, we have the following:
%
%\begin{lemma} There is a $V$-cell $\op{VC}(v,\Lambda)$ attached to each
%centered packing $D$ such that if $D=D(v,\phi)$, then
%   $\op{VC}(v,\Lambda)+v$ is the $V$-cell attached to $(v,\Lambda)$ in
%   Definition~\ref{def:vcell}.
%\end{lemma}
%
%\begin{lemma} \label{lemma:vor}
%The vertex $v$ and the centered packing $D(v,\Lambda)$ determine the
%Voronoi cell at $v$.  In fact,
%  $$\Omega_2(D(v,\Lambda)) = v + \Omega_2(v,\Lambda).$$
%In particular, they have the same volume.
%\end{lemma}



%From $v$ and a centered packing $D(v,\Lambda)$
%it is possible to recover $U(v,\Lambda)$, which we write as
%$U(v,\Lambda)$.

%\begin{remark} From a centered packing $D$, we can recover
%the set of vertices $U(v,\Lambda)$
 %
%  \index{UZ@$U(v,\Lambda)$}
%of distance at most $2t_0$ from the origin, the set of barriers at
%the origin, the simplices of the $Q$-system having a vertex at the
%origin, the $V$-cell $\op{VC}(v,\Lambda)$ at the origin, the Voronoi cell
%$\Omega_2(v,\Lambda)$ at the origin, and so forth, because these structures
%are all compatible with translation.
%\end{remark}



\section{Scoring}

\label{sec:scoring}

In earlier \chaps, we describe each packing of unit balls by its set
$\Lambda\subset \ring{R}^3$ of centers of the packing.  
%We showed
%that we may assume that our packings are saturated in the sense that
%there is no room for additional balls to be inserted into the
%packing without overlap. 
Lemma~\ref{lemma:deltabound} shows that the
Kepler conjecture follows if for each %saturated 
packing $\Lambda$ we
can find a function $A:\Lambda\to\ring{R}$ with two properties: the
function is fcc-compatible and it is 
%saturated 
in the sense of
Definition~\ref{def:negligible}.

The purpose of the first part of this \chap\ is to define a
function $A:\Lambda\to\ring{R}$ for every 
%saturated 
packing
$\Lambda$ and to show that it is negligible.  The formula defining
$A$ consists of a term that is a correction between the volume of
the Voronoi cell $\Omega_2(v)$ and that of the $V$-cell $\op{VC}(v)$
and a further term coming from simplices of the $Q$-system that
have a vertex at $v$.

A major theorem in this \paper\ will be that this negligible
function is fcc-compatible.  The proof of fcc-compatibility can be
expressed as a difficult nonlinear optimization problem over the
set $\op{CP}$ that was introduced in \Chap~\ref{sec:compact}.  In
fact, we construct a  function $A_0$ on the set $\op{CP}$ such
that for each %saturated 
packing $\Lambda$ and each $v\in\Lambda$,
the value of the function $A$ at $v$ is a value in the range of
the function $A_0$ on $\op{CP}$. In this way, we are able to
translate the fcc-compatibility of $A$ into an extremal property
of the function $A_0$ on the set $\op{CP}$.

The proof of fcc-compatibility is more conveniently couched as an
optimization problem over a function that is related to the
function $A_0$ by an affine rescaling.   This new function is
called the score and is denoted $\sigma$.  (The exact relationship
between $A_0$ and $\sigma$ appears in Definition~\ref{def:score}.)
This function is defined in the final paragraphs of this \chap.


\subsection{Definitions}
\label{sec:rules}


The
negligible function $A:\Lambda\to\ring{R}$ that we define is a
composite
  \begin{equation}
  A = A_0\circ (\cdot,\Lambda)
  :\Lambda\to \op{CP}\to \ring{R},\quad v\mapsto (v,\Lambda)\mapsto
  A_0(v,\Lambda),
  \label{eqn:A}
  \end{equation}
where $A_0:\op{CP}\to\ring{R}$ is as defined by
Equations~\ref{eqn:A1} and \ref{eqn:a1-sigma} below.  
If $v\in\Lambda$, let
$\CalQ(v,\Lambda)$ be the subset of $\CalQ$ consisting of
$Q$ with a vertex at $v$.

\begin{definition} \label{def:context}
Let $Q$ be a quarter in $\CalQ(\Lambda)$.  We say that the {\it
context\/} of $Q$ is $\x(p,q)$ if there are $p$ anchors and $p-q$
quarters along the diagonal of $Q$. Write $c(Q,D)$ for the context
of $Q\in\CalQ(\Lambda)$.
\end{definition}\index{context (of a quarter)}

\begin{remark}
The number $q$ counts the ``gaps'' between anchors around the
diagonal. That it, it is the number of consecutive anchors that
are not filled in by a quarter.  For example, the context of a
quarter in a quartered octahedron is $\x(4,0)$. The context of a
single quarter is $\x(2,1)$.
\end{remark}

The function $A_0$ will be defined to be a function on $\op{CP}$
of the form
  \begin{equation}
  A_0(v,\Lambda) = -\op{vol}\,(\Omega_2(v,\Lambda)) + \op{vol}\,(\op{VCM}(v,\Lambda)) +
   \sum_{Q\in\CalQ(v,\Lambda)} A_1(v,Q,c(Q,D)),
   \label{eqn:A1}
   \end{equation}
for some bounded measurable subset $\op{VCM}(v,\Lambda)$ of $\op{VC}(v,\Lambda)$.
Thus, the function $A_0$ measures the difference in volume between
the Voronoi cell and the given measurable subset of the $V$-cell,
as well as certain contributions $A_1$ from the $Q$-system. The
function $A_1(v,Q,c)$ depends on $Q$, its context $c$, and a
vertex $v$ of $Q$.  The function $A_1(v,Q,c)$ will not depend on
the second argument when $Q$ is a quasi-regular tetrahedron.  (The
context is not defined for such simplices.)

\begin{definition}\label{def:vcm-admiss}  We say that a function $\op{VCM}$ from
$\op{CP}$ to subsets of $\ring{R}^3$ is {\it admissible} if
\index{admissible} %there exists $d>0$ such that for every
$(v,\Lambda)\in\op{CP}$,
    \begin{itemize}
        \item $\op{VCM}(v,\Lambda)$ is measurable,
        %\item $\op{VCM}(v,\Lambda)\subset B(0,2)$, and
        \item $\op{VCM}(v,\Lambda)\cap \op{conv}(Q) = 
         \op{VC}(v,\Lambda)\cap \op{conv}(Q)$ for all
        $Q\in\CalQ(v,\Lambda)$.
    \end{itemize}
\end{definition}

\begin{lemma} If $\op{VCM}_1,\ldots,\op{VCM}_r$ are admissible,
then so is $$(v,\Lambda)\mapsto \op{VCM}_1(v,\Lambda)\cup\cdots\cup \op{VCM}_r(v,\Lambda).$$
\end{lemma}

\begin{proof} This is an easy induction on $r$.
\end{proof}

\begin{definition}  We introduce the following notation.  Let
    $$
    \begin{array}{lll}
        \op{VC}(v,S) &= \op{VC}(v)\cap \op{conv}(S),\quad \text{for } v\in
        S\in\CalQ,\\
        \op{VC}_t(v,S) &= \op{VC}(v,S)\cap B(v,t),\quad\text{for } t\ge
        0.
    \end{array}
    $$
\index{V-cell!$V$-cell}
\index{VC}
\end{definition}

By Definition~\ref{def:vcm-admiss}, the existence of an admissible
$\op{VCM}$, implies that the sets $\op{VC}(v,S)$ and
$\op{VC}_t(v,S)$ are measurable.  



A function
    $$
    \op{volan}(v,S)
    $$ that is closely related to $\op{vol}(\op{VC}(v,S))$ is presented in
\Chap~\ref{XX}.  The notation $\op{volan}$
comes from the term ``analytic volume.''  In fact, it is an
analytic continuation of the volume formula that hold initially
when $S$ contains its circumcenter.  However, the analytic
properties of this function do not concern us here.  The following
claim will be proved elsewhere.

\begin{claim}\label{claim:volan} Let $S=\{v_1,v_2,v_3,v_4\}$ be in
the $\CalQ$-system. Then
    $$
    \sum_{i=1}^4 \op{volan}(v_i,S) = \sum_{i=1}^4
    \op{vol}(\op{VC}(v_i,S)) = \op{vol}(\op{conv}(S)).
    $$
\end{claim}



\begin{definition}\label{def:svor}
Recall that solid angle of a radial set $X$ at a vertex $v$ is defined in
Section~\ref{sec:solid}.  It is denoted $\sol(v,X)$.
Another function $\op{sovo}(v,X,\lambda)$ combines the solid
angle and volume, for a parameter $\lambda=(\lambda_v,\lambda_s)$.
A particularly important choice of parameter $\lambda$ is
$$
 \lambda_{oct}=(\lambda_v,\lambda_s)=(-4\doct,1/3).
% \lambda_{sq}& =(\lambda_v,\lambda_s)=(4\doct,\zeta\,\pt-1/3).\\
$$
\index{sovo}\index{ZZlambda@$\lambda$}
\index{ZZlambdaoct@$\lambda_{oct}$}
%\index{ZZlambdasq@$\lambda_{sq}$}
%
%Let\footnote{In the paper \cite{spp}, the volumes in this
%definition were volumes of Voronoi cells, and hence the notation
%notation, although this direct connection with Voronoi cells has
%been lost.}
      $$
      \begin{array}{lll}
      \op{svan}(v,S) &= \lambda_{oct,v} \op{volan}(v,S)
         +\lambda_{oct,s}\sol(v,\op{conv}^0(S)),\\
      \op{sv}(v,S,t) &= \lambda_v \op{vol}\,\op{VC}_{t}(v,S)
         +\lambda_s\sol(v,\op{conv}^0(S))\\
          &= \op{sovo}(v,\op{VC}_t(v,S),\lambda_{oct})\\
            \op{sv}_0(v,S) &= \op{sovo}(v,S,t_0).
      \end{array}$$
When it is clear from the context that the vertex $v$ is
fixed, we drop $v$ from the notation of these
functions.
   If $S=\{v_1,v_2,v_3,v_4\}$, we define $\Gamma(S)$ as the average
   \begin{equation}
   \Gamma(S) = \frac{1}{4}\sum_{i=1}^4\op{sv}(v_i,S).
   \label{eqn:gamma}
   \end{equation}
%
 \index{ZZcamma@$\Gamma$}
\end{definition}

\begin{lemma}\label{lemma:gammavol}
Let $S=\{v_1,v_2,v_3,v_4\}$ be a simplex in the $\CalQ$-system.
    $$\Gamma(S) = \frac{1}{4}(\lambda_{oct,v}\op{vol}(\op{conv}(S)) +\sum_{i=1}^4
    \lambda_{oct,s}\sol(v_i,S)).
    $$
\end{lemma}

\begin{proof} This follows directly from Claim~\ref{claim:volan}
and the definitions of $\op{sovo}$ and $\Gamma$.
\end{proof}

\begin{definition}
Let $Q$ be a quarter.   Let $\eta^+(Q)$ be the maximum of the
circumradii of the two faces of $Q$ along the diagonal of $Q$.
\end{definition}

Let $Q$ be a simplex in the $Q$-system.  We define an involution
$v\to \hat v$ on the vertices of $Q$ as follows.  If $Q$ is a
quarter and $v$ is an endpoint of the diagonal, then let $\hat v$
be the opposite endpoint of the diagonal.  In all other cases, set
$\hat v = v$.

We are ready to complete the definition of the function
$A:\Lambda\to\ring{R}$ (assuming a given choice of an admissible
function $\op{VCM}$). The definition of $A$ was reduced to that of
$A_0$ in Equation~\ref{eqn:A}.  The function $A_0$ was reduced in
turn to that of $A_1$ in Equation~\ref{eqn:A1}. To complete the
definition, we define $A_1$.

\begin{definition}\label{def:sigma}
Set
   \begin{equation}\label{eqn:a1-sigma}
   A_1(v,S,c) = -\op{vol}\,\op{VC}(v,S)+
      \frac{\sol(v,S)}{3\doct} - \frac{\sigma(v,S,c)}{4\doct}.
      \end{equation}  where $\sigma$ is given as follows:
      %
      \index{AZ1@$A_1$}
      \index{ZZsigma@$\sigma$}
\begin{enumerate}
\item When $S$ is a quasi-regular tetrahedron:
   \begin{enumerate}
      \item If the circumradius of $S$ is less than $1.41$, set
         $$\sigma(v,S,-)=\Gamma(S).$$
      \item If the circumradius of $S$ is at least $1.41$, set
         $$\sigma(v,S,-)=\op{svan}(v,S).$$
   \end{enumerate}
\item When $S$ is a strict quarter:
   \begin{enumerate}
      \item If $\eta^+(S) <\sqrt2$:
         \begin{enumerate}
         \item If the context $c$ is $(2,1)$ or $(4,0)$, set
                  $$\sigma(v,S,c)=\Gamma(S)$$
         \item If the context of $S$ is anything else, set
                  $$\sigma(v,S,c)=\Gamma(S) +
                     \frac{\op{sv}_0(v,S)
                      -\op{sv}_0(\hat v,S)}{2}.$$
         \end{enumerate}
      \item If $\eta^+(S) \ge\sqrt2$:
         \begin{enumerate}
         \item If the context of $S$ is $(2,1)$, set
                  $$\sigma(v,S,c)=\op{svan}(v,S).$$
         \item If the context of $S$ is $(4,0)$, set
                  $$\sigma(v,S,c)=\frac{\op{svan}(v,S)
            +\op{svan}(\hat v,S)}{2}.$$
         \item If the context of $S$ is anything else, set
                  $$\sigma(v,S,c)=\frac{\op{svan}(v,S)
           +\op{svan}(\hat v,S)
                  }{2}
                     +\frac{\op{sv}_0(v,S)-
                     \op{sv}_0(\hat v,S)}{2}.$$
         \end{enumerate}
   \end{enumerate}
\end{enumerate}
When the context and vertex $v$ are given, we often write
$\sigma(S)$ or $\sigma(v,S)$ for $\sigma(v,S,c)$.

When $\eta^+<\sqrt2$, we say that the quarter is compressed.
Otherwise, we say it is decompressed.  To say that a quarter is
compressed means that $\Gamma(S)$ is one term of the function
$\sigma(v,S)$. It does not mean that $\Gamma(S)$ is equal to
$\sigma(v,S)$.
%
 \index{compressed}
 \index{decompressed}
\end{definition}

The definition of $\sigma$ on quarters can be expressed a second
way in terms of a function $\mu$.  If $S$ is a quarter, set
    \begin{equation}
    \mu(v,S)=\begin{cases}
    \Gamma(S),&  \text{ if }\eta^+(S)<\sqr2,\\
    \op{svan}(v,S),& \hbox{otherwise.}\end{cases}
    \label{eqn:3.8}
    \end{equation}
If $S$ is a flat quarter, we have $\sigma(v,S,c)=\mu(v,S)$, for
all contexts $c$.

\begin{definition} If $S$ is an upright quarter, set
$$\nu(v,S)=(\mu(v,S)+\mu(\hat v,S) + 
  \op{sv}_0(v,S)-\op{sv}_0(\hat v,S))/2.$$
\index{zznu@$\nu$}
\end{definition}


Suppose $S$ is an upright quarter.\index{quarter!upright}
Definition~\ref{def:sigma} can be expressed as follows.


\begin{itemize}
 \item context $\x(2,1)$:  Set $\sigma(v,S,c)=\mu(v,S)$.
 \item context
    $\x(4,0)$:  Set $\sigma(v,S,c)=(\mu(v,S)+\mu(\hat v,S))/2$.
 \item other contexts:
 Set $\sigma(v,S,c)=\nu(v,S)$.
\end{itemize}





We conclude this section with a result that will be of use in the
next section.

\begin{lemma}\label{lemma:A1-cancel}
Let $S=\{v_1,v_2,v_3,v_4\}$ be a simplex in the $S$-system,  and $c$
its context.   Then
   $$\sum_{i=1}^4 A_1(v_i,S,c)=0.$$
\end{lemma}

\begin{proof}
   By Formula~\ref{eqn:a1-sigma} and the definition of $\op{svan}$,
this is equivalent to
      \begin{equation}
      \sum_{i=1}^4 \sigma(v_i,S,c) = \sum_{i=1}^4
      \op{svan}(v_i,S). 
      \label{eqn:sigma-4}
      \end{equation}
Equation~\ref{eqn:sigma-4} is evident from
Definition~\ref{def:sigma} for $\sigma$.  In fact, the terms of the
form $\op{sv}_0$ have opposing signs and cancel when we sum. The other
terms are weighted averages of the terms $\op{svan}(v_i,S,c)$.
Equation~\ref{eqn:sigma-4} is thus established because a sum is
unaffected by taking weighted averages of its terms.
\end{proof}


\subsection{Negligibility} \label{sec:negligible}

Let $B(x,r)$ be the closed ball of radius $r\in\ring{R}$ centered
at $x$.  Let $\Lambda(x,r)=\Lambda\cap B(x,r)$.

Recall from Definition~\ref{def:negligible} that a function
$A:\Lambda\to\ring{R}$ is said to be {\it negligible} if there is a
constant $C_1$ such that for all $r\ge1$,
   $$\sum_{v\in\Lambda(x,r) } A(v) \le C_1 r^2.$$
%
 \index{negligible}


Recall the function $A: \Lambda\to\ring{R}$ given by
Equation~\ref{eqn:A}.  Explicitly, let
   $$A(v) = A_0(v,\Lambda),$$
where $A_0$ in turn depends on functions $A_1$ and $\sigma$, as
determined by Equations~\ref{eqn:A1} and \ref{eqn:a1-sigma}, and
Definition~\ref{def:sigma}.

\begin{claim}\label{claim:negbounds}
    The absolute values of the functions $\sol$, $\op{volan}$, and $\op{vol}$
are bounded on the set of all quarters and
    quasi-regular tetrahedra.
\end{claim}

%% XX Give a proof somewhere. Give a reference.

\begin{lemma}\label{lemma:A1bound}  $A_1(v,Q,c)$ is bounded by a constant that is
independent of the choice of packing $\Lambda$, simplex
$Q$, context $c$, and vertex $v\in\Lambda$.
\end{lemma}

\begin{proof} By the definition of $A_1$:
    $$
    A_1(v,Q,c) \le \sol(v,Q)/3 + |\sigma(v,Q,c)|/(4\doct).
    $$
By Claim~\ref{claim:negbounds}, it is enough to bound $|\sigma|$.
For all contexts and choices of simplex, we have
    $$|\sigma(v,Q,c)|\le \sum_{i=1}^4 |\op{svan}(v_i,S)| +
        |\op{sv}_0(v,S)| 
      + |\op{sv}_0(\hat v,S)|.
    $$
It is thus enough to bound $|\op{svan}|$ and $|\op{sv}_0|$.  Referring
to their definitions, it is enough to bound $|\sol(v,S)|$,
$|\op{volan}(v,S)|$, and $\op{vol}(\op{VC}(v,S))$. The first two
are bounded by Claim~\ref{claim:negbounds}.  The set
    $$\op{VC}(v,S) = \op{VCM}(v,\Lambda)\cap \op{conv}(S)$$
is the intersection of two measurable sets.  Hence it is a
measurable subset of $\op{conv}(S)$.  The volume of $\op{VC}(v,S)$ is
dominated by that of $\op{conv}(S)$, which is given by
Claim~\ref{claim:negbounds}.  The result follows.
\end{proof}

\begin{lemma} \label{lemma:quarterfiber}
The number of quarters at a vertex is bounded by a constant that
is independent of the packing and the vertex $v$.
\end{lemma}

\begin{proof}  If $Q=\{v,v_1,v_2,v_3\}$, then $Q\subset
\Lambda(v,2\sqrt2)$.  The set $\Lambda(v,2\sqrt2)$ is finite by
Lemma~\ref{lemma:Lambda-finite} and is bounded by a constant $n$
that is independent of $v$ and $\Lambda$.  So $Q$ is an element of
the powerset of $\Lambda(v,2\sqrt2)$, which has cardinality at
most $2^n$.
\end{proof}

\begin{lemma}\label{lemma:qr2} There exists a constant $C$ (independent of the
packing and $p\in\ring{R}^3$) such that the number of
quarters in the $Q$-system that have at least one vertex in
$B(p,r)$ and at least one vertex out is at most $C r^2$, for all
$r\ge 1$.
\end{lemma}

\begin{proof}  For each such quarter, pick a vertex $v_Q=v=(v_x,v_y,v_z)\in
\Lambda(p,r)$.  By Lemma~\ref{lemma:quarterfiber}, The map
    $$
    Q\mapsto (\lfloor 2(v_x-p_x)\rfloor, \lfloor
    2(v_y-p_y)\rfloor,\lfloor 2(v_z-p_z)\rfloor)
    $$
is a finite to one map to $\ring{Z}^3 \cap ( B(0,2r+1) \setminus
B(0,2r-k))$ (for some $k\ge 0$) whose fibers have bounded
cardinality independent of the data.  The result now follows from
Lemma~\ref{lemma:Zr2}.
\end{proof}

\begin{lemma}\label{lemma:negA1} There exists a constant $C$ that is independent of
the packing and the point $x\in\ring{R}^3$ such that for
all $r\ge 1$ we have
$$\sum_{v\in\Lambda(x,r)} \sum_{Q\in\CalQ(v,\Lambda)}
      A_1 (v,Q,c) \le C r^2$$
\end{lemma}

\begin{proof}
Each quarter $Q=\{v_1,v_2,v_3,v_4\}$ in the $Q$-system occurs in
four sets $\CalQ(v_i,\Lambda)$.  By
Lemma~\ref{lemma:A1-cancel} the sum cancels, except when some
vertex of $Q$ lies inside $\Lambda(x,r)$ and another lies outside.
The number of such quarters is at most quadratic in $r$ by
Lemma~\ref{lemma:qr2}.  The contribution of each such quarter at
each vertex is at most the constant of Lemma~\ref{lemma:A1bound}.
The result follows.
\end{proof}

\begin{theorem}\label{lemma:negligible}
The function $A$ of Equation~\ref{eqn:A} is negligible.
\end{theorem}

\begin{proof}   
Referring to the definition in Equation~\ref{eqn:A1}, we find that
the terms coming from $A_1$ are negligible by
Lemma~\ref{lemma:negA1}.  Thus, it is enough to prove the
negligibility of the function $A'$ defined by
      $$
      A'(v,\Lambda) = -\op{vol}(\Omega_2(v,\Lambda))+
         \op{vol}(\op{VCM}(v,\Lambda)).$$
%The Voronoi cells partition $\ring{R}^3$, as do the $V$-cells. 
We
have $\Omega_2(v,\Lambda)\subset B(v,2)$ and by
construction, 
$\op{VC}(v,\Lambda)\subset B(v,2)$. 

Let 
  $$
  B_2(x,r,\Lambda) = \{y \in B(x,r)\mid \exists v\in \Lambda.\ 
         |v-y| < 2\}.
  $$
Hence the Voronoi cells with
$v\in \Lambda(x,r)$ cover $B_2(x,r-2,\Lambda)$ (except for a null set
consisting of the union of planes equidistant from two vertices in
$\Lambda(x,r+2)$). Moreover, the $V$-cells $\op{VCM}(v,\Lambda)$
with $v\in \Lambda(x,r)$ are contained in $B_2(x,r+d,\Lambda)$.  Hence by
the volume formula for a ball, we have
   $$
   \begin{array}{lll}
   \sum_{v\in\Lambda(x,r)} A'(v) &\le 
     -\op{vol}\,B_2(x,r-2,\Lambda)
      +\op{vol}\,B_2(x,r+d,\Lambda)\\&\le 
       -\op{vol}\,B(x,r-2)
      +\op{vol}\,B(x,r+d)\\& \le 
      C r^2
      \end{array}
   $$
for some constant $C$. This completes the proof.
\end{proof}


\subsection{Fcc-compatibility}

We have constructed a negligible function $A$.  The rest of this
\paper\ will prove that this function is fcc-compatible.   This
section translates fcc-compatibility into a property that will be
easier to prove.  To begin with, we introduce a rescaled version
of the function $A$.

\begin{definition}\label{def:score}
Let $\sigma:\op{CP}\to\ring{R}$ be given by
   $$\sigma(v,\Lambda) = -4\doct (\op{vol}\,\Omega_2(v,\Lambda) + A_0(v,\Lambda)) +
   16\pi/3.$$
It is called the {\it score} of the centered packing.
%
 \index{score}
 \index{ZZsigma@$\sigma(v,\Lambda)$}
\end{definition}

Recall from Definition~\ref{def:pt} the constant $\pt\approx
0.05537$.  This constant is called a point.\index{point}

\begin{lemma}\label{lemma:8pt-compat}
Let $A_0$, $A$, and $\sigma$ be the functions defined by
Equations~\ref{eqn:A}, \ref{eqn:A1}  \ref{eqn:a1-sigma}, and
Definition~\ref{def:sigma}. The following are equivalent.
\begin{enumerate}
  \item The minimum of the function on $\op{CP}$ given by
      $$(v,\Lambda)\mapsto \op{vol}\,\Omega_2(v,\Lambda) + A_0(v,\Lambda)$$
is $\sqrt{32}$.
  \item The maximum of $\sigma$ on $\op{CP}$ is $8\,\pt$.
\end{enumerate}
Moreover, these statements imply
\begin{itemize}
  \item For every packing $\Lambda$,
  the function $A$ is
  fcc-compatible.
\end{itemize}
\end{lemma}

(Eventually, we prove fcc-compatibility by proving
$\sigma(v,\Lambda)\le8\,\pt$ for all $(v,\Lambda)\in\op{CP}$.)

\begin{proof} To see the equivalence of the first and second statements,
use Definition~\ref{def:score},  and the identity
   $$8\,\pt = -4\doct (\sqrt{32}) + 16 \pi/3.$$
(Note that this identity is parallel in form to
Definition~\ref{def:score} for $\sigma$.)

For a given packing $\Lambda$, the function $A$ has the
form $A(v) = A_0(v,\Lambda)$.    Thus,
$\op{vol}\,\Omega_2(v,\Lambda)+A(v)$ lies in the range of the function
   $$\op{vol}\,\Omega_2(v,\Lambda) + A_0(v,\Lambda)$$
on $\op{CP}$.  The minimum of this function is $\sqrt{32}$ by the
first of the equivalent statements.  It now follows from the
definition of fcc-compatibility, that $A:\Lambda\to\ring{R}$ is
indeed fcc-compatible.
\end{proof}

\begin{theorem}\label{lemma:exista}
If the maximum of the function $\sigma$ on
$\op{CP}$ is $8\,\pt$, then for every packing $\Lambda$
there exists a negligible fcc-compatible function $A$.
\end{theorem}

\begin{proof} This follows immediately from Theorem~\ref{lemma:negligible}
and Lemma~\ref{lemma:8pt-compat}.
\end{proof}

