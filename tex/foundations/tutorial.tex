% Author Thomas C. Hales
% Copyright Thomas C. Hales
% Format latex.
% 

%!TEX TS-program = latex    
%% This line is for TexShop. 

% Revision history. See svn.
% Jan 24, 2009

\documentclass[cup9a]{cupbook}
%% Cambridge University Press Macros from
%% https://authornet.cambridge.org/information/productionguide/laTex_files/

%

\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{latexsym}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{makeidx}
\usepackage{multicol}
\usepackage{crop}
\usepackage{txfonts}
%\usepackage{pdfsync}  %for TexShop sync.
\usepackage[letterpaper,colorlinks=true,
            ps2pdf,hyperindex=true]{hyperref}
%\usepackage{mparhack} %http://www.tex.ac.uk/cgi-bin/texfaq2html?label=marginparside
\usepackage{multind}
\usepackage{color}

\input{macros}
%\makeindex{guid}

 \crop
%\makeindex



% CUP BOOK CLASS SPECIFIC


\newtheorem{assert}{}[chapter]
\newtheorem{assumption}{Assumption}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{claim}{Claim}[chapter]
\newtheorem{definition}{Definition}[chapter]
\newtheorem{example}{Example}[chapter]
\newtheorem{exer}{Exercise}[chapter]
\newtheorem{interpretation}{Interpretation}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{notation}{Notation}[chapter]
\newtheorem{remark}{Remark}[chapter]
\newtheorem{theorem}{Theorem}[chapter]





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\raggedbottom  % for now.
%\raggedright  % don't worry for now.

    \title{The Foundations of Mathematics :
      %\\ \phantom{Hello}
      \\  An Introductory Course in Higher Order Logic}
    \author{Thomas C. Hales}
    \maketitle
    \frontmatter
    \tableofcontents
    \thanks

\mainmatter

\input{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%  \label{part:intro}
   \newpage

   \setcounter{chapter}{-1}
   \chapter{Preface}
   \label{XX}  % for missing references. XX.

   \chapter{Overview} 

   What are the foundations of mathematics?  First of all, we need a {\it language} in which mathematics can be expressed precisely.  Then, we need {\it rules of logic} that allow us to reason about mathematics.  Finally, we need {\it axioms}, which are statements that are accepted without proof.  Axioms give us a starting point for our logical reasoning.

  The foundational system can be expanded upon, by adding additional definitions, theorems, and proofs.

\section{Why do we need foundations?}

\subsection{consistency}

Frege devoted his life to the development of a logically coherent mathematical system.  His system was shattered in 1900 when B. Russell discovered an inconsistency in Frege's system.  

Here is Russell's paradox.  In Frege's system, it may be possible for a set to be an element of itself.  When this holds we write $Y\in Y$.  When it is not an element of itself, write $Y\not\in Y$.   We define $X$ to be the set of all sets $Y$ such that $Y\not\in Y$.  That is,
    $$X = \{Y\mid Y\not\in Y\}.$$
We ask, whether $X$ is an element of itself.    If $X\in X$, then $X$ satisfies the membership condition $Y\not\in Y$ to belong to $X$;  that is, $X\not\in X$.
If on the other hand $X\not\in X$, then $X$ does not satisfy the membership condition $Y\not\in Y$ to belong to $X$; that is, $X\in X$.  So $X$ is a member of itself, if and only if it is not a member of itself.  This is a contradiction in Frege's system.

\subsection{settle disputes}

Sometimes arguments arise about whether a proof is correct or not.  The problem is usually that the proof has been written in a way that is far from the foundations of mathematics.  By reworking the proof to make its connection with the foundations more transparent, the dispute can generally be resolved.

\subsection{unification of mathematics}

Different branches of mathematics can be seen from a unified perspective from the foundations of mathematics.  Calculus, analysis, differential equations, algebra, group theory, topology, geometry, applied mathematics, etc. can be all be treated as part of a coherent whole, unified by the foundations.

\subsection{formal proofs}

It has become possible in recent years for computers to check every step of mathematical proofs.  A computer-checked proof is called a {\it formal proof}.  The computer systems that check proofs in this way must be based on the foundations of mathematics.

\section{various systems}

There are many foundational systems of mathematics that have been developed.

\subsection{Zermelo set theory}

Russell's paradox prompted mathematicians to develop a consistent system of axioms for doing mathematics.  Most foundational systems are based on set theory.  A system of axioms for doing set theory 
was developed by the mathematician Zermelo in 1908.   This is Zermelo set theory.  This book does not go into details about Zermelo set theory, but we will have occasion to use it.  An appendix covers basic properties of Zermelo set theory.

Later Zermelo set theory was supplemented in various ways.  The mathematician Fraenkel added one more axiom to the system (called the axiom of replacement).  One further axiom (the axiom of choice) was added.  Zermelo set theory, supplemented by these two further axioms, is called Zermelo-Fraenkel-Choice set theory; or simply ZFC set theory.

\subsection{Bourbaki}

In the 1940s a group of French mathematicians banded together under the pseudonym, General Nicholas Bourbaki.  They developed a system of set theory, and gave a careful description of major branches of mathematics within a coherent framework.  Bourbaki has come to represent an approach to mathematics which is abstract, general, and systematic.

\subsection{Higher Order Logic}

This book develops a system of higher-order logic for a foundational system.  The origins of this system can be traced to the work of Alonzo Church.  We will not say more about it now, because the entire book will be devoted to developing this system.

\subsection{others}


In fact, there have been many different foundational systems that have been proposed over the past decades.  There is nothing to stop anyone from proposing a new system of axioms for doing mathematics.


\section{How to choose?}

\subsection{analogy}

What foundational system should we use?

We face a similar question when we purchase a computer.  What computer should we buy?  Different computer run different operating systems, such as UNIX, Linux, Windows, or Mac OS X.  Some become fanatical about what brand is best or what operating system is best.  Others go with whatever other people seem to be using.

No matter what computer or operating system we decide upon, we expect it to have certain basic capabilities.  It should have a web browser.  It should be capable of reading the hard drive, and downloading files.  It should be possible to edit documents and to print files.  It should be possible to set up user accounts.

We can make analogous statements about a foundational system.  There are
many products to choose from (Zermelo, Bourbaki, Higher-Order Logic, etc).  Some people may become fanatically devoted to a particular system and others may go with whatever others seem to be using.  No matter what system we choose to use, it should have certain basic capabilities.  It should be possible to do basic logic.  It should be possible to develop the properties of standard number systems such as the natural numbers, rational numbers, and real numbers.  It should be possible to do calculus, analysis, algebra, topology, and geometry within the system.  Applied mathematics should be possible.  it should be possible to do calculations in an efficient way.

\subsection{Why HOL}

To be honest, I am fanatically devoted to the foundational system in this book.  I hope to convince some of my readers why I find this particular system so appealing.  However, the most popular system among mathematicians in ZFC.  This is largely a result of historical developments, rather than any compelling reason.  The ZFC system has the first-to-market advantage.  Zermelo developed his system first and has retained a large marked share through the decades.



\section{immersion}

Again, we start with an analogy.  Learning a foundational system is like learning a foreign language.  In a foreign language course, you can either learn by immersion or through your native language.  

In an immersion course, you jump into the water and sink or swim, without using your native langauge.  Suppose you are learning Japanese.  In an immersion course, neither the teacher nor you speak a word of English inside the classroom.  You learn the meanings of Japanese words by gestures, pantomimes, and grunts.  An infant learns a language by immersion.  

By contrast, when a language is taught by means of the speakers native language, two languages are spoken in the classroom.  If a native English speaker learns Japanese, both English and Japanese are spoken in the classroom.  English is spoken to instruct how to speak Japanese.   The langauge being acquired is called the target language.  The language used to give instruction is called the meta language.  In this example, English is the instructional langage or meta language, and Japanese is the target language.  (We could also teach English to Japanese students in which English is the target language and Japanese is the meta language.)  Once the student has reached a certain stage in the study of Japanese, it is natural to exclude English from the classroom, and to do everything in Japanese.

We face a similar situation when we learn a new foundational system in mathematics.  The immersion approach is not successful.  It is not really possible to teach advanced mathematics by gestures, pantomimes, and grunts.  We will use a two language system.  We will assume that the reader of this book already has an informal knowledge of mathematics.  We will use that informal system to describe the new langauge.  We will have a meta mathematics (which is the instructional mathematical language), and a target mathematics (which is the new mathematical system we are learning).  
Just as it is important not to confound English with Japanese, it is important not to confound the meta mathematical system with the target system.

This book uses Zermelo set theory as the metamathematical system.  I made this choice, because I assume that it is the most familiar to the readers of this book.  We only need to use simple properties of Zermelo set theory that are summarized in an appendix.  The target mathematical system is Higher Order Logic (HOL).  

In mathematics, there is a greater danger of confounding the metamathematical system with the target mathematical system, because some of the symbols will be the same in both systems.  For example, the natural number $0$ will exist as both a set in Zermelo set theory and as a term in Higher Order Logic.   Or convention will be to distinguish terms Higher Order Logic with backquotes and special fonts.  For example, {\tt \hc{`0`}} denotes the term in Higher-Order Logic and \mc{$0$} is the corresponding thing in Zermelo set theory.

We use the terms metalanguage, metalogic, and metamathematics to refer to the familiar informal language, logic, and math that is being used to construct the system of Higher Order Logic.  We use the terms HOL language, HOL logic, and HOL mathematics to refer to the new foundational system of Higher Order Logic. 


\chapter{Basic Notation}

\section{natural numbers}

The book assumes an elementary knowledge of the theory of sets.  The set of greatest interest to us is the set of natural numbers:
$$
\mc{\ring{N}=\{0,1,2,3,4,5,\ldots\}}.
$$
Zero $\mc{0}$ is a natural number.

\section{notation}

\subsection{prefix}

Generally, a function is written before the input to the argument:
\mc{$f(x)$} indicates the value of a function \mc{$f$} that has been evaluated
at an element \mc{$x$} of its domain.  This is called {\it prefix} notation
because the function \mc{$f$} appears before the element \mc{$x$}.  

\subsection{postfix}

When the function is written after the input, as in \mc{$x f$} for the value of the function on the input \mc{$x$}, it is called postfix notation.  For example, the factorial function \mc{$n\mapsto n! = n (n-1)\cdots 1$} is a function denoted with the symbol \mc{$!$} in postfix notation.   We will generally avoid this notation.

\subsection{infix}

Finally, if the function is a function of two variables \mc{$x$} and \mc{$y$}, and the function symbol is written between the two variables, it is called {\it infix} notation.  This appears as \mc{$x\,f\, y$}.    The infix notation often appears with functions that have symbolic names, such as addition of natural numbers.  The function is written in infix position:
  \mc{$$x + y.$$}

Here are some examples of infix operators.
\mc{$$
3+4,\ 7\times 8,\ 10/2,\ 4 - 3,\ 2 < 7,\ 8\ge 6,\ X\subset Y, \hbox{ and } \ x\in A.
$$}

There are times when we wish to convert infix notation into prefix.  To do so, we place parentheses around the infix function.   For example
\mc{$$
x + y
$$
}
is a notational variant of
\mc{
$$
(+)~x~y.
$$
}
Following this convention, we have the following notation variants:
\mc{
$$
\begin{array}{lll}
\hbox{prefix} & \hbox{infix}\\
(+)~3~4 & 3 + 4\\
(/)~10~2 & 10/2\\
(\ge)~8~6 & 8 \ge 6\\
(\times)~7~8 & 7\times 8\\
\end{array}
$$
}

To say that we have a notational variant means that the two expressions denote precisely the same thing.  


\subsection{right associative}

If \mc{$*$} is an infix operator, then \mc{$a * b * c$} is ambiguous.  It can mean
either \mc{$(a* b)*c$} or \mc{$a*(b*c)$}.  One way to resolve the ambiguity is to insert the parentheses.  Another way to resolve the ambiguity is to declare the infix operator to  be right-associative or left-associative.  If an operator is
declared to be right associative then the parentheses are inserted from the right:
\mc{
$$
a*b*c*d = a*(b*(c*d)),\quad \hbox{right associative}
$$
}
An infix operator declared to be left-associative requires the parentheses to be inserted from the left:
\mc{
$$
a*b*c*d = ((a*b)*c)*d.\quad \hbox{left associative}
$$
}





The distinction between prefix, infix, and postfix can be made at both the mathematical level and at the metamathematical level.  The same holds of right-associative and left-associative.

\chapter{Basic Zermelo Set Theory}

This appendix gives a review of basic set theory.  We only present enough set theory to make sense of the metamathematical constructions in this book.

\section{set notation}

The set with no elements is called the {\it empty set} and is denoted \mc{$\emptyset$} or \mc{$\{\}$}.
A set \mc{$\{a\}$} that contains exactly one element \mc{$a$} is called a {\it singleton set}. 

\subsection{extensionality}

We write \mc{$x\in A$} to mean that \mc{$x$} is {\it an element of} \mc{$A$}.  A set can be imagined as a sort of container of elements.  The {\it axiom of extensionality} for sets asserts that two sets are equal if and only if they contain the same elements:
  \mc{
   $$(A = B)\hbox{ if and only if } \forall x.\ (x\in A) \Leftrightarrow (x\in B).$$}
For example,
   \mc{$$\{1,2,3,4,4,3,2,2,2,2,1\} = \{4,3,2,1\}$$}
because \mc{$x$} is an element of either set precisely when \mc{$x=1,2,3$}, or \mc{$4$}.
Since they contain the same elements, they are equal.  The order of listing and the repetitions do not matter.

Two sets are distinct if the nesting of braces is different.
For example,
\mc{$$
\{\},\quad \{\{\}\},\quad \{\{\{\}\}\},\quad \{\{\},\{\{\}\}\}
$$}
are all different sets from one another.  The first is the empty set.
The second is a set with one element.  That element is the empty set.
The third is a set with one element.  That element is the second set in the list.  The final set contains two distinct elements: the empty set and the singleton set with the empty set as its only element.  Think of sets like these as highly organized sets of empty containers.

\subsection{comprehension}

If \mc{$A$} is a set, we write
\mc{$$
\{x \in A \mid P(x)\}
$$}
for the set of all elements in A that satisfy the property \mc{$P$}.
For example,
\mc{$$
\{x\in\ring{N} \mid x > 3\} = \{4,5,6,7,\ldots\}.
$$}



We write \mc{$A\subset B$} to mean that every element of \mc{$A$} is an element of \mc{$B$}.
We write \mc{$A\cap B$} for the set of all elements that belong to both \mc{$A$} and \mc{$B$}:
\mc{
$$
A\cap B = \{x \mid x\in A\hbox{ and } x \in B\}.
$$
}
The set \mc{$A\cap B$} is called the {\it intersection} of \mc{$A$} and \mc{$B$}.
We write \mc{$A\cup B$} for the set of all elements that belong to either \mc{$A$} or \mc{$B$}:
\mc{$$
A\cup B = \{x\mid x\in A\hbox{ or } x\in B\}.
$$}
The set \mc{$A\cup B$} is called the {\it union} of \mc{$A$} and \mc{$B$}.
For example, if \mc{$A=\{1,2,3\}$} and \mc{$B = \{3,4\}$}, then
\mc{$$
A\cap B = \{3\},\quad A\cup B = \{1,2,3,4\}.
$$}

\subsection{powerset}

Given any set \mc{$X$}, there is a set \mc{$P(X)$}, called the {\it powerset} of \mc{$X$} whose elements are  all the subsets of \mc{$X$}:
\mc{$$
P(X) = \{x\mid (x\in P(X))\Leftrightarrow (x\subset X)\}.
$$}
For example, if \mc{$X = \{1,2,3\}$}, then \mc{$P(X)$} is the following set with
\mc{$2^3 = 8$} elements:
\mc{$$P(X) = \{\emptyset, \quad \{1\},\{2\},\{3\},\quad
          \{1,2\},\{2,3\},\{1,3\},\quad \{1,2,3\} \}.$$}


Zermelo's axioms of set theory insure that \mc{$A\cup B$}, \mc{$A\cap B$}, \mc{$P(X)$} always exist.

\subsection{ordered pairs}

Given any \mc{$x$} and \mc{$y$}, there is a set \mc{$(x,y)$} called the ordered pair
of \mc{$x$} and \mc{$y$}.  It has the property that \mc{$(x,y)=(a,b)$} if and only if
\mc{$$
x = a \quad \hbox{ and } y = b.
$$}
Given any sets \mc{$X$} and \mc{$Y$}, there is a set \mc{$X \times Y$} called the Cartesian product of \mc{$X$} and \mc{$Y$}, consisting of all ordered pairs whose first element belongs to \mc{$X$} and second element belongs to \mc{$Y$}:
\mc{$$
X\times Y  = \{(x,y) \mid x\in X\hbox{ and } y \in Y\}.
$$}
For example, if \mc{$X = \{0,1\}$} and \mc{$Y=\{2,3\}$}, then
\mc{$$
X\times Y = \{\{0,2\},\{0,3\},\{1,2\},\{1,3\}\}.
$$}
There are functions \mc{$\op{fst}:X\times Y\to X$} and \mc{$\op{snd}:X\times Y\to Y$} that return the first and second part of an ordered pair:
\mc{$$
\op{fst}(x,y) = x\qquad \op{snd}(x,y) = y.
$$}

An ordered triple \mc{$(x,y,z)$} is alternate notation for \mc{$(x,(y,z))$}.  (That is, the comma is right-associative.)  An ordered quadruple \mc{$(w,x,y,z)$} is an alternate notation for \mc{$(w,(x,(y,z)))$}.  









\section{natural numbers}

We let \mc{$\ring{N}=\{0,1,2,3,\ldots\}$} be the set of natural numbers. 

\subsection{base}

Traditionally, natural numbers are denoted in base ten representation.  Ten digits are used to denote a natural number
$$
0\quad 1\quad 2\quad 3\quad 4\quad 5\quad 6\quad 7\quad 8\quad 9
$$
The position of each digit in a numeral determines its value:
$$
1728 = 1\times 10^3 + 7\times 10^2 + 2\times 10^1 + 8\times 10^0.
$$
To emphasize the base of the representation, the base can be appended as a subscript:
$$1728_{10}=1\times 10^3 + 7\times 10^2 + 2\times 10^1 + 8\times 10^0.$$

Through the widespread use of binary computers, bases that are powers of two have become increasingly prevalent.  The base two representation uses two digits
$$
0\quad 1
$$
Thus,
$$
1000101_2 = 1\times 2^6 + 0\times 2^5 + 0\times 2^4 + 0\times 2^3 + 1\times 2^2 + 0\times 2^1 +1 \times 2^0 = 69_{10}.
$$
The base sixteen representation uses sixteen digits in the following order:
$$
0\quad 1\quad 2\quad 3\quad 4\quad 5\quad 6\quad 7\quad 8\quad 9\quad
A\quad B\quad C\quad D\quad E\quad F
$$
Thus,
$$
\verb!E7C!_{16} = 14\times 16^2 + 7 \times 16^1 + 12\times 16^0.
$$
The base $256$ representation of a natural number uses 256 digits, called {\it characters}.  
The $256$ digits are listed in a fixed order in a table called the ASCII character table.  The table includes the ten digits $0$ through $9$, the twenty-six lower case Roman alphabet $a$ through $z$, the twenty-six upper case Roman alphabet $A$ through $Z$, and common keyboard strokes such as:
$$
\verb#, ; . : ( ) { } [ ] < > - _ + / * @ % & ? ! #
$$
Each lower case Roman character is different from the corresponding upper-case character.
Thus,
$$
\verb!Rain!_{256} = XX.
$$
and
$$
\verb!rain!_{256} = XX.
$$
An alternate notation for base $256$ numerals is enclosure in double quotation marks.  Thus,
$$
\verb!Rain!_{256} = \verb!"Rain"! = XX_{10}
$$
In this notation, the enclosing quotation marks are not part of the numeral.  The double quotation mark is itself an ASCII character.  When a double quotation mark occurs as part of the numeral, we revert to the appended subscript notation:
$$
\verb!#^%3"4!_{256} = XX_{10}. 
$$
Some of the ASCII characters cannot be printed; there are characters for backspace, tab, carriage return, bell, and so forth.  Numerals with unprintable characters will be avoided in these notes.



\subsection{serial pairs}

\begin{lemma}
There is a one-to-one function $\langle\cdot,\cdot\rangle:\ring{N}\times\ring{N}\to\ring{N}$ given by
$$
\langle x,y\rangle = (x+y)^2 + y + 1.
$$
\end{lemma}
We call \verb!<x,y>! a serial pair. A serialized triple is defined as a nested serial pair: \verb!<x,y,z> = <x,<y,z>>!.

\begin{exer} Show that if $\langle x,y\rangle = \langle x',y'\rangle$, then $x=x'$ and $y=y'$.
\end{exer}



\subsection{recursion}

A fundamental property of the natural numbers is that functions can be
defined by recursion.


\begin{assert}[The principle of recursion]  For any sets $X$, $Y$, for any function $a:X\to Y$, and any function $b:\ring{N}\times X\times Y\to Y$, there exists a unique function $f:\ring{N}\times X\to Y$ such that
$$
\begin{array}{lll}
f(0,x) &= a(x)\\
f(n+1,x) &= b(n,x,f(n,x)),\hbox{ for all } n, x.
\end{array}
$$
\end{assert}

We do not give the proof here, because recursion will be covered in much greater detail later.  In the special case when $X$ is a singleton set $\{x\}$, the function $a:X\to Y$ is determined by the image $a'$ of $x$.  The function $b$ is determined by a function $b':\ring{N}\times Y\to Y$:
$$
b(n,x,y) = b'(n,y).
$$
This gives the following special form of recursion:

\begin{assert}[The principle of recursion: special form]  For any set $Y$, for any element $a\in Y$, and any function $b:\ring{N}\times Y\to Y$, there exists a unique function $f:\ring{N}\to Y$ such that
$$
\begin{array}{lll}
f(0,x) &= a\\
f(n+1,x) &= b(n,f(n)),\hbox{ for all } n.
\end{array}
$$
\end{assert}



\subsection{lists}

We define recursion (special form), for each $n\in\ring{N}$ a subset of the natural numbers called the set of serial lists of length $n$.
  Let \verb!null=0! and
\verb!cons=1!.

\begin{definition}
The set of serial lists of length $0$ is the singleton set \verb!{null}!.  By recursion, the set of serial lists of length $n+1$ is the set
consisting of all serial triples \verb!<cons,k,p>!, where \verb!p! is a serial list of length $n$.   A serial list is a an element of the set of serial lists of length $n$ for some $n$.  We let \verb!SL! denote the set of all serial lists.
\end{definition}

\begin{exer} Explicitly identify the element $a$ and function $b$ that are used in the recursive definition of serial lists.
\end{exer}

\begin{exer}\label{exer:list-length} show that the set of serial lists of length $n$ is disjoint from the set of serial lists of length $n'$ for $n\ne n'$.
\end{exer}

\begin{definition} Let $p$ be a serial list of length $n$.  We call $n$ the length of $p$.  By Exercise~\ref{exer:list-length}, the length is well defined.
\end{definition}


\begin{example}
\verb!<cons,3,<cons,4,<cons,5,null>>>!
is a serial list.
\end{example}

We define a function $f:\ring{N}\times SL\times P(\ring{N})\to SL\times P(\ring{N})$ by recursion (full form).  $f(n,p,y)$ picks off the first $n$ elements of the serial list $p$ and adds them to the set $y$.

Set $f(0,p,y) = (p,y)$ and
$$
f(n+1,p,y) = \begin{cases} f(n,p,y) & \hbox{if } p = null\\
                f(n,p',y\cup\{a\}) & \hbox{if } p = \verb!<cons,a,p'>!\\
\end{cases}
$$
Write \verb!setify! for the function that takes a serial list $p$
of length $n$ and returns the second coordinate of $f(n,p,\emptyset)$.

\begin{example}
\begin{verbatim}
setify<cons,3,<cons,4,null>> = snd(f(2,<cons,3,<cons,4,null>>,{})) 
  = snd(f(1,<cons,4,null,{3}>)) = snd(f(0,null,{3,4})) 
  = snd((null,{3,4}) = {3,4}
\end{verbatim}
\end{example}

We say that $x$ is a member of the serial list $p$ if $x\in\verb!setify(p)!$.


\begin{notation} The serial list \verb!null! is called the null list, and is written \verb![]!.  Others lists will be denoted by a sequence of natural numbers enclosed in square brackets and separated by parentheses, listed in the same order as the \verb!cons!es:
$$
\begin{array}{lll}
\hbox{shorthand notation} & \hbox{full form}\\
~[]&\verb!null!\\
~[3;4]&\verb!<cons,3,<cons,4,null>>!\\
~[2;1;1]&\verb!<cons,2,<cons,1,<cons,1,null>>>!\\
\end{array}
$$
\end{notation}








\section{curried functions}

We write \mc{$Y^X$} for the set of all functions from \mc{$X$} to \mc{$Y$}.  In other
words, \mc{$Y^X$} is the set of all functions with domain \mc{$X$} and range \mc{$Y$}.
In Zermelo set theory, there is a bijection of sets between
\mc{\begin{equation}
  Z^{X\times Y}\hbox { and } (Z^Y)^X.\label{eqn:curry}
\end{equation}}
That is, there is a bijection between functions with domain is the Cartesian product \mc{$X\times Y$} and range \mc{$Z$} on the one hand, and functions whose domain is \mc{$X$} and range is the set of functions from \mc{$Y$} to \mc{$Z$} on the other hand.
(Notice the formal similarity with the law of exponents for natural numbers:
\mc{$z^{x y} = (z^y)^x$}.)

It may seem odd at first that the range of a function is a set of functions, but this will happen quite routinely in this book.

The bijection is given explicity as follows.  If \mc{$b:X\to Z^Y$} is a function
on the right-hand side of (\ref{eqn:curry}), then let \mc{$f_b:X\times Y\to Z$}
be the function given by 
\mc{$$
f_b(x,y) = b(x) (y).
$$}
In the other direction, if \mc{$a:X\times Y\to Z$} is a function on the left-hand side of (\ref{eqn:curry}), then let \mc{$h_a:X\to Z^Y$} be given by
\mc{$$
h_a(x) = (y\mapsto a(x,y)).
$$}
Note that \mc{$h_a(x)$} is a function from \mc{$Y$} to \mc{$Z$}.
It can be  checked that \mc{$a\mapsto h_a$} and \mc{$b\mapsto f_b$} are inverse functions of one another and give the bijection asserted in (\ref{eqn:curry}).
That is,
\mc{$$
f_{h_a} = a,\hbox{ and } h_{f_b} = b.
$$}

This bijection will be extremely important for the developments in this book.  The right-hand side of the bijection (\ref{eqn:curry}) is called the curried form of the function.  The left-hand side of the bijection (\ref{eqn:curry}) is called the uncurried form of the function.  (The name comes from the logician Haskell Curry.)   In the vast majority of all situations, we prefer to use the curried form of the function.  We prefer curried functions in both the metamathematical system and the HOL mathematical system.

As an example, let us analyze addition of natural numbers.  The addition operator in uncurried form takes an ordered pair \mc{$(x,y)$} and
returns the sum \mc{$x+y$}.   Now consider addition as a curried function and analyze the expression \mc{$3+4$}.  For example, we can write this in curried prefix notation as
\mc{$$
(+)~3~4.
$$}
Curried addition is a function in \mc{$(\ring{N}^{\ring{N}})^{\ring{N}}$}.  The domain
is the set of natural numbers and the range is a function from \mc{$\ring{N}$} to \mc{$\ring{N}$}.
That is \mc{$(+)~3$} is a function from \mc{$\ring{N}$} to \mc{$\ring{N}$}.  This function is the function that adds \mc{$3$}; that is, \mc{$(+)~3 = (y\mapsto y+3)$}.  We apply the
the function that adds \mc{$3$} to \mc{$4$} and the result is \mc{$7$}.

Explained somewhat differently, the uncurried function takes everything at once and the curried function takes its inputs one at a time.  We can take \mc{$(3,4)$} together and return the sum \mc{$7$} in uncurried form.  In curried form, we can take \mc{$3$}, then take a pause or even a long siesta before taking the \mc{$4$}, finally returning the \mc{$7$}.  In curried form, we can even stop entirely before evaluating the function \mc{$(+)~3$} on the second summand, and leave it in this form as the function that adds \mc{$3$}.

\subsection{unwrapping the exponents}

We have introduced the notation \mc{$(Z^Y)^X$} for the set of functions with domain \mc{$X$} and range \mc{$Z^Y$}.    If \mc{$b$} is such a function, we can write it
\mc{$b:X\to Z^Y$} to indicate its domain \mc{$X$} and range \mc{$Z^Y$}.  When we take
\mc{$b(x)$} we get a function \mc{$Y\to Z$}.  If we unwrap the exponents, we
take an element of \mc{$X$} then an element of \mc{$Y$} to get an element of \mc{$Z$}.
Thus, it is natural to write
\mc{$$
b:X\to Y\to Z\quad \hbox{ or }\quad  b:X\to (Y\to Z)
$$}
to indicate the domain and range of \mc{$b$}.  The expression on the left
says we take \mc{$x\in X$} then \mc{$y\in Y$} and return \mc{$z\in Z$}.  On the
right, we take \mc{$x\in X$} then return a function \mc{$Y\to Z$}.

Because of this example, we adopt the convention that the arrow \mc{$\to$}
is to be right associative:
\mc{$$
X\to Y \to Z = X\to (Y\to Z).
$$}
The uncurried form of a function \mc{$b:X\to Y\to Z$} is \mc{$f_b:(X\times Y)\to Z$}.
If we want to use a function \mc{$c$} whose domain is \mc{$Y^X$} and range is \mc{$Z$},
the parentheses must be inserted explicitly: \mc{$c:(X\to Y)\to Z$}.

\subsection{parentheses}

The convention is to drop the parentheses on curried functions when this can be done without ambiguity.  For example, curried prefix addition is written
\mc{$$
(+)~x~y
$$}
rather than any of the following forms:
\mc{$$
(+)(x)(y)\quad ((+)(x))(y)  \quad (((+)(x))(y)).
$$}
These forms are correct, but contain unnecessarily many parentheses.
In this example, the parentheses are needed around the \mc{$(+)$} to make it
a prefix operator rather than an infix operator. All other parentheses may
be dropped.

\subsection{partial functions}

Sometimes we wish to consider functions whose domain is a proper subset of a set \mc{$X$} to \mc{$Y$}.  With curried functions, it is often easier to extend the range than to restrict the domain to a proper subset.

If \mc{$Y$} is any set, let \mc{$Y^+ = Y \cup \{Y\}$}.  For example,
\mc{$\{0,1,2\}^+ = \{0,1,2,\{0,1,2\}\}$}.  We write this more suggestively
as \mc{$Y^+ = Y \cup \{\op{Error}_Y\}$}, where \mc{$\op{Error}_Y$} is just an
another name for \mc{$Y$}.  When the set \mc{$Y$} has been fixed, we even drop
\mc{$Y$} from the notation and write \mc{$Y^+ = Y \cup\{\op{Error}\}$}.
(We define \mc{$Y^+$} as we do, because we want to add something to the set \mc{$Y$}
that we can be certain that it does not belong to \mc{$Y$} already.  We can
be certain that \mc{$Y\not\in Y$}, because Zermelo set theory was designed this
way, in order to avoid Russell's paradox.  A set in Zermelo set theory
never belongs to itself.)

If we have a function \mc{$f:X'\to Y$} defined on a proper subset \mc{$X'$} of \mc{$X$}, we can
extend it to a function \mc{$f^+$} on all of \mc{$X$} by the rule:
\mc{$$
f^+(x) = \begin{cases} f(x) & x\in X'\\ \op{Error}_Y & x\not\in X'\end{cases}.
$$}

Rather than explicitly describe the domain of the function \mc{$f:X'\to Y$}, we may simply
define a function \mc{$f^+:X \to Y^+$} that allows \mc{$\op{Error}_Y$} as a possible value in the range.  The set \mc{$X'$} can be recovered as
\mc{$X'=\{x\in X\mid f(x)\in Y\}$}.







\section{curried functions}

We write \mc{$Y^X$} for the set of all functions from \mc{$X$} to \mc{$Y$}.  In other
words, \mc{$Y^X$} is the set of all functions with domain \mc{$X$} and range \mc{$Y$}.
In Zermelo set theory, there is a bijection of sets between
\mc{\begin{equation}
  Z^{X\times Y}\hbox { and } (Z^Y)^X.\label{eqn:curry}
\end{equation}}
That is, there is a bijection between functions with domain is the Cartesian product \mc{$X\times Y$} and range \mc{$Z$} on the one hand, and functions whose domain is \mc{$X$} and range is the set of functions from \mc{$Y$} to \mc{$Z$} on the other hand.
(Notice the formal similarity with the law of exponents for natural numbers:
\mc{$z^{x y} = (z^y)^x$}.)

It may seem odd at first that the range of a function is a set of functions, but this will happen quite routinely in this book.

The bijection is given explicity as follows.  If \mc{$b:X\to Z^Y$} is a function
on the right-hand side of (\ref{eqn:curry}), then let \mc{$f_b:X\times Y\to Z$}
be the function given by 
\mc{$$
f_b(x,y) = b(x) (y).
$$}
In the other direction, if \mc{$a:X\times Y\to Z$} is a function on the left-hand side of (\ref{eqn:curry}), then let \mc{$h_a:X\to Z^Y$} be given by
\mc{$$
h_a(x) = (y\mapsto a(x,y)).
$$}
Note that \mc{$h_a(x)$} is a function from \mc{$Y$} to \mc{$Z$}.
It can be  checked that \mc{$a\mapsto h_a$} and \mc{$b\mapsto f_b$} are inverse functions of one another and give the bijection asserted in (\ref{eqn:curry}).
That is,
\mc{$$
f_{h_a} = a,\hbox{ and } h_{f_b} = b.
$$}

This bijection will be extremely important for the developments in this book.  The right-hand side of the bijection (\ref{eqn:curry}) is called the curried form of the function.  The left-hand side of the bijection (\ref{eqn:curry}) is called the uncurried form of the function.  (The name comes from the logician Haskell Curry.)   In the vast majority of all situations, we prefer to use the curried form of the function.  We prefer curried functions in both the metamathematical system and the HOL mathematical system.

As an example, let us analyze addition of natural numbers.  The addition operator in uncurried form takes an ordered pair \mc{$(x,y)$} and
returns the sum \mc{$x+y$}.   Now consider addition as a curried function and analyze the expression \mc{$3+4$}.  For example, we can write this in curried prefix notation as
\mc{$$
(+)~3~4.
$$}
Curried addition is a function in \mc{$(\ring{N}^{\ring{N}})^{\ring{N}}$}.  The domain
is the set of natural numbers and the range is a function from \mc{$\ring{N}$} to \mc{$\ring{N}$}.
That is \mc{$(+)~3$} is a function from \mc{$\ring{N}$} to \mc{$\ring{N}$}.  This function is the function that adds \mc{$3$}; that is, \mc{$(+)~3 = (y\mapsto y+3)$}.  We apply the
the function that adds \mc{$3$} to \mc{$4$} and the result is \mc{$7$}.

Explained somewhat differently, the uncurried function takes everything at once and the curried function takes its inputs one at a time.  We can take \mc{$(3,4)$} together and return the sum \mc{$7$} in uncurried form.  In curried form, we can take \mc{$3$}, then take a pause or even a long siesta before taking the \mc{$4$}, finally returning the \mc{$7$}.  In curried form, we can even stop entirely before evaluating the function \mc{$(+)~3$} on the second summand, and leave it in this form as the function that adds \mc{$3$}.

\subsection{unwrapping the exponents}

We have introduced the notation \mc{$(Z^Y)^X$} for the set of functions with domain \mc{$X$} and range \mc{$Z^Y$}.    If \mc{$b$} is such a function, we can write it
\mc{$b:X\to Z^Y$} to indicate its domain \mc{$X$} and range \mc{$Z^Y$}.  When we take
\mc{$b(x)$} we get a function \mc{$Y\to Z$}.  If we unwrap the exponents, we
take an element of \mc{$X$} then an element of \mc{$Y$} to get an element of \mc{$Z$}.
Thus, it is natural to write
\mc{$$
b:X\to Y\to Z\quad \hbox{ or }\quad  b:X\to (Y\to Z)
$$}
to indicate the domain and range of \mc{$b$}.  The expression on the left
says we take \mc{$x\in X$} then \mc{$y\in Y$} and return \mc{$z\in Z$}.  On the
right, we take \mc{$x\in X$} then return a function \mc{$Y\to Z$}.

Because of this example, we adopt the convention that the arrow \mc{$\to$}
is to be right associative:
\mc{$$
X\to Y \to Z = X\to (Y\to Z).
$$}
The uncurried form of a function \mc{$b:X\to Y\to Z$} is \mc{$f_b:(X\times Y)\to Z$}.
If we want to use a function \mc{$c$} whose domain is \mc{$Y^X$} and range is \mc{$Z$},
the parentheses must be inserted explicitly: \mc{$c:(X\to Y)\to Z$}.

\subsection{parentheses}

The convention is to drop the parentheses on curried functions when this can be done without ambiguity.  For example, curried prefix addition is written
\mc{$$
(+)~x~y
$$}
rather than any of the following forms:
\mc{$$
(+)(x)(y)\quad ((+)(x))(y)  \quad (((+)(x))(y)).
$$}
These forms are correct, but contain unnecessarily many parentheses.
In this example, the parentheses are needed around the \mc{$(+)$} to make it
a prefix operator rather than an infix operator. All other parentheses may
be dropped.

\subsection{partial functions}

Sometimes we wish to consider functions whose domain is a proper subset of a set \mc{$X$} to \mc{$Y$}.  With curried functions, it is often easier to extend the range than to restrict the domain to a proper subset.

If \mc{$Y$} is any set, let \mc{$Y^+ = Y \cup \{Y\}$}.  For example,
\mc{$\{0,1,2\}^+ = \{0,1,2,\{0,1,2\}\}$}.  We write this more suggestively
as \mc{$Y^+ = Y \cup \{\op{Error}_Y\}$}, where \mc{$\op{Error}_Y$} is just an
another name for \mc{$Y$}.  When the set \mc{$Y$} has been fixed, we even drop
\mc{$Y$} from the notation and write \mc{$Y^+ = Y \cup\{\op{Error}\}$}.
(We define \mc{$Y^+$} as we do, because we want to add something to the set \mc{$Y$}
that we can be certain that it does not belong to \mc{$Y$} already.  We can
be certain that \mc{$Y\not\in Y$}, because Zermelo set theory was designed this
way, in order to avoid Russell's paradox.  A set in Zermelo set theory
never belongs to itself.)

If we have a function \mc{$f:X'\to Y$} defined on a proper subset \mc{$X'$} of \mc{$X$}, we can
extend it to a function \mc{$f^+$} on all of \mc{$X$} by the rule:
\mc{$$
f^+(x) = \begin{cases} f(x) & x\in X'\\ \op{Error}_Y & x\not\in X'\end{cases}.
$$}

Rather than explicitly describe the domain of the function \mc{$f:X'\to Y$}, we may simply
define a function \mc{$f^+:X \to Y^+$} that allows \mc{$\op{Error}_Y$} as a possible value in the range.  The set \mc{$X'$} can be recovered as
\mc{$X'=\{x\in X\mid f(x)\in Y\}$}.








\chapter{Types}

Foundational systems can be {\it typed} or {\it untyped}.  Zermelo set
theory is an example of an untyped system.  HOL is an example of a typed
system.

In a typed system, every  {\it term} has a {\it type} that describes
what kind of object it is.   For example, $0$ is a natural number.  We express this by saying that the type of $0$ is the type of natural numbers.  Again, $2$ is a natural number and its type is the type of natural numbers.  Similarly, $1/2$ is a rational number and its type is the type of rational numbers.  The number $\pi = 3.14159\ldots$ is a real number and its type is the type of real numbers.  Similarly, the the type of the base $e=2.71828\ldots$ of the natural logarithm is the type of real numbers.

\bigskip
We give a construction of the set of types in the HOL system.  It is a subset of
$\ring{N}$, depending on a set \verb!typecon!.
Let \verb!tyvar=1!, and \verb!tyapp=1!.
Let \verb!tycon! be a finite set of natural numbers of the form \verb!<s,n>!.
We assume that \verb!tycon! contains the elements
\verb!<"bool",0>! and \verb!<"fun",2>!.  We assume that if \verb!<s,n>=<s,n'>!,
then \verb!n=n'!, for any two elements of \verb!tycon!.

\begin{definition}
We define the set of types of depth \verb!0! to be
the set of order pairs of the form \verb!<tyvar,n>!.  By recursion, we define
the set of types of depth at most \verb!n+1! to be the union of the set
of types of depth at most \verb!n!, and the set of all \verb!<tyapp,s,nlist>!, where for some \verb!n!,
\begin{itemize}
\item \verb!nlist! is a list of length \verb!n!, 
\item each element of \verb!nlist! is a type of depth at most \verb!n!,
\item \verb!<s,n>! is an element of \verb!tycon!.
\end{itemize}
The set of types is the union of the sets of types of depth at most \verb!n! for all \verb!n!.  
\end{definition}

\begin{notation}  We write
$$
\begin{array}{lll}
\hbox{shorthand} & \hbox{full form}\\
\verb!`:A`! &\verb!<tyvar,"A">!\\
\verb!`:B`! &\verb!<tyvar,"B">!\\
\verb!`:bool`!&\verb!<tyapp,"bool",[]>!\\
\verb!`:A->B`!&\verb!<tyapp,"fun",[<tyvar,"A">;<tyvar,"B">]>!\\
\end{array}
$$
\end{notation}
In the notational shorthand, the type information is always preceded by a colon and is enclosed in backquotes.  The ASCII two-stroke arrow \verb!->! is to be understood as a right-associative infix operator.  Thus,
$$
\verb!`:A -> B -> C`! \hbox{ and } \verb!`:A -> (B -> C)`!
$$
both denote the same type as
$$
\scriptsize
\verb!<tyapp,"fun",[<tyvar,"A">;<tyapp,"fun",[<tyvar,"B">;<tyvar,"C">]>]>!
$$


Here are some basic facts about types.
\begin{itemize}
\item Every type has exactly one of the following forms:
\verb!<tyvar,_>!, \verb!<tyapp,_>!.
Every term in HOL will have a type. (We have not defined terms yet; we will do so soon.)
The type \verb!`:bool`! represents the boolean type.  Eventually, we will prove that every term of this type is equal to true or false.
\item A type of the form \verb!`:A->B`xs! is a function type.  Any function \verb!`f:A->B`! with domain \verb!`:A`! and range \verb!`:B`! has this type.
\item Types with multiple arrows are the types of curried functions.  A function \verb!`f:A->B->C`! has domain \verb!`:A`! and range \verb!`:B->C`!, which is again a function type.
\item Type variables \verb!<tyvar,_>! represent indeterminate types.   The prime example is the type of \verb!(=)! (equality).  The equals sign takes any two terms of the same type and yields a term of type \verb!`:bool`!.
\item The two terms that are compared under \verb!(=)! must have the same type, but there are no further restrictions.  We write
$$
\verb!`:A -> A -> bool`!
$$
for the type of \verb!(=)! in curried form.
\end{itemize}


\end{document}
