
\chapter{Nonlinear Programming Software}

{\bf Warning.}  This file is a rough draft of a text that was never brought into final form.
Use it at your own risk.

\newterm{Nitpick} comes from the acronym NPK for Nonlinear Programming for the Kepler conjecture.

The following resources are available for the proof of nonlinear inequalities.  The years of active development are indicated.

\begin{itemize}
\item Roland Zumkeller's 
Sergei software%
\footnote{\url{http://code.google.com/p/sergei/}} %
 2008-2010.
\item Sean McLaughlin's KeplerCode software%
\footnote{\url{http://code.google.com/p/kepler-code/}}%
\item Sam Ferguson's software \url{}, 1994--1998.
\item Thomas Hales's software \url{}, 1994--1998.
\end{itemize}

Some chapters in this guide give details about the specific nonlinear inequalities that are
used in {\it Dense Sphere Packings}.

The following resources are available for the nonrigorous verification of inequalities.

\begin{itemize}
\item 
\end{itemize}

\chapter{Linear Programming Software}

The following resources are available for linear programming for {\it Dense Sphere Packings}.

\begin{itemize}
\item Steven Obua's software \url{}.
\item \newterm{Lipstick} software \url{}.
\end{itemize}

\section{Flyspeck II}

Steven Obua's thesis shows how to treat $92.5\%$ of the tame graphs
that appear in the original proof of the Kepler conjecture~\cite{obua:phd}.  There are
several additional sources of documentation including a 50 minute video
presentation by Obua at Lausanne in 2008~\cite{obua:2008:video} and a
published account by Obua and Nipkow~\cite{obua-nipkow:2009}.

\section{Lipstick}

The Lipstick program takes its name from the acronym LPSK, for
{\it Linear Programming Software for the Kepler conjecture}.  It is available
at the code repository for the Flyspeck project.


\subsection{github download}\label{sec:code}

There are no precompiled binaries for the project.  The source code
must be downloaded and then compiled.  This subsection gives
instructions about how to download source code.

To download code from a git code project go to the main page of the
project and follow the instructions.

For example to download the entire Flyspeck project, go to
the Flyspeck project%
\footnote{\url{https://github.com/flyspeck/flyspeck}} %


\subsection{installation}

The lipstick code is available from the Flyspeck  code repository in
the glpk%
\footnote{\url{/projects_discrete_geom}} %
 subdirectory.  Section~\ref{sec:code}
gives instructions for downloading code from the  code repository.

The following other resources are needed to run the code.

\begin{itemize}
\item The Objective Caml language%
\footnote{\url{http://caml.inria.fr/}} %
\item The GNU Linear Programming Kit (GLPK)%
\footnote{\url{http://www.gnu.org/software/glpk/}} %
\item The archive of tame graphs% 
\footnote{\url{http://weyl.math.pitt.edu/hanoi2009/Kepler/Kepler}}
\end{itemize}

The code uses the GNU MathProg modeling language to describe the linear programs that arise in the proof of the Kepler conjecture.

The following sources of documentation are useful.

\begin{itemize}
\item Modeling Language GNU MathProg manual.  This manual is part of the GLPK distribution.  It is also directly downloadable in pdf%
\footnote{\url{http://www.cs.unb.ca/~bremner/docs/glpk/gmpl.pdf} --2008 version} %
 and html%
\footnote{\url{http://www.im.pwr.wroc.pl/~przemko/opty/gmpl.html}} %
\end{itemize}

\subsection{other resources}

The student edition of AMPL%
\footnote{\url{http://www.ampl.com/}} % 
is useful for 
purposes of debugging model and data files that are used by MathProg.

\begin{verbatim}
$ ampl
ampl: model contact.mod;
ampl: reset;
\end{verbatim}




\chapter{Graph Generator Software}


\begin{itemize}
\item The Nipkow-Bauer Flyspeck I project.
\item Gangplank software
\end{itemize}

\section{Flyspeck I}

The Flyspeck I project makes a formal verification of the enumeration
of tame graphs that appear in the original proof of the Kepler
conjecture~\cite{BauerN-AFP06}.  The project started with Bauer's
thesis under the direction of Nipkow~\cite{Bauer:2006:Thesis}.  The
formal verification was done in the Isabelle proof assistant.  The
code is available~\cite{BauerN-Flyspeck-I-Isabelle}.

In 2009, it became necessary to change some of the parameters that enter into the definition of tame graph.  This requires minor changes to the Flyspeck I project.



\section{Gangplank}

The name \newterm{Gangplank} comes from the acronym GGPK for the {\it
  Graph Generation Program for the Kepler conjecture.}  Gangplank is a
program written in Java for the generation of restricted hypermaps with special properties.
The first version of the software was written by Hales in 1994.  It
has been under gradual development by him since then.

A set of input parameters defines a class $C$ of restricted hypermaps.  Gangplank
then generates a list $D$ of hypermaps with the property that every hypermap in $C$
appears in $D$, up to unoriented\footnote{Hypermaps $H$ and $H'$ have
an unoriented isomorphism between them if $H$ is isomorphic to $H'$ or
$H$ is isomorphic to the opposite of $H'$.} isomorphism.

In practice, it may be difficult to check whether some of the properties of  a hypermap
are satisfied.  Gangplank is conservative in its approach.  If in doubt, it prints it out.
This means that the list $D$ may contain extraneous hypermaps.

\subsection{installation and execution}

The software is available in the graph\_generator%
\footnote {\url{/graph_generator}} %
 directory at the flyspeck code repository.  Section~\ref{sec:code} gives instructions on downloading the code.

The Java%
\footnote{\url{http://www.java.com/}} %
 programming language must be installed on the computer for the software to run.

To compile Gangplank:

\begin{itemize} 
\item Open a shell, 
\item Change into the graph\_generator/src subdirectory
\item Type the following command at the shell prompt:
\begin{verbatim}
javac -d ../classes graph/Generator.java 
\end{verbatim}
\end{itemize}

To run Gangplank:

\begin{itemize}
\item Choose a properties file from the graph\_generator/properties subdirectory and copy it to /tmp/graph.properties.  (The behavior of the program is directed by this file.)
\item Change into the subdirectory graph\_generator/classes
\item Type the following command at the shell prompt:
\begin{verbatim}
java -Xms300m -Xmx1g graph/Generator  
\end{verbatim}
\end{itemize}

The output goes to the standard output (screen).

\subsection{terminology}

This section follows the terminology from {\it Dense Sphere Packings}.  In particular,
it uses the language of hypermaps.  An exceptional face of a hypermap is one with
at least five darts.  The type of a node is a triple $(p,q,r)$,
where $p$ is the number of triangles that meet the node, $q$ is the number of quadrilaterals that meet it, and $r$ is the number of exceptional faces that meet it.
A node is a set of darts. Its cardinality corresponds to what is called the degree of the
node in graph theory.

\subsection{input parameters}

The input parameters are given in a file /tmp/graph.properties.
(To use a different input file, edit the string propertiesFile
in src/graph/Constants.java.)  Various examples of properties files
are found in the directory graph\_generator/properties.

The format of the properties file is a Java configuration%
\footnote{\url{http://en.wikipedia.org/wiki/.properties}} % 
file.  A line beginning with \verb!#! or ! is interpreted as a comment.
Each property is given by a line of the form key=value.
Most parameters have a default value if none is specified.
This subsection describes the keys, admissible values, and defaults.
Each choice of parameters describe a class of restricted hypermaps, which we will call $C$.
(A better notation would show the dependence of $C$ on the parameters:
$C(\text{excludeDegree2,excludePentQRTet},\ldots)$, but this would be unwieldy.)
The program Gangplank generates a set of hypermaps that contains every element of
$C$ up to unoriented isomorphism.


\subsubsection{excludeDegree2=false}

If set to true,  $C$ does not contain any hypermaps with a node of degree $2$.

\subsubsection{excludePentQRTet=false}

If set to true,  $C$ does not contain a hypermap with a node of type $(1,0,1)$
in which the exceptional face is a pentagon. (See Figure~\ref{fig:excludePentQRTet}.)

\tikzfig{excludePentQRTet}
{If true, the node $3$ of type $(1,0,1)$ is excluded.}
{
[scale=0.004]
% java render/Gentikz "33 4  4 0 4 2 1 4 0 1 2 3    3 2 4 3     3 0 3 4 "
%tikz format auto generated by Gentikz
%in LaTeX file, enclose code in tikzpicture environment
% invariant: 147615209765
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {$0$};
\path ( 0,-400) node (P1) {$1$};
\path ( -400,0) node (P2) {$2$};
\path ( 0,0) node (P3) {$3$};
\path ( 0,400) node (P4) {$4$};
%Draw edges:
\draw
  (P0) -- (P1)
  (P0) -- (P4)
%  (P0) -- (P3) % hand edited.
  (P1) -- (P2)
  (P2) -- (P4)
  (P2) -- (P3)
  (P3) -- (P4)
;
}

\subsubsection{exclude2inQuad=true}

If set to true, then $C$ does not contain a  hypermap that contains a
simple contour loop through precisely four nodes such that both the interior and exterior
 contain at least two additional nodes. (See Figure~\ref{fig:exclude2inQuad}.)
Expressed in terms of planar graphs, there is no $4$-cycle such that both its interior
and exterior contain at least two nodes.

\tikzfig{exclude2inQuad}
{If true, $C$ does not contain this subarrangement.}
{
[scale=0.004]
% java render/Gentikz "33 2 4 0 1 2 3 4 0 3 2 1"
% nodes P4,P5,P6,P7 added by hand.
%tikz format auto generated by Gentikz
%in LaTeX file, enclose code in tikzpicture environment
% invariant: 230148743091
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {$0$};
\path ( 0,400) node (P1) {$1$};
\path ( -400,0) node (P2) {$2$};
\path ( 0,-400) node (P3) {$3$};
\path (-100,0) node (P4) {$4$};
\path (100,0) node (P5) {$5$};
\path (-300,300) node (P6) {$6$};
\path (300,300) node (P7) {$7$};
%Draw edges:
\draw
  (P0) -- (P3)
  (P0) -- (P1)
  (P1) -- (P2)
  (P2) -- (P3)
;
}


\subsubsection{exclude1inTri=true}

If set to true, then $C$ does not contain a  hypermap that contains a
contour loop through precisely three nodes such that both the interior and exterior
contain both contain at least one additional node.  (See Figure~\ref{fig:exclude1inTri}.)

\tikzfig{exclude1inTri}
{If true, $C$ does not contain this subarrangement.}
{
[scale=0.004]
%tikz format auto generated by Gentikz
%in LaTeX file, enclose code in tikzpicture environment
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {$0$};
\path ( -200,346) node (P1) {$1$};
\path ( -200,-346) node (P2) {$2$};
\path (0,0) node (P3) {$3$};
\path (300,300) node (P4) {$4$};
%Draw edges:
\draw
  (P0) -- (P2)
  (P0) -- (P1)
  (P1) -- (P2)
;
}

\subsubsection{ignoreArchive=false}

There is a large archive of hypermaps /src/graph/archive.java.  Let $D$ be this
collection.   When true,
the list of hypermaps in the archive is ignored and all hypermaps are built from scratch.

When false, the class $C$ is effectively replace with $C\setminus D$.  The output
of Gangplank only reports hypermaps that are outside the archive.

This parameter differs from the others because it affects the output, rather than the
definition of the class $C$.

\subsubsection{vertexCountMin=1}

For every hypermap $H$ in $C$, the number of nodes of $H$ is at least this value.
The value must be at least $0$.  The class $C$ is empty unless the value is at least $3$.

\subsubsection{vertexCountMax=100}

For every hypermap $H$ in $C$, the number of nodes of $H$ is at most this value.
This value must be at least vertexCountMin.

\subsubsection{nodeCardMaxAtExceptionalVertex=5}

For every hypermap $H$ in $C$, the cardinality of every node with an exceptional face
is at most this value.

\subsubsection{nodeCardMax=6}

For every hypermap $H$ in $C$, the cardinality of every node is at most
this value.  The name of the parameter is not very intuitive.  In
graph theory terms, it is the upper bound on the degree of a node.

\subsubsection{faceCardMax=8}

For every hypermap $H$ in $C$, the cardinality of every face is at most
this value.  

\subsubsection{squanderTarget=1}

The next few parameters relate to admissible weight assignments.  A
weight assignment on a hypermap is a real-valued function on its set
of faces.  The admissibility conditions are given as a system of
inequalities on the weight assignment.  These conditions depend on parameters
$a,b,d,k,\op{tgt}$.

The parameter $\op{tgt}$ equals squanderTarget, and $k$ equals 
nodeCardMaxAtExceptionalVertex.  The other three parameters are functions:
$a:\ring{N}\to\ring{R}$, $b:\ring{N}^2\to \ring{R}$ and $d:\ring{N}\to\ring{R}$.
A weight assignment $\tau$ on a hypermap $H$
is $(a,b,d,k,\op{tgt})$-\newterm{admissible}, if the following
conditions hold.
\begin{enumerate}
\item \case{total weight} $\sum_F \tau(F) < \op{tgt}$.
\item \case{bound~a} 
Let $v$ be any node of type $(p,q,r)$ such that $p+q+r=k$ and $r>1$. Let
  $A$ be the set of triangles and quadrilaterals meeting that node.  Then
\[ \sum_{F\in A} \tau(F)
\ge  a(p) + p\, d(3) + q\, d(4).\] 
\item \case{bound~b}
\formaldef{}{adm\_2}
 If a node $v$ has type $(p,q,0)$, then%
\footnote{The conditions in the original proof of the Kepler conjecture were slightly
more complicated than this, being expressed on \newterm{separated} sets of nodes.  Early versions of Gangplank had to treat this more general condition.}
  \[ \sum_{F:\,v\cap F\ne\emptyset} \tau(F) \ge
    b(p,q).\] 
%        \label{admissible:b}
\item \case{bound~d}
\formaldef{}{adm\_1}
 If the face $F$ has cardinality $n$, then
$\tau(F) \ge d(n)$.
\end{enumerate}
Note that for each $p$ and constant $a(p)$ there are various node types that go with it:
\[
(p,0,k-p),\quad (p,1,k-p-1),\ldots,\quad (p,k-1-p,1).
\]


The admissibility parameters $a,b,d$ are defined in the configuration
file.  Every hypermap $H\in C$ must have an
$(a,b,d,k,\op{tgt})$-admissible weight assignment for the
given parameters.

\begin{example}  If $\op{tgt}=1$ and the functions $a,b,d$ are all identically zero,
then the zero function is an admissible weight assignment.  This choice of parameters
effectively 
turns the weight assignment conditions off.
\end{example}

\begin{example} If  $d(n)\ge\op{tgt}$ for some $n$, then a hypermap with
an admissible weight assignment cannot have a face of cardinality $n$.  This gives
a way to constrain the sizes of the faces.
\end{example}

\begin{example} If $b(p,q)\ge\op{tgt}$ for some $(p,q)$, then a hypermap with
an admissible weight assignment cannot have a node of type $(p,q,0)$.  This gives
a way to constrain the types of the nodes.
\end{example}

\subsubsection{tableWeightD\wild =squanderTarget}

These parameters set the function $d$ that is used to define admissibility.
The default is the squander target, which means that a face of that size cannot occur
in the class $C$.

\begin{example} Suppose the properties file contains the following lines:
\begin{verbatim}
squanderTarget=1600
tableWeightD3=0
tableWeightD4=200
tableWeightD5=400
tableWeightD6=900
\end{verbatim}
Faces of other sizes are assigned the default $\op{tgt}$, 
which means they cannot occur.  
For these parameters, 
we may deduce that
every hypermap $H$ in the class $C$ has the following properties:
\begin{itemize}
\item Every face has $3,4,5$ or $6$ sides.
\item There cannot be two hexagons: $2d(6) =1800 > 1600=\op{tgt}$.
\item A hypermap with one hexagon has at most one pentagon: $d(6)+2d(5) = 1700 > 1600 = \op{tgt}$.
\end{itemize}
\end{example}
Property declarations 
that are not in the range $n=3,\ldots,\text{faceCardMax}$ are ignored.
The constants are required to be monotonic:
\[
d(3) \le d(4) \le \cdots
\]

\subsubsection{tableWeightA\wild =squanderTarget}

These parameters set the function $a$ that is used to define admissibility.
The default is the squander target, which means that a face of that size cannot occur
in the class $C$.

\begin{example} Suppose the properties file contains the following lines:
\begin{verbatim}
squanderTarget=1500
nodeCardMaxAtExceptionalVertex=6
tableWeightD3=0
tableWeightD4=200
tableWeightD6=700
tableWeightA5=800
\end{verbatim}
Suppose there is a node of type $(5,0,1)$. The associated constants
are $p=5,q=0,r=1,k=p+q+r=6$.
Let  $A$ be the set of five triangles at that node.  The definition of admissible
weight assignment implies that
\[
\sum_{F\in A}\tau(F) \ge a(5) + 5\, d(3) + 0\, d(4) = a(5) = 800.
\]
We conclude that a hypermap in class $C$ cannot contain both a node of type $(5,0,1)$
and a hexagon: 
\[
800 + d(6) = 1500 = \op{tgt}.
\]
\end{example}

\begin{example}
At a node of type $(0,0,k)$, the condition is
\[
0  =\sum_{F\in\emptyset}\tau(F) \ge a(0),
\]
which is inconsistent unless $a(0)\le 0$.  This means that if $a(0)$ is set to any
positive value, the class $C$ does not contain any nodes of type $(0,0,k)$.
In particular, if the default value is used and $\op{tgt}$ is positive, then no nodes
of type $(0,0,k)$ occur.
\end{example}

Property declarations 
that are not in the range 
\[
p=0,\ldots,\text{nodeCardMaxAtExceptionalVertex}-1
\]
are ignored. 


\subsubsection{tableWeightB\wild\wild=squanderTarget}

These parameters set the function $b$ that defines admissibility.  The default is
the squander target, which means that a node of that type $(p,q,0)$ cannot occur in
$C$.

\begin{example} Suppose the properties file contains the following lines:
\begin{verbatim}
squanderTarget=1600
tableWeightB21= 800
tableWeightB22= 400
tableWeightB23=1200
\end{verbatim}
From the definition of admissibility, it follows that if a node of type $(p,q,0)$ occurs,
then $p=2$ and $q\in\{1,2,3\}$.  Moreover, there are various restrictions on 
combinations of nodes.  For example, there cannot be two nodes of type $(2,1,0)$ because
$2b(2,1)  = 1600=\op{tgt}$.
\end{example}
Properties declarations where $p$ or $q$ is greater than nodeCardMax are ignored.

\subsubsection{tableWeightC}

In the specification of admissibility, there are functions $a,b,d$,
but no function $c$.  This happens for historical reasons.  There was
originally a function $c$ that was similar in purpose to $d$, but it
has been retired.

\subsection{archive format}

The output consists of strings that encode the combinatorial structure of planar graphs.  (More precisely, the strings encode planar hypermaps.)

Here is a sample string:
\begin{verbatim}
65974205892 19 4 0 1 2 3 4 0 3 4 5 3 4 3 6 3 6 
3 2 3 6 2 7 3 7 2 8 3 8 2 1 3 8 1 9 4 9 1 0 5 
3 9 5 10 3 10 5 4 3 10 4 11 3 11 4 6 3 11 6 7 
3 11 7 12 3 12 7 8 3 12 8 9 3 12 9 10 3 10 11 12
\end{verbatim}

The first integer is a hash code of the planar hypermap.  It depends only on the
unoriented isomorphism class of the hypermap.  
If two hypermaps have the same hash code
it is quite probable that there is an unoriented isomorphism between them.
Gangplank 
makes an exhaustive search for unoriented isomorphisms of hypermaps.

The second integer is the number of faces in the hypermap.  In the example,
there are $19$ faces.

The remaining entries fall into a group for each face.  The first entry of the group
gives the size of the face.  The remaining entries of the group are the darts of
the face, listed in cyclic order according to the face permutation.

The sample above can be punctuated as follows:
\begin{verbatim}
65974205892 19 
[4: 0 1 2 3] [4: 0 3 4 5] 
[3: 4 3 6]  [3: 6 3 2] [3: 6 2 7] [3: 7 2 8] [3: 8 2 1] 
[3: 8 1 9] [4: 9 1 0 5] [3: 9 5 10] [3: 10 5 4] [3: 10 4 11] 
[3: 11 4 6] [3: 11 6 7] [3: 11 7 12] [3: 12 7 8] [3: 12 8 9] 
[3: 12 9 10] [3: 10 11 12]
\end{verbatim}
We see that this is a hypermap
with $16$ triangles and $3$ quadrilaterals.  See Figure~\ref{fig:graph}.
(Note that the figure actually gives the opposite hypermap.)




\subsection{related programs}


\subsubsection{interface with linear programs}

The output from Gangplank becomes the input to the linear programming
part of the proof.  For that purpose, the flyspeck project contains
code%
\footnote{\url{lpproc.ml}
  convert\_to\_list} %
that converts the string into an Objective CAML array.



\subsubsection{plaintri}

The Musin-Tarasov proof of the explicit thirteen spheres problem uses the
program plaintri,%
\footnote{\url{http://cs.anu.edu.au/~bdm/plantri/}}%
which generates planar graphs.

\subsubsection{generating tikz files}

A Java program that generates tikz%
\footnote{\url{http://sourceforge.net/projects/pgf/}} % 
files from an archive string is included
with the Gangplank program.  Tikz files are easily displayed by LaTex.  See
Figure~\ref{fig:graph}.
One or more archive strings can be given.  From the graph\_generator/src
directory give the following command:

\begin{verbatim}
javac -d ../classes render/Gentikz.java 
cd ../classes
java render/Gentikz "65974205892 19 
  4 0 1 2 3 4 0 3 4 5 3 4 3 6 3 6 3 2 3 6 2 7 3 
  7 2 8 3 8 2 1 3 8 1 9 4 9 1 0 5 3 9 5 10 3 10 
  5 4 3 10 4 11 3 11 4 6 3 11 6 7 3 11 7 12 3 
  12 7 8 3 12 8 9 3 12 9 10 3 10 11 12 "
\end{verbatim}

\tikzfig{graph}
{This figure is automatically generated by Gentikz from the archive string.}
{
[scale=0.008]
%tikz format auto generated by Gentikz
%in LaTeX file, enclose code in tikzpicture environment
% invariant: 65974205892
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {$0$};
\path ( 0,400) node (P1) {$1$};
\path ( -400,0) node (P2) {$2$};
\path ( 0,-400) node (P3) {$3$};
\path ( 14,-102) node (P4) {$4$};
\path ( 109,-28) node (P5) {$5$};
\path ( -91,-235) node (P6) {$6$};
\path ( -293,11) node (P7) {$7$};
\path ( -48,294) node (P8) {$8$};
\path ( 56,48) node (P9) {$9$};
\path ( -75,58) node (P10) {$10$};
\path ( -159,-25) node (P11) {$11$};
\path ( -84,170) node (P12) {$12$};
%Draw edges:
\draw
  (P0) -- (P3)  (P0) -- (P1)  (P0) -- (P5)  (P1) -- (P2)  (P1) -- (P8)
  (P1) -- (P9)  (P2) -- (P3)  (P2) -- (P6)  (P2) -- (P7)  (P2) -- (P8)
  (P3) -- (P4)  (P3) -- (P6)  (P4) -- (P5)  (P4) -- (P10)  (P4) -- (P11)
  (P4) -- (P6)  (P5) -- (P9)  (P5) -- (P10)  (P6) -- (P11)  (P6) -- (P7)
  (P7) -- (P11)  (P7) -- (P12)  (P7) -- (P8)  (P8) -- (P12)  (P8) -- (P9)
  (P9) -- (P12)  (P9) -- (P10)  (P10) -- (P12)  (P10) -- (P11)  (P11) -- (P12)
;
}

\subsubsection{generating DOT files}

The \newterm{DOT}%
\footnote{\url{http://en.wikipedia.org/wiki/DOT_language}} %
 language is a way of describing graphs in simple text.
A Java program that generates DOT files from an archive string is included
with the Gangplank program.  One or more archive strings can be given.
From the graph\_generator/src
directory give the following command:

\begin{verbatim}
javac -d ../classes render/Gendot.java 
cd ../classes
java render/Gendot "65974205892 19 
  4 0 1 2 3 4 0 3 4 5 3 4 3 6 3 6 3 2 3 6 2 7 3 
  7 2 8 3 8 2 1 3 8 1 9 4 9 1 0 5 3 9 5 10 3 10 
  5 4 3 10 4 11 3 11 4 6 3 11 6 7 3 11 7 12 3 
  12 7 8 3 12 8 9 3 12 9 10 3 10 11 12 "
\end{verbatim}


\subsubsection{displaying DOT files}


The \newterm{neato}%
\footnote{\url{http://www.graphviz.org/Download..php}.\ \    When I downloaded the precompiled binary (.dmg) of graphviz for Mac OS X, I was unable to find the command line neato program, but I found it in the non-dmg download.} %
and \newterm{graphviz} programs render graphs that have been described in the DOT language.
For example,  the command line prompt
%
\begin{verbatim}
 neato -s -n g.dot -Tgif -o graph65974205892.gif
\end{verbatim}
%
produces a gif from the DOT file (g.dot) produced by Gendot.  The gif file is
similar in  appearance
to Figure~\ref{fig:graph}.


The program dot2tex%
\footnote{\url{http://www.fauskes.net/}} %
converts graphs in the dot language directly into
LaTeX in tikz format.  I have not used this program because Gentikz gives
the tikz file directly, without the extra conversion.




\chapter{Mathematica for Dense Sphere Packings}

The identifiers in Mathematica do not contain underscores, but the identifiers in HOL-Light do.
The HOL Light identifier is translated by eliminating underscores and converting a letter after the underscore to uppercase:
\[
\op{rad2\_x (HOL Light)} \to \op{rad2X (Mathematica)}.
\]

\chapter{Formal Proof Software}

\chapter{Illustrations of Dense Sphere Packings}


\chapter{Verification of Linear Programs}

\section{Model}

\id{MathProg} is a linear programming modeling language that builds linear
programs from collections of parameters, sets, variables, and inequalities.
This section defines a large number of parameters and sets that have been
implemented in code as a \id{MathProg} model.


\begin{definition}[extended]
Let $V\subset\BB$ be a contravening packing.
An extended fan $(V,E)$ is a fan such that 
$V\subset\BB$ is contravening 
and $E_{std}\subset E$.  
\end{definition}

The eventual aim is to show that the set of contravening packings is empty.  The proof
is by contradiction.
We fix one contravening packing $V$ and make a detailed investigation.  
The eventual aim is to show that it cannot exist.
There will be various extended fans $(V,E)$ that will be associated with
the contravening packing $V$.  




\subsection{parameters}








\begin{definition}[$\sol_0$, $\op{tgt}$, $\op{tgt}_e$ $\rho_L$]
Define
\begin{align*}
\sol_0 &= \sol(2,2,2,2,2,2) \approx 0.551\\
\op{tgt} &= 1.541\\
\rho_L(y) &= 1 + \left(\frac{\sol_0}{\pi}\right) (1-L(y/2))\quad for 2\le y\le 2.52.\\
\op{rhazim}(\v_1,\v_2,\v_3) &= \rho_L(\normo{\v_1})\azim(\orz,\v_1,\v_2,\v_3)\\
\end{align*}
\end{definition}






If $V$ is contravening then the hypermap of $(V,E_{std})$ is tame.  We can
identify the set of nodes of $\op{hyp}(V,E)$ with $V$.  
The following sets are associated with an extended fan $(V,E)$ and its hypermap.  
We do not
show the dependence on $(V,E)$ explicitly in the notation.

\begin{definition}[\id{card\_node},~\id{node},~\id{card\_face},~\id{face}]
We define the following numbers and sets:
\begin{enumerate}
\item $\id{card\_node} = \card(V).$
\item \id{card\_face} is the number of faces in the hypermap of $(V,E)$.
\item $\id{node} = \{ 0,\ldots, \id{card\_node}-1\}$.  We fix a bijection
between $\id{node}\to V$ ($i\mapsto \v_i$) 
and often identify the two.  Of course, any metric
properties of the contravening packing must be obtained from $V$ and not
from the set of natural numbers \id{node}.
\item $\id{face}  = \{0,\ldots,\id{card\_face}-1\}$.  We identify \id{face} with
the set of faces by fixing an order on the faces.
\end{enumerate}
\end{definition}

\begin{remark}[model and data]
The language \id{MathProg}  is designed to separate the linear program into
two files: a model and a
data file.  The model can be viewed as the part of the problem that does not depend
on the contravening packing $V$ and the data as the part of the problem that
does.  For example, the model declares that there is a parameter
\id{card\_node}  that takes some value in $\{13,14,15\}$, because this much
holds for all contravening packings.  For any given contravening
packing $V$, its data file provides the exact value of \id{card\_node}.
For example, a few lines from the model file are as follows
\begin{verbatim}
param card_node 'number of nodes' >= 13, <= 15; 
param card_face 'number of faces' >= 0; 
set node := 0..(card_node-1);
set face := 0..(card_face-1);
\end{verbatim}
\end{remark}

\begin{remark}[finiteness]
We may combine different contravening packings into a single data file if they
have the same parameters and sets.  In this way, there are only finitely many different
data files that need to be processed to prove the nonexistence of contravening
packings.
\end{remark}

\begin{definition}[\id{dart},~\id{e\_dart}]
Every face
of $(V,E_{std})$ is simple.  The same is true of every face of an extended fan $(V,E)$.
This means that 
in $\op{hyp}(V,E)$, each dart is uniquely determined by the node and face to
which it belongs.  This allows us to define the set of darts \id{dart} as a subset of
$\id{node}\times\id{dart}$.
Under this identification, the face map $f$ of the hypermap becomes a permutation
on \id{dart}.  We have $f(i,j) = (f_j i,j)$ for some permutation $f_j$ of the nodes
that meet the face $j$.  Let 
\[
\id{e\_dart} = \{(i_1,i_2,i_3,j) \mid (i_1,j)\in\id{dart},~~ i_2 = f_j i_1,~~ i_3 = f_j i_2\}
\]
We call it the set of extended darts.  The indices $i_1,i_2,i_3$ are three consecutive
nodes following $f$ around the face $j$.
\end{definition}

\begin{definition}[\id{d\_edge},~\id{edge}]
The set of directed edges of the hypermap can be identified with the set of darts
\[
\id{d\_edge} = \id{dart}.
\]
If the directed edge is represented as an arrow from one node to another within a face $j$, then the arrow from $(i,j)$ to $(f_ji,j)$ is identified with the dart $(i,j)$
at its tail.
The set of  edges \id{edge} is given as pairs of darts:
\[
\id{edge} = \{(i_2,j_1,i_3,j_2) \mid \exists i_0,i_1.~
     (i_1,i_2,i_3,j_1)\in \id{e\_dart},~~ (i_0,i_3,i_2,j_2)\in \id{e\_dart} \}.
\]
\end{definition}

\begin{definition}[standard~face,~\id{std},~\id{std3},~\id{std4},
~\id{std5},~\id{std6}]
Recall that a dart of a fan $(V,E)$ is a pair of nodes $(\u,\v)$ such that $\{\u,\v\}\in E$.
A face is a set of nodes. Thus, if $E_{std}\subset E$, it may happen that some
face of $\op{hyp}(V,E_{std})$ is equal\footnote{Precise equality is meant here. No
identifications are made.} to some face of $\op{hyp}(V,E)$.  The set of
{\it standard faces}  is the set of  faces of $\op{hyp}(V,E)$ that equal a face
of $\op{hyp}(V,E_{std})$.  It is identified with $\id{std}\subset\id{face}$.
The set \id{std} is the disjoint union of
\id{std3}, \id{std4}, \id{std5}, \id{std6} according to the number of
darts in the face $3,4,5,6$. (Recall that a face of a tame hypermap has between
three and six darts.)
\end{definition}

There are many other sets of faces, darts, directed edges, and nodes
that enter into the model.

\begin{verbatim}
std3_big, std3_small, 
std56_flat_free, non_std, 
std3_small_200_218, std3_big_200_218,

dart_std3, dart_std4, dart3,
dartX, dartY, dart4_diag3,

apex_flat, apex_sup_flat, apex_sup_flat_pair,
apex4, apex5, apex_A, 
apex_std3_hll, apex_std3_small_hll

d_edge_225_252, d_edge_200_225,

node_218_252, node_236_252, node_218_236, node_200_218, 
\end{verbatim}

These sets are defined by various metric conditions on $V$.  For example
$i\in \id{node\_218\_252}\subset \id{node}$ 
if and only if $\normo{\v_i}\in\leftclosed 2.18,2.52
\rightclosed$.  An apex set is a set of darts in which one distinguished dart
is selected from a face, based on the metric properties of the face.


\subsection{variables}

\subsection{inequalities}

\section{Branching}


\chapter{Verification of the Nonlinear  Inequalities}

Turn to the proof of Lemma~\ref{lemma:cluster}.  Let $Z$ be a cell
cluster and let $\ee$ be the critical edge shared by the cells in the
cluster.  Call this critical edge the \newterm{spine}.  Consider all
the faces along the spine $\{ \u_0, \u_1\}$, consisting of three
points $\{ \u_0, \u_1, \u_2\}$ in the packing with circumradius less
than $\sqrt2$.  Call such a face a \newterm{leaf}. 
\indy{Index}{edge!spine} %
\indy{Index}{edge!critical} %
\indy{Index}{leaf} %

Consecutive cells around the spine are \newterm{adjacent}.  A cell
adjacent to a $4$-cell is a $3$-cell or another $4$-cell.  A cell
adjacent to a $2$-cell is a $3$-cell.  There are no $0$- or $1$-cells
along a critical edge.  \indy{Index}{adjacent} %
\indy{Index}{quarter} %

Call a $4$-cell a \newterm{quarter}, when it has exactly one critical
edge and all other edges of the simplex have length at most $2 h_-$.
The weight of any quarter is $1$.

\section{Cluster Inequality}

%\begin{calculation}\label{calc:cc:qtr}\guid{GLFVCVK}\guid{4869905472}\guid{2477216213}\guid{8328676778}\cutrate{}
%Let $\gamma_L$ be given by Definition~\ref{def:gammaL}, $\op{wt}$ by
%Definition~\ref{def:wt}, and $\beta$ by Definition~\ref{def:beta}.
%If $X$ is any $k$-cell that is not a quarter with $k\in\{2,3,4\}$,
%then % gammaL is nonneg on quarters. cc:qtr
%\[ 
%\gamma_L(X) \op{wt}(X) + \beta(e,X)\ge 0.
%\]  
%\end{calculation}
%

%\begin{calculation}\label{calc:cc:2bl}\guid{FHBVYXZ}\guid{1118115412}\cutrate{}
%Let $\gamma_L$ be given by Definition~\ref{def:gammaL}.  Let $X$ be
%any quarter.  Let $Y$ be a $3$-cell that flanks it.  Then
%\[ 
%\gamma_L(X)+\gamma_L(Y)\ge 0,
%\] 
%% 2-leaf calculation, gammaL(fourcell)+gammaL(threecell) >=0. % cc:2bl:
%\end{calculation}

\begin{calculation}\label{calc:shorts}\cutrate{}
The following calculations involve many cases that are itemized by
computer code.
\begin{itemize}\wasitemize 
\item \case{BIXPCGW} Let $Z$ be any cell-cluster along a spine $e$
with three leaves.  Then
\[ 
\Gamma(Z)> 0.
\] 
\item \case{QITNPEA} Let $Z$ be any cell-cluster along a spine $e$
with four leaves.  Then
\[ 
\Gamma(Z)> 0.
\] 
\end{itemize}\wasitemize 
\end{calculation}





%\section{Two Leaves}
%
%The proof is  divided into cases, according to the number of
%leaves along the critical edge.
%
%\claim{It suffices to prove Lemma~\ref{lemma:cluster} when the cluster
%contains at least one quarter and at least two leaves.} Indeed, by
%Calculation~\ref{calc:cc:qtr}, if $X$ is any cell,
%then % gammaL is nonneg on quarters. cc:qtr ~[GLFVCVK]
%\[  
%\gamma(X,L) \op{wt}(X) + \beta(\ee,X)\ge 0
%\]  
%when $X$ is not a quarter.  This is the desired inequality.  Also, a
%quarter is flanked by two leaves.
%
%Consider a cluster with exactly two leaves.
%Without loss of generality, the two leaves flank a quarter
%$X$. 
%The azimuth angle of what remains outside the quarter
%is greater than $\pi$.  Thus, there must be a $3$-cell
%along each leaf.  Let $Y$ be one of these $3$-cells.
%The cell $Y$ has weight $1$.
%Then 
%\begin{equation}\label{eqn:cc2bl} 
%\Gamma(Z)\ge \gamma(X,L)+\gamma(Y,L)\ge 0,
%\end{equation}
%by Calculation~\ref{calc:cc:2bl}.
%%a calculation~\cite[FHBVYXZ]
%% 2-leaf calculation, gammaL(fourcell)+gammaL(threecell) >=0. % cc:2bl:
%\indy{Index}{azimuth} %
%\indy{Index}{angle!azimuth} %

%\section{Five Or More Leaves}


\section{Three Or Four Leaves}\label{sec:3or4}

In the case of three and four leaves, the proof relies to an even
greater extent on computer calculations.  
Lemma~\ref{lemma:cluster} asserts a nonlinear inequality.  The inequality
asserts that some continuous function $f$ is positive on a compact
domain $D$ in Euclidean space.  Rigorous methods of global nonlinear
optimization can be used to show that the function $f$ is indeed
positive.

Details about global nonlinear optimization appear in the appendix.
The method is linear relaxation, which can be briefly described as
follows.\footnote{Linear relaxations appear again later in the
solution of significantly more difficult nonlinear optimization
problems.}  The domain $D$ is partitioned into finitely many subsets
$D_1,\ldots, D_r$.  The positivity of $f$ is established on each
subset $D_i$.  The graph $\{(f(x), x)\mid x\in D_i\}$ of $f$ on $D_i$
is a subset of a polyhedron $P_i$.  The inequalities defining the
polyhedron can be determined explicitly.  A linear program computes
the minimum of the first coordinate over $P_i$.  This minimum is
positive.  Since the graph is contained in $P_i$, the values of $f$ on
$D_i$ must also be positive.

This strategy has been implemented and gives the desired lower bound.
The linear programming has been implemented as a \newterm{MathProg} model
in Calculation~\ref{calc:shorts}.\footnote{MathProg implements a
subset of the \newterm{AMPL} modeling language.  The computer code
giving the model appears in shorts.mod and the computer code
controlling the branching appears in shorts.ml.}  This model
contains the number of leaves, variables representing the edges and
the azimuth angles between consecutive leaves.

The proof that each graph is contained in a explicit polyhedron $P_i$
relies on nonlinear inequalities.  In fact, the proof requires over
one hundred nonlinear inequalities that have been established by
computer.

A function on the set $D$ with finite range partitions $D$ into
finitely many subsets, according to the image of a point.  Several
simple boolean functions and functions with finite range were used to
partition $D$ into subsets $D_i$: Are there three leaves or four?  Is
there a $2$-cell in the cluster?  Is the $4$-cell a quarter?  Is the
azimuth angle of a given cell greater than $2.3$?  Is the value of
$\gamma(\wild,L)$ on a given quarter negative? Does a particular leaf have a
nonspinal edge of length greater than $2h_-$?  What is the weight of a
given $4$-cell?  The inequalities that define the polyhedra $P_i$ have
been designed specifically for the subdomains $D_i$, according to the
answers to these questions.

These linear relaxations and are sufficient to prove the bound in all
but one case.  This is the case of four leaves, three quarters, and
one $4$-cell that has two critical edges: the spine and the edge
opposite the spine.  The other four edges of the $4$-cell have length
at most $2h_-$.  In this case as well, the inequality is established
by linear relaxation, but things are more involved.

The method to prove this case by computer is as follows.  Number the
four simplices $j=1,2,3,4$, with $j=1$ representing the $4$-cell of
weight $1/2$.  Write $\gamma^j$ in abbreviation of
$\gamma(X,L)\op{wt}(X) + \beta(\ee,X)$.  The desired inequality is
\begin{equation}\label{eqn:gpos} 
\sum_{j=1}^4 \gamma^j > 0.
\end{equation}
The domain is a set of ordered four-tuples of simplices
$X_1,\ldots,X_4$ that fit together into an octahedron (the dihedral
angles along the spine sum to $2\pi$, the four simplices all have the
same spline length $y_1(X_j)$, and the shared edges are the same
length for the two simplices sharing the edge).  Instead of the single
inequality asserted by Lemma~\ref{lemma:cluster}, many inequalities of
the following form are established:
\begin{equation}\label{eqn:gpart} 
\gamma^j + a_i \dih^j + b_i^j y_1 + c_i^j (y_2+y_3+y_5+y_6) + d_i^j > 0, 
\end{equation}
for all $X \in I_i^j$, \quad $i \in I$, and $j\in \{1,2,3,4\}$.  Here,
$\gamma^j$, $\dih^j$, and $y_i$ are all functions of $X$.  The simplex
$X$ has spine of length $y_1$ and other edges with lengths $y_k$.
Also, $\dih^j$ is the dihedral angle of $X$ along the spine.  $I$ is a
finite indexing set.  Each domain $I_i^j$ is a product of intervals in
$\ring{R}^6$, under the parameterization of a simplex by the lengths
of its six edges.  The union over $i$ of the sets
\[  
\{(X_1,\ldots,X_4)\mid~ X_j \in I_i^j,\text{ for } j=1,2,3,4.\}
\] 
covers the entire domain of the desired inequality~\eqref{eqn:gpos}.   

\claim{A subset of this union already covers the domain.}  Indeed, the
dihedral angles of the four simplices along the spine sum to $2\pi$:
\[  
\sum_{j=1}^4 \gamma^j = 2\pi.
\] 
Furthermore, the spine lengths of the simplices must agree: $y_1(X_j)
= y_1(X_k)$ for all $j,k\in\{1,2,3,4\}$.  Finally, each leaf flanks
two different simplices; the edge lengths of the leaf must agree.
This gives a collection of inequalities of the form $y_i(X_j) =
y_{i'}(X_{j'})$.  These are the subset relations.

The coefficients of the inequalities~\eqref{eqn:gpart}
are chosen so that for each $i$, the following inequality holds:
\begin{equation}\label{eqn:glin} 
0 > a_i 2\pi + 
\sum_{j=1}^4 (b_i^j y_1 +  c_i^j (y_2(X_j)+y_3(X_j)+y_5(X_j)+y_6(X_j)) + d_i^j).
\end{equation}
(Notice that this inequality is linear in the variables $y_k(X_j)$ and
the domain is a product of intervals.  Hence, this inequality is
particularly easy to check.)  The sum of Inequality~\eqref{eqn:gpart} over $j$, Inequality~\ref{eqn:glin},
and the subset relation yield the desired inequality~\ref{eqn:gpos}.

A four-leafed cluster is an octahedron.  The set of octahedra is a
$13$-dimensional object, parameterized by twelve external edges and one
diagonal (the spine).  By contrast, a simplex in $\ring{R}^3$ is only
a $6$-dimensional object, parameterized by six edges.  The four-leafed
cluster inequality is an inequality in thirteen dimensions.  The preceding
arguments reduce the $13$-dimensional inequality into a series of
$6$-dimensional inequalities.  The six-dimensional inequalities are
within the reach of a computer.

The only question is how the magical coefficients
$a_i,b_i^j,c_i^j,d_i^j$ are obtained.  Clearly, the
inequalities~\eqref{eqn:glin} and \eqref{eqn:gpart} are linear in these
coefficients.  Thus, a they can be found by linear programming.  It is
somewhat troubling that there are infinitely many constraints, as each
point $X_j$ in the domain gives one constraint.  In practice, the
infinite number of constraints can be replaced by a finite collection.
Some information is lost in approximating the system with a finite
number of constraints.  However, the coefficients, once they are
guessed by approximations, can be checked independently by computer.
(An exact fit it not necessary; any coefficients that work will do.)
It was necessary to partition the domain into smaller pieces to
produce coefficients that work.  In other words, the indexing set $I$
contains more than one element.  After some experimentation, we found
a set $I$ of cardinality twenty-three that works.  Through these methods,
coefficients were found.






\section{Verification of the Nonlinear Local Fan Inequality}



\begin{calculation}\guid{2158872499}\cutrate{}\label{calc:2der}
%% checked in Mathematica NMaximize
% old tag: eqn:arc'' 
This is a
  calculation of the sign of a second derivative of $\arc$.  There are
  two cases.  It is an optimization problem in two variables.
Let $y_1,y_2\in \leftclosed 2,2\hm\rightclosed$.  
\begin{itemize}\wasitemize 
\item 
Let $g(t) = \arc(y_1,y_2+t,2)$.  Then $g''(0) < 0$.
Explicitly,
\[ 
  g''(0) = \dfrac{
    -64 + 48y_1^2 - 12 y_1^4 + y_1^6 
  + 80 y_2^2 - 8 y_1^2 y_2^2 - 3 y_1^4 y_2^2
    - 12 y_2 ^4 + 3 y_1^2 y_2^4 - y_2^6
  }{y_2^2 \sqrt{\ups(y_1^2,y_2^2,4)}^3}
\] 
and the polynomial in the numerator takes negative values on the given
domain.
\item
Let $g(t) = \arc(y_1+t,y_2-t,2)$.  Then $g''(0) < 0$.
Explicitly,
\[ 
  g''(0) = \dfrac{\sqrt{\ups(y_1^2,y_2^2,4)} \left(
      -4 y_1^2 + y_1^4 - 4y_1^3 y_2 - 4y_2^2 
   + 6 y_1^2 y_2^2 - 4 y_1 y_2^3 +y_2^4
    \right)}{y_1^2 y_2^2 (2+y_1-y_2)^2 (2+y_2-y_1)^2}
\] 
and the polynomial in the numerator takes negative values on the given
domain.
\end{itemize}\wasitemize 
\end{calculation}



\begin{calculation}\guid{EFJSUSK}\cutrate{}\label{calc:irred} %cc:tau
%%cc:par
Let $(V,E,F,G)$ be an irreducible minimal fan with parameters
$(r,s)$.  Then $\tau(V,E,F) \ge d(r,s)$.  (A separate calculation
has been made for each of the cases in the list given above.)
% Interval arithmetic
% calculations~ %% cc:par partition cases for tau[r,s].
\end{calculation}

% Chapter: Local Fan:


\calcentry{Lemma~\ref{lemma:pentagon-free}}{DAKGBMR}{NL}{The main
  estimate holds for pentagons.  There are two straight nodes, giving two
  cases according to whether the straight nodes are adjacent.  Each case
  has two subcases $0,1$ according to the cardinality of $S$.
  Each subcase is an optimization problem in as many as five
  variables.}

\calcentry{Lemma~\ref{lemma:hexagon-free}}{INRCFAH}{NL}{The main estimate
  holds for pentagons.  There are several cases according to the
  configuration of straight nodes.  Depending on the case, there may be as
  many as seven variables.}









%\begin{calculation}\guid{5779862781}\cutrate{}\label{calc:cc:d2a}
%  Let $y_5,y_6\in \{ 2,2\hm\}$, $y_1,y_2,y_3\in \leftclosed
%  2,2\hm\rightclosed$, and $y_4\in \leftclosed 2,4\hm\rightclosed$.
%  Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.  If
%  $\Delta(y_1^2,y_2^2,\ldots,y_6^2)> 0$ and if $ g'(0)=0, $ then
%  $g''(0)<0$.\footnote{The function $g(t)$ may fail to be
%    differentiable at $t=0$ for parameters $y_1,\ldots,y_6$ for which
%    $\Delta(y_1^2,\ldots,y_6^2)=0$.  Thus, it is necessary to work on
%    the noncompact domain $\Delta>0$ for this inequality.}
%%  (The proof is an interval arithmetic calculation over a
%%  four-dimensional space~cc:d2a.  %%cc:d2a
%%  The calculation verifies that the second derivative is negative
%%  whenever the derivative is zero.)
%\end{calculation} 
%

%\begin{calculation}\guid{6645853705}\cutrate{}\label{calc:cc:d2b}
%  Let $y_5\in \{2,2\hm\}$, $y_1,y_2,y_3\in \leftclosed
%  2,2\hm\rightclosed$, and $y_4\in \leftclosed 2,4\hm\rightclosed$.
%  Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.  If
%  $\Delta(y_1^2,y_2^2,\ldots,y_6^2)> 0$, if
%\[ 
%\arc(y_1,2\hm,2) + \arc(y_2,2\hm,2) 
%\le y_6 \le \arc(y_1,2,2\hm)+\arc(y_2,2,2\hm)
%\]  
%and if
%$
%g'(0)=0,
%$
%then $g''(0)<0$.
%\end{calculation}
%
%\begin{calculation}\guid{5606476569}\cutrate{}\label{calc:cc:qua}
%Let $y_{12},y_{23},y_{34},y_2,y_3\in\{2,2\hm\}$.
%Let $y_1,y_4\in \leftclosed 2,2\hm\rightclosed$.
%Let $y_{14}\in\leftclosed 2\hm,y_1+y_4\rightclosed$.
%Let $y_{13}\in\leftclosed 2\hm,y_1+y_3\rightclosed$.
%Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.
%If 
%\[ 
%\Delta(y_1^2,y_2^2,y_3^2,y_{23}^2,y_{13}^2,y_{12}^2)> 0 \textand 
%\Delta(y_1^2,y_4^2,y_3^2,y_{43}^2,y_{13}^2,y_{14}^2)> 0,
%\]  
%if\footnote{If $\{\v_1,\ldots,\v_4\}$ is a set of vectors such that
%  $y_i = \normo{\v_i}$ and $y_{ij} = \norm{\v_i}{\v_j}$, then
%  $\op{cross}(y_4,\ldots,y_{12}) = \norm{\v_2}{\v_4}$.}
%\[ 
%\op{cross}(y_4,y_1,y_3,y_{13},y_{34},y_{14},y_2,y_{23},y_{12})\ge y_{13},
%\] 
%and if
%$
%g'(0)=0,
%$
%then $g''(0)<0$.
%\end{calculation}
%



\section{Strong Dodecahedral Conjecture}


\begin{calculation}[local inequality]\guid{PWVDMPT}
The local inequality  has separate cases for $D_k$-cells for
$k=1,2,3,$.
\end{calculation}

The $D_1$-cell inequality, after dividing through by the solid angle, becomes
the easy inequality:
\[
r^2 + 3 a_D \approx 0.257 \ge 0,\quad r = \sqrt2.
\]

The $D_2$-cell inequality, after dividing through by the dihedral angle, becomes
\[
 (r^2-h^2)/2 + 3 a_D (1-h/r)  + 3 b_D L(h) \ge 0, \quad h\in [1,r],\quad r = \sqrt2.
\]
This holds even if $r$ is as small as $1.34077$.

\begin{calculation}[local inequality]\guid{9627800748}
\end{calculation}

\begin{proof}[discussion.]
In the $D_4$-cell, the domain is
$y_i\in[2,\sqrt8]$, but we can restrict to $y_i\in[2,2.75]$ as follows.
If some edge has length greater than $2.75$, the simplex has
circumradius at least $1.375$.  Truncate at $1.375$, breaking the
simplex into $1$-, $2$-, and $3$-cells.
\end{proof}

\begin{calculation}[local inequality]\guid{6938212390}
\end{calculation}

\begin{proof}[discussion.]
The $D_3$-cell  has domain $y_i\in[2,\sqrt8]$ and
truncation $r=\sqrt2$, but the result holds for much smaller
truncation.  We can restrict to $y_i\in [2,2.75]$ by decreasing the
truncation to $1.375$ and breaking the $D_3$-cell into $1$-, $2$-cells.

If the circumradius is bigger than $1.35$, we can truncate at $1.35$, breaking
it into $1$- and $2$-cells.  (This trick doesn't seem to work for the standard Marchal
inequality for the Kepler conjecture.)
\end{proof}


The circumradius constraint in the $D_4$-cell inequality is not necessary.


\calcentry{Lemma~\ref{lemma:D-local}}{XRULQNO}{NL}{This is the main cell inequality that arises in the
proof of the strong dodecahedral conjecture.  It breaks into cases according to the type of cell
$k=2,3,4$.}

\chapter{Calculations}

\input{/tmp/ineqdoc}



