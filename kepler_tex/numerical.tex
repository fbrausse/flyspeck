% File started Jan 24, 2010.
%
\chapter{Numerical Methods}

\section{Linear Programming}

\section{Nonlinear Optimization}

\section{Graph Generation}

\section{Summary of Computer Calculations}

The following table gives a summary of the proofs in the book where
computer calculations have been used.  The table lists the lemma
number, gives a tracking number, indicates whether the calculation
involves nonlinear optimization (NL), linear programming (LP), or
graph generation (GR).  The table also gives a brief description of
the nature of the calculation.  The tracking number can be used to
search the internet for further details of the computer calculation.

% Chqpter: Packing

\calcentry{Lemma~\ref{lemma:MI}}{XHVKJFS}{NL}{This is Marchal's
  inequality for $k$-cells. It separates into cases according to
  $k\in\{0,1,2,3,4\}$.}

\calcentry{Lemma~\ref{lemma:cluster}}{SQMANBP}{NL}{This is the cell
  cluster estimate for clusters.  It separates into cases according to
  the number of blades.}

\calcentry{%Lemma~\ref{lemma:13-14},~
  Inequality~\eqn{eqn:disks}}{8550443271}{NL}{The inequality asserts
  the disjointness of disks on the unit sphere of variable radius
  $g(h)$.}

\calcentry{Inequality~\eqn{eqn:alin}}{7991525482}{NL}{This is a linear
  lower approximation to the area of a regular spherical $n$-gon.}

\calcentry{Inequality~\eqn{eqn:alin2}}{8540377696}{NL}{This is a
  linear lower approximation to the area of a regular spherical
  $n$-gon.}

% Chapter: Local Fan:

\calcentry{Inequality~\eqn{eqn:g''}}{2065952723}{NL}{This is a
  calculation of the sign of a second derivative to show that the
  function $\tau$ does not have a local minimum as a function of the
  edge lengths.  It initially appears to depend on six variables, but
  the dependence on three of the variables is linear and will be
  extremal at the endpoints.}

\calcentry{Inequality~\eqn{eqn:arc''}}{2158872499}{NL}{This is a
  calculation of the sign of a second derivative of $\arc$.  There are
  two cases.  It is an optimization problem in two variables.}

\calcentry{Lemma~\ref{lemma:triangle-free}}{MPWFVCK}{NL}{The main
  estimate holds for triangles.  There are four cases depending on the
  cardinality of $S$.  It is an optimization problem in three
  variables.}

\calcentry{Lemma~\ref{lemma:flat-exists}}{2986512815}{NL}{The function
  $\tau$ does not have a local minimum along the indicated curve.  It
  is an optimization problem in four variables.}

\calcentry{Lemma~\ref{lemma:quadrilateral-free}}{FVPVRZP}{NL}{The main
  estimate holds for quadrilaterals.  There are two cases according to
  whether there is a flat node.  When there is no flat node, it is an
  optimization in five variables.  When there is a flat node, there
  are further subcases $0,1,2$ according to the cardinality of $S$.
  Each subcase is an optimization problem in four variables.}

\calcentry{Lemma~\ref{lemma:pentagon-free}}{DAKGBMR}{NL}{The main
  estimate holds for pentagons.  There are two flat nodes, giving two
  cases according to whether the flat nodes are adjacent.  Each case
  has two two subcases $0,1$ according to the cardinality of $S$.
  Each subcase is an optimization problem in as many as five
  variables.}

\calcentry{Lemma~\ref{lemma:hexagon-free}}{INRCFAH}{NL}{The main estimate
  holds for pentagons.  There are several cases accordin to the
  configuration of flat nodes.  Depending on the case, there may be as
  many as seven variables.}




\calcentry{Lemma~\ref{lemma:face-size}}{UTIICTO}{NL}{A linear lower
  approximation to the function $\arc$ is computed.}

\calcentry{Lemma~\ref{lemma:D-local}}{XRULQNO}{NL}{This is the main cell inequality that arises in the
proof of the strong dodecahedral conjecture.  It breaks into cases according to the type of cell
$k=2,3,4$.}


%\begin{tabular}{llll}
%Lemma~\ref{lemma:face-size}&VEXKBSL&NL&A linear lower approximation to the function $\arc$ is computed.\\
%\end{tabular}


\section{inequalities listings}



\subsection{packings, general inequalities}

This appendix gives a summary of the nonlinear inequalities that have
been cited in the chapter on packings.  Information about the computer
verifications can be found at \cite{hales:2009:nonlinear}.


\begin{note}%XX
This book contains a number of nonlinear inequalities that have been
established by interval-arithmetic calculations by computer.  Some
of these interval arithmetic calculations are still in the process
of being verified.  The approach to the proof of the Kepler
conjecture described here is still work in progress.  A description
of the inequalities and their current status can be found
at~\cite{hales:2009:nonlinear}.
\end{note}


(Note that the following is an inequality in at most six variables; the most
difficult case to prove is that of a $4$-cell.)  Formulas for the
volumes and solid angles appear in Chapter~\ref{chapter:volume}.  An
explicit formula for the dihedral angle appears in
Chapter~\ref{part:trig}.


\begin{calculation}\label{calc:marchal}\guid{WJDLOCM}\guid{1025009205}\guid{3564312720}\rating{ZZ}
%% cc:mar are the k-cell estimates for non-cell clusters.
Define the function $M$ by equations (\ref{eqn:M}) and
(\ref{eqn:m-def}).  Define the function $\gamma(X,M)$ by equation
(\ref{eqn:gamma-def}).  If $X$ is a $0$, $1$, $2$, $3$, or $4$-cell,
then
\begin{displaymath}
\gamma(X,M)\ge 0.
\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:qtr}\guid{GLFVCVK}\guid{4869905472}\guid{2477216213}\guid{8328676778}\rating{ZZ}
Let $\gamma_L$ be given by Definition~\ref{def:gammaL}, $\op{wt}$ by
Definition~\ref{def:wt}, and $\beta$ by Definition~\ref{def:beta}.
If $X$ is any $k$-cell that is not a quater with $k\in\{2,3,4\}$,
then % gammaL is nonneg on quarters. cc:qtr
\begin{displaymath}
\gamma_L(X) \op{wt}(X) + \beta(e,X)\ge 0.
\end{displaymath} 
\end{calculation}

\begin{calculation}\label{calc:cc:2bl}\guid{FHBVYXZ}\guid{1118115412}\rating{ZZ}
Let $\gamma_L$ be given by Definition~\ref{def:gammaL}.  Let $X$ be
any quarter.  Let $Y$ be a $3$-cell that flanks it.  Then
\begin{displaymath}
\gamma_L(X)+\gamma_L(Y)\ge 0,
\end{displaymath}
% 2-leaf calculation, gammaL(fourcell)+gammaL(threecell) >=0. % cc:2bl:
\end{calculation}

\begin{calculation}\label{calc:cc:5bl}\guid{ZTGIJCF}\rating{ZZ}
Let
\begin{displaymath}
a= 0.0560305, \quad\text{and}\quad  b= -0.0445813.
\end{displaymath}
\begin{itemize}
\item \case{1821661595} A $4$-cell $X$ along a spine $e$ satisfies
\begin{displaymath}
\gamma_L(X)\op{wt}(X) + \beta(e,X) \ge a + b\,\op{azim}(X),
\end{displaymath}
\item \case{7907792228} The $2$-cell $X_2$ and two $3$-cells $X_1,X_3$
that flank it along a spine $e$ satisfy
\begin{displaymath}
\sum_{i=1}^3 \left(\gamma_L(X_i)\op{wt}(X_i) + \beta(e,X_i)\right)\ge a + b\,\sum_{i=1}^3\op{azim}(X_i).
\end{displaymath}
\end{itemize}
\end{calculation}

\begin{calculation}\label{calc:cc:disks}\guid{8550443271}\rating{ZZ}
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
If $h_1,h_2\in [1,\hm]$, then
\begin{displaymath}
\op{arc}(2h_1,2h_2,2) - g(h_1) - g(h_2)\ge 0.
\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:alin}\guid{7991525482}\rating{ZZ}
Let $L$ be given by Definition~\ref{def:L}.
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
Let
\begin{displaymath}
\op{reg}(a,k) = 2\pi - 2 k (\arcsin(\cos(a)\sin(\pi/k))).
\end{displaymath}
Then
\begin{displaymath}
\op{reg}(g(h),k) \ge c_0 + c_1 k + c_2 L(h),\quad
k = 3,4,\ldots,\quad 1\le h\le \hm,
\end{displaymath}
where
\begin{displaymath}c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 =
0.4754.\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:alin2}\guid{8540377696}\rating{ZZ}
Let $L$ be given by Definition~\ref{def:L}.
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
Let
\begin{displaymath}
\op{reg}(a,k) = 2\pi - 2 k (\arcsin(\cos(a)\sin(\pi/k))).
\end{displaymath}
Let
\begin{displaymath}a'=\arc(2,2,2\hm)-g(\hm) \approx
0.797.\end{displaymath} Then for $k=3,4,\ldots$,
\begin{displaymath}\op{reg}(a',k) \ge c_0 + c_1 k + c_2 L(1) +
c_3\end{displaymath}
where 
\begin{displaymath}c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 =
0.4754,\quad c_3 = 0.85.\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:shorts}\rating{ZZ}
The following calculations involve many cases that are enumerated by
computer code.
\begin{itemize}
\item \case{BIXPCGW} Let $Z$ be any cell-cluster along a spine $e$
with three leaves.  Then
\begin{displaymath}
\Gamma(Z)> 0.
\end{displaymath}
\item \case{QITNPEA} Let $Z$ be any cell-cluster along a spine $e$
with four leaves.  Then
\begin{displaymath}
\Gamma(Z)> 0.
\end{displaymath}
\end{itemize}
\end{calculation}




\section{Local Fan: listing}

\begin{calculation}\guid{2065952723}\rating{ZZ}\label{calc:Lexell}
%See Mathematica numerical calculation.
Let
\begin{displaymath}
g(s;a,b,c,e_1,e_2,e_3) = \sum_{i=1}^3 \dih_i(2,2,2,a+s,b,c) e_i,
\end{displaymath}
where $\dih_i$ is given by Definition~\ref{def:tau}.
Let $\Delta = \Delta(4,4,4,a^2,b^2,c^2)$.
Let primes denote derivatives with respect to the variable $s$.
Assume that
$e_i\in\leftclosed1,1+\sol_0/\pi\rightclosed$,  that
$a,b,c\in\leftclosed2/\hm,4\rightclosed$.
Then
\begin{equation}\label{eqn:calc:Lexell}
  \Delta (g'(0;a,b,c,e_1,e_2,e_3))^2 
- 0.01\Delta^{3/2}g''(0;a,b,c,e_1,e_2,e_3) > 0.
\end{equation}
(The factors of $\Delta$ clear the denominator in
(\ref{eqn:calc:Lexell}) to simplify the inequality to be proved.)
\end{calculation}

\begin{calculation}\guid{2158872499}\rating{ZZ}\label{calc:2der}
%% checked in Mathematica NMaximize
Let $y_1,y_2\in \leftclosed 2,2\hm\rightclosed$.  
\begin{itemize}
\item 
Let $g(t) = \arc(y_1,y_2+t,2)$.  Then $g''(0) < 0$.
Explicitly,
\begin{displaymath}
  g''(0) = \dfrac{
    -64 + 48y_1^2 - 12 y_1^4 + y_1^6 
  + 80 y_2^2 - 8 y_1^2 y_2^2 - 3 y_1^4 y_2^2
    - 12 y_2 ^4 + 3 y_1^2 y_2^4 - y_2^6
  }{y_2^2 \sqrt{\ups(y_1^2,y_2^2,4)}^3}
\end{displaymath}
and the polynomial in the numerator takes negative values on the given
domain.
\item
Let $g(t) = \arc(y_1+t,y_2-t,2)$.  Then $g''(0) < 0$.
Explicitly,
\begin{displaymath}
  g''(0) = \dfrac{\sqrt{\ups(y_1^2,y_2^2,4)} \left(
      -4 y_1^2 + y_1^4 - 4y_1^3 y_2 - 4y_2^2 
   + 6 y_1^2 y_2^2 - 4 y_1 y_2^3 +y_2^4
    \right)}{y_1^2 y_2^2 (2+y_1-y_2)^2 (2+y_2-y_1)^2}
\end{displaymath}
and the polynomial in the numerator takes negative values on the given
domain.
\end{itemize}
\end{calculation}

\begin{calculation}\guid{2986512815}\rating{ZZ}\label{calc:cc:qua}  %m11
Let $y_1y_2,y_3,y_7\in \leftclosed 2,2\hm\rightclosed$,
$y_5,y_8,y_9\in \{2,2\hm\}$, $y_4,y_6\ge 2\hm$.
Let $x_i = y_i^2$.
Assume that
\begin{displaymath}
\Delta(x_1,x_2,x_3,x_4,x_5,x_6)>0,\quad{ and }
\Delta(x_3,x_2,x_7,x_9,x_8,x_4)>0.
\end{displaymath}
Assume that
\begin{displaymath}
\dih(y_3,y_1,y_2,y_6,y_4,y_5)+\dih(y_3,y_2,y_7,y_9,y_8,y_4) < \pi
\end{displaymath}
and\footnote{If $\{\v_1,\ldots,\v_4\}$ is a set of vectors such that
$y_i = \normo{\v_i}$ and $y_{ij} = \norm{\v_i}{\v_j}$, then
$\op{cross}(y_4,\ldots,y_{12}) = \norm{\v_2}{\v_4}$.}
\begin{displaymath}
\op{cross}(y_1,y_2,y_3,y_4,\ldots,y_9) \ge y_4.
\end{displaymath}
Let 
\begin{displaymath}g(t;y_1,\ldots,y_9) =
  \tau_{tri}(y_1,y_2,y_3,y_4+t,y_5,y_6)+\tau_{tri}(y_3,y_2,y_7,y_9,y_8,y_4+t).
\end{displaymath}
Then \begin{displaymath}g'(0)^2 - 0.01 g''(0) > 0.\end{displaymath}
\end{calculation}


\begin{calculation}\guid{EFJSUSK}\rating{ZZ}\label{calc:irred} %cc:tau
%%cc:par
Let $(V,E,F,G)$ be an irreducible minimal fan with parameters
$(r,s)$.  Then $\tau(V,E,F) \ge d(r,s)$.  (A separate calculation
has been made for each of the cases in the list given above.)
% Interval arithmetic
% calculations~ %% cc:par partition cases for tau[r,s].
\end{calculation}










%\begin{calculation}\guid{5779862781}\rating{ZZ}\label{calc:cc:d2a}
%  Let $y_5,y_6\in \{ 2,2\hm\}$, $y_1,y_2,y_3\in \leftclosed
%  2,2\hm\rightclosed$, and $y_4\in \leftclosed 2,4\hm\rightclosed$.
%  Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.  If
%  $\Delta(y_1^2,y_2^2,\ldots,y_6^2)> 0$ and if $ g'(0)=0, $ then
%  $g''(0)<0$.\footnote{The function $g(t)$ may fail to be
%    differentiable at $t=0$ for parameters $y_1,\ldots,y_6$ for which
%    $\Delta(y_1^2,\ldots,y_6^2)=0$.  Thus, it is necessary to work on
%    the noncompact domain $\Delta>0$ for this inequality.}
%%  (The proof is an interval arithmetic calculation over a
%%  four-dimensional space~cc:d2a.  %%cc:d2a
%%  The calculation verifies that the second derivative is negative
%%  whenever the derivative is zero.)
%\end{calculation} 
%

%\begin{calculation}\guid{6645853705}\rating{ZZ}\label{calc:cc:d2b}
%  Let $y_5\in \{2,2\hm\}$, $y_1,y_2,y_3\in \leftclosed
%  2,2\hm\rightclosed$, and $y_4\in \leftclosed 2,4\hm\rightclosed$.
%  Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.  If
%  $\Delta(y_1^2,y_2^2,\ldots,y_6^2)> 0$, if
%\begin{displaymath}
%\arc(y_1,2\hm,2) + \arc(y_2,2\hm,2) 
%\le y_6 \le \arc(y_1,2,2\hm)+\arc(y_2,2,2\hm)
%\end{displaymath} 
%and if
%$
%g'(0)=0,
%$
%then $g''(0)<0$.
%\end{calculation}
%
%\begin{calculation}\guid{5606476569}\rating{ZZ}\label{calc:cc:qua}
%Let $y_{12},y_{23},y_{34},y_2,y_3\in\{2,2\hm\}$.
%Let $y_1,y_4\in \leftclosed 2,2\hm\rightclosed$.
%Let $y_{14}\in\leftclosed 2\hm,y_1+y_4\rightclosed$.
%Let $y_{13}\in\leftclosed 2\hm,y_1+y_3\rightclosed$.
%Let $g(t) = \tau_{tri}(y_1+t,y_2,y_3,y_4,y_5,y_6)$.
%If 
%\begin{displaymath}
%\Delta(y_1^2,y_2^2,y_3^2,y_{23}^2,y_{13}^2,y_{12}^2)> 0 \text{ and }
%\Delta(y_1^2,y_4^2,y_3^2,y_{43}^2,y_{13}^2,y_{14}^2)> 0,
%\end{displaymath} 
%if\footnote{If $\{\v_1,\ldots,\v_4\}$ is a set of vectors such that
%  $y_i = \normo{\v_i}$ and $y_{ij} = \norm{\v_i}{\v_j}$, then
%  $\op{cross}(y_4,\ldots,y_{12}) = \norm{\v_2}{\v_4}$.}
%\begin{displaymath}
%\op{cross}(y_4,y_1,y_3,y_{13},y_{34},y_{14},y_2,y_{23},y_{12})\ge y_{13},
%\end{displaymath}
%and if
%$
%g'(0)=0,
%$
%then $g''(0)<0$.
%\end{calculation}
%
