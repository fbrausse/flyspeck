% file started March 22, 2009




\chapter{Formulation}

\section{Statement}



\begin{theorem}\guid{IJEKNGA}[Sphere Packing Problem (Kepler Conjecture)]
\label{theorem:kepler}   No packing of congruent balls in
Euclidean three space has density greater than that of the
face-centered cubic packing.
\end{theorem}

\begin{remark}
This density is $\pi/\sqrt{18}\approx 0.74.$  There are other
packings, such as the hexagonal close packing, that attain this
same density.
\end{remark}

The proof of this result is presented in this book. Here, we
describe the top-level outline of the proof and give references to
the sources of the details of the proof.

By a {\it packing}, we mean an arrangement of congruent balls that
are nonoverlapping in the sense that the interiors of the balls are
pairwise disjoint. Consider a \indy{Index}{packing} packing of congruent
balls in Euclidean three space. There is no harm in assuming that
all the balls have unit radius. 

The density of a packing does not
decrease when balls are added to the packing. Thus, to answer a
question about the greatest possible density we may add
nonoverlapping balls until there is no room to add further balls.
Such a packing will be said to be {\it saturated}.

 \indy{Index}{saturated}
 \indy{Index}{overlap}

Let $\Lambda$ be the set of centers of the balls in a
packing. Our choice of radius for the
balls implies that any two points in $\Lambda$ have distance at
least $2$ from each other. We call the points of $\Lambda$ {\it
\indy{Index}{vertex} vertices}.
%A bijection
%$\varph:\ring{N}\to\Lambda$ is called an {\it enumerated\/}
%packing.

%\begin{lemma}\guid{DQLSGKR} A saturated packing $\Lambda$ is countably infinite.  Hence,
%there exists a bijection $\varphi:\ring{N}\to\Lambda$.
%\end{lemma}

%\begin{proof}  If $\Lambda$ is finite, there is room to add a ball
%far from the finite cluster $\Lambda$, so $\Lambda$ is not
%saturated.

%The map $\Lambda\to\ring{Z}^3$, $$(x,y,z)\mapsto (\lfloor 2x
%\rfloor, \lfloor 2y \rfloor, \lfloor 2z \rfloor)$$ is a one-one
%map from $\Lambda$ into a countable set.  Hence $\Lambda$ is
%countable.
%\end{proof}


  Let $B(p,r)$ denote the open ball in
Euclidean three space at center $p$ and radius $r$.  The open ball
is measurable, with measure $4\pi r^3/3$.



Let $\delta(\Lambda,p,r)$ be the finite density, defined as the
ratio of the volume of $B(\Lambda,p,r)$ to the volume of $B(p,r)$,
where $B(\Lambda,p,r)$ is defined as the intersection with
$B(p,r)$ of the union of all balls in the packing. Set
$\Lambda(p,r) = \Lambda \cap
B(p,r)$ and $\Lambda^*(p,r) = \Lambda(p,r)\setminus \{p\}$.
\indy{Greek}{ZZdelta@$\delta(\Lambda,p,r)$}
\indy{Greek}{ZZLamda@$\Lambda(p,r)$}
\indy{Greek}{ZZLamda@$\Lambda^*(p,r)$}

\begin{lemma}\guid{KIUMVTC}\rating{80}\label{lemma:Lambda-finite}
Let $\Lambda$ be a packing and let $p\in\ring{R}^3$.
Then the set $\Lambda(p,r)$ is finite.
\end{lemma}

\begin{proof}  Let $p = (p_x,p_y,p_z)$. The map
$$v=(v_x,v_y,v_z)\mapsto (\lfloor 2(v_x-p_x)
\rfloor, \lfloor 2(v_y-p_y) \rfloor, \lfloor 2(v_z-p_z) \rfloor)$$
is a one-one map from $\Lambda(p,r)$ into the set $\ring{Z}^3\cap B(0,2
r
 + 1)$.  By Lemma~\ref{lemma:Zcount}, this gives a one-to-one map
 into a finite set, hence $\Lambda(p,r)$ is finite.
\end{proof}


\begin{definition}[Voronoi~cell,~$\Omega$]\label{def:voronoi}\indy{Index}{Voronoi cell} Voronoi cell
$\Omega(v)=\Omega(\Lambda,v)$\indy{Greek}{ZZzomega@$\Omega(v)$} around a
vertex $v\in \Lambda$ is the set of points closer to $v$ than to
any other ball center. 
% Let $\Omega_t(\Lambda,v) = \Omega(\Lambda,v)
%\cap B(v,t)$ be the truncated Voronoi cell at radius $t$.
\end{definition}

\begin{lemma}\guid{DRUQUFE}\label{80} Let $\Lambda$ be a saturated packing and let $t>0$.
Each Voronoi cell $\Omega(\Lambda,v)$, for $v\in\Lambda$, is
convex, open, bounded, and measurable.
\end{lemma}

\begin{proof}  This is elementary.
\end{proof}

\begin{definition}[negligible]\label{def:negligible}
Let $A:\Lambda\to\R$ be a function.  We say that $A$\indy{Index}{Az@$A$}
is
  {\it negligible\/}\indy{Index}{negligible}
if there is a constant $C_1$ such that for all $r\ge1$ and all
$p\in\ring{R}^3$,
   $$\sum_{v\in\Lambda(p,r)} A(v) \le C_1 r^2.$$
We say that the function $A:\Lambda\to\R$ is
  {\it fcc-compatible\/}\indy{Index}{fcc-compatible}
if for all $v\in\Lambda$ we have the inequality
$$\sqrt{32}\le \op{vol}(\Omega(v)) + A(v).$$
\end{definition}





\begin{remark}
The value $\op{vol}(\Omega(v)) + A(v)$ may be interpreted as a
{\it corrected\/} volume\indy{Index}{corrected volume} of the Voronoi
cell. Fcc-compatibility asserts that the corrected volume of the
Voronoi cell is always at least the volume of the Voronoi cells in
the face-centered cubic and hexagonal-close packings.
\end{remark}

%\begin{remark} In \cite{Hales:2006:DCG}, the full Voronoi cell $\Omega(v)$
%is used, rather than $\Omega(v)$.  The truncation at radius $2$
%is just a matter of convenience to guarantee the boundedness
%and hence the finite volume of the (truncated) Voronoi cell.
%In \cite{Hales:2006:DCG}, the same effect was achieved by requiring all packing%s
%to be saturated.  We have dropped the assumption of saturation
%on $\Lambda$.
%\end{remark}


\begin{lemma}\guid{JGXZYGW}\label{150}
\label{lemma:deltabound} If there exists a \indy{Index}{negligible}
negligible \indy{Index}{fcc-compatible} fcc-compatible function
$A:\Lambda\to\R$ for a 
%saturated 
packing $\Lambda$, then there
exists a constant $C$ such that for all $r\ge1$ and all
$p\in\ring{R}^3$,
    $$
    \delta(\Lambda,p,r)
    \le \pi/\sqrt{18} + C/r.
    $$
The constant $C$ depends on $\Lambda$ only through the constant
$C_1$ of Definition~\ref{def:negligible}.
\end{lemma}



\begin{proof}
The numerator $\op{vol}\, B(\Lambda,p,r)$ of $\delta(\Lambda,p,r)$
is at most the product of the volume of a ball $4\pi/3$ with the
number $\card(\Lambda(p,r+1))$ of balls intersecting $B(p,r)$.  Hence
    \begin{equation}
    \op{vol}\, B(\Lambda,p,r) \le \card(\Lambda(p,r+1)) 4\pi/3.
    \label{eqn:Abound}
    \end{equation}

%In a %saturated packing 
Each truncated Voronoi cell is contained in a ball of
radius $2$ centered at the {\it center} of the cell.  The volume
of the ball $B(p,r+3)$ is at least the combined volume of 
truncated Voronoi
cells whose center lies in the ball $B(p,r+1)$. This observation,
combined with fcc-compatibility and negligibility, gives
    \begin{equation}
    \begin{split}
    \sqrt{32}\card(\Lambda(p,r+1))
    &\le \sum_{v\in\Lambda(p,r+1)} (A(v) +
    \op{vol}(\Omega(v))) \\
    &\le C_1 (r+1)^2 + \op{vol}\,B(p,r+3) \\
    &\le C_1 (r+1)^2 + (1+3/r)^3 \op{vol}\,B(p,r)
    \label{eqn:Bbound}
    \end{split}.
    \end{equation}
Recall that $\delta(\Lambda,p,r)=
\op{vol}\,B(\Lambda,p,r)/\op{vol}\,B(p,r)$. Divide Inequality
\ref{eqn:Abound} through by $\op{vol}\,B(p,r)$.  Use
Inequality~\ref{eqn:Bbound} to eliminate $\card(\Lambda(p,r+1))$ from the
resulting inequality.  This gives
    $$\delta(\Lambda,p,r)
        \le \frac{\pi}{\sqrt{18}} (1+3/r)^3 + C_1 \frac{(r+1)^2}{r^3\sqrt{32}}.
    $$
The result follows for an appropriately chosen constant $C$.
\end{proof}

\begin{remark} \label{remark:precise}
We take the precise meaning of the packing problem to be the
bound $\delta(\Lambda,p,r) \le \pi/\sqrt{18} + C/r$ of the lemma.
Thus, the solution to the packing problem follows, provided a negligible
fcc-compatible function can be found. The strategy will be to
define a negligible function, and then to solve an optimization
problem in finitely many variables to establish that it is
fcc-compatible.
\end{remark}

If $\Lambda$ is a %saturated 
packing, we have an ordered pair
$(\Lambda,v)$ for each vertex $v\in\Lambda$.  The pairs
$(\Lambda,v)$ are called {\it centered packings}.



\section{Rogers's partition}

\begin{definition}[saturated packing]
A packing $\Lam\subset \ring{R}^3$ is a set such that
$$\forall \lam~\mu\in \Lam.~  \norm{\lam}{\mu} < 2 \Rightarrow (\lam=\mu).$$
The packing is saturated if for every $v\in\ring{R}^3$,   there exists $\lam\in\Lam$
such that $\norm{\lam}{v}\le 2$.
\end{definition}

%We think of $\Lam$ as the set of centers of a  packing of congruent balls of radius $1$. To be saturated means that there is no room for further balls to be added to the packing. There is no loss in generality in assuming that the packing is saturated, when searching for the greatest possible density of a packing.

Given a packing $\Lam$, Rogers gives a partition of Euclidean space into
simplices with vertices at $\Lam$ \cite{Rogers:1958:Packing}.   This section describes his partition.

Let $\Omega(\lam)$  be the closed Voronoi cell centered at $\lam$:
$$
  \Omega(\lam) = \{p \mid  \norm{p}{\lam} 
\le \norm{p}{\mu},\ \lam\ne\mu\in\Lam\}.
$$
If $S\subset\Lam$, let $\Omega(S)$ be the intersection of the family:
$$\Omega(S)  = \bigcap \{\Omega(\lam)\mid \lam\in S \}.$$
We call $\Omega(S)$ the $S$-face of $\Omega(\lam)$, when $\lambda\in S$.

For $X\subset\ring{R}^3$, we let $\dim(X)$ be the dimension of the affine hull
of $X$: $\dim(X) = \dim(\op{aff}(X))$.

If $\bl=(\lam_0,\ldots,\lam_k)$ and $j\le k$ write $\bl[j] = (\lam_0,\ldots,\lam_j)$.
Let $\Lam(k)$ be the set of $k+1$-tuples $\bl=(\lam_0,\ldots,\lam_k)$, with
$\lambda_i\in\Lambda$ such
that 
\begin{equation}\label{eqn:omega-dim}
\dim(\Omega(\bl[j])) = 3-j,
\end{equation}
for all $0<j\le k$.
In particular, $\Lam(0)=\Lam$.  Also, $\Lam(1)$ is the
set of all pairs $(\lam,\mu)$ such that the Voronoi cells at $\lam$ and $\mu$ meet along
a face of codimension $1$, and
so forth.


Define $v(\bl)$ recursively on $\Lam(k)$ by
$$v(\lam[0]) = \lam[0]$$
and $v(\lam[j+1])$ is the closest point on $\Omega(\lam[j+1])$ to $v(\lam[j])$.  The point is defined whenever $\Omega(\lam[j+1])$ is nonempty.
The set $\Omega(\lam[j+1])$ is convex and compact.  Thus, the point $v(\lam[j+1])$ exists
uniquely.

For $\bl\in\Lam(k)$, let 
$$R(j,\bl) = \op{conv}\{v(\lam[j]), v(\lam[j+1]),\ldots,v(\lam[k])\}.$$  Set $R(\bl)=R(0,\bl)$.


\begin{lemma}\guid{GLTVHUM}\rating{200}
For any saturated packing $\Lambda$, we have
$$\ring{R}^3 = \bigcup \{ R(\bl) \mid \bl\in \Lam(3)\}.$$
\end{lemma}

\begin{proof}
We have $$\ring{R}^3 = \bigcup \{\Omega(\lam)\mid \lam\in \Lam(0)\}.$$
So it is enough to show that
$$\Omega(\bl[0]) = \bigcup \{ R(\bl') \mid \bl'\in \Lam(3),~\bl[0]=\bl'[0]\}.$$
We have
$$\Omega(\bl[0]) = \bigcup \op{conv}(v(\bl[0]),\{\Omega(\bl[1])\mid \bl[1]\in \Lam(1)\}).$$
So it is enough to show that
$$\Omega(\bl[1]) = \bigcup \{ R(1,\bl') \mid \bl'[1]=\bl[1],~\bl'\in \Lam(3)\}.$$
Repeating, it is enough to show that
$$\Omega(\bl[3]) = \bigcup\{R(3,\bl')\mid\bl'[3]=\bl[3],~\bl'\in\Lambda(3)\}.$$
The right-hand side is the singleton $\{v(\bl[3])\}$.  The left-hand side
contains this point and is contained in a properly decreasing chain of affine spaces:
$\ring{R}^3$, the bisector of $\lam_0$ and $\lam_1$, and so forth.  This determines a point,
so the two sides are equal.
\end{proof}

\begin{lemma}\guid{DUUNHOR}\rating{140}  
The intersection of any two distinct $R(\bl)$ and $R(\bm)$ is contained in a plane (hence has measure zero).
\end{lemma}

Combined with the previous lemma, we see that the simplices $R(\bl)$ partition Euclidean
space.

\begin{proof}  Let $\bl = (\lambda_0,\ldots)$ and $\mu = (\mu_0,\ldots)$.
If $\lambda_0\ne\mu_0$, the intersection of the simplices lies in $\Omega(\lam_0,\mu_0)$
and we are done.  Let $k+1$ the first index such that
$$\op{conv}(v(\lam_0),\ldots,v(\lam_0,\ldots,\lam_{k+1}))\ne
\op{conv}(v(\mu_0),\ldots,v(\mu_0,\ldots,\mu_{k+1})).
$$
By induction $\Omega(\lam_0,\ldots,\lam_k) = \Omega(\mu_0,\ldots,\mu_k)$
but
$$\Omega\lam_0,\ldots,\lam_{k+1}) \ne \Omega(\mu_0,\ldots,\mu_{k+1}).$$
The intersection lies in the convex hull $C$ of
$\{v(\lam_0),\ldots,v(\lam_0,\ldots,\lam_k)\}$ and
$V=\Omega(\lam_0,\ldots,\lam_{k+1},\mu_{k+1})$.  The set $V$ lies in an affine space of 
codimension $k+2$
and $C$ has codimension $(k+2) - (k+1) = 1$.
\end{proof}

\begin{lemma}\guid{XNHPWAB}\rating{500}\label{lemma:v2} Let $\bl=(\lam_0,\ldots,\lam_3)\in\Lambda(3)$ and fix $0\le j\le 3$.  Assume that
$$
\norm{v(\bl[j]) }{ v(\bl[0])} < \sqrt2.
$$
Then $v(\bl[j])$ is the circumcenter of the points $S_j =\{\lam_0,\ldots,\lam_j\}$ and
lies in the convex hull of $S_j$.  The points $v(\bl[j])$, for $j=0,1,2,3$, are distinct.
\end{lemma}

\begin{proof} By definition, an element $\bl\in\Lambda(3)$ gives dimensions: 
$$\dim\Omega(\lam_0,\ldots,\lam_j) = 3-j.$$  The case $j=0$ of the lemma is trivially
satisfied.  Assume by induction the result holds for numbers less than $j$.

Now $j>0$.
The circumcenter $p=p_{j}$ of the set $S_{j}$ is the point on the plane $\op{aff}(S_{j})$
closest to $p_{j-1}=v(\bl[j-1])$.  We claim that $p$ lies in $\Omega(S_{j})$.  Otherwise
there is a point $\mu\in\Lambda$ closer to $p$ than any $\lambda\in S_{j}$.  
The angles $\angle{p}{\mu}{\lam_i}$ are obtuse for $i\le j$:
$$
\norm{p}{\mu} < \sqrt2,\quad \norm{p}{\lambda_1} <\sqrt2,\quad \norm{\mu}{\lambda_1} \ge 2.
$$  
We make a case-by-case
argument for each $j$.

If $j=1$, the points $p,\lam_0,\lam_1$ are collinear and cannot give two obtuse angles.

If $j=2$, let $\mu'$ be the projection of $\mu$ to the plane containing
$p,\lam_0,\lam_1,\lam_2$. The four points $\mu',\lam_0,\lam_1,\lam_2$ can be arranged
cyclically around $p$, each forming an obtuse angle with the next.  A circle around $p$
cannot give four obtuse angles.


If $j=3$, assume that $\lam_0,\ldots,\lam_3$ are labeled in cyclic order around the line
$\op{aff}\{p,\mu\}$.  Consider the dihedral angle 
  $$
  \gamma=\gamma_i=\dih(\{p,\mu\},\{\lam_i,\lam_{i+1}\}).
  $$
By the law of cosines the angle $\gamma$ is given in terms of the edges of the spherical
triangle $a,b,c$ by
$$
  \cos c - \cos a \cos b = \sin a \sin b \cos \gamma.
$$
All the terms on the left-hand side are negative, so $\gamma =\gamma_i > \pi/2$.
This is impossible, as the sum of the four dihedral angles $\gamma_i$ is $2\pi$.
This completes the proof that $v(\bl[j])$ is the circumcenter.

Next we show that this point lies in the convex hull of $S_j$.
If $j=0$, there is nothing to show.  If $j=1$, the point is the midpoint of the convex hull.
If $j=2$, the point is the circumcenter of an acute triangle.  If $j=3$, the point is the
circumcenter of a simplex such that every face has positive orientation.  Thus,
in every case the point lies in the convex hull.

The distances $\norm{v(\bl[j])}{v(\bl[0])}$ are increasing, so it is enough to show
that $v(\bl[j])\ne v(\bl[j+1])$.  If we had equality, then the circumcenter $v(\bl[j])$
would have an equally close packing point $\lambda_{j+1}\in\Lambda$, which is impossible by the first part of the proof.
\end{proof}

\begin{note}%XX
The concept of {\it positive orientation} is used in the proof.  This is discussed in the 1998 proof and in {\it Lemmas in Geometry}.  If a face has circumradius less than $\sqrt2$ it has positive orientation.  If every face has positive orientation, then the circumcenter of the simplex is contained in its convex hull.
\end{note}

\begin{lemma}\guid{YIFVQDV}\rating{140}   
Let $\bl\in\Lambda(k)$.  Assume that $\norm{v(\bl)}{v(\bl[0])}<\sqrt2$. Let $\bm$ be any permutation of the components of $\bl$.  Then $\bm\in\Lambda(k)$ and  $v(\bl) = v(\bm)$.
\end{lemma}

\begin{proof} 
Since the sets $\Omega(\bl[j])$ satisfy (\ref{eqn:omega-dim}), we have that
$\Omega(\bl)\cap \op{conv}\{\lambda_0,\lambda_j\}$ is a point consisting of the singleton $\{v(\bl)\}$, which is the
circumcenter of the simplex with vertices $\{\lam_0,\ldots,\lam_k\}$.  This describes
the point $v(\bl)$ in a way that is independent of the permutation.

We check that the condition (\ref{eqn:omega-dim}) holds for the permutation $\mu$.
The proof of Lemma~\ref{lemma:v2} shows that the midpoint of $\op{conv}(\mu_0,\mu_1)$
lies in $\Omega(\bm[1])$ and since the inequalities are strict, some neighborhood
of this midpoint in the bisecting plane of $\{\mu_0,\mu_1\}$ lies in $\Omega(\bm[1])$.
Thus, $\dim(\Omega(\bm[1]))=2$.  We continue in this fashion, showing that each dimension
$\dim(\Omega(\bm[j]))$ drops by exactly one.
\end{proof}

\begin{lemma}\guid{WQPRRDY}\rating{400}\label{lemma:Rconv} Let $\bl = (\lam_0,\ldots,\lam_k)\in\Lambda(k)$.  Assume that $\norm{v(\bl)}{v(\bl[0])}<\sqrt2$.
For any permutation $\pi$, let $\pi(\bl)\in\Lam(k)$ be the permuted entry.  Let
$S(k)$ be the group of all permutations on $k+1$ letters.   Then
$$
\op{conv}\{\lam_0,\ldots,\lam_k\} = \bigcup \{ R(\pi(\bl)) : \pi\in S(k)\}.
$$
\end{lemma}

\begin{proof} Let $L = \{\lam_0,\ldots,\lam_k\}$.  We prove it by induction on $k$.
When $k=0$, the result is trivial.  Now assume $k>0$.

The circumcenter $v(\bl)$ of $L$ lies in the convex hull of these
point (see the proof of Lemma~\ref{lemma:v2}).  Thus, the left-hand side is the union
of the cones over the (k+1)-faces:
$$
\op{conv}(S) = \bigcup\{ \op{conv}(v(\bl),L\setminus \{\lam_i\}\mid i=0,\ldots,k) \}.
$$
The sets $L\setminus \{\lam_i\}$ can be identified with  cosets of $S(k)/S(k-1)$.
By induction $L\setminus \{\lam_i\}$ is the union of $R(\bm)$ as $\bm$ runs
over all permutations $S(k-1)$ of $L\setminus \{\lam_i\}$.
The result follows by induction.
\end{proof}

We remark that the Rogers's simplices $R(\bl)$ are compatible with the Voronoi
decomposition of space (by construction).  Also, by Lemma~\ref{lemma:Rconv}, under
mild restrictions on the circumradius, they can also be reassembled into simplices
with vertices at the centers of the packing (the Delaunay simplices).  

\section{Marchal's partition}

C, Marchal has introduced a new approach to the Keper conjecture that is manifestly superior to the one in~\cite{Hales:2006:DCG}.  If his approach can be pushed
to completion, it would cut years off the Flyspeck project.  The definition of $k$-cells, Conjecture~\ref{conj:m1}, Theorem~\ref{theorem:mk1}, and the method of Lemma~\ref{lemma:13-14} are all due to him.

His articles claim to give
a {\it demonstration} of the Kepler conjecture \cite{marchal:2007}, \cite{marchal:2008}.  However, the
mathematically rigorous part of the article only gives a reduction
of the problem to an optimization problem in a finite number of
variables.  The method of gradient descent is then used to explore
the local minima of the optimization problem in finitely many variables.

Marchal's partition of space is a variant of Rogers's partition into simplices
$R(\bl)$.  The main part of construction is 
the decomposition obtained by truncating the Voronoi cells
by a ball of radius $\sqrt2$.  In a few carefully chosen situations he assembles the simplices
into a larger convex hull along the lines of Lemma~\ref{lemma:Rconv}.

Let $h(\bl[i]) = \norm{v(\bl[i])}{\lam_0}$.  The numbers $h(\bl[i])$ are increasing with $i$.

\begin{definition} Consider $\bl=(\lam_0,\ldots,\lam_3)\in \Lambda(3)$.
\hfill\break\smallskip  
{\bf The $0$-cell} of $\bl$ is
$$
\cell(\bl,0) = \{x\in R(\bl) \mid \norm{v(\lam_0)}{x} > \sqrt2\}.
$$
\bigskip
{\bf The $1$-cell} of $\bl$ is 
$$
\cell(\bl,1) = \op{conv}(v(\lam_0),T_1),\hbox{ where } T_1 = \{x \in R(\bl) \mid \norm{v(\lam_0)}{x}= \sqrt2\}.
$$
\bigskip
{\bf The $2$-cell} of $\bl$ is
$$
\begin{array}{rll}
\cell(\bl,2) &= \op{conv}(\lambda_0,\lambda_1,T_2),\quad \\
  T_2 &= \{x \in R(\bl)\cap \Omega(\bl[1]) \mid \norm{\lam_0}{x}=\norm{\lam_1}{x} =\sqrt2\}.
\end{array}
$$
\bigskip
{\bf The $3$-cell} of $\bl$ is defined to be empty unless 
$$
h(\bl[2]) <\sqrt2 \le h(\bl[3]).
$$
When this inequality holds,
there is a a unique point $p(\bl[2])$ in
$\op{conv}(\bl[2],\bl[3])$ at distance exactly $\sqrt2$ from $\lam_0$.  
Define the $3$ cell to be
$$
\cell(\bl,3) = \op{conv}\{\lam_0,\lam_1,\lam_2,p(\bl[2])\}.
$$
\bigskip
{\bf The $4$-cell} of $\bl$ is defined to be empty unless
$$
h(\bl[3]) <\sqrt2.
$$
When this inequality holds, define the $4$ cell to be
$$
\cell(\bl,4) = \op{conv}\{\lam_0,\lam_1,\lam_2,\lam_3\}.
$$
\end{definition}

Note the the $0$ and $1$-cells are always subsets of $R$.  However, the $2$, $3$, and
$4$-cells are finite unions of Rogers simplices.

\begin{lemma}\guid{RVFXXBU}\rating{400}  The $0,\ldots,4$-cells of all Rogers simplices $R(\bl)$, for $\bl\in \Lam(3)$
give a partition of $\ring{R}^3$.  An $i$-cell is never equal to a $j$-cell when $i\ne j$. For $k\ge 2$, 
two $k$-cells $\cell(\bl,k)=\cell(\bm,k)$ are equal exactly when $\bl[k-1]$
is a permutation of $\bm[k-1]$.
\end{lemma}

\begin{proof}  First we will prove that cells are either disjoint (up to a null set) or equal.  At the same
time, we determine when two $k$-cells are equal to one another.
By Lemma~\ref{lemma:Rconv}, the $4$-cell $\cell(\bl,4)$ is a union of the Rogers simplices
$R(\bm)$, as $\bm$ runs over permutations of $\bl$. 
 Two $4$-cells
that meet are equal. 
Every $4$-cell is a union of simplices
$R(\bl)$ with $h(\bl)<\sqrt2$.  This condition gives $\cell(\bl,i)=\emptyset$, for $i=0,1,2,3$.

Similarly, the $3$-cell is a union
of the convex hulls $\op{conv}(p(\bm[2]),R(\bm[2]))$ as $\bm[2]$ runs over permutations of $\bl[2]$.  Note that the point $p(\bm[2])=p(\bl[2])$ is independent of the permutation, since
it is determined as the point at distance $\sqrt2$ from $\lam_0$ along the line through
from $v(\bm[2])=v(\bl[2])$ perpendicular to the plane $\op{aff}\{\lam_0,\lam_1,\lam_2\}$
(in the half-space of $\bl[3]$). Two $3$-cells that meet are equal and come from parameters that are permutations of
one another as described.   The intersection $\cell(\bl,3)$ cannot meet $\cell(\bl,i)$, for $i<3$, in
a set of full dimension, because the plane $P(\bl[2])=\op{aff}\{\lam_0,\lam_1,p\}$ separates them.

The $2$-cell $\cell(\bl,2)$ is separated from the $0$ and $1$-cells $\cell(\bl,i)$
by the cone $P(\bl[1])$ with apex $\lam_0$
passing through $T_2$. The $1$-cell is separated from $0$-cells the the sphere $P(\bl[0])$
of radius
$\sqrt2$, centered at $\lam_0$.

Finally, we show that every point $x$ in $\ring{R}^3$ belongs to a cell.  By the Rogers
partition, the point $x$ belongs to a Rogers simplex $R(\bl)$.  If $h(\bl)<\sqrt2$, then
$x$ belongs to a $4$-cell.  Otherwise $x\in R(\bl)$ belongs to $\cell(\bl,i)$ according to
which side of the plane $P(\bl[2])$, cone $P(\bl[1])$, and sphere $P(\bl[0])$ the point
lies, as described above.
\end{proof}


\section{Kissing number estimates}

This section shows how Conjecture~\ref{conj:m1} would follow from an explicit estimate
related to the Gregory-Newton problem


We define the following constants and functions.  The first constant
is the area of a spherical triangle with sides $\pi/3$.
$$
\begin{array}{lll}
\Delta_0 &= 3\arccos(1/3)-\pi\\
\tau_0 &= 4\pi - 20\Delta_0\\
m_1 &= \Delta_0 2\sqrt2/\tau_0 = 1.012\ldots \\ %% K 
m_2  &= (6\Delta_0- \pi)\sqrt2/(6 \tau_0) = 0.0254\ldots\\ %% M 
M(h) = &=
\begin{cases}
 (\sqrt2-h) (h-1.3254) (9h^2 - 17 h + 3)/(1.627 (\sqrt2-1))& h\le\sqrt2\\
 0 & h >\sqrt2.
\end{cases}
\\
\end{array}
$$
We have 
\begin{equation}\label{eqn:km}m_1 - 12m_2 = \sqrt{1/2}\end{equation}
and
\begin{equation}M(1) = 1,\quad M(\sqrt2) =0\end{equation}


\begin{conjecture}[Marchal]\rating{600}\label{conj:m1} For any packing $\Lam$, and
any $\lam_0\in\Lam$, we have
$$
\sum_{(\lam_0,\lam_1)\in\Lam(1)} M(h(\lam_0,\lam_1)) \le 12.
$$
\end{conjecture}

\begin{theorem}\guid{KIZHLTL}\rating{300}\label{theorem:mk1}
Conjecture~\ref{conj:m1} implies the Kepler conjecture.
\end{theorem}

\begin{note}%XX
This book contains a number of nonlinear inequalities that have been established by interval-arithmetic calculations by computer.  The approach to the proof of the Kepler conjecture described here is still work in progress.  Some of these interval arithmetic calculations are still in the process of being verified.  A current description of the inequalities and their status can be found at~\cite{hales:2009:nonlinear}.
\end{note}

\begin{proof} 
We show that $A(\lam_0)  = -\op{vol}(\Omega(\lam_0)) + 8 m_1 - \sum 8 m_2 M(h(\bl))$ is fcc-compatible and negligeable.  The
result then follows from Lemma~\ref{lemma:deltabound}.  
This is fcc-compatible directly
by equation~(\ref{eqn:km})
and Conjecture~\ref{conj:m1}.  The issue is to prove it negligeable.  Explicitly, we need
to show there exists a constant  $C$ such that for all $r\ge 1$ and all $x\in\ring{R}^3$:
\begin{equation}\label{eqn:neg}
  \sum \op{vol}(\Omega(\lam)) -\sum 8m_1 + \sum \sum 8 m_2 M(h) \ge C r^2,
\end{equation}
where the outer sum runs over $\lam\in \Lam(x,r)$.

We may use Lemmas~\ref{lemma:Zr2} and \ref{lemma:Lambda-finite}, which show that the number of points of $\Lambda$ near the boundary of $B(p,r)$ is bounded by $C r^2$.

Let $V(X)$ be the set of extremal vertices of the $k$-cell $X$ in $\Lambda$.  Explicitly, $V(X)=\emptyset$ if $k=0$; and $V(X) = \{\lambda_0,\ldots,\lam_{k-1}\}$ in general.  Each $k$-cell is measurable and eventually
radial at each $\lam\in V(X)$.  We define the total solid angle of $X$ to be
$$
\op{tsol}(X) = \sum_{\lambda\in V(X)} \sol(X,\lambda).
$$

Let $E(X)$ be the set of extremal edges of the $k$-cell $X$ in $\Lambda$.  Explicitly, let 
$$E(X)=\{\{\lam_i,\lam_j\}\mid \lam_i\ne\lam_j\in V(X)\}.$$
In particular, the set is empty for $0$ and $1$-cells, and contains
$k\choose{2}$ pairs when $k\ge 2$.


The value
$\dih(X,e)$ of
of the basic dihedral angle indexed by $e\in E(X)$ is defined to be the dihedral angle along that edge
of the boundary.  
The (single) basic  dihedral angle of a $2$-cell is
the same as the radian angle subtended by the arc $T_2$ in the construction of $2$-cells.
The basic dihedral angles of a $3$ or $4$-cell are the dihedral angles along the given edge of the simplex $X$. 

Each element $e=\{\lam_i,\lam_j\}\in E(X)$ also determines
the real number $h(e) = \norm{\lam_i}{\lam_j}/2$.

For any function $f$ and any cell $X$, set
\begin{equation}\label{eqn:gamma-def}
\gamma(X,f) =  \op{vol}(X)
-\left(\frac{2m_1}{\pi}\right) \op{tsol}(X) + \left(\frac{8m_2}{\pi}\right)
\sum_{e\in E(X)} \dih(X,e)  f(h(e))
\end{equation}
We have the Marchal's fundamental estimate\cite[cc:mar]{hales:2009:nonlinear} for any cell $X$:  %% cc:mar are the k-cell estimates for non-supercells.
\begin{equation}\label{eqn:mfe}
\gamma(X,M)\ge 0.
\end{equation}
(Note that this is an inequality in at most six variables; the most difficult case to prove is that of a $4$-cell.)  The volumes and solid angles and so forth are given by the explicit formulas.

Sum the inequality~(\ref{eqn:mfe}) over all cells in a large ball $B(x,r)$ to get an
inequality of the form $T_1 + T_2 + T_3\ge 0$ for three sums $T_i = T_i(r)$.  We compare this term-by-term
with the three terms $T'_i(r)$ of the desired equation~(\ref{eqn:neg}). 
It is enough to show that
$$
T_i'(r) \ge T_i(r) + C_i r^2,
$$
for some constants $C_i$.
The sum of the volumes of the Voronoi cells $\lam\in B(p,r)$ is
the volume of $B(p,r)$, up to a boundary term coming from Voronoi cells
that are only partly contained in $B(p,r)$.  Similarly, the sum of
the various $k$-cells, for $X\subset B(p,r)$ is the volume of $B(p,r)$,
again up to a boundary term. The boundary effects have order $r^2$.
Thus,
$$
T_1'= \sum_{\lam\in B(p,r)} \op{vol}(\Omega(\lam)) \ge \sum_{X\subset B(p,r)} \op{vol}(X) + C_1 r^2 = T_1 + C_1 r^2.
$$
The estimates on the other terms are similar.  The solid angles
around each vertex sum to $4\pi$.
In Landau big O notation, this gives
$$
\begin{array}{lll}
\sum_{X\subset B(p,r)} \op{tsol}(X) &= 
\sum_{X\subset B(p,r)} \sum_{\lam\in V(X)} \sol(X,\lam)\\
 &=\sum_{\lam\in B(p,r)} \sum_{X\mid \lam\in V(X)} \sol(X,\lam)\\
 &=\sum_{\lam\in B(p,r)} 4\pi    + O(r^2),
\end{array}
$$
and
$$
T_2' = -\sum 8 m_1 = -\sum\left(\frac{2m_1}\pi\right) \op{tsol(X)} + C_2 r^2 = T_2 + C_2 r^2.
$$
Similarly, the dihedral angles around each edge sum to $2\pi$.  There is a factor of $2$ that enters when we switch from unordered pairs $\{\lam_0,\lam_1\}$ to ordered pairs $(\lam_0,\lam_1)$:
$$
\begin{array}{lll}
&\sum_{X\subset B(p,r)} \sum_{e\in E(X)} \dih(X,e)  M(h(e)) \\
&\qquad=\sum_{e\subset B(p,r)} \sum_{X: e\in E(X)} \dih(X,e)  M(h(e)) \\
 &\qquad=\sum_{e\subset B(p,r)} 2\pi M(h(e)) \\
 &\qquad=\sum_{\lam_0\in B(p,r)} \sum_{\lam_1\in B(p,r) } \pi M(h(\lam_0,\lam_1)) + O(r^2),\\
\end{array}
$$
and 
$$
T_3' = \sum\sum 8 m_2 M(h(\bl)) \ge \left(\frac{8m_2}\pi\right)
\sum\sum\dih(X,e) M(h(e)) + C_3 r^2 = T_3 + C_3 r^2.
$$
\end{proof}




\section{More kissing number estimates}

This section shows how to improve on the estimates of the previous section
by combining various cells into {\it supercells}.

\begin{definition}
Set
$$
\begin{array}{lll}
  h_0  &= 1.26\\  %%\hm
  h_+  &= 1.3254\\
\end{array}
$$
Let $L:[1,\sqrt{2}]\to\ring{R}^2$ be the linear function interpolating the
values:
$$
L(1) = 1\quad L(\hm) = 0.
$$
Let $h_- = 1.23175\ldots$ be the unique root of the quartic polynomial
$M(h)-L(h)$ lying in the interval $[1.2,1.3]$.
Define the function $M_2:\{h\mid h\ge 1\}\to\ring{R}$ by
$$
M_2(h) = \max(0,\min(M(h),L(h))) = 
\begin{cases}
  M(h) & h \in [1,h_-]\\
  L(h) & h \in [h_-,\hm]\\
  0 & h \ge \hm\\
\end{cases}
$$
\end{definition}

The function $M_2$ is continuous and piecewise smooth.  We have
$M_2(h)\ge M(h)$ except when $h\in [h_-,h_+]$.  The aim of this section is to prove a variant of Theorem~\ref{theorem:mk1} that uses the function $M_2$ rather than $M$.  For this, we need to combine cells into larger groups, called supercells.

\begin{definition}
Let $X$ be a $k$-cell, with $k\ge 2$.  Let $e\in E(X)$.
We say the edge is {\it critical} if $h(e)\in[h_-,h_+]$.
Let $X$ be a $k$-cell with a critical edge.  Let $E_c(X)\subset E(X)$
be the set of critical edges of $X$.  If $X$ is any cell such that
$E_c(X)$ is nonempty, let the weight $w(X)$ of $X$  
be $1/m$, where
$m$ is the cardinality of $E_c(X)$.
\end{definition}

\begin{definition}
Let $e\in E_c(X)$ be a critical edge of a $k$-cell for some $k\ge 1$.
A supercell is the set 
$$
\op{super}(e) = \{X\mid e\in E(X)\} 
$$
of all cells around $e$. If $Z$ is a finite set of cells, define
$$
\begin{array}{lll}
\Gamma_2(Z) &= \sum_{X\in Z} \gamma_2(X) w(X),\quad\hbox{ where }\\
\gamma_2(X) &= \gamma(X,M_2),
\end{array}
$$
and where $w(X)$ is the weight of $X$.

\end{definition}

\begin{theorem}\guid{OXLZLEZ}[supercell estimate]\rating{1500}\label{lemma:superineq} 
Let $Z$ be any supercell.  Then $\Gamma_2(Z)\ge 0$.
\end{theorem}

The proof of this theorem will occupy the rest of the section.  Before giving the proof, we give its relation to the Kepler conjecture.


\begin{conjecture}\label{conj:m2} For any packing $\Lam$, and
any $\lam_0\in\Lam$, we have
\begin{equation}\label{eqn:M12}
\sum_{\bl=(\lam_0,\lam_1)\in\Lam(1)} M_2(h(\bl)) \le 12.
\end{equation}
\end{conjecture}

\begin{theorem}\guid{UPFZBZM}\rating{300}\label{theorem:mk2}
Conjecture~\ref{conj:m2} implies the Kepler conjecture.
\end{theorem}

\begin{proof}  We imitate the proof of Theorem~\ref{theorem:mk1}.
It is enough to show that $A_2(\lam_0)  = -\op{vol}(\Omega(\lam_0)) + 8 m_1 - \sum 8 m_2 M_2(h(\bl))$ is fcc-compatible and negligeable. 
This is fcc-compatible directly
by equation~(\ref{eqn:km})
and Conjecture~\ref{conj:m2}.  The issue is to prove it negligeable.  Explicitly, we need
to show there exists a constant  $C$ such that or all $r\ge 1$ and all $x\in\ring{R}^3$:
\begin{equation}\label{eqn:A2neg}
  \sum \op{vol}(\Omega(\lam)) -\sum 8m_1 + \sum \sum 8 m_2 M_2(h) \ge C r^2,
\end{equation}

For cells $X$ that do not belong to a supercell,
the proof is just as in the proof of Theorem~\ref{theorem:mk1}.
If $E_c(X)=\emptyset$, then 
$M_2(h(e))\ge M(h(e))$ on each edge $e\in E(X)$, and
$$\gamma_2(X)=\gamma(X,M_2)\ge \gamma(X,M)\ge 0$$ 
by inequality (\ref{eqn:mfe}).

For supercells, we need Theorem~\ref{lemma:superineq}.
Again, using big O notation, we have
$$
\begin{array}{lll}
\sum_{X\subset B(p,r)} \gamma_2(X) &= 
\sum_{X\subset B(p,r)\mid E_c(X)\ne\emptyset} \gamma_2(X) +
\sum_{X\subset B(p,r)\mid E_c(X)=\emptyset} \gamma_2(X) \\
&\ge \sum_{X\subset B(p,r)\mid E_c(X)\ne\emptyset} \gamma_2(X) \\
&=\sum_{X\subset B(p,r)}\gamma_2(X)\sum_{e \in E_c(X)}w(X) + O(r^2)\\
&=\sum_{e\subset B(p,r)}\sum_{X\mid e \in E_c(X)}\gamma_2(X)w(X) + O(r^2)\\
&=\sum_{e\subset B(p,r)}\Gamma_2(\op{super}(e)) + O(r^2)\\
&\ge O(r^2).
\end{array}
$$

From the definition of $\gamma_2$, the sum $\sum \gamma_2(X)$ may be exanded as the sum of three terms $T_1+T_2+T_3$, which we compare term by term with (\ref{eqn:A2neg}):
$$
T_i' \ge T_i + C_i r^2.
$$
This proceeds exactly as in the proof of Theorem~\ref{theorem:mk1}.
\end{proof}



\begin{conjecture} \label{conj:L12} 
For any packing $\Lam$, and
any $\lam_0\in\Lam$, we have
\begin{equation}\label{eqn:L12}
\sum_{\lam_1\in\Lam\mid h(\lam_0,\lam_1)\le \hm} L(h(\lam_0,\lam_1)) \le 12,
\end{equation}
\end{conjecture}

\begin{corollary}\guid{ECAMUNU}\rating{80} 
Conjecture~\ref{conj:L12} implies the Kepler conjecture.
\end{corollary}

\begin{proof}
We have 
$$
 M_2(h) \le \begin{cases} L(h) & h \le \hm\\ 0 & h\ge \hm \end{cases}
$$
Hence if inequality~(\ref{eqn:L12}) holds, then so does Conjecture~\ref{conj:m2}.
\end{proof}



Now we turn to the proof of Theorem~\ref{lemma:superineq}. We fix one critical edge and consider the supercell of all cells around it.  Consider all the faces along the critical edge $\{\lambda_0,\lambda_1\}$, consisting of three vertices $\{\lambda_0,\lambda_1,\lambda_2\}$ with circumradius less than $\sqrt2$.  Call such faces {\it blades}.  The proof will be divided into cases, according to the number of blades along the critical edge.

We call a $4$-cell a {\it quarter}, when it has exactly one critical edge and all other edges of the simplex have length at most $2 h_-$. By calculations~\cite[cc:qtr:GLFVCVK]{hales:2009:nonlinear}, if $X$ is any cell, then % gamma2 is nonneg on quarters.
$$
 \gamma_2(X) \ge 0,
$$ 
except possibly when $X$ is a quarter.  Thus, it
suffices to prove the theorem
when there is at least one quarter along the critical
edge.  We note that the weight of any quarter is $1$.
Adjacent to a $4$-cell along a blade is always a $3$-cell or another $4$-cell. Adjacent to a $2$-cell is a $3$-cell.

\begin{note}%XX  
The details of the proof of Theorem~\ref{lemma:superineq} are still quite sketchy.  A later draft of this book will provide further details.  Some of the calculations involved can be found in a Mathematica notebook in located in book code section of the flyspeck svn repository.
\end{note}


\subsection{two blades}

The assumption of a quarter gives at least two blades.  Consider
the case of exactly two blades.
We may assume that the two blades are edges of a quarter
$X_4$. 
The azimuth angle of what remains outside the quarter
is greater than $\pi$.  Thus, there must be a $3$-cell
along each blade.  Let $X_3$ be one of these $3$-cells.
It has weight $1$.
Then 
\begin{equation}\label{eqn:34}
\Gamma_2(Z)\ge \gamma_2(X_4)+\gamma_2(X_3)\ge 0,
\end{equation}
by a calculation~\cite[cc:2bl:FHBVYXZ]{hales:2009:nonlinear}. % 2-blade calculation, gamma2(fourcell)+gamma2(threecell) >=0.

\subsection{three blades}

The nonlinear inequalities for three blades are found at~\cite[cc:3bl:BIXPCGW]{hales:2009:nonlinear}.  Assume a quarter with $\gamma_2(X) <0$.  If number of $4$-cells around the diagonal is less than three, then each quarter has a $3$-cell adjacent to it.  The positivity of $\gamma_2$ on non-quarters and the inequality~(\ref{eqn:34}) give the result.  

Thus, we may assume there are three $4$-cells. If $\gamma_2(X)<0$, then its azimuth angle is at most $1.65$. Every $4$-cell along the critical edge has azimuth angle at most $2.8$.  As
$$
2 (1.65) + 2.8 < 2 \pi,
$$
the quarter $X$ is unique that satisfies $\gamma_2(X)<0$.  One of the $4$-cells $Y$ adjacent to $X$ has angle at least 
$$
(2\pi - 1.65)/2 > 2.3.
$$
Such a $4$-cell has weight $1$. We have
$$
\Gamma_2(Z)\ge \gamma_2(X) + \gamma_2(Y) \ge -0.0057 + 0.0057 \ge0.
$$

\subsection{six or more blades}

The nonlinear inequalities for six or more blades are found at~\cite[cc:6bl:TTAMHQQ]{hales:2009:nonlinear}.
There is an azimuth cycle $\sigma$
on all blades around a given critical edge.  There is an azimuth
angle $\op{azim}(b,b')$ between blades $b$ and $b'$.  The sum
of the azimuth angles is $2\pi$:
$$
\sum_b \op{azim}(b,\sigma(b)) = 2\pi.
$$

Let $B=B(b)$ be the set of all the $k$-cells between consecutive blades $b,\sigma(b)$.    (This will be either a single $4$-cell, or a $2$-cell sandwiched between $3$-cells positioned along the two blades.)  Calculations give 
$$\sum_{X\in B} \gamma_2(X) w(X) \ge 0.2147 - 0.20495\sum \op{azim}(b,\sigma(b)).$$
We sum this inequality over the supercell, blade by blade:
$$
\Gamma_2(Z) \ge 6 (0.2147) - 0.20495 (2\pi) \ge 0.
$$


\subsection{five blades}

The nonlinear inequalities for five blades are found at~\cite[cc:5bl:ZTGIJCF]{hales:2009:nonlinear}.  Let $j=1,\ldots,5$ be the number of quarters.
A quarter satisfies an inequality of the form:
$$
\gamma_2(X) \ge a_j + b_j\, \op{azim}(X),
$$
and between consecutive blades, there is a similar inequality for $j=1,\ldots,4$:
$$
\sum_{X\in B(b)} \gamma_2(X)w(X) \ge a_j' + b_j\,\op{azim}(b,\sigma(b)).
$$
We get
\begin{equation}\label{eqn:5bl}
\Gamma_2(Z) \ge j a_j + (5-j) a_j' + b_j\, (2\pi) \ge 0.
\end{equation}

\subsection{four blades}

The nonlinear inequalities for four blades are found at~\cite[cc:4bl]{hales:2009:nonlinear}.
We consider subcases, according to the number $j=1,2,3,4$ of quarters along the critical edge.  The argument is similar, based on an inequality of the
form (\ref{eqn:5bl}), with a different list of constants $a_j,a_j',b_j$.  

The only difference is that the following additional argument is used in the case $j=2$ of two quarters, in the case that all of the edges of the blades, except the diagonal, have lengths in $[2,2h_-]$.  Calculations of the edge opposite the diagonal show that one of these edges has length at most $2h_-$, making it a quarter, contrary to the assumption that there are only two quarters.  Thus, when $j=2$, some non-diagonal edge of a blade has length greater than $2h_-$.  This fact is used in computing the constant $a_2'$.

\smallskip

This completes the proof of Theorem~\ref{lemma:superineq}.


\section{bounding the number of spheres}

The purpose of the remainder of this work is to prove Conjecture~\ref{conj:L12}, although the weaker Conjecture~\ref{conj:m2} would suffice for the proof of the Kepler conjecture.  This stronger inequality has the advantage of a linear function.

Since $L(h)\le 1$, for $h\ge1$, it is clear that the inequality holds whenever the number of summands is at most $12$. The following is a variant of a lemma of Marchal.


\begin{lemma}\guid{DLWCHEM}\rating{300}\label{lemma:13-14}  If the number of nonzero summands is $15$ or greater, then inequality~\ref{eqn:L12} holds.
\end{lemma}

\begin{proof} 
Consider a configuration with $15$ or more nonzero summands, $\lambda_1,\ldots,\lambda_N$. 
We fix the origin $\lambda_0=0$.  Set $h_i = \normo{\lambda_i}/2$.  We have $h_i\le h_0=1.26$.  Set
$$
a(h) = \arccos(h/2) - \pi/6.
$$
On the unit sphere,  consider the disks $D_i$ of radii $a(h_i)$, centered at $\lambda_i/\normo{\lambda_i}$.  These disks do not overlap; this follows from the easy inequality~\cite[cc:disks]{hales:2009:nonlinear} %% Marchal disks are disjoint.
$$
a(h_i) + a(h_j) \le \op{arc}(2h_i,2h_j,2).
$$
Let $P_i$ be the half-space containing the origin, bounded by the plane through the circular boundary of $D_i$.  The intersection of these half-spaces is a convex polytope with faces $F_i$.  The radial projection of $F_i$ to the unit sphere is a spherical polygon $R_i$ containing $D_i$.  Let $n_i$ be the number of sides to the polygon $R_i$.  The area of $R_i$ is at least the area $A(a(h_i),n_i)$ of the smallest $n_i$-gon containing $D_i$.  The smallest spherical $n$-gon containing a disk of radius $a$ has area at least (Lemma~\ref{lemma:ngon}, \ref{lemma:ngon-area})
$$
A(a,n) = 2\pi - 2 n (\arcsin(\cos(a)\sin(\pi/n))).
$$
We can verify directly that~\cite[cc:alin]{hales:2009:nonlinear} %% Linear lower bound on regular polygon.
$$
A(a(h),n) \ge c_0 + c_1 n + c_2 L(h),\quad
n = 3,4,\ldots,\quad 1\le h\le \hm,
$$
where
$$c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 = 0.4754.$$
The sum $\sum_i n_i$ is the number of darts in the planar hypermap of
the convex polyhedron (Lemma~\ref{lemma:polyhedron}).  By the Lemma~\ref{lemma:dart-upper}, 
$\sum_i n_i \le (6N-12)$.
Summing over $i=1..N$, for $N\ge 15$, we get the follow
estimate on $\bar L = \sum_i L(h_i)$:
$$
\begin{array}{lll}
4\pi &= \sum_i\op{area}(R_i)\\
     &\ge \sum_i A(a(h_i),n_i) \\
     &\ge c_0 N +c_1\sum_i n_i + c_2 \bar L\\
     &\ge c_0 N +c_1 (6N-12) + c_2 \bar L\\
     &\ge c_0 (15) +c_1 (78) + c_2 \bar L.\\
\end{array}
$$
This gives
$$
11.94 \ge \bar L. 
$$
\end{proof} 


\begin{lemma}\guid{XULJEPR}\label{300}\label{lemma:D'}  
If some $\lambda_1$ satisfies $\normo{\lambda_1}=2$ and
$\norm{\lambda_1}{\lambda'}\ge 2\hm$ for all $0\ne\lambda'\in\Lambda$,
then  inequality~\ref{eqn:L12} holds.
\end{lemma}

\begin{proof}  We assume that we have $N\ge 13$. We create a larger disk $D_1'$ centered at $\lambda_1/2$ and argue otherwise as in the previous proof.  
By the conditions of the lemma, we may take 
$$a'=\arc(2,2,2\hm)-a(\hm) \approx 0.797$$
for the arcradius of this disk.  We can verify directly that~\cite[cc:alin2]{hales:2009:nonlinear} %% Linear lower bound on regular polygon (large disk)
$$A(a',n) \ge c_0 + c_1 n + c_2 L(1) + c_3$$
where $c_3 = 0.85$.
Then 
$$
\begin{array}{lll}
4\pi &= \sum_i\op{area}(R_i)\\
     &\ge A(a',n_1)+\sum_{i>1} A(a(h_i),n_i) \\
     &\ge  c_0 N +c_1\sum_i n_i + c_2 \bar L + c_3\\
     &\ge c_0 N +c_1 (6N-12) + c_2 \bar L + c_3\\
     &\ge  c_0 (13) +c_1 (66) + c_2 \bar L + c_3.\\
\end{array}
$$
This gives
$$
11.97 > \bar L. 
$$
\end{proof}

