% file started March 22, 2009

\chapter{Packing}


\section{Definition}



Intuitively, a \newterm{packing} is an arrangement of congruent
balls in Euclidean three space that are nonoverlapping in the sense
that the interiors of the balls are pairwise disjoint.  By convention,
we take the radius of the congruent balls to be $1$.
%the scale
%invariance of density, without loss of generality, units can be chosen
%so that each ball has radius $1$. 
Let $ V$ be the set of centers of the balls in a
packing. The choice of unit radius for the
balls implies that any two points in $ V$ have distance at
least $2$ from each other. 
 Formally, the packing is identified
with the set of centers $V$.
\indy{Notation}{V@$ V$ (packing)}%

%
%The density of a packing does not decrease when balls are added to the
%packing. Thus, to construct packings of maximal density, one may add
%nonoverlapping balls until there is no room to add further balls.  A
A packing in which no further balls can be added is said to be {\it
saturated}.

\begin{definition}[saturated,~packing]
A \newterm{packing} $ V\subset \ring{R}^3$ is a set such that
\begin{displaymath}\forall  \u,~\v\in  V.~  \norm{ \u}{\v} < 2 \Rightarrow ( \u=\v).\end{displaymath}
A set is \newterm{saturated} if for every $\p\in\ring{R}^3$, there
exists $ \u\in V$ such that $\norm{ \u}{\p}< 2$.
\end{definition}
\indy{Index}{saturated}%
\indy{Index}{packing}%



Let $B(\p,r)$ denote the open ball in
Euclidean three-space at center $\p$ and radius $r$.  The open ball
is measurable with measure $4\pi r^3/3$.
 Set $ V(\p,r) = V \cap
B(\p,r)$. %and $ V^*(\p,r) = V(\p,r)\setminus \{\p\}$.
\indy{Index}{measure}%
\indy{Notation}{B@$B(\p,r)$}%

\begin{lemma}\guid{KIUMVTC}
\oldrating{80}
\formalauthor{Nguyen Tat Thang}
\rating{0}
\label{lemma:V-finite}
Let $ V$ be a packing and let $\p\in\ring{R}^3$.
Then the set $ V(\p,r)$ is finite.
\end{lemma}

\begin{proof}  Let $\p = (p_1,p_2,p_3)$. The floor function gives the map
\begin{displaymath}\v=(v_1,v_2,v_3)\mapsto (\lfloor 2(v_1-p_1)
\rfloor, \lfloor 2(v_2-p_2) \rfloor, \lfloor 2(v_3-p_3) \rfloor)\end{displaymath}
is a one-one map from $ V(\p,r)$ into the set $\ring{Z}^3\cap B(\orz,2r + 1)$.  By Lemma~\ref{lemma:Zcount} the range of this one-to-one map is finite. 
Hence the domain $ V(\p,r)$ of the map is also finite.%
\footnote{An alternate proof uses the open cover of compact ball $\bar B(\p,r)$ by the sets $\bar B(\p,r)\setminus V$ and $B(\v,1)$, for $\v\in V$. By compactness, the cover is necessarily finite.}
\end{proof}
\indy{Notation}{1@$\lfloor\cdot\rfloor$ (floor)}%




\section{Rogers simplex}\label{sec:rogers}



% Think of $ V$ as the set of centers of a packing of congruent balls
% of radius $1$. To be saturated means that there is no room for
% further balls to be added to the packing. There is no loss in
% generality in assuming that the packing is saturated, when searching
% for the greatest possible density of a packing.


Given a packing $ V$, Rogers gives a partition of Euclidean space into
simplices with extreme points in $ V$ \cite{Rogers:1958:Packing}.  He used
this partition to give a bound on the density of sphere packings in
Euclidean space of arbitrary dimension.  In two dimensions, the bound
is sharp and gives a solution to the sphere packing problem.


\subsection{Voronoi cell}

\begin{definition}[Voronoi~cell,~$\Omega$]\label{def:voronoi}
%\indy{Index}{Voronoi cell}% 
Let $V\subset\ring{R}^3$ and $\v\in V$.
The \newterm{Voronoi cell} 
$\Omega(V,\v)$
is the set of points at least as close to $\v$ as to
any other point in $V$. 
% Let $\Omega_t( V,\v) = \Omega( V,\v)
%\cap B(\v,t)$ be the truncated Voronoi cell at radius $t$.
\end{definition}
\indy{Notation}{ZZZomega@$\Omega$ (Voronoi cell)} %

\begin{remark}
If $V$ is a saturated packing, then every point $\p$ has distance less than $2$ from
some point of $V$.  The set $V(\p,2)$ is finite.  Hence, $\p$ is at least as close to some
$\v\in V$ as it is to any other $\w\in V$.  This means that $\p\in\Omega(V,\v)$.
It follows that
\begin{equation}\label{eqn:vor-rn}
\ring{R}^3 = \bigcup \{\Omega(V,\v)\mid \v \in V\}.
\end{equation}
\end{remark}

\begin{remark}
Set
\begin{eqnarray*}
A_+(\u,\v) &= \{\p\in\ring{R}^3
\mid 2(\v-\u)\cdot \p \le \normo{\v}^2 - \normo{\u}^2 \},\\
A(\u,\v) &= \{\p\in\ring{R}^3
\mid 2(\v-\u)\cdot \p = \normo{\v}^2 - \normo{\u}^2 \},\\
\end{eqnarray*}
when $\u,\v\in\ring{R}^3$.  The plane $A(\u,\v)$ is the bisector of
$\{\u,\v\}$ and $A_+(\u,\v)$ is the half-space of points at least as
close to $\u$ as to $\v$.  The Voronoi cell $\Omega(V,\v)$ is the
intersection of the half-spaces $A_+(\v,\u)$ as $\u$ runs over
$V\setminus \{\v\}$.
\end{remark}

\begin{lemma}\label{lemma:V4}
Let $V\subset\ring{R}^3$ be a saturated packing.    Then $\Omega(V,\v)\subset  B(\v,2)$.
Also, $\Omega(V,\v)$ is a polyhedron defined by the intersection of the  finitely many
half-spaces $A_+(\v,\u)$, for $\u\in V(\v,4)$. 
\end{lemma}

\begin{proof} Let $\p\not\in B(\v,2)$.  
By saturation, there exists $\u\in V$ such that $\norm{\p}{\u}<2$.
Then 
\begin{displaymath}
\norm{\p}{\u} < 2 \le \norm{\p}{\v}.
\end{displaymath}
Hence, $\p\not\in\Omega(V,\v)$.  This proves the first conclusion.


Let $\Omega'$ be the intersection of the half-spaces $A_+(\v,\u)$ as $\u$ runs
over $V(\v,4)$.  Clearly, $\Omega(V,\v)\subset \Omega'$.  Assume for a contradiction
that $\p\in \Omega'\setminus\Omega(V,\v)$.  The intersection of the ray $\op{aff}_+\{\v,\p\}$
with $\Omega(V,\v)$ is a closed and bounded  convex subset of the line.  By general
principles of convex sets, this intersection is an interval $\op{conv}\{\v,\p'\}$, for some
$\p'\in\Omega(V,\v)\subset B(\v,2)$.   For some small $t>0$,  the point lies beyond
the interval but remains within the ball:
\begin{displaymath}
\q = (1+t)\p' -t \v\in (B(\v,2)\cap \Omega')\setminus \Omega(V,\v).
\end{displaymath}
Pick $\u\in V\setminus V(\v,4)$ such that $\q\in A_+(\u,\v)$.  By the triangle inequality,
\begin{displaymath}
\norm{\u}{\v} \le \norm{\u}{\q} + \norm{\v}{\q} \le 2\norm{\v}{\q} < 4.
\end{displaymath}
This contradicts the assumption $\u\not\in V(\v,4)$.

The number of half-spaces $A_+(\v,\u)$, for $\u\in V(\v,4)$ is finite by
Lemma~\ref{lemma:V-finite}.  A set defined by the intersection of a finite number
of closed half-spaces is a polyhedron.
\end{proof}

\begin{lemma}\guid{DRUQUFE}
\formalauthor{Nguyen Tat Thang}
\oldrating{80} 
\rating{0}
Let $ V$ be a saturated packing.  For every $\v\in  V$, 
the Voronoi cell $\Omega( V,\v)$,  is
compact, convex, and measurable.
\end{lemma}

\begin{proof}  By the previous lemma, it is a bounded polyhedron.  Every bounded
polyhedron is compact, convex, and measurable.
\end{proof}




\begin{definition}[$\Omega$ reprise]
The notation $\Omega(V,*)$ can be \newterm{overloaded} to denote intersections
of Voronoi cells, when the second argument is a set or list of points.
If $W\subset V$, %(or if $W$ is an ordered tuple of elements of $ V$), 
then the intersection of the family of Voronoi cells is  $\Omega(V,W)$:
\begin{displaymath}\Omega(V,W) = \bigcap \{\Omega(V, \u)\mid \u\in W
\}.\end{displaymath}
Define $\Omega$ on lists % by recursion:
%\begin{displaymath}
%\begin{array}{lll}
%\Omega(V,[]) &= \ring{R}^3,\\
%\Omega(V,\u_0\cooln[\u_1;\ldots;\u_k]) &= \Omega(V,\u_0)\cap \Omega(V,[\u_1;\ldots;\u_k]).\\
%\end{array}
%\end{displaymath}
to be the same as its value on point sets: 
\begin{eqnarray*}
%\Omega(V,[]) &= \ring{R}^3,\\
%\Omega(V,\u_0\cooln\bu) &= \Omega(V,\u_0)\cap \Omega(V,\bu).\\
\Omega(V,[\u_0;\ldots;\u_k]) = \Omega(V,\{\u_0;\ldots;\u_k\}).
\end{eqnarray*}
%Call $\Omega(V,W)$ the $W$-face of $\Omega(V, \u)$ when $ \u\in W$.
\end{definition}

An intersection of Voronoi cells can be written in many equivalent forms:
\begin{displaymath}
\Omega(V,\v)\cap \Omega(V,\u) =\Omega(V,\{\u,\v\})= \Omega(V,\v)\cap A_+(\u,\v) 
= \Omega(V,\v)\cap A(\u,\v) =  \cdots
\end{displaymath}





\begin{definition}[$\bV$]
Let $V$ be a saturated packing.
Let $ \bV(k)$ be the set of lists of length $k+1$:
$[\u_0;\ldots;\u_k]$, with $ \u_i\in V$ such that
\begin{equation}\label{eqn:omega-dim}
\dimaff(\Omega(V,[\u_0;\ldots;\u_j])) = 3-j
\end{equation}
for all $0<j\le k$.
(Recall that   $\dimaff(X)$ is the affine dimension of $X$ from Definition~\ref{def:affine}.)
\indy{Notation}{dimaff@$\dimaff$}%
\end{definition}

In particular, $V$ can be identified with $\bV(0)$ under the natural
bijection $\v\mapsto[\v]$, and $\bV(1)$ is the set of lists $[\u;\v]$
of distinct elements such that the Voronoi cells at $ \u$ and $\v$
have a common facet, and so forth.  

\begin{notation}[underscore]
%Given a saturated packing $V$, and natural number $k$, the definition gives $\bV(k)$ as a certain set of lists of points in $V$.  
We hope that the  use of underscores does not lead to confusion.  The underscore in $\bV(k)$ is a function
\begin{displaymath}
\underline{\phantom V}:\{V \mid \text{$V$ saturated packing} \}
\times \ring{N} \to \ldots
\end{displaymath}
Contrast this with the use of the underscore in $\bu$.  Here the underscore is not a function, but part of its name, following a general typographic convention to mark lists of points. The two uses are coherent in the sense that $\bu\in\bV(k)$.
\end{notation}

\begin{notation}[$\trunc{\bu}{j}$]
\indy{Notation}{u@$\bu$ (list of points)}%
When $\bu=[\u_0;\ldots;\u_k]$ and $j\le k$, write
%\footnote{The  notation follows the syntax of Python slices.} 
$\trunc{\bu}{j} = 
[\u_0;\ldots;\u_j]$ for the truncation of the list.  
\indy{Notation}{1@$\trunc{*}{:*}$}%
\end{notation}

Truncation
$\bu\mapsto\trunc{\bu}{j}$ maps $\bV(k)$ to $\bV(j)$, when $j\le k$.
Beware of the index:  $k$ is the {\it codimension} of
$\Omega(V,\bu)$ in $\ring{R}^3$, when $\bu\in \bV(k)$; it is not the
{\it length} of the list $\bu$ (which is $k+1$).\footnote{Compare this to the
convention that presents a $d$-simplex as a $d+1$-tuple.  Because of this shift by $1$, the notation $\bu[:j]$ also differs by the same shift from Python slice notation.}


\begin{lemma}\label{lemma:omega-face}  
Let $V\subset\ring{R}^3$ be a saturated packing.
Let $\bu=[\u_0;\ldots;\u_{k}]\in \bV(k)$.  
Then $\Omega(V,\bu)$ is a face of $\Omega(V,\u_0)$.
\end{lemma}

\begin{proof} $\Omega(V,\bu)$ is the intersection of $\Omega(V,\u_0)$ with
the planes $A(\u_0,\u_i)$, where $i>0$.  
%Alternatively, it is the
%intersection of $\Omega(V,\u_0)$ with the planes $A(\u_i,\u_0)$, where $i>0$.
It follows directly from the definition of a face that each plane
$A(\u_0,\u_i)$ is a face of the polyhedron $A_+(\u_0,\u_i)$.  Thus, if 
\begin{displaymath}
\op{aff}^0_+(\emptyset,\{\p,\q\}) = \{ s \p + t \q \mid s>0,\quad t>0,~\quad s + t = 1\}
\end{displaymath} 
meets
$\Omega(V,\bu)$ for some $\p,\q\in \Omega(V,\u_0)\subset
A_+(\u_0,\u_i)$, then it also meets the face $A(\u_i,\u_0)$ and $\p,\q$
must also lie in the face $A(\u_0,\u_i)$ of the polyhedron
$A_+(\u_0,\u_i)$ containing $\p,\q$ (by
the definition of face).  Then $\p,\q$ also lie in
$\Omega(V,\bu)$.  By the definition of face, $\Omega(V,\bu)$ is a face
of $\Omega(V,\u_0)$.
\end{proof}

\begin{lemma} Let $V\subset\ring{R}^3$ be a saturated packing.
Let $\bu\in \bV(k)$, for some $k<3$.   Then $F$ is a facet of $\Omega(V,\bu)$ if and only if
there exists $\bv\in \bV(k+1)$ such that $F = \Omega(V,\bv)$ and $\trunc{\v}{k} = \bu$.
\end{lemma}

\begin{proof}
Use Lemma~\ref{lemma:V4} to write the polyhedron $\Omega(V,\bu)$ in the form of Equation~\ref{eqn:polyrep}:
\begin{displaymath}
\Omega(V,\bu) = A \cap A_\pm(\v_1,\u_0) \cap \cdots\cap A_\pm(\v_r,\u_0),
\end{displaymath}
where $A$ is the affine hull of $\Omega(V,\bu)$, $\v_i\in V$, 
where $A_-(\v,\w) = A_+(\w,\v)$ with the signs $\pm$  chosen as
needed, 
and $r$ is as small as possible.
By Lemma~\ref{lemma:webster}, if $F$ is any facet of $\Omega(V,\bu)$, then there exists
an $i\le r$ such that 
\begin{displaymath}
F = \Omega(V,\bu) \cap A(\v_i,\u_0) = \Omega(V,\bv),
\end{displaymath}
where $\bv = [\u_0;\cdots;\u_k;\v_i]$ is the list that appends $\v_i$ to $\bu$.
Also, since $F$ is a facet:
\begin{displaymath}
\dimaff(\Omega(V,\bv)) = \dimaff(F) = \dimaff(\Omega(V,\bu)) - 1 = 3 - k - 1.
\end{displaymath}
So $\bv \in \bV(k+1)$.  This proves the implication in the forward direction.

To prove the converse, let $\bv\in \bV(k+1)$, where $\trunc{\bv}{k} = \bu$.
Elementary verifications show that $\Omega(V,\bv)\subset \Omega(V,\bu)$ and
that this set is nonempty if $k<3$.  By Lemma~\ref{lemma:omega-face} and Lemma~\ref{lemma:webster}, $\Omega(V,\bv)$ is a face of $\Omega(V,\bu)$.  By the definition of $\bV(*)$,
\begin{displaymath}
\dimaff(\Omega(V,\bv)) = 3 - (k+1) = \dimaff(\Omega(V,\bu)) -1,
\end{displaymath}
so $\Omega(V,\bv)$ is a facet of $\Omega(V,\bu))$.
\end{proof}

\subsection{partition}

\begin{definition}[$\omega$]
Define $\omega: \coprod_{j=0}^3 \bV(j)\to \ring{R}^3$ by recursion over $j$ as follows.
Let \begin{displaymath}
\omega([\u]) = \u,
\end{displaymath} and
let $\omega( \bu)$ be the closest point on $\Omega(V, \bu)$ to
$\omega( \trunc{\bu}{j})$, when $\bu\in \bV(j+1)$.
\end{definition}

The point $\omega(\bu)$ exists when $\bu\in V(k)$, and $k\le 3$.
Indeed, the set $\Omega(V, \bu)$ is nonempty, convex, and compact.  Thus, by
convex analysis, the closest point $\omega( \bu)$ exists uniquely.
\indy{Notation}{zzomega@$\omega$ (extreme points of Rogers
  simplex)}%

\begin{definition}[R,~Rogers simplex]
Let $V\subset\ring{R}^3$ be a saturated packing. For $\bu\in \bV(k)$, let 
\begin{displaymath}
R(\bu) = \op{conv}\{\omega( \trunc{\bu}{0}), \omega(
\trunc{\bu}{j+1}),\ldots,\omega( \trunc{\bu}{k})\}.
\end{displaymath}
%Set $R(\bu)=R(0,\bu)$.  
The set $R(\u)$ is called the Rogers simplex of $\bu$.
\indy{Notation}{R@$R$ (Rogers simplex)}%
\end{definition}

\begin{lemma}\guid{GLTVHUM}\rating{200}
For any saturated packing $V\subset\ring{R}^3$, 
\begin{displaymath}\ring{R}^3 = \bigcup\, \{ R(\bu) \mid \bu\in
\bV(3)\}.\end{displaymath}
\end{lemma}

\begin{proof}
The proof uses the following standard facts about convex sets and polyhedra, which will
be left as exercises to the reader:
\begin{itemize}
\item If $P$ is a bounded polyhedron of positive affine dimension with facets $F_1,\ldots,F_r$ and if $\emptyset\ne
A\subset P$,
then 
\begin{displaymath}
P = \bigcup_{i=1}^r \op{conv}(A\cup F_i).
\end{displaymath}
\item If $P$ is convex and $P = \bigcup_{i=1}^r P_i$, where $P_i$ is convex, then
\begin{displaymath}
\op{conv}(A\cup P ) = \bigcup_{i=1}^r\op{conv}(A\cup P_i).
\end{displaymath}
\item $\op{conv}(A\cup \op{conv}(B)) = \op{conv}(A \cup B)$.
\end{itemize}
%
Now turn to the proof.  
By the covering of $\ring{R}^3$  by Voronoi cells by (\ref{eqn:vor-rn}),
%\begin{displaymath}\ring{R}^3 = \bigcup\, \{\Omega(V, \bu)\mid \bu\in
%\bV(0)\}.\end{displaymath}
it is enough to show that each Voronoi cell is covered by Rogers simplices.

Let $\bu\in V(j)$, for $j<3$.
Consider the following predicate of a natural number $k$: 
\begin{displaymath}
\text{Either  $k>3$ or}~\Omega(V,\bu) = \bigcup
\left\{\op{conv}(O_k \cup\Omega(V,\bv)) %\\&\qquad\qquad
\mid
\bv \in \bV(k),~\trunc{\bv}{j}=\bu\right\},
\end{displaymath}
where $O_k = \{\omega(\trunc{\bv}{j}),\ldots,\omega(\trunc{\bv}{k-1})\}$.

\claim{This predicate holds by induction when $k\ge j$.}  Indeed, the base case
$k=j$ is 
\begin{displaymath}
\Omega(V,\bu) = \op{conv}(\Omega(V,\bu)),
\end{displaymath}
which holds by basic facts about the convexity for a polyhedron $\Omega(V,\bu)$.
Assume the induction hypothesis holds for $k$, and consider the predicate for
$k+1$.  We may assume that $k<3$ to avoid trivial cases.
Then
\begin{eqnarray*}
&\phantom{=}&\bigcup _{\bv \in \bV(k+1),~\trunc{\bv}{j}=\bu}
%\left\{
\op{conv}(O_{k+1} \cup\Omega(V,\bv))
%\mid%
%
%\right\}
\vspace{6pt}\\
&=&\bigcup _{\bv \in \bV(k+1),~\trunc{\bv}{j}=\bu}
%\left\{
\op{conv}(O_{k} \cup\op{conv}(\{\omega(\trunc{\bv}{k})\}\cup\Omega(V,\bv)))
%\mid
%\right\}
\vspace{6pt}\\
&=&\bigcup _{\bw\in V(k),~\trunc{\bw}{j}=\bu}
%\left\{
\bigcup_{\bv \in \bV(k+1),~\trunc{\bv}{k}=\bw}
%\left\{
\op{conv}(O_{k} \cup\op{conv}(\{\omega(\trunc{\bv}{k})\}\cup\Omega(V,\bv)))
%\mid
%\right\}\mid 
%\right\}
\vspace{6pt}\\
&=&\bigcup _{\bw\in V(k),~\trunc{\bw}{j}=\bu}
%\left\{
\op{conv}(O_{k} \cup \Omega(V,\bw)    
%\mid 
%\right\}
\vspace{6pt}\\
&=&\quad\Omega(V,\bu).
\end{eqnarray*}
The induction hypothesis is used in the last step.  This proves the induction.

Consider  what the predicate asserts when $j=0$ and $k=3$.  The set $\Omega(V,\bv)$
reduces to $\{\omega(\bv)\}$  and the convex hull becomes
\begin{displaymath}
\op{conv}(O_{k}\cup \Omega(V,\bv)) = R(\bv),
\end{displaymath}
when $\bv\in \bV(3)$.
This gives
\begin{equation}
\Omega(\u_0) = \bigcup \{ R(\bv) \mid \bv\in V(3),~\trunc{\bv}{0} =[\u_0]\}.
\end{equation}
This proves the lemma.
\end{proof}


%%%
%\begin{displaymath}\Omega(V,\trunc{\bu}{0}) = 
%\bigcup\, \{ R(\bv) \mid \trunc{\bu}{0}=\trunc{\bv}{0},~\bv\in  \bV(3)\}.
%\end{displaymath}
%By Lemma~\ref{lemma:webster}, the relative boundary of the bounded
%polyhedron $\Omega(V,\trunc{\bu}{0})$ is the union of its facets.  The
%polyhedron can be partition into the cones over these facets.
%\begin{displaymath}\Omega(V,\trunc{\bu}{0}) = \bigcup\, \left\{
%  ~\op{conv}(\{\omega(\trunc{\bu}{0})\}\cup \Omega(V,\trunc{\bu}{1}))   
%   \mid \trunc{\bu}{1}\in  \bV(1)
%   \right\}.
%\end{displaymath}
%It is enough to show that
%\begin{displaymath}
%\Omega(V,\trunc{\bu}{1}) = \bigcup\, \{ R(1,\bv) \mid \trunc{\bv}{1}=\trunc{\bu}{1},~\bv\in  \bV(3)\}.
%\end{displaymath}
%After successively partitioning each facet into cones over facets of
%facets, it is enough to show that
%\begin{displaymath}\Omega(V,\trunc{\bu}{3}) = \bigcup\,\{R(3,\bv)\mid\trunc{\bv}{3}=\trunc{\bu}{3},~\bv\in \bV(3)\}.\end{displaymath}
%The right-hand side is the singleton $\{\omega(\trunc{\bu}{3})\}$.  The
%left-hand side contains this point and is contained in a properly
%decreasing chain of affine sets: $\ring{R}^3$, the bisector of $ \u_0$
%and $ \u_1$, and so forth.  This determines a unique point, so the two
%sides are equal.
%\end{proof}

\begin{lemma}\guid{DUUNHOR}\rating{140}  
The intersection of any two distinct $R(\bu)$ and $R(\bv)$ is
contained in a plane and hence has measure zero.
\end{lemma}

This result and the previous lemma show that the simplices $R(\bu)$
partition Euclidean three-space.

\begin{proof} Let $\bu = [\u_0;\ldots]$ and $\bv = [\v_0;\ldots]$.
If $ \u_0\ne\v_0$, the intersection $R(\bu)\cap R(\bv)$ lies in
$\Omega(V, [\u_0;\v_0])\subset A(\u_0,\v_0)$ and the conclusion follows.  Let $k+1$ be the
first index such that
\begin{displaymath}\op{conv}\{\omega( [\u_0]),\ldots,\omega( [\u_0;\ldots; \u_{k+1}])\}\ne
\op{conv}\{\omega([\v_0]),\ldots,\omega([\v_0;\ldots;\v_{k+1}])\}.
\end{displaymath}
Consider the predicate of $j\in\ring{N}$: 
\begin{displaymath}
\text{Either $j>k$ or}~~\Omega(V, [\u_0;\ldots;\u_j]) = \Omega(V,[\v_0;\ldots;\v_j]).
\end{displaymath}

\claim{This predicate holds by induction for all $j$.}
Indeed, the base case of the induction is the triviality: $\u_0 = \v_0$ implies
$\omega([\u_0]) = \omega([\v_0])$.  Now admit the induction hypothesis, and
assume further that $j<k$ to avoid trivialities.
\begin{displaymath}
\Omega(V,[\u_0;\ldots;\u_{j+1}]) = \Omega(V,[\u_0;\ldots;\u_j]) \cap A(\u_0,\u_{j+1})
\end{displaymath}

\begin{displaymath}\Omega(V,[\u_0;\ldots;\u_{k+1}]) \ne \Omega(V,[\v_0;\ldots;\v_{k+1}]).
\end{displaymath}
The intersection lies in the convex hull $C$ of 
$\{\omega([\u_0]),\ldots,\omega( [\u_0;\ldots; \u_k])\}$ and 
$\Omega'=\Omega(V,[\u_0;\ldots;\u_{k+1};\v_{k+1}])$.  
The set $\Omega'$ lies in an affine set of codimension
$k+2$ and $C$ has codimension $(k+2) - (k+1) = 1$.  The intersection
is thus contained in a plane.
\end{proof}


\subsection{circumcenter}

\begin{definition}[circumcenter,~circumradius]
Let $S\subset\ring{R}^N$.  
A point $\p$ is a \newterm{circumcenter} of $S$ if it is an element
in the affine hull of $S$ that is equidistant from every $\v\in S$.  If $S$ has
circumcenter $\p$, then the common distance $\norm{\p}{\v}$, for all $\v\in S$,
is the \newterm{circumradius} of  $S$.
\end{definition}

Recall that a finite set $S$
is \newterm{affinely independent} if $\dimaff(S) = \card(S) -1$.

\begin{lemma}\label{lemma:affine-system}
Let $S=\{\v_0,\ldots,\v_n\}$ be an affinely independent set of cardinality $n+1$.
Then every system of equations
\begin{displaymath}
\p \cdot (\v_i - \v_0) = b_i,\qquad i=1,\ldots,n,
\end{displaymath}
has a unique solution in $\p$ that lies in the affine hull of $S$.
\end{lemma}

\begin{proof} This is a standard result from linear algebra~\cite{XX}.
We briefly sketch a proof.

Let $\w_i = \v_i-\v_0$.  The lemma reduces to the following claim.
Let $S' = \{\w_1,\ldots,\w_n\}$ be a \newterm{linearly independent} set
of cardinality $n$.  Then every system of equations
\begin{displaymath}
\p \cdot \w_i = b_i,\qquad i=1,\ldots,n,
\end{displaymath}
has a unique solution in $\p$ that lies in the linear span of $S'$.

\claim{A solution is unique}. Indeed, the difference 
$\p = \p'-\p'' = \sum s_i \w_i$ of two solutions
$\p',\p''$ satisfies
\begin{displaymath}
\normo{\p}^2=\p\cdot\p = \sum s_i \w_i \cdot (\p' - \p'') =
\sum s_i (b_i-b_i)= 0.
\end{displaymath}
So that $\p=0$ and $\p'=\p''$.  This proves uniqueness.

Let $W$ be the linear span of $\w_1,\ldots,\w_n$.  The image of the map $W\to\ring{R}^n$, $\p\mapsto (\p\cdot\w_1,\ldots,\p\cdot\w_n)$ is a linear space, hence an affine set and a polyhedron (Lemma~\ref{lemma:aff-poly}).  

\claim{A solution exists; that is, the image is all of $\ring{R}^n$.}
Otherwise, by the definition of polyhedron some inequality must hold; that is, there exists $\u\ne \orz$ and $b$ such that $\u\cdot \q \le b$, for every point $\q$ in the image.  As the image is linear, in fact, $\u\cdot \q = 0$ on the image.  Write $\p = \sum u_i \w_i\in W$.  Then
\begin{displaymath}
\normo{\p}^2 = \p\cdot\p = \sum u_i (\p \cdot \w_i) = \u\cdot \q = 0,
\end{displaymath} 
where $\q\in\ring{R}^n$ is the image of $\p\in W$.
Thus $\p=\orz$ so that $\u=0$, and we have reached a contradiction.

\end{proof}

\begin{lemma} 
Let $S$ be a non-empty affinely independent set.  Then there exists a unique
circumcenter of $S$.
\end{lemma}

\begin{proof}
A point $\p$ is a circumcenter if and only if it is a point in the affine hull of $S$
that satisfies the system of equations:
\begin{displaymath}
\norm{\p}{\v_i}^2 = \norm{\p}{\v_0}^2,\qquad i = i,\ldots,n.
\end{displaymath}
Equivalently,
\begin{displaymath}
\p\cdot (\v_i-\v_0) = b_i,\qquad i=1,\ldots,n,
\end{displaymath}
where $b_i = (\normo{\v_i}^2-\normo{\v_0}^2)/2$.  By
Lemma~\ref{lemma:affine-system}, this system of equations has a unique
solution.
\end{proof}

\begin{lemma}
Let $V$ be a saturated packing.
If $\bu\in \bV(k)$, then its point set $\{\u_0,\ldots,\u_k\}$ 
is affinely independent of cardinality $k+1$.
\end{lemma}

\begin{proof}
\end{proof}


\begin{definition}[h]
%Let $h(\trunc{\bu}{i}) = \norm{\omega(\trunc{\bu}{i})}{ \u_0}$.  
If $\bu=[\u_0;\u_0;\ldots;\u_k]\in \bV(k)$, let $h(\bu)$ be the
circumradius of its point set $\{ \u_0,\ldots, \u_k\}$.
\end{definition}
\indy{Notation}{h@$h$ (circumradius)}%

\begin{lemma}\guid{XNHPWAB}\rating{500}\label{lemma:v2} 
Let $\bu=[\u_0;\ldots;\u_3]\in \bV(3)$ and fix $0\le j\le 3$.
Assume that $h(\trunc{\bu}{j})<\sqrt2$.
%\begin{displaymath}
%\norm{\omega(\trunc{\bu}{j}) }{  \u_0} < \sqrt2.
%\end{displaymath}
Then 
\begin{nomerate}
\item \case{circumcenter} $\omega(\trunc{\bu}{j})$ is the circumcenter of the
set $W_j =\{ \u_0,\ldots, \u_j\}$.
\item \case{convex hull} The circumcenter of $W_j$ lies in the convex
hull of $W_j$.
\item \case{distinctness} The points $\omega(\trunc{\bu}{j})$, for
$j=0,1,2,3$, are all distinct.
\end{nomerate}
\end{lemma}
\indy{Index}{convex hull}%

\begin{proof} The three conclusions of the lemma will be proved
separately.

\indy{Index}{circumcenter}%
\case{circumcenter} By definition, if $\bu\in \bV(3)$, then
\begin{displaymath}
\dimaff\Omega(V,[\u_0;\ldots;\u_j]) = 3-j.
\end{displaymath}  
The case $j=0$ of the lemma is trivially
satisfied.  Assume by induction the result holds for numbers less than
$j$.

Now assume $j>0$.  The circumcenter $\p=\p_{j}$ of the set $W_{j}$ is
the point on the plane $\op{aff}(\Omega(V,W_{j}))$ closest to
$\p_{j-1}=\omega(\trunc{\bu}{j-1})$.

\claim{The point $\p$ lies in $\Omega(V,W_{j})$.}   Otherwise
there is a point $\v\in V\setminus W_j$ satisfying
\begin{equation}\label{eqn:closest}
\norm{\v}{\p}\le \norm{ \u}{\p}, \quad\text{for all }  \u\in W_j.
\end{equation}
The angles $\arc_V(\p,\{\v, \u_i\})$ are obtuse for $i\le j$ because
\begin{displaymath}
\norm{\p}{\v} < \sqrt2,\quad \norm{\p}{ \u_i} <\sqrt2,\quad \norm{\v}{ \u_i} \ge 2.
\end{displaymath} 
A case-by-case argument follows, for each $j$.

If $j=1$, the points $\p, \u_0, \u_1$ are collinear and cannot give
two obtuse angles.

If $j=2$, let $\mu'$ be the projection of $\v$ to the plane containing
$\p, \u_0, \u_1, \u_2$. The four points $\mu', \u_0, \u_1, \u_2$ can
be arranged cyclically around $\p$, each forming an obtuse angle with
the next.  A circle around $\p$ cannot give four obtuse angles.


If $j=3$, assume that $ \u_0,\ldots, \u_3$ are labeled in cyclic order
around the line $\op{aff}\{\p,\v\}$.  Consider the dihedral angle
\begin{displaymath}
\gamma=\gamma_i=\dih(\{\p,\v\},\{ \u_i, \u_{i+1}\}).
\end{displaymath}
The sphere $S^2(\p)$ of radius $1$ centered at $\p$ meets any ray
$\op{aff}_+(\p,\{\q\})$ at a point.  As $\q$ runs over $\{\v, \u_i,
\u_{i+1})$, the three corresponding rays give three points on
$S^2(\p)$, which are the vertices of a spherical triangle with sides
$a,b,c$.  By the spherical law of cosines, the angle $\gamma$ of the
spherical triangle is given in terms of the edges as
\begin{displaymath}
\cos c - \cos a \cos b = \sin a \sin b \cos \gamma.
\end{displaymath}
All the terms on the left-hand side are negative, so $\gamma =\gamma_i
> \pi/2$.  This is impossible, as the sum of the four dihedral angles
$\gamma_i$ is $2\pi$.  This completes the proof that $\omega(\trunc{\bu}{j})$
is the circumcenter.

\indy{Index}{hull!convex}%
\case{convex hull} Next, it will be shown that $\p_j$ lies in the
convex hull of $W_j$.
% If $j=0$, there is nothing to show.  If $j=1$, the point is the
% midpoint of the convex hull.  If $j=2$, the point is the
% circumcenter of an acute triangle.  If $j=3$, the point is the
% circumcenter of a simplex such that every face has positive
% orientation.  Thus, in every case the point lies in the convex hull.
Suppose to the contrary that $\p=\p_j$ does not lie in the convex
hull. Then there is $i<j$ such that $\op{aff}(W')$ separates $\p$ from
$ \u_i$, where $W'=W_j\setminus\{i\}$.  Let $\p'$ be the circumcenter
of $W'$, and let $\v= \u_i$.  Then for $k\ne i$ and $0\le k\le j$, it
follows that
\begin{eqnarray*}
\norm{ \u_k}{\p'} &=& (\norm{ \u_k}{\p}^2 - \norm{\p}{\p'}^2)^{1/2} \\
&\ge& \norm{ \u_k}{\p} - \norm{\p}{\p'} \\
&=&\norm{\v}{\p} - \norm{\p}{\p'}\\
&=&\norm{\v}{\p'}.
\end{eqnarray*}
This is contrary to inequality~\ref{eqn:closest}.


\case{distinctness} The distances
$\norm{\omega(\trunc{\bu}{j})}{\omega(\trunc{\bu}{0})}$ are increasing, so it is
enough to show that $\omega(\trunc{\bu}{j})\ne \omega(\trunc{\bu}{j+1})$.  Otherwise,
equality holds, and the circumcenter $\omega(\trunc{\bu}{j})$ has an equally
close packing point $ \u_{j+1}\in V$, which is impossible by
inequality~\ref{eqn:closest}.
\end{proof}


% The concept of {\it positive orientation} is used in the proof.
% This is discussed in the 1998 proof and in {\it Lemmas in Geometry}.
% If a face has circumradius less than $\sqrt2$ it has positive
% orientation.  If every face has positive orientation, then the
% circumcenter of the simplex is contained in its convex hull.



By the lemma, if $h(\trunc{\bu}{j})<\sqrt2$, then the numbers $h(\trunc{\bu}{i})$ are
increasing in $i$, for $i\le j$.


Let $\op{Sym}(k+1)$ be the \newterm{group} of all permutations on $k+1$ letters.
Let $\bu = ( \u_0,\ldots, \u_k)\in \bV(k)$.  For any \newterm{permutation}
$\pi\in\op{Sym}(k+1)$, let $\pi_*(\bu)\in \bV(k)$ be the \newterm{rearrangement} given by
\begin{displaymath}
\pi_*(\bu)_i =  \u_{\pi i},
\end{displaymath}   
where $\u_i$ denotes the $i$th element of a list $\bu$.
\indy{Notation}{Xpi@$\pi$ (permutation)}


\begin{lemma}\guid{YIFVQDV}\rating{140}   
Let $\bu\in \bV(k)$.  Assume that $h(\bu)<\sqrt2$. Let $\bv$ be any
rearrangement of $\bu$ under a permutation.  Then $\bv\in \bV(k)$,
$\norm{\omega(\bv)}{\v_0}<\sqrt2$, and $\omega(\bu) = \omega(\bv)$.
\end{lemma}

\begin{proof} 
Since the sets $\Omega(V,\trunc{\bu}{j})$ satisfy \eqn{eqn:omega-dim}, it
follows that $\Omega(V,\bu)\cap \op{conv}\{ \u_0,\ldots, \u_k\}$ is
the singleton $\{\omega(\bu)\}$, which contains the circumcenter of
the simplex with extreme points $\{ \u_0,\ldots, \u_k\}$.  This describes
$\omega(\bu)$ in a way that does not depend on the ordering of $
\u_0,\ldots, \u_k$.

The condition \eqn{eqn:omega-dim} can be shown to hold for $\bv$.
The proof of Lemma~\ref{lemma:v2} shows that the midpoint of $\v_0$
and $\v_1\}$ lies in $\Omega(V,\trunc{\bv}{1})$.  By the distinctness
conclusion of the same lemma, some neighborhood of this midpoint in
the bisecting plane of $\{\v_0,\v_1\}$ lies in $\Omega(V,\trunc{\bv}{1})$.
Thus, $\dimaff(\Omega(V,\trunc{\bv}{1}))=2$.  Continue in this fashion to show
that
\begin{displaymath}
\dimaff(\Omega(V,\trunc{\bv}{j}))=3-j.\end{displaymath}
\end{proof}

\begin{lemma}\guid{WQPRRDY}\rating{400}\label{lemma:Rconv}  Let $\pi\in\op{Sym}(k+1)$
and $\bu = [\u_0;\ldots;\u_k]\in \bV(k)$.  Assume that
$h(\bu)<\sqrt2$. Then
\begin{displaymath}
\op{conv}\{ \u_0,\ldots, \u_k\} = \bigcup \,\{ R(\pi_*(\bu)) : \pi\in \op{Sym}(k+1)\}.
\end{displaymath}
\end{lemma}
\indy{Notation}{Sym@$\op{Sym}$ (symmetric group)}%

\begin{proof} Let $L = \{ \u_0,\ldots, \u_k\}$.  The proof is by
induction on $k$.  When $k=0$, the result is trivial.  Now assume
$k>0$.

The circumcenter $\omega(\bu)$ of $L$ lies in the convex hull of
these points.  (See the proof of Lemma~\ref{lemma:v2}.)  Thus, the
left-hand side is the union of cones:
\begin{displaymath}
\op{conv}(W) = \bigcup\,\{ \op{conv}(\omega(\bu),L\setminus \{ \u_i\}\mid i=0,\ldots,k) \}.
\end{displaymath}
The sets $L\setminus \{ \u_i\}$ can be identified with cosets of
$\op{Sym}(k+1) /\op{Sym}(k)$.  By induction $L\setminus \{ \u_i\}$ is
the union of $R(\bv)$ as $\bv$ runs over all permutations
$\op{Sym}(k)$ of $L\setminus \{ \u_i\}$.  The result follows by
induction.
\end{proof}

By construction, the Rogers simplices $R(\bu)$  are
compatible with the Voronoi decomposition of space.  Under mild
restrictions on the circumradius, they can also be reassembled into
simplices with extreme points at the centers of the packing (the Delaunay
simplices), by Lemma~\ref{lemma:Rconv}.
\indy{Index}{simplex!Delaunay}%
\indy{Index}{partition!Rogers}%
\indy{Index}{decomposition!Voronoi} %



\section{Marchal cells}

C. Marchal~\cite{marchal:2008} has proposed an approach to sphere packings
 that gives significant improvements to the original proof
in~\cite{Hales:2006:DCG}.  The definition of $k$-cells,
Conjecture~\ref{conj:m1}, Theorem~\ref{theorem:mk1}, and the method of
Lemma~\ref{lemma:13-14} are all due to him.  
\indy{Index}{Marchal, C.}%

% His articles claim to give a {\it demonstration} of the Kepler
% conjecture \cite{marchal:2007}, \cite{marchal:2008}.  However, the
% mathematically rigorous part of the article only gives a reduction
% of the problem to a difficult optimization problem in a finite
% number of variables.  The method of gradient descent is then used to
% explore the local minima of the optimization problem in finitely
% many variables.

Marchal's partition of space is a variant of Rogers's partition into
the simplices $R(\bu)$.  The main part of construction is the
decomposition obtained by truncating the Voronoi cells by a ball of
radius $\sqrt2$.  In a few carefully chosen situations, he assembles
the simplices $R(\bu)$ into larger convex cells, as suggested by
Lemma~\ref{lemma:Rconv}.



\begin{definition}[Marchal cells] Consider $\bu=( \u_0,\ldots,
\u_3)\in \bV(3)$.  \hfill\break\smallskip \case{The $0$-cell} of $\bu$
is
\begin{displaymath}
\cell(\bu,0) = \{\p\in R(\bu) \mid \norm{\omega([ \u_0])}{\p} > \sqrt2\}.
\end{displaymath}
\bigskip
\case{The $1$-cell} of $\bu$ is 
\begin{displaymath}
\cell(\bu,1) = \op{conv}(\{\omega([ \u_0])\}\cup R_1),\hbox{ where } R_1 = \{\p \in R(\bu) \mid \norm{\omega([ \u_0])}{\p}= \sqrt2\}.
\end{displaymath}
\indy{Notation}{R@$R_1$ (Rogers simplex)}%
\indy{Index}{cell}%
\indy{Index}{Marchal cell}%
\bigskip
\case{The $2$-cell} of $\bu$ is
\begin{eqnarray*}
\cell(\bu,2) &=& \op{conv}( \{\u_0, \u_1\}\cup R_2),\quad\text{where }  \vspace{6pt}\\
R_2 &=& \{\p \in R(\bu)\cap \Omega(V,\trunc{\bu}{1}) \mid \norm{ \u_0}{\p}=\norm{ \u_1}{\p} =\sqrt2\}.
\end{eqnarray*}
\bigskip
\case{The $3$-cell} of $\bu$ is defined to be empty unless 
\begin{displaymath}
h(\trunc{\bu}{2}) <\sqrt2 \le h(\trunc{\bu}{3}).
\end{displaymath}
When this inequality holds, there is a a unique point $\xi(\trunc{\bu}{2})$ in
$\op{conv}\{\omega(\trunc{\bu}{2}),\omega(\trunc{\bu}{3})\}$ at distance exactly
$\sqrt2$ from $ \u_0$.  Define the $3$ cell to be
\begin{displaymath}
\cell(\bu,3) = \op{conv}\{ \u_0, \u_1, \u_2,\xi(\trunc{\bu}{2})\}.
\end{displaymath}
\bigskip
\case{The $4$-cell} of $\bu$ is defined to be empty unless
\begin{displaymath}
h(\trunc{\bu}{3}) <\sqrt2.
\end{displaymath}
When this inequality holds, define the $4$ cell to be
\begin{displaymath}
\cell(\bu,4) = \op{conv}\{ \u_0, \u_1, \u_2, \u_3\}.
\end{displaymath}
\end{definition}
\indy{Notation}{zzxi@$\xi(\cdot)$}%

Note the the $0$ and $1$-cells are always subsets of a single simplex
$R$.  However, the $2$, $3$, and $4$-cells lie in a union of
simplices.

\begin{lemma}\guid{RVFXZBU}\rating{400}  The $0,\ldots,4$-cells of the parameters $\bu\in  \bV(3)$
give a partition of $\ring{R}^3$.  An $i$-cell is never equal to a
$j$-cell when $i\ne j$. For $k\ge 2$, two $k$-cells
$\cell(\bu,k)=\cell(\bv,k)$ are equal exactly when some permutation carries
$\trunc{\bu}{k-1}$ to
 $\trunc{\bv}{k-1}$.
\end{lemma}

\begin{proof} First, the proof establishes that cells are either
disjoint (up to a null set) or equal.  At the same time, it
determines exactly when two $k$-cells are equal to one another.

By Lemma~\ref{lemma:Rconv}, the $4$-cell $\cell(\bu,4)$ is a union
of the simplices $R(\bv)$, as $\bv$ runs over rearrangements of $\bu$.
Two $4$-cells that meet in a set of positive measure are equal.
Every $4$-cell is a union of simplices $R(\bu)$ with
$h(\bu)<\sqrt2$.  This condition gives $\cell(\bu,i)=\emptyset$, for
$i=0,1,2,3$.

Similarly, the $3$-cell is a union of the convex hulls
$\op{conv}(\{\xi(\trunc{\bv}{2})\}\cup R(\trunc{\bv}{2}))$ as $\trunc{\bv}{2}$ runs over
rearrangements of $\trunc{\bu}{2}$.  Note that the point
$\xi(\trunc{\bv}{2})=\xi(\trunc{\bu}{2})$ is independent of the rearrangement, since
it is determined as the point at distance $\sqrt2$ from $ \u_0$
along the line through from $\omega(\trunc{\bv}{2})=\omega(\trunc{\bu}{2})$
perpendicular to the plane $\op{aff}\{ \u_0, \u_1, \u_2\}$ (in the
half-space of $\trunc{\bu}{3}$). Two $3$-cells that meet in a set of
positive measure are equal.  Their parameters are equal:
$\trunc{\bu}{2}=\trunc{\bv}{2}$.  The intersection $\cell(\bu,3)$ cannot meet
$\cell(\bu,i)$, for $i<3$, in a set of affine dimension three, because the
plane $\op{aff}\{ \u_0, \u_1,\p\}$ separates them.

The $2$-cell with parameter $\bu$ is contained in the right-circular cone
\begin{displaymath}
\op{rcone}( \u_0, \u_1,\cos(\op{arc}(\norm{ \u_0}{ \u_1},\sqrt2,\sqrt2)))
\end{displaymath}
This cone separates the $2$-cell from the $0$ and $1$-cells with the
same parameter $\bu$.  The $1$-cell is separated from $0$-cells by the
sphere of radius $\sqrt2$, centered at $ \u_0$.

\claim{Finally, every point $\p\in\ring{R}^3$ belongs to a cell.}
Indeed, by Rogers's partition, the point $\p$ belongs to a simplex
$R(\bu)$.  If $h(\bu)<\sqrt2$, then $\p$ belongs to a $4$-cell.
Otherwise $\p\in R(\bu)$ belongs to $\cell(\bu,i)$ according to which
side of the separating plane, right-circular cone, and sphere the
point lies, as described above.
\end{proof}


\section{Dense Sphere Packings and the Kepler Conjecture}

\subsection{the primitive state of our subject revealed}


\begin{theorem}[Sphere Packing Problem (Kepler Conjecture)]\guid{IJEKNGA}
\label{theorem:kepler}   No packing of congruent balls in
Euclidean three space has density greater than that of the
face-centered cubic packing.
\end{theorem}

\begin{remark}
This density is $\pi/\sqrt{18}\approx 0.74.$  There are other
packings, such as the hexagonal close packing, that attain this
same density.
\end{remark}

The proof of this result is presented in this book. This section
describes the outline of the proof and gives references to
the sources of the details of the proof.



\begin{definition}[negligible,~fcc-compatible]\label{def:negligible}
A function $G:V\to \ring{R}$ on a set $V\subset\ring{R}^3$
is \newterm{negligible\/}
if there is a constant $c_1$ such that for all $r\ge1$,
% and all $\p\in\ring{R}^3$,
\begin{displaymath}\sum_{\v\in V(\orz,r)} G(\v) \le c_1
r^2.\end{displaymath}
A function $G: V\to\ring{R}$ is
\newterm{fcc-compatible\/}
if for all $\v\in V$, 
\begin{displaymath}\sqrt{32}\le \op{vol}(\Omega(V,\v)) +
G(\v).\end{displaymath}
\indy{Index}{negligible}%
\indy{Index}{fcc-compatible}%
\indy{Notation}{G (negligible function)}%
\end{definition}


\begin{remark}
The value $\op{vol}(\Omega(V,\v)) + G(\v)$ may be interpreted as a
{\it corrected\/} volume of the Voronoi cell. The constant
$\sqrt{32}$ that appears in the definition of fcc-compatibility is
the volume of the Voronoi cell in the face-centered cubic and
hexagonal-close packings.  The corrected volume is at least the
volume of these Voronoi cells when the correction term $G$ is
fcc-compatible.  \indy{Index}{corrected volume}%
\end{remark}

% \begin{remark} In \cite{Hales:2006:DCG}, the full Voronoi cell
%   $\Omega(V,\v)$ is used, rather than $\Omega(V,\v)$.  The truncation at
%   radius $2$ is just a matter of convenience to guarantee the
%   boundedness and hence the finite volume of the (truncated) Voronoi
%   cell.  In \cite{Hales:2006:DCG}, the same effect was achieved by
%   requiring all packing%s
%   to be saturated.  Drop the assumption of saturation on $ V$.
%\end{remark}



The density $\delta( V,\p,r)$ of a packing $ V$ within a bounded
region of space is defined as a ratio. The numerator is volume of
$B(V,\p,r)$, defined as the intersection with $B(\p,r)$ of the union
of all balls in the packing.  The denominator is the volume of
$B(\p,r)$. 
%An ordered pair $( V,\v)$ with $\v\in V$ is called a \newterm{centered
%packing}.  \indy{Index}{packing!centered}%
\indy{Notation}{ZZdelta@$\delta( V,\p,r)$}%
\indy{Notation}{V@$ V$ (packing)}%
%\indy{Notation}{V@$ V^*$(packing)}%


\begin{lemma}\guid{JGXZYGW}
\oldrating{150}
\formalauthor{Nguyen Tat Thang}
\rating{0}
\label{lemma:deltabound} If there exists a 
\newterm{negligible} \newterm{fcc-compatible} function
$G: V\to\ring{R}$ for a 
%saturated 
packing $ V$, then there
exists a constant $c$ such that for all $r\ge1$,
% and all $\p\in\ring{R}^3$, %%  removed on  Jan 16, 2009 after formalization.
\begin{displaymath}
\delta( V,\orz,r)
\le \pi/\sqrt{18} + c/r.
\end{displaymath}
%The constant $c$ depends on $ V$ only through the constant
%$c_1$ of Definition~\ref{def:negligible}.
\end{lemma}

%\begin{remark}\label{conj:fcc-neg}
%For every saturated packing $ V$, there exists a negligible
%fcc-compatible function $G: V\to R$.
%\end{remark}



\begin{proof}
The volume of $B( V,\orz,r)$ is at most the product of the volume
$4\pi/3$ of a single ball $4\pi/3$ with the number of centers in
$B(\orz,r+1)$.  Hence
\begin{equation}
\op{vol}\, B( V,\orz,r) \le \card( V(\orz,r+1)) 4\pi/3.
\label{eqn:Abound}
\end{equation}

%In a %saturated packing 
Each truncated Voronoi cell is contained in a ball of
radius $2$ that is concentric with the unit ball in that cell.  The volume
of the large ball $B(\orz,r+3)$ is at least the combined volume of 
all truncated Voronoi
cells centered in $B(\orz,r+1)$. This observation,
combined with fcc-compatibility and negligibility, gives
\begin{equation}
\begin{split}
\sqrt{32}\,\,\card( V(\orz,r+1))
&\le \sum_{\v\in V(\orz,r+1)} (G(\v) +
\op{vol}(\Omega(V,\v))) \\
&\le c_1 (r+1)^2 + \op{vol}\,B(\orz,r+3) \\
&\le c_1 (r+1)^2 + (1+3/r)^3 \op{vol}\,B(\orz,r)
\label{eqn:Bbound}
\end{split}.
\end{equation}
\indy{Index}{fcc-compatible}%
Recall that $\delta( V,\orz,r)=
\op{vol}\,B( V,\orz,r)/\op{vol}\,B(\orz,r)$. Divide Inequality
\ref{eqn:Abound} through by $\op{vol}\,B(\orz,r)$.  Use
Inequality~\ref{eqn:Bbound} to eliminate $\card( V(\orz,r+1))$ from the
resulting inequality.  This gives
\begin{displaymath}\delta( V,\orz,r)
\le \frac{\pi}{\sqrt{18}} (1+3/r)^3 + c_1 \frac{(r+1)^2}{r^3\sqrt{32}}.
\end{displaymath}
The result follows for an appropriately chosen constant $c$
(depending on $c_1$).
\end{proof}

\begin{remark} \label{remark:precise} The precise meaning of the
sphere packing problem is to prove the bound bound $\delta( V,\orz,r)
\le \pi/\sqrt{18} + c/r$ for every packing $ V$.  Thus, by the
preceding lemma, the existence of a negligible fcc-compatible
function provides the solution to the packing problem.  The strategy
will be to define a negligible function and then to solve an
optimization problem in finitely many variables to establish that
the function is also fcc-compatible.
\end{remark}


\subsection{negligibility}

This section shows how the existence of a fcc-compatible negligible
function (Remark~\ref{rem:precise})  will follow from an explicit
estimate related to the the distances $h(\bu)$, where $\bu\in \bV(1)$.

%\begin{note}%
%Replace $\sol_0/\pi =\Delta_1$ to simplify formulas.
%\end{note}

Define the following constants and functions: 
\begin{eqnarray}\label{eqn:m-def}
\sol_0 &=& 3\arccos(1/3)-\pi\\
%\Delta_1 &=& (3\arccos(1/3)-\pi)/\pi\\
\tau_0 &=& 4\pi  - 20\sol_0\\
m_1 &=& \sol_0 2\sqrt2/\tau_0 = 1.012\ldots \\ %% K 
m_2  &=&  (6\sol_0- \pi)\sqrt2/(6 \tau_0) = 0.0254\ldots\\ %% M 
h_+ &=& 1.3254 \hbox{~(exact rational value)}
\end{eqnarray}
The constant $\sol_0$
is the area of a spherical triangle with sides $\pi/3$.
Let $M:\ring{R}\to\ring{R}$ 
be the following piecewise polynomial function (Figure~\ref{fig:M}):
\begin{equation}\label{eqn:M}
M(h) =
\begin{cases}
% (\sqrt2-h) (h-1.3254) (9h^2 - 17 h + 3)/(1.627 (\sqrt2-1))& h\le\sqrt2\\
\dfrac{\sqrt2-h}{\sqrt2-2}~ \dfrac{h_+-h}{h_+-1} ~\dfrac{17 h - 9 h^2 - 3}{5} & h \le \sqrt2.\vspace{3pt} \\
0 & h >\sqrt2.
\end{cases}
\\
\end{equation}
\begin{figure}[htb]
\centering
\szincludegraphics[width=60mm]{\pdfp/Mfun.eps}
% Plot[Mfun[h], {h, 1, Sqrt[2]}]
% copied to Preview, then saved, then converted to eps via pdf2eps.
\caption{The quartic polynomial $M$.}
\label{fig:M}
\end{figure}

Simple calculations based on the definitions give
\begin{equation}\label{eqn:km}m_1 - 12m_2 = \sqrt{1/2}\end{equation}
and
\begin{equation}M(1) = 1,\quad M(h_+)=0,\quad M(\sqrt2) =0.\end{equation}


\begin{conjecture}[Marchal]\guid{PHNFUXP}\rating{ZZ}\label{conj:m1} For any packing $ V$, and
any $ \u_0\in V$,
\begin{displaymath}
\sum_{\bu\in \bV(1)} M(h(\bu)) \le 12.
\end{displaymath}
\end{conjecture}

Marchal's conjecture is still open.  This book proves a variant of
Marchal's conjecture.

\begin{theorem}\guid{KIZHLTL}\rating{300}\label{theorem:mk1}
Marchal's Conjecture~\ref{conj:m1} implies
that for every saturated packing $V$, there exists a negligible fcc-compatible function
$G:V\to \ring{R}$.
\end{theorem}

\begin{note}%XX
This book contains a number of nonlinear inequalities that have been
established by interval-arithmetic calculations by computer.  Some
of these interval arithmetic calculations are still in the process
of being verified.  The approach to the proof of the Kepler
conjecture described here is still work in progress.  A description
of the inequalities and their current status can be found
at~\cite{hales:2009:nonlinear}.
\end{note}

\begin{proof} 
It is enough to show that $G( \u_0) = -\op{vol}(\Omega(V, \u_0)) + 8
m_1 - \sum 8 m_2 M(h(\bu))$ is fcc-compatible and negligible.
%The result then follows from Lemma~\ref{lemma:deltabound}.  
The function $G$ is fcc-compatible directly
by equation~\eqn{eqn:km}
and Conjecture~\ref{conj:m1}:
\indy{Index}{negligible}%
\indy{Index}{fcc-compatible}%
\begin{eqnarray*}
\sqrt{32} &=& 8 m_1 - 8\cdot 12 m_2\\
&\le& 8 m_1 - 8 m_2 \sum M(h)\\
&=& \op{vol}(\Omega(V, \u_0)) + G( \u_0).
\end{eqnarray*}
The issue is to prove it negligible.  More explicitly, one must find a
constant $c$ such that for all $r\ge 1$ and all $\p\in\ring{R}^3$:
\begin{equation}\label{eqn:neg}
-\sum G( \u) = \sum \op{vol}(\Omega(V, \u)) -\sum 8m_1 + \sum \sum 8 m_2 M(h) \ge c r^2,
\end{equation}
where the outer nested sum runs over $ \u\in  V(\p,r)$.

Lemmas~\ref{lemma:Zr2} and \ref{lemma:V-finite} show that the number
of points of $ V$ near the boundary of $B(\p,r)$ is bounded by $c
r^2$.

Let $V(X)$ be the intersection of $ V$ with the set of extremal points
of the $k$-cell $X$.  Explicitly, $V(X)=\emptyset$ if $k=0$; and $V(X)
= \{ \u_0,\ldots, \u_{k-1}\}$ in general.  Each $k$-cell is measurable
and eventually radial at each $ \u\in V(X)$.  Define the total solid
angle of $X$ to be
\begin{displaymath}
\op{tsol}(X) = \sum_{ \u\in V(X)} \sol(X, \u).
\end{displaymath}
\indy{Index}{angle!total solid}%
\indy{Index}{extreme point}%
\indy{Notation}{tsol@$\op{tsol}$}%

Let $E(X)$ be the set of extremal edges of the $k$-cell $X$ in $ V$.
More precisely, let
\begin{displaymath}E(X)=\{\{ \u_i, \u_j\}\mid \u_i\ne \u_j\in
V(X)\}.\end{displaymath}
In particular, $E(X)$ is empty for $0$ and $1$-cells, and contains
$\tbinom{k}{2}$ pairs when $k\ge 2$.
\indy{Notation}{1@$\tbinom{n}{k}$}%

The value $\dih(X,e)$ of the dihedral angle indexed by an edge $e\in
E(X)$ is defined to be the dihedral angle along that edge of the
boundary.  The (single) dihedral angle of a $2$-cell is the same as
the radian angle subtended by the arc $R_2$, which was defined in the
construction of $2$-cells.  The dihedral angle of a $3$ or $4$-cell is
the dihedral angle along the given edge of the simplex $X$.
\index{Notation}{dih@$\dih$} \index{Index}{angle!dihedral} Each
element $e=\{ \u_i, \u_j\}\in E(X)$ also determines the real number
$h(e) = \norm{ \u_i}{ \u_j}/2$.

For any function $f:\ring{R}\to\ring{R}$ and any cell $X$, set
\begin{equation}\label{eqn:gamma-def}
\gamma(X,f) =  \op{vol}(X)
-\left(\frac{2m_1}{\pi}\right) \op{tsol}(X) + \left(\frac{8m_2}{\pi}\right)
\sum_{e\in E(X)} \dih(X,e)  f(h(e))
\indy{Notation}{ZZddgamma@$\gamma$ (fundamental estimate)}%
\end{equation}
By Calculation~\ref{calc:marchal}, Marchal's fundamental estimate
holds for any cell
$X$: %% cc:mar are the k-cell estimates for non-cell clusters.
\begin{equation}\label{eqn:mfe}
\gamma(X,M)\ge 0.
\end{equation}
(Note that this is an inequality in at most six variables; the most
difficult case to prove is that of a $4$-cell.)  Formulas for the
volumes and solid angles appear in Chapter~\ref{chapter:volume}.  An
explicit formula for the dihedral angle appears in
Chapter~\ref{part:trig}.

The sum of the inequality~\eqn{eqn:mfe} over all cells in a large ball
$B(\p,r)$ gives an inequality of the form $T_1 + T_2 + T_3\ge 0$ for
three terms $T_i = T_i(r)$ of \eqn{eqn:gamma-def}.  The desired
equation~\eqn{eqn:neg} consists of three corresponding terms
$T'_i(r)$.  It is enough to show that
\begin{displaymath}
T_i'(r) \ge T_i(r) + c_i r^2,
\end{displaymath}
for some constants $c_i$.

The sum of the volumes of the Voronoi cells $ \u\in B(\p,r)$ is not
exactly the volume of $B(\p,r)$, because of the contribution at the
boundary of $B(\p,r)$ of Voronoi cells that are only partly contained
in $B(\p,r)$.  Similarly, the sum of the various $k$-cells, for
$X\subset B(\p,r)$ is not exactly the volume of $B(\p,r)$, because of
contribution from the boundary. The boundary contributions have order
$r^2$. Thus,
\begin{displaymath}
T_1'= \sum_{ \u\in  V(\p,r)} \op{vol}(\Omega(V, \u)) \ge \sum_{X\subset B(\p,r)} \op{vol}(X) + c_1 r^2 = T_1 + c_1 r^2.
\end{displaymath}


The estimates on the other terms are similar.  The solid angles
around each point sum to $4\pi$.
In Landau big O notation, this gives
\begin{eqnarray*}
\sum_{X\subset B(\p,r)} \op{tsol}(X) &=& 
\sum_{X\subset B(\p,r)} \sum_{ \u\in V(X)} \sol(X, \u)\\
&=&\sum_{ \u\in  V(\p,r)} \sum_{X\mid  \u\in V(X)} \sol(X, \u) + O(r^2)\\
&=&\sum_{ \u\in  V(\p,r)} 4\pi    + O(r^2).
\end{eqnarray*}
Hence
\begin{displaymath}
T_2' = -\sum_{ V(\p,r)} 8 m_1 = -\sum_{X\subset B(\p,r)}\left(\frac{2m_1}\pi\right) \op{tsol(X)} + c_2 r^2 = T_2 + c_2 r^2.
\end{displaymath}
Similarly, the dihedral angles around each edge sum to $2\pi$.  A
factor of $2$ enters the following calculation, because there are two
ordered pairs for each unordered pairs $\{ \u_0, \u_1\}$:
\begin{eqnarray*}
&\phantom{=}&\sum_{X\subset B(\p,r)} \sum_{e\in E(X)} \dih(X,e)  M(h(e)) \vspace{3pt}\\
&=&\sum_{e\subset B(\p,r)} \sum_{X: e\in E(X)} \dih(X,e)  M(h(e)) +O(r^2)\vspace{3pt}\\
&=&\sum_{e\subset B(\p,r)} 2\pi M(h(e)) + O(r^2)\vspace{3pt} \\
&=&\sum_{ \u_0\in  V(\p,r)} \sum_{ \u_1\in  V(\p,r) } \pi M(h( \u_0, \u_1)) + O(r^2).\\
\end{eqnarray*}
Finally,
\begin{displaymath}
T_3' = \sum\sum 8 m_2 M(h(\bu)) \ge \left(\frac{8m_2}\pi\right)
\sum_{X\subset B(\p,r)}\sum_{e\in E(X)}\dih(X,e) M(h(e)) + c_3 r^2 = T_3 + c_3 r^2.
\end{displaymath}
\end{proof}




\section{Clusters}

\begin{summary} Marchal's Conjecture is still open.  This section
gives another conjecture that is closely related to Marchal's
Conjecture.  In this new conjecture, a piecewise linear function $L$
replaces the piecewise polynomial function $M$.  More crucially, the
support of the function $L$ is contained in
$\leftclosed2,2.52\rightclosed]$.  By contrast, the support of
Marchal's function is much larger:
$\leftclosed2,2.6508\rightclosed$.  This small difference in the
support of the function creates an enormous difference in the
difficulty of the conjectures.

The conjecture formulated in this section also implies the existence
of fcc-compatible negligible functions.  To prove this, it is
helpful to group Marchal cells together, into what are called
\newterm{clusters}.  This section makes a detailed study of clusters
in order to produce a negligible function.

The sections and chapters that follow this one give a proof of the
conjecture in this section.  The proof of this conjecture is the
main intermediate result in the journey to prove the Kepler
conjecture.
\end{summary}

% This section shows how to improve on the estimates of the previous
% section by combining various cells into {\it cell clusters}.
Recall $M(h_+) = 0$, where   $h_+ = 1.3254$.
\indy{Index}{cell cluster}%

\begin{definition}[$L$,~$h_0$,~$h_-$]\label{def:L}
Set
\begin{displaymath}
h_0 = 1.26\\  %%\hm
\end{displaymath}
Let $L:\ring{R}\to\ring{R}$ be the piecewise linear function 
\begin{displaymath}
L(h) = \begin{cases}
\dfrac{h_0-h}{h_0-1}, & h \le h_0 \\
0, & h\ge h_0. \\
\end{cases}
\end{displaymath}
It follows from the definition that
\begin{displaymath}
L(1) = 1\quad L(\hm) = 0.
\end{displaymath}
Let $h_- = 1.23175\ldots$ be the unique root of the quartic polynomial
$M(h)-L(h)$ lying in the interval $[1.2,1.3]$.
\indy{Notation}{L@$L$ (linear function)}%
\indy{Notation}{h@$h_- = 1.23175\ldots$}%
\indy{Notation}{h@$h_0 = 1.26$}%
\end{definition}

%%
\begin{figure}[htb]
\centering
\szincludegraphics[width=60mm]{\pdfp/Lfun.eps}
% Plot[{Mfun[h],Lfun[h]}, {h, 1.2, 1.35}]
% copied to Preview, then saved, then converted to eps via pdf2eps.
%% WW very big .eps file!
\caption{Detail of the quartic $M$ and linear function $L$.}
\label{fig:L}
\end{figure}

The inequality $L(h)\ge M(h)$ holds except when $h\in [h_-,h_+]$.  The
aim of this section is to prove a variant of Theorem~\ref{theorem:mk1}
that uses the function $L$ rather than $M$.  For this, one needs to
combine cells into groups called cell clusters.

\begin{definition}[critical edge,~$\op{EC}$,~$\op{wt}$]\label{def:wt}
Let $X$ be a $k$-cell, where $k\ge 2$.  Let $e\in E(X)$.  An edge is
\newterm{critical} if $h(e)\in[h_-,h_+]$.  Let $\op{EC}(X)\subset
E(X)$ be the set of critical edges of $X$.  If $X$ is any cell such
that $\op{EC}(X)$ is nonempty, let the weight $\op{wt}(X)$ of $X$ be
$1/\card(\op{EC}(X))$.
\end{definition}
\indy{Index}{critical!edge}%
\indy{Notation}{E@$\op{EC}$ (critical edges)}%
\indy{Notation}{wt@$\op{wt}$ (weight)}%

\begin{definition}[$\beta$,~$\op{bump}$] \label{def:beta}
Set 
\begin{displaymath}
\op{bump}(h) = 0.005 (1 - (h-h_0)^2/(h_+-h_0)^2).
\end{displaymath}
If $X$ is a $4$-cell with exactly two critical edges, then set
\begin{displaymath}
\beta(e,X) = \op{bump}(h(e)) - \op{bump}(h(e')), \text{ where } \{e,e'\} = \op{EC}(X).  
\end{displaymath}
Otherwise, for all other edges in all other cells, set $\beta(e,X) = 0$.
\end{definition}
\indy{Notation}{bump@$\op{bump}$}%
\indy{Notation}{ZZbeta@$\beta$ (bump)}%

\begin{definition}[cell cluster,~$\Gamma$,~$\gamma_L$]\label{def:gammaL}
Let $e\in \op{EC}(X)$ be a critical edge of a $k$-cell for some $k\ge 1$.
A cell cluster is the set 
\begin{displaymath}
\op{cluster}(e) = \{X\mid e\in E(X)\} 
\end{displaymath}
\indy{Notation}{cluster}%
of all cells around $e$. 
If $Z$ is a finite set of cells, define
\indy{Notation}{ZZddgamma@$\gamma_L$ (cell cluster)}%
\begin{displaymath}
\Gamma(Z) = \sum_{X\in Z} \gamma_L(X) \op{wt}(X) +\beta(e,X),\quad\hbox{ where }\quad
\gamma_L(X) = \gamma(X,L).
\end{displaymath}
%and where $\op{wt}(X)$ is the weight of $X$.
\indy{Notation}{ZZddGamma@$\Gamma$}%
\indy{Notation}{ZZcamma@$\gamma_L$}%

\end{definition}
\indy{Index}{cell cluster}%

\begin{theorem}[cell cluster
estimate]\guid{OXLZLEZ}\rating{1500}\label{lemma:cluster}
Let $Z$ be any cell cluster.  Then $\Gamma(Z)\ge 0$.
\end{theorem}

The proof of this theorem occupies the rest of the section.  


\begin{conjecture}\guid{BJERBNU}\rating{ZZ}\label{conj:L12} For any packing $ V$, and
any $ \u_0\in V$,
\begin{equation}\label{eqn:L12}
\sum_{ \u_1\in V\mid h( \u_0, \u_1)\le \hm} L(h( \u_0, \u_1)) \le 12.
\end{equation}
\end{conjecture}

\begin{theorem}\guid{UPFZBZM}\rating{300}\label{theorem:mk2}
Conjecture~\ref{conj:L12} implies the Kepler conjecture.
\end{theorem}

\begin{proof} The proof imitates the proof of
Theorem~\ref{theorem:mk1}.  It is enough to show that $G_L( \u_0) =
-\op{vol}(\Omega(V, \u_0)) + 8 m_1 - \sum 8 m_2 L(h(\bu))$ is
fcc-compatible and negligible.  The function $G_L$ is fcc-compatible
directly from equation~\eqn{eqn:km} and Conjecture~\ref{conj:L12}.

The theorem follows from a proof that $G_L$ is negligible.  More
precisely, one needs to show there exists a constant $c$ such that
for all $r\ge 1$ and all $\p\in\ring{R}^3$:
\begin{equation}\label{eqn:A2neg}
\sum \op{vol}(\Omega(V, \u)) -\sum 8m_1 + \sum \sum 8 m_2 L(h) \ge c r^2,
\end{equation}

For cells $X$ that do not belong to a cell cluster,
the proof is just as in the proof of Theorem~\ref{theorem:mk1}.
If $\op{EC}(X)=\emptyset$, then 
$L(h(e))\ge M(h(e))$ for each edge $e\in E(X)$, and
\begin{displaymath}\gamma_L(X)\ge \gamma(X,M)\ge 0\end{displaymath} 
by inequality \eqn{eqn:mfe}.

Note that the function $\beta(e,X)$ averages to zero for any $4$-cell $X$:
\begin{displaymath}
\sum_{e\in \op{EC}(X)} \beta(e,X) = 0.
\end{displaymath}
Hence the terms involving $\beta$ in sums may be safely disregarded.
(The terms involving $\beta$ may be disregarded here, but they are
needed for the proof of Lemma~\ref{lemma:cluster} in
Section~\ref{sec:3or4}.)

Theorem~\ref{lemma:cluster} gives the required inequality for cell
clusters.  Again, using big O notation,
\begin{eqnarray*}
\sum_{X\subset B(\p,r)} \gamma_L(X) &=&
\sum_{X\subset B(\p,r)\mid \op{EC}(X)\ne\emptyset} \gamma_L(X) +
\sum_{X\subset B(\p,r)\mid \op{EC}(X)=\emptyset} \gamma_L(X) \vspace{6pt}\\
&\ge& \sum_{X\subset B(\p,r)\mid \op{EC}(X)\ne\emptyset} \gamma_L(X)\vspace{6pt} \\
&=&\sum_{X\subset B(\p,r)}\gamma_L(X)\sum_{e \in \op{EC}(X)}\op{wt}(X) + O(r^2)\vspace{6pt}\\
&=&\sum_{e\subset B(\p,r)}\sum_{X\mid e \in \op{EC}(X)}\gamma_L(X)\op{wt}(X) + O(r^2)\vspace{6pt}\\
&=&\sum_{e\subset B(\p,r)}\Gamma(\op{cluster}(e)) + O(r^2)\vspace{6pt}\\
&\ge& ~~O(r^2).
\end{eqnarray*}


From the definition of $\gamma_L$, the sum $\sum \gamma_L(X)$ may be
expanded as the sum of three terms, $T_1+T_2+T_3$, and compared term
by term with \eqn{eqn:A2neg}:
\begin{displaymath}
T_i' \ge T_i + c_i r^2.
\end{displaymath}
This proceeds exactly as in the proof of Theorem~\ref{theorem:mk1}.
\end{proof}

\begin{corollary}\guid{RDWKARC}\rating{ZZ}\label{cor:CE} If the Kepler Conjecture is false,
there exists a finite packing $ V$ with $\orz\in V$, such that
\begin{equation}\label{eqn:CE}
\sum_{ \u\in V \mid h(\orz, \u)\le h_0} L(h(\orz, \u)) > 12.
\end{equation}
\end{corollary}

\begin{proof} If the Kepler conjecture is false,
inequality~\eqn{eqn:L12} is violated for some packing $ V$ and some
$ \u_0\in V$.  After the replacement of $ V$ with $ V - \u_0$ and $
\u_0$ with $\orz$, it follows without loss of generality that $
\u_0=\orz\in V$.  After the replacement of $ V$ with the finite
subset
\begin{displaymath}
\{ \u\in V\mid h(\orz, \u)\le h_0\},
\end{displaymath}
it follows without loss of generality that the packing is finite.
\end{proof}


Turn to the proof of Lemma~\ref{lemma:cluster}.  Let $Z$ be a cell
cluster and let $e$ be the critical edge shared by the cells in the
cluster.  Call this critical edge the \newterm{spine}.  Consider all
the faces along the spine $\{ \u_0, \u_1\}$, consisting of three
points $\{ \u_0, \u_1, \u_2\}$ in the packing with circumradius less
than $\sqrt2$.  Call such a face a \newterm{leaf}. 
\indy{Index}{edge!spine}%
\indy{Index}{edge!critical}%
\indy{Index}{leaf}%

Consecutive cells around the spine are \newterm{adjacent}.  A cell
adjacent to a $4$-cell is a $3$-cell or another $4$-cell.  A cell
adjacent to a $2$-cell is a $3$-cell.  There are no $0$ or $1$-cells
along a critical edge.  \indy{Index}{adjacent}%
\indy{Index}{quarter}%

Call a $4$-cell a \newterm{quarter}, when it has exactly one critical
edge and all other edges of the simplex have length at most $2 h_-$.
The weight of any quarter is $1$.


\subsection{two leaves}

The proof will be divided into cases, according to the number of
leaves along the critical edge.

\claim{It suffices to prove Lemma~\ref{lemma:cluster} when the cluster
contains at least one quarter and at least two leaves.} Indeed, by
Calculation~\ref{calc:cc:qtr}, if $X$ is any cell,
then % gammaL is nonneg on quarters. cc:qtr ~[GLFVCVK]
\begin{displaymath}
\gamma_L(X) \op{wt}(X) + \beta(e,X)\ge 0
\end{displaymath} 
when $X$ is not a quarter.  This is the desired inequality.  Also, a
quarter is flanked by two leaves.

Consider a cluster with exactly two leaves.
Without loss of generality, the two leaves flank a quarter
$X$. 
The azimuth angle of what remains outside the quarter
is greater than $\pi$.  Thus, there must be a $3$-cell
along each leaf.  Let $Y$ be one of these $3$-cells.
The cell $Y$ has weight $1$.
Then 
\begin{equation}\label{eqn:34}
\Gamma(Z)\ge \gamma_L(X)+\gamma_L(Y)\ge 0,
\end{equation}
by Calculation~\ref{calc:cc:2bl}.
%a calculation~\cite[FHBVYXZ]
% 2-leaf calculation, gammaL(fourcell)+gammaL(threecell) >=0. % cc:2bl:
\indy{Index}{azimuth}%
\indy{Index}{angle!azimuth}%




\subsection{five or more leaves}

Let $B$ be the set of cells in the cluster that lie between any two
consecutive leaves.  $B$ is either a singleton set containing a
$4$-cell, or a set of three cells: a $2$-cell and two adjacent
$3$-cells.  Write $\op{azim}(B)$ for the azimuth angle formed by the
two leaves.  By Calculation~\ref{calc:cc:5bl}, the cells between two
consecutive leaves satisfy an
inequality: % five or more leaves along a spine are found
% at~[ZTGIJCF].  % cc:5bl:

\begin{displaymath}
\sum_{X\in B} \gamma_L(X)\op{wt}(X) + \beta(e,X) \ge a + b\,\op{azim}(B),
\end{displaymath}
where
\begin{displaymath}
a= 0.0560305, \quad\text{and}\quad  b= -0.0445813.
\end{displaymath}
It follows that
\begin{displaymath}
\Gamma(Z) \ge 5 a + b\, (2\pi) > 0.
\end{displaymath}

\subsection{three or four leaves}\label{sec:3or4}

In the case of three and four leaves, the proof relies to an even
greater extent on computer calculations.  
Lemma~\ref{lemma:cluster} asserts a nonlinear inequality.  The inequality
asserts that some continuous function $f$ is positive on a compact
domain $D$ in Euclidean space.  Rigorous methods of global nonlinear
optimization can be used to show that the function $f$ is indeed
positive.

Details about global nonlinear optimization appear in the appendix.
The method is linear relaxation, which can be briefly described as
follows.\footnote{Linear relaxations appear again later in the
solution of significantly more difficult nonlinear optimzation
problems.}  The domain $D$ is partitioned into finitely many subsets
$D_1,\ldots, D_r$.  The positivity of $f$ is established on each
subset $D_i$.  The graph $\{(f(x), x)\mid x\in D_i\}$ of $f$ on $D_i$
is a subset of a polyhedron $P_i$.  The inequalities defining the
polyhedron can be determined explicitly.  A linear program computes
the minimum of the first coordinate over $P_i$.  This minimum is
positive.  Since the graph is contained in $P_i$, the values of $f$ on
$D_i$ must also be positive.

This strategy has been implemented and gives the desired lower bound.
The linear programming has been implemented as a {\tt MathProg} model
in Calculation~\ref{calc:shorts}.\footnote{{\tt MathProg} implements a
subset of the {\it AMPL} modeling language.  The computer code
giving the model appears in {\tt shorts.mod} and the computer code
controlling the branching appears in {\tt shorts.ml}.}  This model
contains the number of leaves, variables representing the edges and
the azimuth angles between consecutive leaves.

The proof that each graph is contained in a explicit polyhedron $P_i$
relies on nonlinear inequalities.  In fact, the proof requires over
one hundred nonlinear inequalities that have been established by
computer.

A function on the set $D$ with finite range partitions $D$ into
finitely many subsets, according to the image of a point.  Several
simple boolean functions and functions with finite range were used to
partition $D$ into subsets $D_i$: Are there three leaves or four?  Is
there a $2$-cell in the cluster?  Is the $4$-cell a quarter?  Is the
azimuth angle of a given cell greater than $2.3$?  Is the value of
$\gamma_L$ on a given quarter negative? Does a particular leaf have a
nonspline edge of length greater than $2h_-$?  What is the weight of a
given $4$-cell?  The inequalities that define the polyhedra $P_i$ have
been designed specifically for the subdomains $D_i$, according to the
answers to these questions.

These linear relaxations and are sufficient to prove the bound in all
but one case.  This is the case of four leaves, three quarters, and
one $4$-cell that has two critical edges: the spine and the edge
opposite the spine.  The other four edges of the $4$-cell have length
at most $2h_-$.  In this case as well, the inequality is established
by linear relaxation, but things are more involved.

The method to prove this case by computer is as follows.  Number the
four simplices $j=1,2,3,4$, with $j=1$ representing the $4$-cell of
weight $1/2$.  Write $\gamma^j$ in abbreviation of
$\gamma_L(X)\op{wt}(X) + \beta(e,X)$.  The desired inequality is
\begin{equation}\label{eqn:gpos}
\sum_{j=1}^4 \gamma^j > 0.
\end{equation}
The domain is a set of ordered four-tuples of simplices
$X_1,\ldots,X_4$ that fit together into an octahedron (the dihedral
angles along the spine sum to $2\pi$, the four simplices all have the
same spline length $y_1(X_j)$, and the shared edges are the same
length for the two simplices sharing the edge).  Instead of the single
inequality asserted by Lemma~\ref{lemma:cluster}, many inequalities of
the following form are established:
\begin{equation}\label{eqn:gpart}
\gamma^j + a_i \dih^j + b_i^j y_1 + c_i^j (y_2+y_3+y_5+y_6) + d_i^j > 0, 
\end{equation}
for all $X \in I_i^j$, \quad $i \in I$, and $j\in \{1,2,3,4\}$.  Here,
$\gamma^j$, $\dih^j$, and $y_i$ are all functions of $X$.  The simplex
$X$ has spine of length $y_1$ and other edges with lengths $y_k$.
Also, $\dih^j$ is the dihedral angle of $X$ along the spine.  $I$ is a
finite indexing set.  Each domain $I_i^j$ is a product of intervals in
$\ring{R}^6$, under the parameterization of a simplex by the lengths
of its six edges.  The union over $i$ of the sets
\begin{displaymath}
\{(X_1,\ldots,X_4)\mid~ X_j \in I_i^j,\text{ for } j=1,2,3,4.\}
\end{displaymath}
covers the entire domain of the desired inequality~\eqn{eqn:gpos}.   

\claim{A subset of this union already covers the domain.}  Indeed, the
dihedral angles of the four simplices along the spine sum to $2\pi$:
\begin{displaymath}
\sum_{j=1}^4 \gamma^j = 2\pi.
\end{displaymath}
Furthermore, the spine lengths of the simplices must agree: $y_1(X_j)
= y_1(X_k)$ for all $j,k\in\{1,2,3,4\}$.  Finally, each leaf flanks
two different simplices; the edge lengths of the leaf must agree.
This gives a collection of inequalities of the form $y_i(X_j) =
y_{i'}(X_{j'})$.  These are the subset relations.

The coefficients of the inequalities~\eqn{eqn:gpart}
are chosen so that for each $i$, the following inequality holds:
\begin{equation}\label{eqn:glin}
0 > a_i 2\pi + \sum_{j=1}^4 (b_i^j y_1 +  c_i^j (y_2(X_j)+y_3(X_j)+y_5(X_j)+y_6(X_j)) + d_i^j).
\end{equation}
(Notice that this inequality is linear in the variables $y_k(X_j)$ and
the domain is a product of intervals.  Hence this inequality is
particularly easy to check.)  The sum of the
inequality~\eqn{eqn:gpart} over $j$, the inequality~\ref{eqn:glin},
and the subset relation yield the desired inequality~\ref{eqn:gpos}.

A four-leafd cluster is an octahedron.  The set of octahedra is a
$13$-dimensional object, parameterized by $12$ external edges and one
diagonal (the spine).  By contrast, a simpliex in $\ring{R}^3$ is only
a $6$-dimensional object, parameterized by $6$ edges.  The four-leafed
cluster inequality is an inequality in $13$-dimensions.  The preceding
arguments reduce the $13$-dimensional inequality into a series of
$6$-dimensional inequalities.  The $6$-dimensional inequalities are
within within the reach of a computer.

The only question is how the magical coefficients
$a_i,b_i^j,c_i^j,d_i^j$ are obtained.  Clearly, the
inequalities~\eqn{eqn:glin} and \eqn{eqn:gpart} are linear in these
coefficients.  Thus, a they can be found by linear programming.  It is
somewhat troubling that there are infinitely many constraints, as each
point $X_j$ in the domain gives one constraint.  In practice, the
infinite number of constraints can be replaced by a finite collection.
Some information is lost in approximating the system with a finite
number of constraints.  However, the coefficients, once they are
guessed by approximations, can be checked independently by computer.
(An exact fit it not necessary; any coefficients that work will do.)
It was necessary to partition the domain into smaller pieces to
produce coefficients that work.  In other words, the indexing set $I$
contains more than one element.  After some experimentation, we found
a set $I$ of cardinality $23$ that works.  Through these methods,
coefficients were found.


\section{Counting spheres}


\subsection{solid angle}
\indy{Index}{polygon}%
\indy{Index}{polygon!regular}%


\begin{lemma}\guid{GOTCJAH}\rating{300}\label{lemma:ngon}
Let $P$ be a bounded polyhedron in $\ring{R}^3$ that contains $\orz$
as an interior point.  Let $F$ be a facet of $P$, given by an
equation
\begin{displaymath}
F = \{\p \mid \p \cdot \v = b\} \cap P.
\end{displaymath} 
Let $W_F$ be the corresponding topological component of $Y(V_P,E_P)$.  
Assume that $W_F$ contains the right-circular cone 
\begin{displaymath}
\op{rcone}^0(\orz,\v,h)
\end{displaymath}
for some $h>0$.
Then 
\begin{displaymath}
\sol(W_F) \ge 
2\pi - 2 k \,\arcsin\left(\,h\sin(\pi/k)\,\right),
\end{displaymath}
where $k$ is the number of edges of $F$.
\end{lemma}

%\begin{lemma}\guid{ZZ}\rating{0}\label{lemma:ngon:old}
%  Let $C$ be a circle on the unit sphere with arcradius $a<\pi/2$.
%  Among all spherical $n$-gons that contain $C$ (that is, among all
%  $n$-fold intersections of hemispheres containing $C$), that of
%  minimal area is the regular $n$-gon.
%\end{lemma}
%
%In other words, the minimal configuration consists of the
% intersection of $n$-hemispheres whose bounding great circles are
% tangent to the circle $C$ at $n$-equally spaced bounds around $C$.

\begin{proof} 
\claim{Without loss of generality, we may assume that each edge of
$F$ meets $\op{rcone}(\orz,\v,h)$ in a unique point.}  Indeed,
each edge of $F$ is the intersection of $F$ with another facet
$F_i$.  Write
\begin{displaymath}
F_i = \{\p \mid \p \cdot \v_i = b_i\} \cap P.
\end{displaymath}
The region $W_F$ consists of points $\p$ for which there exists a
$t>0$ such that $t\p \in\op{ri}(F)$ (by Lemma~\ref{lemma:WF}).  Hence
if we produce a second polyhedron $P'$ and facet $F'$ with
$\op{ri}(F')\subset \op{ri}(F)$, then
\begin{displaymath}
\sol(W_F)\ge \sol(W_{F'}).
\end{displaymath}
Shift the facet $F_i$ to
\begin{displaymath}
\op{aff}(F'_i) = \{\p \mid \p \cdot \v_i = b'_i\}.
\end{displaymath}
where $b'_i$ is chosen so that the point $\p_i\in \op{aff}(F'_i)\cap
\op{aff}(F)$ and lies on the boundary of $\op{rcone}(\orz,\v,h)$.
Define $P'$ by the intersection of $P$ with the half-spaces
\begin{displaymath}
\{\p \mid \p \cdot \v_i \le b'_i\},
\end{displaymath}
where the signs are chosen so that $b'_i>0$.  Let $F' = P'\cap F$.
Then $F'$ is a facet of $P'$.  The polyhedron $P'$ and facet $F'$
satisfy the assumptions of the lemma with the same constant $k= k_F =
k_{F'}$.  This completes the proof that we may assume that each edge
of $F$ meets $\op{rcone}(\orz,\v,h)$ in a unique point.  That is, the
edge is tangent to the right-circular cone.

Drop the primes from the notation: $P=P'$, $F=F'$, and so forth.  The
Rogers partition gives a partition of the polyhedron $P$ into
simplices.  There are $2k$ simplices in (the closure of) $W_F$.  The
solid angle of each simplex is the area of a spherical triangle.

Consider a spherical triangle with sides $a,b,c$ and opposite angles
$\alpha,\beta,\gamma$.  If $\gamma=\pi/2$, then by Girard's formula,
the area of the triangle is
\begin{displaymath}
\alpha+\beta-\pi/2,
\end{displaymath}
and by the law of cosines 
\begin{displaymath}
\cos(\alpha) =\sin(\beta)\cos(a).
\end{displaymath}
This determines the area $g(a,\beta)$ of the triangle 
as a function of $a$ and $\beta$. 
\indy{Index}{Girard's formula}%
\indy{Notation}{g@$g$ (triangle area)}%
\indy{Notation}{ZZalpha@$\alpha$ (angle)}%
\indy{Notation}{ZZbeta@$\beta$ (angle)}%
\indy{Notation}{ZZddgamma@$\gamma$ (angle)}%
\indy{Index}{convex}%
\indy{Index}{Girard's formula}%
\indy{Index}{polygon}%

The solid angle of $W_F$ is the sum of the areas of the triangles:
\begin{displaymath}
\sum_{i=1}^k g(a,\beta_i) 2,
\end{displaymath}
with angle sum
\begin{displaymath}
\sum_{i=1}^k \beta_i = 2\pi.
\end{displaymath}
With  $a$ fixed, the second partial of $A$ with respect to $\beta$ is
\begin{displaymath}
\frac{\partial^2 g(a,\beta)}{\partial \beta^2} = \frac{\cos(a)\sin^2(a)\sin(\beta)}{\sin^2(\alpha)} > 0.
\end{displaymath}
The function is convex.
By convexity, the minimum area occurs when all angles are equal
$\beta=\beta_i = \pi/k$.

The solid angle bound of the lemma is equal to 
\begin{displaymath}
2 k g(a,\beta)
\end{displaymath}
where $\cos(a)=h$.  Alternatively, the polygon breaks into $2k$
triangles, each computed by Girard's formula to have area
\begin{displaymath}
\beta - (\pi/2 - \alpha)  = \pi/k - \arcsin(\cos(\alpha)) = 
\pi/k - \arcsin(\cos(a)\sin(\beta)).
\end{displaymath}
\end{proof}

%\begin{lemma}\guid{BBEVFIC}\rating{0}\label{lemma:ngon-area}
%  The minimum area of an intersection of $k$-hemispheres containing a
%  circle $C$ of arcradius $a<\pi/2$ is
%\begin{displaymath}
%2\pi - 2 k \,\arcsin\left(\,\cos(a)\sin(\beta)\,\right),
%\end{displaymath}
%when $\beta = \pi/k$.
%\end{lemma}



\subsection{a polyhedral bound}

\begin{definition}[weakly saturated]
Let $r$ and $r'$ be real numbers such that $2\le r\le r'$.  Define a
set $ V\subset\ring{R}^3$ to be \newterm{weakly saturated} with
parameters $(r,r')$ if for every $\p\in\ring{R}^3$
\begin{displaymath}
\normo{\p}\le r'~~~\implies~~~  \u\in V\setminus\{\orz\}.~\norm{ \u}{\p}< r.
\end{displaymath}
\end{definition}

\begin{lemma}\guid{TARJJUW}\rating{ZZ}\label{lemma:poly-bounded} 
Fix $r$ and $r'$ such that $2\le r\le r'$.
Let $ V$ be a weakly saturated finite packing with parameters $(r,r')$ 
such that $\orz\in  V$.
%where 
%   $\orz\in V$, and
%   $\normo{ \u}\le r'$ for all $ \u\in V$,
Set $ V^*= V\setminus\{\orz\}$.
For any $g: V^*\to\ring{R}$, let $P( V,g)$ be the
polyhedron given by the intersection of half-spaces
\begin{displaymath}
\{\p \mid  \u\cdot \p \le g( \u)\}.
\end{displaymath}
Then $P( V,g)$ is bounded.
\end{lemma}
\indy{Index}{polyhedron}%

\begin{proof} Otherwise $P=P( V,g)$ is unbounded, and there exists
$\p\in P$ such that $\normo{\p} > g( \u) r'/2$ for all $ \u\in V^*$.
Let $\v = r' \p/\normo{\p}$ so that $r'=\normo{\v}$.  By the weak
saturation of $ V$, there exists $ \u\in V^*$ such that $\norm{\v}{
\u}<r$.  Then,
\begin{eqnarray*}
\normo{\p} &>& g( \u) r'/2 \ge  \u\cdot (r' \p)/2 = \normo{\p}  \u\cdot \v /2\\
&=& \normo{\p} (\normo{ \u}^2 + \normo{\v}^2 - \norm{ \u}{\v}^2)/4\\
&>& \normo{\p}(4+r'^2-r^2)/4\\
&\ge& \normo{\p}.
\end{eqnarray*}
This contradiction shows that $P$ is bounded.
\end{proof}




Since $L(h)\le 1$ when $h\ge1$, it is clear that a counerexample in
the sense of Corollary~\ref{cor:CE} has more than $12$ nonzero terms.
The following variant of a lemma of Marchal gives an upper bound on
the number of nonzero terms.


\begin{lemma}\guid{DLWCHEM}\rating{300}\label{lemma:13-14}  %%
If the Kepler conjecture is false, there exists a packing $ V$ with
$\orz\in V$, containing either $13$ or $14$ nonzero points for which
inequality~\ref{eqn:CE} holds.
\end{lemma}


\begin{proof} If $ V$ contains at most $12$ nonzero points then
the inequality~\ref{eqn:CE} cannot hold, because $L\le 1$.

Consider a finite packing $ V=\{\orz, \u_1,\ldots, \u_N\}$ satisfying
inequality~\ref{eqn:CE}.  Without loss of generality, by adding points
as necessary, the packing becomes weakly saturated in the sense of
Lemma~\ref{lemma:poly-bounded}, with $r=2$ and $r'=2\hm$.  Set $h_i =
\normo{ \u_i}/2$.  Then $h_i\le h_0=1.26$.  Set
\begin{displaymath}%
g(h) = \arccos(h/2) - \pi/6.  %
\end{displaymath}%
On the unit sphere, consider the disks $D_i$ of radii $g(h_i)$,
centered at $ \u_i/\normo{ \u_i}$.  These disks do not overlap; this
follows from the easy
Calculation~\ref{calc:cc:disks} %% Marchal disks are disjoint.  % cc:disks
\begin{displaymath}%
g(h_i) + g(h_j) \le \op{arc}(2h_i,2h_j,2).%
\end{displaymath}%
\indy{Notation}{D@$D$ (spherical disks)}%
For each $i$, the plane through the circular boundary of $D_i$ bounds
a half-space containing the origin.  The intersection of these
half-spaces is a polyhedron $P$.  The polyhedron is bounded by
Lemma~\ref{lemma:poly-bounded}.  Lemma~\ref{lemma:polyhedron}
associates a fan $(V_P,E_P)$ with $P$.  (The set $V_P$ is dual to $
V^*$; the set $V_P$ is in bijection with extreme points of $P$, whereas $
V^*$ is in bijection with the faces of $P$.)  There are natural
bijections between the following sets:
\begin{itemize}
\item $ V^* = \{ \u_1,\ldots, \u_N\}$.
\item The  facets of $P$.
\item The set of  topological components of $Y(V_P,E_P)$.
\item The set of faces in the hypermaps $\op{hyp}(V_P,E_P)$.
\end{itemize}
The bijection of the first two sets follows from the first conclusion
of Lemma~\ref{lemma:webster}.  Lemmas~\ref{lemma:WF} and
~\ref{lemma:face} give the other two bijections.

Let $k_i$ be the cadinality of the face in $\op{hyp}(V_P,E_P)$
corresponding to the facet $i$.  By Lemma~\ref{lemma:ngon}, the solid
angle of the topological component $W_i$ of $Y(V_P,E_P)$ is at least
$\op{reg}(g(h_i),k_i)$, where \indy{Index}{half-plane}%
\indy{Index}{half-space}%
\indy{Notation}{reg (area of regular spherical polygon)}%
\begin{displaymath}
\op{reg}(a,k) = 2\pi - 2 k (\arcsin(\cos(a)\sin(\pi/k))).
\end{displaymath}
By Calculation~\ref{calc:cc:alin}, %% Linear lower bound on regular
%% polygon. % cc:alin
\begin{displaymath}
\op{reg}(g(h),k) \ge c_0 + c_1 k + c_2 L(h),\quad
k = 3,4,\ldots,\quad 1\le h\le \hm,
\end{displaymath}
where
\begin{displaymath}c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 =
0.4754.\end{displaymath} The sum $\sum_i k_i$ is the number of darts
in $\op{hyp}(V_P,E_P)$ (Lemma~\ref{lemma:polyhedron}).  By
Lemma~\ref{lemma:dart-upper}, $\sum_i k_i \le (6N-12)$.  Summing over
$i$, an estimate on $N$ follows: \indy{Index}{polyhedron!convex}%
\indy{Index}{hypermap!planar}%
\begin{eqnarray*}
4\pi &=& \sum_i\op{sol}(W_i)\\
&\ge& \sum_i \op{reg}(g(h_i),k_i) \\
&\ge& c_0 N +c_1\sum_i k_i + c_2 \sum L(h_i)\\
&\ge& c_0 N +c_1 (6N-12) + c_2 12\\
\end{eqnarray*}
This gives
\begin{displaymath}
14.93 \ge N.
\end{displaymath}
\end{proof} 


\begin{lemma}\guid{XULJEPR}\label{300}\label{lemma:D'}  
Let $ V$ be a finite packing containing the origin.
Assume that there exists $ \u_1$ such that $\normo{ \u_1}=2$ and
$\norm{ \u_1}{ \u}\ge 2\hm$ for all $\orz\ne \u\in V$,
Then  inequality~(\ref{eqn:CE}) does not hold on $ V$.
\end{lemma}

\begin{proof} Assume for a contradiction that a packing exists that
satisfies the assumptions and the inequality.  Without loss of
generality, assume that $N\ge 13$, since the inequality is known to
hold when $N\le 12$.  Create one large disk $D_1'$ centered at $
\u_1/2$ and repeat the proof of the previous lemma.  By
Lemma~\ref{lemma:poly-bounded} (with $r=r'=2\hm$), the polyhedron is
bounded.  By the assumptions of the lemma, take
\begin{displaymath}a'=\arc(2,2,2\hm)-g(\hm) \approx 0.797\end{displaymath}
for the arcradius of this disk.  By Calculation~\ref{calc:cc:alin2}, %% Linear lower bound on regular polygon (large disk) % cc:alin2
\begin{displaymath}\op{reg}(a',k) \ge c_0 + c_1 k + c_2 L(1) +
c_3\end{displaymath}
where $c_3 = 0.85$.
Then 
\begin{eqnarray*}
4\pi &=& \sum_i\op{sol}(W_i)\\
&\ge& \op{reg}(a',k_1)+\sum_{i>1} \op{reg}(g(h_i),k_i) \\
&\ge&  c_0 N +c_1\sum_i k + c_2 \sum L(h_i) + c_3\\
&\ge& c_0 N +c_1 (6N-12) + c_2 12 + c_3\\
\end{eqnarray*}
This gives a contradiction:
\begin{displaymath}
12.97 \ge N \ge 13.
\end{displaymath}
\end{proof}

\section{Appendix: nonlinear inequalities}

This appendix gives a summary of the nonlinear inequalities that have
been cited in this chapter.  Information about the computer
verifications can be found at \cite{hales:2009:nonlinear}.

\begin{calculation}\label{calc:marchal}\guid{WJDLOCM}\guid{1025009205}\guid{3564312720}\rating{ZZ}
%% cc:mar are the k-cell estimates for non-cell clusters.
Define the function $M$ by equations (\ref{eqn:M}) and
(\ref{eqn:m-def}).  Define the function $\gamma(X,M)$ by equation
(\ref{eqn:gamma-def}).  If $X$ is a $0$, $1$, $2$, $3$, or $4$-cell,
then
\begin{displaymath}
\gamma(X,M)\ge 0.
\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:qtr}\guid{GLFVCVK}\guid{4869905472}\guid{2477216213}\guid{8328676778}\rating{ZZ}
Let $\gamma_L$ be given by Definition~\ref{def:gammaL}, $\op{wt}$ by
Definition~\ref{def:wt}, and $\beta$ by Definition~\ref{def:beta}.
If $X$ is any $k$-cell that is not a quater with $k\in\{2,3,4\}$,
then % gammaL is nonneg on quarters. cc:qtr
\begin{displaymath}
\gamma_L(X) \op{wt}(X) + \beta(e,X)\ge 0.
\end{displaymath} 
\end{calculation}

\begin{calculation}\label{calc:cc:2bl}\guid{FHBVYXZ}\guid{1118115412}\rating{ZZ}
Let $\gamma_L$ be given by Definition~\ref{def:gammaL}.  Let $X$ be
any quarter.  Let $Y$ be a $3$-cell that flanks it.  Then
\begin{displaymath}
\gamma_L(X)+\gamma_L(Y)\ge 0,
\end{displaymath}
% 2-leaf calculation, gammaL(fourcell)+gammaL(threecell) >=0. % cc:2bl:
\end{calculation}

\begin{calculation}\label{calc:cc:5bl}\guid{ZTGIJCF}\rating{ZZ}
Let
\begin{displaymath}
a= 0.0560305, \quad\text{and}\quad  b= -0.0445813.
\end{displaymath}
\begin{itemize}
\item \case{1821661595} A $4$-cell $X$ along a spine $e$ satisfies
\begin{displaymath}
gamma_L(X)\op{wt}(X) + \beta(e,X) \ge a + b\,\op{azim}(X),
\end{displaymath}
\item \case{7907792228} The $2$-cell $X_2$ and two $3$-cells $X_1,X_3$
that flank it along a spine $e$ satisfy
\begin{displaymath}
\sum_{i=1}^3 \left(\gamma_L(X_i)\op{wt}(X_i) + \beta(e,X_i)\right)\ge a + b\,\sum_{i=1}^3\op{azim}(X_i).
\end{displaymath}
\end{itemize}
\end{calculation}

\begin{calculation}\label{calc:cc:disks}\guid{}\rating{ZZ}
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
If $h_1,h_2\in [1,\hm]$, then
\begin{displaymath}
\op{arc}(2h_1,2h_2,2) - g(h_1) - g(h_2)\ge 0.
\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:alin}\guid{}\rating{ZZ}
Let $L$ be given by Definition~\ref{def:L}.
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
Let
\begin{displaymath}
\op{reg}(a,k) = 2\pi - 2 k (\arcsin(\cos(a)\sin(\pi/k))).
\end{displaymath}
Then
\begin{displaymath}
\op{reg}(g(h),k) \ge c_0 + c_1 k + c_2 L(h),\quad
k = 3,4,\ldots,\quad 1\le h\le \hm,
\end{displaymath}
where
\begin{displaymath}c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 =
0.4754.\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:cc:alin2}\guid{}\rating{ZZ}
Let $L$ be given by Definition~\ref{def:L}.
Let
\begin{displaymath}
g(h) = \arccos(h/2) - \pi/6.
\end{displaymath}
Let
\begin{displaymath}
\op{reg}(a,k) = 2\pi - 2 k (\arcsin(\cos(a)\sin(\pi/k))).
\end{displaymath}
Let
\begin{displaymath}a'=\arc(2,2,2\hm)-g(\hm) \approx
0.797.\end{displaymath} Then for $k=3,4,\ldots$,
\begin{displaymath}\op{reg}(a',k) \ge c_0 + c_1 k + c_2 L(1) +
c_3\end{displaymath}
where 
\begin{displaymath}c_0 = 0.6327,\quad c_1 = -0.0333,\quad c_2 =
0.4754,\quad c_3 = 0.85.\end{displaymath}
\end{calculation}

\begin{calculation}\label{calc:shorts}\rating{ZZ}
The following calculations involve many cases that are enumerated by
computer code.
\begin{itemize}
\item \case{BIXPCGW} Let $Z$ be any cell-cluster along a spine $e$
with three leaves.  Then
\begin{displaymath}
\Gamma(Z)> 0.
\end{displaymath}
\item \case{QITNPEA} Let $Z$ be any cell-cluster along a spine $e$
with four leaves.  Then
\begin{displaymath}
\Gamma(Z)> 0.
\end{displaymath}
\end{itemize}
\end{calculation}