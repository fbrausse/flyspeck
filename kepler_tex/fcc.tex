%------------------------------------------------------------
% Author: Thomas C. Hales
% Format: LaTeX
% Book Chapter: Dense Sphere Packings
%------------------------------------------------------------


\chapter{Close Packing}

\section{History}\label{sec:history}

This section gives a brief history of the study of dense sphere
packings.  Further details appear at \cite{Szpiro} and
\cite{Hales:2006:overview}.
The early history of sphere packings is concerned with the
face-centered cubic (FCC) packing, a familiar pyramid arrangement
of congruent balls used to stack cannonballs at war memorials and
oranges at fruit stands.

\subsection{Sanskrit sources}



The study of the mathematical properties of the FCC
packing can be traced back\footnote{I am indebted to Plofker for
telling me of these results~\cite{Plo00}.} to a Sanskrit work (the \=Aryabha\d t\={\i}ya
 of \=Aryabha\d ta) composed around 499 CE.  The following passage gives
the formula for the number of balls in a pyramid pile with triangular base as
a function of the number of balls along an edge of the pyramid~\cite{Ary}:

% {\it \=Aryabha\d t\={\i}ya}, Ga\d nitap\=ada 21:

\bigskip

{\narrower\it\font\ninerm=cmr9

For a series [lit. ``heap''] with a common difference and
  first term of 1, the product of three [terms successively] increased
  by 1 from the total, or else the cube of [the total] plus 1
  diminished by [its] root, divided by 6, is the total of the pile
  [lit. ``solid heap''].  

}

\bigskip

 In modern notation, the passage gives two formulas for the number of
 balls in a pyramid with $n$ along the edge:
\[
\dfrac{n(n+1)(n+2)}{6} =  \dfrac{(n+1)^3 - (n+1)}{6}
\]

\subsection{Hariot and Kepler}

The modern mathematical study of spheres and their close packings can
be traced to Hariot.  His work -- unpublished, unedited, and
largely undated -- shows a preoccupation with sphere packings.  He
seems to have first taken an interest in packings at the prompting of
Sir Walter Raleigh.  At the time, Hariot was Raleigh's mathematical
assistant, and Raleigh gave him the problem of determining formulas
for the number of cannonballs in regularly stacked piles.  Hariot
interpreted the number of balls in a pyramind as an entry in Pascal's
triangle.\footnote{Hariot was well-versed in Pascal's triangle long
  before Pascal.}  Shirley, Hariot's biographer, writes that it was
his study of cannonball arrangements in the late sixteenth century
that  ``led him inevitably to the corpuscular or atomic
theory of matter originally deriving from Lucretius and Epicurus.''
\cite[p.~242]{Shi83}

J. Kepler became involved in sphere packings through his correspondence
with Hariot around 1606--1607. They shared an interest in optics.
Hariot, the atomist, attempted to understand reflection and refraction
of light in atomic terms.  Kepler favored a more classical explanation of
reflection and refraction in terms of ``the union of two opposing
qualities -- transparences and opacity'' (quoting Kargon~\cite[p.26]{Kar66}).  
Hariot was stunned that
Kepler would be satisfied by such reasons.

Despite Kepler's initial reluctance to adopt an atomic
theory, he was eventually swayed, and in 1611 he published an essay
that explores the consequences of a theory of matter composed of small
spherical particles. 
Kepler's essay describes the FCC packing and asserts
that ``the packing will be the tightest possible, so that in no other
arrangement could more pellets be stuffed into the same
container''~\cite{Kep66}.  This assertion has come to be known as the
Kepler conjecture.  This book
gives a proof of this conjecture.

\subsection{Newton and Gregory}

The next episode in the history of this problem,  a debate between
Isaac Newton and David Gregory,  centered on the
question of how many spheres of equal radius can be arranged to touch
a given sphere.  The analogous question in two dimensions is readily answered;
six pennies, but no more, can be arranged
to touch a central penny.  In three dimensions, Newton said that the maximum was
12 spheres, but Gregory claimed that 13 might be possible.

The Newton-Gregory problem was not solved until centuries later.
The first proper proof was obtained by van der Waerden and
Sch\"utte in 1953 \cite{Sch53}.  An elementary proof appears in Leech
\cite{Leech:1956:MG}.  Although a connection between the Newton-Gregory
problem and Kepler's problem is not obvious, Fejes T\'oth succesfully linked the
problems in 1953~\cite{Fej53}.


\section{Face-Centered Cubic}



The FCC packing is the familiar pyramid arrangement of
balls on a square base as well as a pyramid arrangement on a
triangular base.  The two packings
differ only in their orientation in space.
Figure~\ref{fig:tri-square-cannonballs} shows how the triangular base
packing fits between the peaks of two adjacent square base pyramids.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The square and triangular based packings of cannonballs}
  \label{fig:tri-square-cannonballs}
\end{figure}

Density, defined as a ratio of volumes, is insensitive to changes of
scale.  For convenience, it is sufficient to consider balls of unit
radius. This means that the distance between centers of balls in a
packing is always be at least $2$.  We identify a packing with its set
of centers.   For our purposes, a packing is just a set of points
in $\ring{R}^3$, whose elements are separated by distances of at least
$2$.


%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The FCC as a tiling of tetrahedra and octahedra}
  \label{fig:tet-oct}
\end{figure}

The density of a packing is the ratio of the volume occupied by the
balls to the volume of a large container of the balls.  The
purpose of a finite container is to prevent the volumes from becoming
infinite.  To eliminate the distortion of the packing caused by the
shape of the its boundary, we take the limit of the densities within an increasing
sequence of spherically shaped containers, as the diameter tend to infinity.

The FCC packing is  obtained from a cubic
lattice, by inserting a ball at each of the eight extreme points of
each cube and then inserting a another ball at the center of each
of the six facets of each cube.  The name \newterm{face-centered cubic} comes from this
construction.  The edge of each cube is $2\sqrt2$, and the diagonal of
each face is $4$.  
  The density of the packing as a whole 
is equal to the density within a single cube.  The cube has volume
$(2\sqrt2)^3 = 16\sqrt2$  and contains a total of four balls: half a
ball along each of six faces and one eighth a ball at each of eight
corners.  Thus, the density within one cube is
   \begin{displaymath}
   \frac{   4 (4\pi/3)}{16\sqrt2} = \frac{\pi}{\sqrt{18}}.
   \end{displaymath}
See Figure~\ref{fig:fcc-cube}.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The FCC structure}
  \label{fig:fcc-cube}
\end{figure}


% based on page 28 of kepler research scan/scan0001.tif
The FCC packing is a tiling of alternating regular tetrahedra and
regular octahedra.  See Figure~\ref{fig:tet-oct}.  The figure has one
tetrahedron at each extreme point and one octahedron in the center. By
similarity, the total volume is $8 = 2^3$ times the volume of each
smaller tetrahedron. This dissection exhibits the volume of a regular
octahedron as exactly four times the volume of a regular tetrahedron
of the same edge length.

The tiling of regular tetrahedra and octahedra can be
superimposed on the picture of the cube.  Each tetrahedron has an extreme point
in common with the cube and three other extreme points at centers of faces
of the cube.   One octahedron is concentric with the cube and has an extreme
point at the center of each face.  There is an
additional quarter of an octahedron along each edge of the cube, extending to the
midpoints of the two adjacent faces, making a total of eight
tetrahedra and four octahedra.  As each octahedron has the volume of
four tetrahedra, exactly $1/3$ of the cube is filled with tetrahedra,
the other $2/3$ with octahedra.  This decomposition shows that the
volume of a tetrahedron is $2\sqrt2/3$.
%(pretend ignorance). The volume $16\sqrt2$ 
%of the cube equals $24$ tetrahedra \dots, giving each a volume
%of 
%$2\sqrt{2}/3$.

The density of the FCC packing is the weighted density
of the densities of the tetrahedron and octahedron.  Write $\dtet$ and
$\doct$ for these densities.  Explicitly, $\dtet$ is the ratio of the
volume of the part within the tetrahedron of the unit balls (at the
four extreme points) to the volume of the tetrahedron.  As tetrahedra fill
$1/3$ of volume of the cube and octahedra fill
the other $2/3$,
\begin{displaymath}
  \frac{\pi}{\sqrt{18}} = \frac{1}{3}\dtet + \frac{2}{3}\doct.
\end{displaymath}

The Voronoi cell of a point $v$ in a packing $V$ is defined as the set of all
points in $\ring{R}^3$ 
that are at least as close to $v$ as to any other point
of $V$.  Each Voronoi cell of the FCC packing is a
rhombic dodecahedron (Figure~\ref{fig:rhombic}),  %% not drawn.
which is constructed from a cube by placing a
square based pyramid (with height half as great as an edge of its
square base) on each of the six faces
(Figure~\ref{fig:rhombic-cube}).  %% not drawn.

Recall that the cubes under discussion  have an edge length
$\sqrt{2}$.
The Voronoi cells can be superimposed on the cube by
centering a cube at each ball in the packing. These
cubes fill the black grid of an infinite three dimensional
checkerboard, leaving a second grid of white cubes unfilled.  Each
white cube can be partitioned into pyramids along its six faces with apex
at the center of the cube.  Attaching these pyramids along their bases
to the adjoining black cubes gives the Voronoi cell.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The rhombic dodecahedron as a Voronoi cell}
  \label{fig:rhombic}
\end{figure}

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The rhombic dodecahedron constructed from a cube}
  \label{fig:rhombic-cube}
\end{figure}

A Voronoi cell contains one black cube of side $\sqrt2$ and a total
of one white cube, for a total volume of $4\sqrt2$, which is
one of the fundamental constants in this book.  The density of the
FCC packing is the ratio of the volume of a ball to the volume
of its Voronoi cell, which gives $\pi/\sqrt{18}$ yet again.





\section{Hexagonal-Close Packing}

There is a popular and persistent misconception that the FCC
 packing is the only packing with density $\pi/\sqrt{18}$.
The hexagonal-closed packing (HCP) has the same density.
\indy{Index}{HCP}%
\indy{Index}{hexagonal-close packing (HCP)}%
\indy{Index}{FCC}%
\indy{Index}{face-centered cubic (FCC)}%

In the FCC packing, each ball is tangent to twelve
others.  Every ball in the packing has the same arrangement of twelve
tangent balls.  Call it the \newterm{FCC pattern}.  Likewise, in the
HCP, each ball is tangent to twelve others
(Figure~\ref{fig:hcp}) in the same arrangement.  Call it the
\newterm{HCP pattern}.  However, the FCC pattern is different from the
HCP pattern.  In the FCC pattern, there are four different planes
through the center of the central ball that contain the centers of six
other balls at the vertices of a regular hexagon while in the HCP
pattern, there is only one such plane.  Call the arrangement of balls
tangent to a given ball the \newterm{local tangent arrangement} of the
ball.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The FCC and HCP patterns}
  \label{fig:hcp}
\end{figure}

There are, in fact, uncountably many packings of density $\pi/\sqrt{18}$ in which
the tangent arrangement around each ball is either the FCC
pattern or the HCP pattern.

A \newterm{hexagonal layer} is a translate of the
two-dimensional hexagonal lattice (also known as the triangular
lattice). That is, it is a translate of the planar lattice generated
by two vectors of length $2$ and angle $2\pi/3$.  The FCC
 packing is an example of a packing built from hexagonal layers.

 If $L$ is a hexagonal layer, a second hexagonal layer $L'$ can be
 placed parallel to the first so that each lattice point of $L'$ has
 a distance of $2$ from three different points of $L$.  When the second
 layer is placed in this manner, it is as close to the first layer as
 possible.  A choice of a unit normal vector $\e$ to the plane of $L$ determines
 an upward direction.  There are two different positions in which $L'$
 can be placed closely above $L$ and two different positions in which
 $L'$ can be placed closely below $L$ (Figure~\ref{fig:two-holes}). As
 packing is constructed layer by layer, ($L$, $L'$, $L''$, and so
 forth), there are two choices at each stage of the close placement of
 the layer above the previous layer. Running through different
 sequences of choices gives uncountably many packings.  In each of
 these packings the tangent arrangement around each ball is that of
 the twelve balls in the FCC packing or the HCP.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The two positions of hexagonal layers}
  \label{fig:two-holes}
\end{figure}

As a packing is constructed, each layer may be labeled
$A$, $B$, or $C$ depending on three possible orthogonal projection to a plane
with normal vector $\e$.
Each layer carries a different label the layers immediately
above and below it.  In the FCC packing, the successive layers are
$A,B,C,A,B,C$, and so forth.  In the HCP packing, the successive layers are
$A,B,A,B$, and so forth.  If the vertices of a triangle are labeled $A$, $B$, and $C$,
then the succession of labels is a
walk along the vertices of the triangle, different walks through the
triangle describing different packings (Figure~\ref{fig:fcc-tri}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{A description of layers by walks through a triangle}
  \label{fig:fcc-tri}
\end{figure}

The different walks through a triangle give all packings of infinitely
many congruent balls in which each tangent arrangement is
either the FCC pattern  or the HCP pattern.  To see
this, first assume that $V$ does not contain any balls whose local
tangent arrangement is the HCP pattern, making every local tangent
arrangement a the FCC pattern.  Adjacent FCC patterns interlock in a unique way
that forces $V$ itself to crystallize into the
FCC packing.  This completes the proof in this case.

Now assume that a packing $V$ contains some ball (centered at $\u$)
in the HCP pattern, which contains a uniquely determined
plane of symmetry. This plane contains $\u$ and the centers of six
others arranged in a regular hexagonal. If $\v$ is the center of one of
the six other balls in the plane of symmetry, its local tangent arrangement
of twelve balls must include $\u$ and an additional four of the
twelve balls around $\u$. These five centers around $\v$ are not a
subset of the FCC pattern, but  extend uniquely to
a HCP pattern.   Around $\u$ and $\v$, the HCP patterns  have the same
plane of symmetry. In this way, as
soon as there is a single center that is locally arranged in the HCP pattern, the pattern
propagates along the plane of symmetry to create a hexagonal layer
$L$.

Once a packing $V$ contains a single hexagonal layer, the condition
that each ball be tangent to twelve others forces a hexagonal layer
$L'$ above $L$ and another hexagonal layer below $L$.  Thus, a single
hexagonal layer forces an infinite sequence of close-packed hexagonal
layers.  The position of each layer over the previous layer is described 
as a step from one vertex to an adjacent vertex of a triangle.
This completes the proof that the different walks through a triangle give
all possibilities.



\section{Gauss}

Gauss proved that the FCC packing has the greatest density
of any lattice packing in three dimensional Eulidan space.  There is a
short proof that does not require any calculations.

Start with an arbitrary lattice $V$ in which every point has a distance of
at least $2$ from every other.  Center a unit ball at each point in
the lattice.  In a lattice of greatest density, some pair of balls
touch.  The lattice property then forces the balls into parallel
infinite linear strings like beads on a string.  Two of these infinite
parallel strings touch in an optimal lattice.  The
lattice property then constrains the strings in parallel sheets.  On
each sheet the touching parallel strings form a rhombic tiling.  Each
parallel sheet sits as snugly as possible on the sheet below in an optimal
lattice.  In such an arrangement, a ball (centered at
$\v_0$) of one sheet touches three balls (centered at
$\v_1,\v_2,\v_3$) on a the next layer down (Figure~\ref{fig:rhombus}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{A ball from one sheet touches three balls centered at points of a rhombus.}
  \label{fig:rhombus}
\end{figure}

As the balls on each sheet form a rhombic tile, two of the distances
between $\v_1,\v_2,\v_3$, corresponding to two edges of the rhombus, are
equal to $2$.  This means that $\v_0$ together with two of
$\v_1,\v_2,\v_3$ form an equilateral triangle.  From the perspective of
the plane containing this equilateral triangle, the lattice property
forces this entire plane, as well as parallel planes, to be tiled with
equilateral triangles.  From the earlier argument, each plane sits as
snugly as possible on the sheet below.  A ball of one sheet touches
the three balls forming an equilateral triangle in the layer below.
These four balls form a regular tetrahedron, which
uniquely identifies the lattice as the FCC.






\section{Thue}\label{sec:thue}


As mentioned, Thue solved the packing problem for congruent disks in
the plane.  The optimal packing is the hexagonal packing
(Figure~\ref{fig:2D-hex}).  The density of this packing is
$\pi/\sqrt{12}$, that is, the ratio of the area of a unit disk to the area of a
hexagon of inradius one.  Thue's theorem admits an elementary proof that
we sketch.    Casselman has an animated interactive demo of this
solution \cite{casselman:pennies}.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The optimal packing in two dimensions}
  \label{fig:2D-hex}
\end{figure}

Let $V$ be the set of centers of a collection of unit disks in
$\ring{R}^2$.  Take the Voronoi cell around each
disk.\footnote{Voronoi cells of packings in any dimension $\ring{R}^n$
  are defined by the same rule as we gave above for $\ring{R}^3$.}   It
is enough to show that each Voronoi cell has density at most
$\pi/\sqrt{12}$, because the limiting density of the packing in the entire plane cannot exceed
a bound on the density within a Voronoi cell.  


Truncate the Voronoi cell by intersecting it with a disk of radius
$r=2/\sqrt3$.   The density increases as the volume of the cell is made smaller,
so if the truncated Voronoi cell
has density at most $\pi/\sqrt{12}$, then so does the untruncated Voronoi cell .

There is not a point $\w$ in the plane that has a distance of less than $r$
from three disk centers $\v_1,\v_2,\v_3$.  Otherwise, one of the three
angles $\gamma$ at $\w$ is at most $2\pi/3$, and $\cos\gamma\ge -0.5$.
The law of cosines applied to the triangle $\w,\v_i,\v_j$ with angle
$\gamma$ gives the contradiction:
   \begin{displaymath}
   4 \le c^2 = a^2 + b^2 - 2 a b \cos\gamma 
   \le a^2 + b^2 + a b < 3r^2 = 4.
   \end{displaymath}
Thus, the boundary of the truncated Voronoi cell consists of circular
arcs and chords of the circle of radius $r$ (see Figure~\ref{fig:2D-proof}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The sectors and triangles of a truncated Voronoi cell}
  \label{fig:2D-proof}
\end{figure}

The parts of the Voronoi cell that lie within a circular sector have
density $1/r^2 = 3/4 < \pi/\sqrt{12}$.  A simple calculation shows
that the parts of the Voronoi cell that lie within a triangle have
density
   \begin{equation}\label{eqn:rog2d}
   \frac{\theta}{r^2 \cos\theta\sin\theta}
   \end{equation}
% checked 3/31/2008.
where $0 \le \theta\le \pi/6$.  An easy optimization gives the maximum
at $\theta=\pi/6$ with value $\pi/\sqrt{12}$.  This completes the proof of Thue's theorem.

In some ways it it unfortunate that the problem in two dimensions is
so elementary.  It gives only meager hints about how to solve the problem
in three dimensions such as the value of Voronoi cells
and the usefulness of truncation.  The optimization problem on
triangles in Equation~\ref{eqn:rog2d} generalizes to $n$-dimensions.
But beyond these simple observations, there is little from the proof of Thue's
theorem that prepares us for higher dimensions.

%\subsection{two dimensions}

\bigskip

There are many proofs of Thue's theorem, among them Fejes T\'oth's,
which uses a \newterm{Delaunay triangulation} for infinite sets $V$ of
points in the plane (or more generally in $n$-dimensions).  Assume
that $V$ is the set of centers of packing so that distances between
points of $V$ are at least $2$.  A enlargement of the packing
$V\subset V'$ increases density.  In issues of density, it does no
harm to assume that the packing is \newterm{saturated}; that is, it is
not a proper subset of another packing.  A saturated packing of the
plane (or $n$-space) has a Delaunay triangulation.  It is a
triangulation in which the circumscribing circle of each triangle
contains no points of $V$ in its interior.  Each triangle has radius
at most $2$, because otherwise the packing is not saturated: an
additional point can be placed at the center of the circumscribing
circle.

\begin{proof}
  Admitting the existence of the Delaunay triangulation, the proof of
  the packing problem in two dimensions is elementary.  Each 
  triangle contains a portion of a disk at each of its three vertices.
  The interior angles of a triangle sum to $\pi$, giving half a disk
  per triangle.  If each triangle has area at least $\sqrt{3}$, then
  the density of the packing is at most $(\pi/2)/(\sqrt{3}) =
  \pi/\sqrt{12}$.  To minimize the area of a triangle
  $\{\v_0,\v_1,\v_2\}$, first replace it with a smaller similar triangle
  whose shortest edge (say $\v_1\v_2$) has length $2$.  The third vertex
  $\v_0$ is constrained to have a distance of at least $2$ from $\v_1$ and
  $\v_2$, and to have circumradius at most $2$.  The constraints on
  $\v_0$ form three circular arcs as shown in
  Figure~\ref{fig:2D-FT} % not drawn.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The constraints on the point $A$, vertex of a Delaunay triangle}
  \label{fig:2D-FT}
\end{figure}

The minimizing triangle is determined by the point $\v_0$ closest to
the segment $\{\v_1,\v_2\}$.  There are three such points, all giving
triangles of area exactly $\sqrt3$.  This completes the proof.
\end{proof}

\section{Dense Packings in a Nutshell}

This section describes the proof of the Kepler conjecture in general,
without
getting embroiled in detail.  The entire book
is a blueprint with all the electrical schematics, plumbing, and
ventilation systems.  This section is the tourist brochure.

The Kepler conjecture asserts that no packing of congruent balls in
three-dimensional Euclidean space has density greater than the density
$\pi/\sqrt{18}$ of the FCC packing.  Imagine that we
have an explicit counterexample to the Kepler conjecture in the form of a
packing of density greater than $\pi/\sqrt{18}= 0.74048$\dots.  Pick
units so that the balls have radius $1$.  Additional balls may be
added to the packing until the packing becomes saturated.  At this
point, there is no room to add any additional balls without overlap.
By saturating the packing, the density can only increase, and a
counterexample can only grow stronger.

We present the proof in four stages.  Undefined terms are clarified in the
discussion that follows.

\begin{enumerate}
\item A geometric partition of space, adapted to a counterexample $V$, 
reduces the problem to an inequality that holds for some finite packing $W$.
\item The finite packing $W$ is transformed into another packing that satisfies the same
inequality and that has a few additional properties that make it a \newterm{contravening} packing.
\item The combinatorics of $W$ is encoded as a hypermap.  A list is
  made of the purely combinatorial properties of $W$.  A hypermap with
  these properties is said to be \newterm{tame}.
\item A computer generates an explicit list, enumerating
  tame hypermaps up to isomorphism.  Linear programs, which are
  adapted to each tame hypermap in the enumeration, certify that
  none of the combinatorial possibilities can be geometrically realized by a set
  $W\subset \ring{R}^3$.
\end{enumerate}

From the non-existence of $W$, it follows that there is no
counterexample $V$ to the Kepler conjecture.



\subsection{geometric partition}

The first stage of the proof defines a geometric partition of space
and uses it to reduce the Kepler conjecture to an optimization problem
in a finite number of variables.

The packing of congruent balls determines a partition of
three-dimensional Euclidean space into simplices.  The packing is
entirely determined by the infinite discrete set $V$ of centers of the
congruent balls.  A packing determines a partition of $\ring{R}^3$
into Voronoi cells.  By definition, the Voronoi cell $\Omega(V,\v)$
associated to $\v\in V$ is the polyhedron formed by all points of
$\ring{R}^3$ that are at least as close to $\v$ as to any other $\w\in
V$.  The Voronoi cell at $\v$ can be further partitioned into Rogers
simplices.  Each Rogers simplex is determined by a facet, an edge of
the facet, and an extreme point of the edge.  The simplex is the
convex hull of the point $\v$, the closest point $\v_1$ on the facet
to $\v$, the closest point $\v_2$ on the edge to $\v_1$, and the
extreme point $\v_3$ of the edge.


We cut and group the Rogers simplices slightly more so that they
become \newterm{Marchal cells}.  The exact rules for how the Marchal cells
are formed do not concern us here.  The rules depends on which of the
points $\v_1,\ldots,\v_3$ have a distance of less than $\sqrt2$ from
$\v_0$.

The Marchal cells are used to define a function $G:V\to \ring{R}$.
(The function $G$ is defined geometrically in terms of volumes, solid
angles, and dihedral angles of Marchal cells, grouped together into
\newterm{clusters}.)  The function $G$ has the following two
fundamental properties:
\begin{description}
\item \case{FCC compatible} If $\CalL(V,\v)\le 12$ 
(the function $\CalL$ is  described below), then 
\[
\sqrt{32}\le \Omega(V,\v) +G(\v).
\]
\item \case{negligible}   There exists $C>0$ such that the points of $V$ in a ball $B(\orz,r)$
of radius $r\ge 1$ satisfy
\[
\sum_{\v\in V \cap B(\orz,r)} G(\v) < C r^2.
\]
\end{description}
The constant $\sqrt{32}$ is the volume of the Voronoi cell of the FCC packing.

From these fundamental properties and from the assumption that $V$ is a counterexample,
it follows that $\CalL(V,\v)>12$ for some $\v\in V$.  Indeed, if $\CalL(V,\v)\le 12$ for all
$\v\in V$, then the fundamental properties
imply that on average the Voronoi cells of $V$ have volume at least that of the FCC packing, up to a negligible error term $C r^2$.  From this, it follows that the density
of the packing $V$ is at most that of the FCC packing.

 $\CalL(V,\v)$ is defined as
\[
\CalL(V,\v) = \sum_{\w\in V} L(\norm{\w}{\v}/2),
\]
where $L$ is the function whose graph is linear from $(x,y)=(1,1)$ to $(0,1.26)$ and equal
to zero for $x\ge 1.26$.  (The constants $1.26$ and $2.52=2(1.26)$ appear throughout the
proof as parameters used in truncation.)   
The function $L$ has compact support, so that the sum in the
definition of $\CalL$ is a finite sum.

Returning to the counterexample $V$, we pick $\v\in V$ such that
$\CalL(V,\v)>12$.  By the translational invariance of the problem, we
may assume that $\v=\orz$.  Then
\begin{equation}\label{eqn:LW}
\CalL(W) = \sum_{\w\in W} L(\normo{\w}/2)  > 12,
\end{equation}
where $W$ is the finite set  $\{\w\in V\mid \normo{\w} \le 2.52\}$.

This completes the first stage of the proof, by reducing the Kepler conjecture to an optimization
problem $\max_W \CalL(W,\orz) \le 12$ in a finite number of variables $W\subset B(\orz,2.52)$.
The counterexample $V$ to the Kepler conjecture leads to a finite packing $W$
that satisfies~\eqn{eqn:LW}.

\subsection{contravening packing}

We assume that $V$ is a counterexample to the Kepler conjecture and that $W\subset V$
is a finite subset that satisfies \eqn{eqn:LW}.
The second stage of the proof shows that the 
finite packing $W$ can be enhanced in various ways.  The result of the enhancement is
a new finite packing that is a \newterm{contravening packing}.  At this stage, we also
make $W$ into a graph by defining a set of edges $E$ with nodes in $W$.

For example, the value of $\CalL$
depends only on the norms $\normo{\w}$, and $L$ is a decreasing
function, so that any rearrangement of the points of $W$ that does not
increase the norms strengthens the inequality \eqn{eqn:LW}.

The finite packing $W$ determines a graph $(W,E)$ with node set $W$.  The set
of edges is defined by $\{\v,\w\}\in E$ if 
\[2\le\norm{\v}{\w}\le 2.52.\] This graph is called the \newterm{standard
  fan} of $W$.

We can get a crude idea about what $W$ must look like by studying the
set of normalized points $\w/\normo{\w}$ in the unit sphere.  These
points can be used to partition the unit sphere into spherical
polygons.  As we know that the sum of the areas of the polygons equals
the area $4\pi$ of the sphere, we can extract bits of information
about $W$ from estimates of the areas of the polygons.  Analysis along
these lines leads to the conclusion that some finite packing $W$
has the following
properties.
\begin{itemize}
\item $W\subset B(\orz,2.52)$.
\item $\CalL(W) > 12$.
\item The cardinality of $W$ is thirteen, fourteen, or fifteen.
\item $W$ maximizes the function $\CalL$.
\item Join points $\v/\normo{\v}$ and $\w/\normo{\w}$ with a geodesic arc on the
unit sphere if $\{\v,\w\}\in E$.  Then the arcs do not meet except at the endpoints and
give a planar graph.  Moreover, the angle between each pair of consecutive arcs at a vertex is less
that $\pi$.  In particular, the spherical polygons cut out by the arcs are convex.
\end{itemize}
A finite packing $W$ with these properties is called a \newterm{contravening} packing.


\subsection{tame hypermap}

The starting point of the third stage of the proof is a contravening
packing $W$ and the corresponding planar graph $(W,E)$.  The result of
this stage is a \newterm{tame hypermap} (described below).

By definition, a \newterm{planar graph} is a graph that admits a
\newterm{planar} embedding.  On the other hand, a graph, endowed with
a fixed embedding into the plane, is a \newterm{plane graph}.  A
planar graph has too little structure for our purposes, because it
does not single out a particular embedding and the plane graph has too
much structure because it gives a topological object where combinatorics
alone should suffice.  A hypermap gives just the right amount of
structure.  It is a purely combinatorial notion, yet encodes the
relations among nodes, edges, and faces determined by the embedding.
An entire chapter of this book is about hypermaps.

The graph $(W,E)$ of a contravening packing $W$ determines a hypermap
$\op{hyp}(W,E)$. We study the following question: what  purely
combinatorial properties of the hypermap $\op{hyp}(W,E)$ can be derived from
the assumption  that
$W$ is a contravening packing?  For example, the cardinality of a
contravening packing $W$ is thirteen, fourteen, or fifteen.  Hence the hypermap
has thirteen, fourteen, or fifteen nodes.  Much of the later chapters of the book
revolve around the question of the combinatorial properties of the
hypermap.

The final chapter of the proof compiles all of these combinatorial
properties into a long list.  
Although the exact details of the list are not significant,
%The list of properties is every bit as
%artificial as a top ten list of world wonders or unsolved mysteries.
%This The idea is to produce -- with minimal effort -- any list of
the list of combinatorial properties severely constrains the set of possible
hypermaps.  

Any hypermap satisfying all of these properties is said to be
\newterm{tame}.  This list of properties appears in
Definition~\ref{definition:tame}.

%There is little to be gained by extra efforts at this stage, because
%the final stage gives more efficient means to constrain the set of
%possibilities.

\subsection{linear programming}

The fourth and final stage completes the proof the non-existence of
the contravening packing $W$.  At the beginning of this stage,
$\op{hyp}(W,E)$ is a tame hypermap.  The list of defining properties
of a tame hypermap are sufficiently restrictive that an explicit finite
list can be generated of every tame hypermap, up to isomorphism.  
This list is generated by computer.  The details of the algorithm are
described in the chapter on hypermaps.

Equipped with an explicit list of possible combinatorial structures,
we move to the proof's end game.  At this stage, because of the computer
generated list of tame hypermaps, the cardinality and
combinatorial structure of $W$ are explicit.

A list is made of the properties of $W$ (and its associated hypermap)
that can be described by linear inequalities.  For each tame hypermap,
a computer solves one or more linear programs that test for feasible
solutions to the system of linear inequalities.  In each case, the
computer produces a certificate that shows that no feasible solution
exists.  It follows that no tame hypermap can be realized in the form
$\op{hyp}(W,E)$.  Each tame hypermap, which represents a
combinatorially feasible arrangement, is geometrical infeasible.  It
follows that $W$, and hence also $V$, do not exist.

As no counterexample exists, the Kepler conjecture follows.

\section{Gallery}

This section explores the history of packings and coverings through a
series of figures.

Harriot (Pascal's triangle) -- Marchal 2D -- Marchal 3D -- Rogers's
proof (2D) -- Roger's (3D) -- Fejes T\'oth's proof 2D -- Fejes
T\'oth's proposal 3D -- Hsiang 3D -- dodecahedral conjecture --
Delaunay simplices 3D (conjectured best) -- Hales 3D (superposition)
-- Hales 3D hybrid -- Beth Chen (tetrahedra) -- covering problem 2D --
covering 3D -- heptagons (Kuperberg) -- atom packings -- circle
packings -- Tammes problem -- van der Waerden 13 (Musin)
