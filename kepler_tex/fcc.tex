%------------------------------------------------------------
% Author: Thomas C. Hales
% Format: LaTeX
% Book Chapter: Dense Sphere Packings
%------------------------------------------------------------


\chapter{Close Packing}\label{sec:close}

\section{History}\label{sec:history}

This section gives a brief history of the study of dense sphere
packings.  Further details appear at \cite{Szpiro} and
\cite{Hales:2006:overview}.
The early history of sphere packings is concerned with the
face-centered cubic (FCC) packing, a familiar pyramid arrangement
of congruent balls used to stack cannonballs at war memorials and
oranges at fruit stands (Figure~\ref{fig:fcc-packing}).

\figDHQRILO % fig:fcc-packing


\subsection{Sanskrit sources}



The study of the mathematical properties of the FCC
packing can be traced\footnote{I am obliged to Plofker~\cite{Plo00}.} to a Sanskrit work (the \=Aryabha\d t\={\i}ya
 of \=Aryabha\d ta) composed around 499 CE.  The following passage gives
the formula for the number of balls in a pyramid pile with triangular base as
a function of the number of balls along an edge of the pyramid~\cite{Ary}.

% {\it \=Aryabha\d t\={\i}ya}, Ga\d nitap\=ada 21

\bigskip

{\narrower\it\font\ninerm=cmr9

For a series [lit. ``heap''] with a common difference and
  first term of 1, the product of three [terms successively] increased
  by 1 from the total, or else the cube of [the total] plus 1
  diminished by [its] root, divided by 6, is the total of the pile
  [lit. ``solid heap''].  

}

\bigskip

 In modern notation, the passage gives two formulas for the number of
 balls in a pyramid with $n$ balls along an edge (Figure~\ref{fig:sanskrit}):
\begin{equation}\label{eqn:sanskrit}
\dfrac{n(n+1)(n+2)}{6} =  \dfrac{(n+1)^3 - (n+1)}{6}.
\end{equation}

\figKSOEMIZ % fig:sanskrit

\subsection{Harriot and Kepler}

The modern mathematical study of spheres and their close packings can
be traced to Harriot.  His work -- unpublished, unedited, and largely
undated -- shows a preoccupation with sphere packings.  He seems to
have first taken an interest in packings at the prompting of Sir
Walter Raleigh.  At the time, Harriot was Raleigh's mathematical
assistant, and Raleigh gave him the problem of determining formulas
for the number of cannonballs in regularly stacked piles.  Harriot
interpreted the number of balls in a pyramid as an entry in Pascal's
triangle\footnote{Harriot was well-versed in Pascal's triangle long
  before Pascal.} (Figure~\ref{fig:pascal}). Through his study of
triangular and pyramidal numbers, Harriot later discovered finite
difference interpolation~\cite{BeS08}.  Shirley, Harriot's biographer,
writes that it was his study of cannonball arrangements in the late
sixteenth century that ``led him inevitably to the corpuscular or
atomic theory of matter originally deriving from Lucretius and
Epicurus'' \cite[p.~242]{Shi83}.

\figBDCABIA % fig:pascal

Kepler became involved in sphere packings through his correspondence
with Harriot around 1606--1607 on the topic of optics.
Harriot, the atomist, attempted to understand reflection and refraction
of light in atomic terms.  Kepler favored a more classical explanation of
reflection and refraction in terms of what Kargon describes as ``the union of two opposing
qualities -- transparence and opacity''~\cite[p.26]{Kar66}.  
Harriot was stunned that
Kepler would be satisfied by such reasons.

Despite Kepler's initial reluctance to adopt an atomic
theory, he was eventually swayed and  published an essay in  1611
that explores the consequences of a theory of matter composed of small
spherical particles. 
Kepler's essay describes the FCC packing and asserts
that ``the packing will be the tightest possible, so that in no other
arrangement could more pellets be stuffed into the same
container''~\cite{Kep66}.  This assertion has come to be known as the
Kepler conjecture.  This book
gives a proof of this conjecture.

\subsection{Newton and Gregory}

The next episode in the history of this problem,  a debate between
Isaac Newton and David Gregory,  centered on the
question of how many congruent balls  can be arranged to touch
a given ball.  The analogous question in two dimensions is readily answered;
six pennies, but no more, can be arranged
to touch a central penny.  In three dimensions, Newton said that the maximum was
twelve balls, but Gregory claimed that thirteen might be possible.

The Newton--Gregory problem was not solved until centuries later
(Figure~\ref{fig:musin}).  The first proper proof was obtained by van
der Waerden and Sch\"utte in 1953 \cite{Sch53}.  An elementary proof
appears in Leech \cite{Leech:1956:MG}.  Although a connection between
the Newton--Gregory problem and Kepler's problem is not obvious, Fejes
T\'oth successfully linked the problems in 1953~\cite{Fej53}.

\figPTFTWZM % fig:musin

\section{Face-Centered Cubic}



The FCC packing is the familiar pyramid arrangement of
balls on a square base as well as a pyramid arrangement on a
triangular base.  The two packings
differ only in their orientation in space.
Figure~\ref{fig:tri-square} shows how the triangular base
packing fits between the peaks of two adjacent square based pyramids.

\figNTNKMGO % fig:tri-square

Density, defined as a ratio of volumes, is insensitive to changes of
scale.  For convenience, it is sufficient to consider balls of unit
radius. This means that the distance between centers of balls in a
packing is always  at least $2$.  We identify a packing with its set $V$
of centers.   For our purposes, a packing is just a set of points
in $\ring{R}^3$ in which the elements are separated by distances of at least
$2$.



The density of a packing is the ratio of the volume occupied by the
balls to the volume of a large container.  The
purpose of a finite container is to prevent the volumes from becoming
infinite.  To eliminate the distortion of the packing caused by the
shape of the its boundary, we take the limit of the densities within an increasing
sequence of spherically shaped containers, as the diameter tends to infinity.

The FCC packing is obtained from a cubic lattice, by inserting a ball
at each of the eight extreme points of each cube and then inserting a
another ball at the center of each of the six facets of each cube
(Figure~\ref{fig:face-centered-cubic}).  The name
\fullterm{face-centered cubic}{FCC} comes from this construction.  The edge
of each cube is $\sqrt8$, and the diagonal of each facet is $4$.  The
density of the packing as a whole is equal to the density within a
single cube.  The cube has volume $\sqrt8^3$ and contains a total of
four balls: half a ball along each of six facets and one eighth a ball
at each of eight corners.  Thus, the density within one cube is
   \[ 
   \frac{   4 (4\pi/3)}{\sqrt8^3} = \frac{\pi}{\sqrt{18}}.
   \] 


\figTCFVGTS % fig:face-centered-cubic


%The tiling of regular tetrahedra and octahedra can be
%superimposed on the picture of the cube.  Each tetrahedron has an extreme point
%in common with the cube and three other extreme points at centers of facets
%of the cube.   One octahedron is concentric with the cube and has an extreme
%point at the center of each facet.  There is an
%additional quarter of an octahedron along each edge of the cube, extending to the
%midpoints of the two adjacent facets, making a total of eight
%tetrahedra and four octahedra.  As each octahedron has the volume of
%four tetrahedra, exactly $1/3$ of the cube is filled with tetrahedra,
%the other $2/3$ with octahedra.  This decomposition shows that the
%volume of a tetrahedron is $2\sqrt2/3$.
%%(pretend ignorance). The volume $16\sqrt2$ 
%%of the cube equals $24$ tetrahedra \dots, giving each a volume
%%of 
%%$2\sqrt{2}/3$.

The density $\pi/\nsqrt{18}$ of the packing is the ratio of the volume
$4\pi/3$ of a ball to the volume of a fundamental domain of the FCC
lattice.  The volume of the fundamental domain is therefore
$4\nsqrt{2}$.  A fundamental domain of the FCC lattice is a
parallelepiped that can be dissected into two regular tetrahedra and
one regular octahedron (Figure~\ref{fig:fcc-fun-domain}).  The FCC
packing is then an alternating tiling by tetrahedra and octahedra in
2:1 ratio.  A tetrahedron scaled by a factor of two consists of one
tetrahedron at each extreme point and one octahedron in the center
(Figure~\ref{fig:tet-oct-ratio}). By similarity, the total volume is
$8 = 2^3$ times the volume of each smaller tetrahedron. This
dissection exhibits the volume of a regular octahedron as exactly four
times the volume of a regular tetrahedron of the same edge length.  As
a result, the volume of a regular tetrahedron of side $2$ is $1/6$ the
volume of the fundamental domain, or $2\nsqrt{2}/3$.

\figSEYIMIE % fig:fcc-fun-domain

\figAZGXQWC % fig:tet-oct-ratio

The density of the FCC packing is the weighted density
of the densities of the tetrahedron and octahedron.  Write $\dtet$ and
$\doct$ for these densities.  Explicitly, $\dtet$ is the ratio of the
volume of the part within the tetrahedron of the unit balls (at the
four extreme points) to the full volume of the tetrahedron.  As tetrahedra fill
$1/3$ of volume of the fundamental domain and an octahedron fills
the other $2/3$,
\[ 
  \frac{\pi}{\sqrt{18}} = \frac{1}{3}\dtet + \frac{2}{3}\doct.
\] 

As above, we identify a packing with the set $V$ of centers of the
balls.  The \fullterm{Voronoi cell}{decomposition!Voronoi} 
of a point $v$ in a packing $V$ is
defined as the set of all points in $\ring{R}^3$ (or more generally in
$\ring{R}^n$) that are at least as close to $v$ as to any other point
of $V$ (Figure~\ref{fig:voronoix}).  Each Voronoi cell of the FCC
packing is a rhombic dodecahedron
(Figure~\ref{fig:rhombic-dodec}),
which is constructed from an inscribed cube by placing a square based pyramid
(with height half as great as an edge of its square base) on each of
the six facets.

\indy{Index}{Voronoi|see{decomposition}}%

\figEVIAIQPx % fig:voronoix

\figPQJIJGE % fig:rhombic-dodec

%Recall that the cubes under discussion  have an edge length
%$\sqrt{2}$.
Rhombic dodecahedra, being the Voronoi cells of the FCC packing, tile space.
In each rhombic dodecahedron, we 
may color the inscribed cube black and the six square-based pyramids
white.  In the tiling, 
the black cubes fill the black spaces of an infinite three-dimensional
checkerboard, and the white pyramids fill the white spaces.

A Voronoi cell contains an inscribed black cube of side $\sqrt2$ and a total
of one white cube, for a total volume of $4\nsqrt2$, which is
again the volume of the fundamental domain.  The density of the
FCC packing is the ratio of the volume of a ball to the volume
of its Voronoi cell, which gives $\pi/\nsqrt{18}$ yet again.



\section{Hexagonal-Close Packing}\label{sec:hcp}

There is a popular and persistent misconception that the FCC
 packing is the only packing with density $\pi/\nsqrt{18}$.
The hexagonal-closed packing (HCP) has the same density.
\indy{Index}{HCP}%
\indy{Index}{FCC}%


In the FCC packing, each ball is tangent to twelve others in the same
fixed arrangement.  We call it the \fullterm{FCC
  pattern}{FCC!pattern}.  Likewise, in the HCP, each ball is tangent
to twelve others in the same arrangement
(Figure~\ref{fig:fcc-hcp-pattern}).  We call it the \fullterm{HCP
  pattern}{HCP!pattern}.  The FCC pattern and HCP patterns are
different from each other.  In the FCC pattern, four different planes
through the center give a regular hexagonal cross section, while the
HCP pattern has only one such plane.

\figSGIWBEN % fcc-hcp-pattern

There are, in fact, uncountably many packings of density
$\pi/\nsqrt{18}$ in which the tangent arrangement around each ball is
either the FCC pattern or the HCP pattern.

A \newterm{hexagonal layer} (Figure~\ref{fig:hex-layers}) is a translate of the
two-dimensional hexagonal lattice (also known as the triangular
lattice). That is, it is a translate of the planar lattice generated
by two vectors of length $2$ and angle $2\pi/3$.  The FCC
 packing is an example of a packing built from hexagonal layers.

 If $L$ is a hexagonal layer, then a second hexagonal layer $L'$ can be
 placed parallel to the first so that each lattice point of $L'$ has
 distance $2$ from three different points of $L$,
%When the second
% layer is placed in this manner, 
 which is the smallest possible distance from first layer.  A choice
 of a unit normal vector $\e$ to the plane of $L$ determines an upward
 direction.  There are two different positions in which $L'$ can be
 closely placed above $L$
% and two different positions in which
% $L'$ can be placed closely below $L$ 
(Figure~\ref{fig:hex-layers}).  Each successive layer 
  ($L$, $L'$, $L''$, and so
 forth) offers two further choices  for the placement of
 that layer. Running through different 
 sequences of choices gives uncountably many packings.  In each of
 these packings the tangent arrangement around each ball is the FCC or HCP arrangement.

\figCCQCYWU % fig:hex-layers

As a packing is constructed, each layer may be labeled
$A$, $B$, or $C$ depending on three possible orthogonal projections to a fixed plane
with normal vector $\e$.
Each layer carries a different label from the layers immediately
above and below it.  In the FCC packing, the successive layers are
$A,B,C,A,B,C$, and so forth.  In the HCP packing, the successive layers are
$A,B,A,B$, and so forth.  If the vertices of a triangle are labeled $A$, $B$, and $C$,
then the succession of labels is a
walk along the vertices of the triangle, and inequivalent walks through the
triangle describe different packings.


The different walks through a triangle give all possible packings of
infinitely many congruent balls in which each tangent arrangement is
either the FCC pattern or the HCP pattern~\cite{CoSl95}.  To see that
there are no other possibilities, we first assume that every ball of
$V$ is surrounded by the FCC pattern.  Adjacent FCC patterns interlock
in a unique way that forces $V$ itself to crystallize into the FCC
packing.  This completes the proof in this case.

Now we assume that a packing $V$ contains some ball (centered at $\u$)
in the HCP pattern. Its uniquely determined
plane of reflectional symmetry contains $\u$ and the centers of six
others arranged in a regular hexagon. If $\v$ is the center of one of
the six other balls in the plane of symmetry, its  tangent arrangement
of twelve balls must include $\u$ and an additional four of the
twelve balls around $\u$. These five centers around $\v$ are not a
subset of the FCC pattern, but  extend uniquely to
a HCP pattern.   Around $\u$ and $\v$, the HCP patterns  have the same
plane of symmetry. In this way, as
soon as some center has the HCP pattern, the pattern
propagates along the plane of symmetry to create a hexagonal layer
$L$.

Once a packing $V$ contains a single hexagonal layer, the condition
that each ball be tangent to twelve others forces a hexagonal layer
$L'$ above $L$ and another hexagonal layer below $L$.  Thus, a single
hexagonal layer forces an infinite sequence of close-packed hexagonal
layers.  The position of each layer over the previous layer is described 
by the labels $A$, $B$, and $C$ of the triangle.
This completes the proof that the different walks through a triangle give
all possibilities.



\section{Gauss}

Gauss proved that the FCC packing has the greatest density
of any lattice packing in three-dimensional Euclidean space.  There is a
short proof that does not require any calculations.

\begin{proof}
Start with an arbitrary lattice $V$ in which every point has distance 
at least $2$ from every other.  Center a unit ball at each point in
the lattice.  In a lattice of greatest density, some pair of balls
touch.  The lattice property then forces the balls into parallel
infinite linear strings like beads on a string.  Two of these infinite
parallel strings touch if the lattice is  optimal.  The
lattice property then constrains the strings in parallel sheets.  On
each sheet the touching parallel strings form a rhombic tiling.  Each
parallel sheet sits as snugly as possible on the sheet below in an optimal
lattice.  In such an arrangement, a ball (centered at
$\v_0$) of one sheet touches three balls (centered at
$\v_1,\v_2,\v_3$) on the next layer down (Figure~\ref{fig:rhombus}).

\figAFRJFRK % fig:rhombus


As the balls on each sheet form a rhombic tile, two of the distances
between $\v_1,\v_2,\v_3$, corresponding to two edges of the rhombus, are
equal to $2$.  This means that $\v_0$ together with two of
$\v_1,\v_2,\v_3$ form an equilateral triangle.  

From the perspective of the plane containing this equilateral
triangle, the lattice property forces this entire plane, as well as
parallel planes, to be tiled with equilateral triangles.  From the
earlier argument, each of these planes sits as snugly as possible on
the sheet below.  A ball of one sheet touches the three balls in an
equilateral triangle on the layer below.  These four balls form a
regular tetrahedron, which uniquely identifies the lattice as the FCC.
\end{proof}






\section{Thue}\label{sec:thue}


As mentioned in the preface, Thue solved the packing problem for
congruent disks in the plane.  The optimal packing is the hexagonal
packing (Figure~\ref{fig:2D-hex}).  The density of this packing is
$\pi/\nsqrt{12}$, that is, the ratio of the area of a unit disk to the
area of a hexagon of inradius one.  Thue's theorem admits an
elementary proof that we sketch.  Casselman has an 
interactive demo of this solution \cite{casselman:pennies}.

\figOCULYIA % fig:2D-hex

\begin{proof}
Let $V$ be the set of centers of a collection of unit disks in
$\ring{R}^2$.  Take the Voronoi cell around each
disk.\footnote{Voronoi cells of packings in any dimension $\ring{R}^n$
  are defined by the same rule as we gave above for $\ring{R}^3$.}   It
is enough to show that each Voronoi cell has density at most
$\pi/\nsqrt{12}$ because the limiting density of the packing in the entire plane cannot exceed
a bound on the density within a Voronoi cell.  


Truncate the Voronoi cell by intersecting it with a disk of radius
$r=2/\nsqrt3$.   The density increases as the volume of the cell is made smaller,
so if the truncated Voronoi cell
has density at most $\pi/\nsqrt{12}$, then so does the untruncated Voronoi cell.

There is not a point $\w$ in the plane that has distance  less than $r$
from three disk centers $\v_1,\v_2,\v_3$.  Otherwise, one of the three
angles $\gamma$ at $\w$ formed by pairs $(\v_i,\v_j)$ of points
 is at most $2\pi/3$, and $\cos\gamma\ge -0.5$.
The \newterm{law of cosines} applied to the triangle $\w,\v_i,\v_j$ with angle
$\gamma$ and sides $a$, $b$, and $c$ gives the contradiction
   \[ 
   4 \le c^2 = a^2 + b^2 - 2 a b \cos\gamma 
   \le a^2 + b^2 + a b < 3r^2 = 4.
   \] 
Thus, the boundary of the truncated Voronoi cell consists of circular
arcs and chords of the circle of radius $r$, as shown in Figure~\ref{fig:2D-proof}.

\figSENQMWT % fig:2D-proof

The parts of the Voronoi cell that lie within a circular sector have
density $1/r^2 = 3/4 < \pi/\nsqrt{12}$.  A simple calculation shows
that the part of a Voronoi cell that lies within a triangle has
density
   \begin{equation}\label{eqn:rog2d}
   \frac{\theta}{r^2 \cos\theta\sin\theta}
   \end{equation}
% checked 3/31/2008.
for some $0 \le \theta\le \pi/6$.  An easy optimization gives the maximum
at $\theta=\pi/6$ with value $\pi/\nsqrt{12}$.  This completes the proof of Thue's theorem.
\end{proof}

In some ways it it unfortunate that the problem in two dimensions is
so elementary.  It gives only meager hints about how to solve the problem
in three dimensions such as the value of Voronoi cells
and the usefulness of truncation.  The optimization problem on
triangles in Equation~\ref{eqn:rog2d} generalizes to $n$-dimensions.
But beyond these simple observations,  little from the proof of Thue's
theorem prepares us for higher dimensions.

%\subsection{two dimensions}

\bigskip

\indy{Index}{decomposition!Delaunay}%

There are other proofs of Thue's theorem, including one by Fejes
T\'oth that uses the \fullterm{Delaunay triangulation}{decomposition!Delaunay} 
of a packing $V$
in the plane (or in $n$-dimensions).  A Delaunay triangulation of $V$
is a triangulation of Euclidean space into simplices with extreme
points in $V$ such that no point of $V$ lies in the interior of any
circumscribing circle of any of the simplices (Figure~\ref{fig:delaunay}).  
If $V$ is
\newterm{saturated},\footnote{A packing $V$ is saturated if it is not
  a proper subset of any other packing $V'$.  To maximize density, it
  is useful to increase the density by saturating the packing with
  additional points.} then a Delaunay triangulation of
$V$ exists.  Each Delaunay triangle in a saturated packing $V$ has
circumradius at most $2$ because otherwise an additional point can be
placed at the center of the circumscribing circle, contrary to saturation.

\figANNTKZP % fig:delaunay

\begin{proof}
  By admitting the existence of a Delaunay triangulation, the proof of
  the packing problem for saturated packings $V$ in two dimensions becomes
  elementary.  Each Delaunay triangle contains a portion of a disk at each of
  its three vertices.  The three interior angles of a triangle sum to
  $\pi$, giving half a disk per triangle.  If we show that each triangle has area
  at least $\nsqrt{3}$, then it follows that the density of the packing is at most
  $(\pi/2)/\nsqrt{3} = \pi/\nsqrt{12}$.  The problem thus reduces to
  an area minimization problem.  To decrease the area of a triangle
  $\{\v_0,\v_1,\v_2\}$, we first replace it with a smaller similar
  triangle with shortest edge (say $\v_1\v_2$) of length $2$.  The
  third vertex $\v_0$ is constrained to have distance at least $2$
  from $\v_1$ and $\v_2$, and to have circumradius at most $2$.  The
  constraints on $\v_0$ form three circular arcs as shown in
  Figure~\ref{fig:delaunay-proof}.

\figCCKQLLH  % fig:delaunay-proof


The minimizing triangle is determined by the point $\v_0$ closest to
the line through $\v_1$ and $\v_2$.  There are three such triangles,
each with area exactly $\sqrt3$.  This completes the proof.
\end{proof}

\section{Dense Packings in a Nutshell}

This section describes the proof of the Kepler conjecture in general,
without
getting embroiled in detail.  The entire book
is a blueprint with all the electrical schematics, plumbing, and
ventilation systems.  This section is the tourist brochure.

The Kepler conjecture asserts that no packing of congruent balls in
three-dimensional Euclidean space has density greater than the density
$\pi/\nsqrt{18} \approx 0.74048$ of the FCC packing.  For a contradiction, we suppose that an
explicit counterexample exists to the Kepler conjecture in the form of a
packing of balls of unit radius with density  greater than
$\pi/\nsqrt{18}$.  Additional balls may be added to this packing until
saturation is reached.  The saturation of a counterexample may push its
density even higher.

We present the proof in four stages.  Undefined terms are clarified in the
discussion that follows.

\begin{enumerate}
\item A geometric partition of space, adapted to a saturated
  counterexample $V$, reduces the problem to finite packing $W$ that
  gives a counterexample to a particular inequality.  In notation
  established below, the particular inequality is $\CalL(W,\orz)\le
  12$ for every finite packing $W\subset B(\orz,2.52)$, where $B(\p,r)$
denotes the open ball of radius $r$ centered at $\p$.  The
  counterexample satisfies $\CalL(W,\orz)>12$.
\item The finite packing $W$ is transformed into another finite packing that violates the same
inequality and that has a few additional properties that make it a \newterm{contravening} packing.
\item The combinatorial structure of $W$ is encoded as a hypermap.  A list is
  made of the purely combinatorial properties of $W$.  A hypermap with
  these properties is said to be \newterm{tame}.
\item A computer generates an explicit list, enumerating
  tame hypermaps up to isomorphism.  Linear programs, which are
  adapted to each tame hypermap in the enumeration, certify that
  none of the combinatorial possibilities can be  realized geometrically as a finite packing
  $W\subset \ring{R}^3$.  
\end{enumerate}
\indy{Notation}{L1@$\CalL(V)$ (estimation of a packing)}%
\indy{Notation}{B@$B(\v,r)$ (open ball)}%

From the nonexistence of a counterexample $W$, 
it follows that there is no saturated
counterexample $V$ to the Kepler conjecture.



\subsection{geometric partition}

The first stage of the proof defines a geometric partition of space
and uses it to reduce the Kepler conjecture to an optimization problem
in a finite number of variables.

We recall that a saturated packing is
identified with the discrete set $V$ of centers of the
congruent balls.  Also, as above, the Voronoi cell $\Omega(V,\v)$
associated with $\v\in V$ is the polyhedron formed by all points of
$\ring{R}^3$ that are at least as close to $\v$ as to any other $\w\in
V$.   

The Voronoi cell at $\v$ can be further partitioned into Rogers
simplices, each of which is determined by a facet of the Voronoi cell, an edge of
the facet, and an extreme point of the edge.  The Rogers simplex is defined to be the
convex hull of four points: $\v\in V$, the closest point $\v_1$ to $\v$ on the given facet, the closest point $\v_2$ to $\v_1$ on the edge, and the
extreme point $\v_3$ of the edge (Figure~\ref{fig:rogers-intro}).

\figORQISJR % fig:rogers-intro

We dissect and combine the Rogers simplices somewhat further to make
them into \fullterm{Marchal cells}{Marchal cell} (Figure~\ref{fig:marchal-intro}).  
The exact rules for the
construction of Marchal cells do not concern us here.  The rules
depend on which of the points $\v_1,\ldots,\v_3$ have distance less
than $\sqrt2$ from $\v$.
\indy{Index}{decomposition!Marchal}%

\figODGBUWK % fig:marchal-intro

The function
 $\CalL(V,\v)$ is defined as
\begin{equation}\label{eqn:LV0}
\CalL(V,\v) = \sum_{\w\in V\setminus\{v\}} L(\norm{\w}{\v}/2),
\end{equation}
where $L$ is the piecewise linear function that has a linear graph from
$(x,y)=(1,1)$ to $(0,1.26)$ and is equal to zero for $x\ge 1.26$.  (The
constants $1.26$ and $2.52=2(1.26)$ appear throughout the proof as
parameters used in truncation.)   
The sum in the definition of $\CalL$ is actually finite for every packing $V$ because only finitely many terms
lie in the support of $L$. 

Next, a function $G:V\to \ring{R}$ is defined geometrically in terms
of the volumes, solid angles, and dihedral angles of Marchal cells.
We do not give the definition here because it is rather
complex.  The function $G$ has the following two fundamental
properties.
\begin{enumerate}
\item If $\CalL(V,\v)\le 12$, then 
\[
4\nsqrt{2}\le \op{vol}(\Omega(V,\v)) +G(\v).
\]
\item There exists $C>0$ such that the points of $V$ in a ball $B(\orz,r)$
of radius $r\ge 1$ satisfy
\[
\sum_{\v\in V \cap B(\orz,r)} G(\v) < C r^2.
\]
\end{enumerate}
The constant $4\nsqrt{2}$ is the volume of the Voronoi cell of the FCC packing.

From these fundamental properties and from the assumption that $V$ is a saturated counterexample,
it follows that $\CalL(V,\v)>12$ for some $\v\in V$.  Indeed, if $\CalL(V,\v)\le 12$ for all
$\v\in V$, then the fundamental properties
imply that on average the Voronoi cells of $V$ have volume at least that of the FCC packing, up to a negligible error term $C r^2$.  From this, it follows that the density
of the packing $V$ is at most that of the FCC packing.



Returning to the counterexample $V$, we select $\v\in V$ such that
$\CalL(V,\v)>12$.  By the translational invariance of the problem, we
may assume that $\v=\orz$.  Then
\begin{equation}\label{eqn:LW}
\CalL(W,\orz) = \sum_{\w\in W} L(\normo{\w}/2)  > 12,
\end{equation}
where $W$ is the finite set  $\{\w\in V\mid 0 < \normo{\w} \le 2.52\}$.

This completes the first stage of the proof.
%, by reducing the Kepler conjecture to an optimization
%problem $\max_W \CalL(W,\orz) \le 12$ in a finite number of variables $W\subset B(\orz,2.52)$.
The counterexample $V$ to the Kepler conjecture leads to a finite packing $W$
that satisfies~\eqref{eqn:LW}.

\subsection{contravening packing}

We assume that $V$ is a counterexample to the Kepler conjecture and
that $W\subset V$ is a finite subset that satisfies \eqref{eqn:LW}.
The second stage of the proof shows that the finite packing $W$ can be
enhanced in various ways.  The result of the enhancement is a new
finite packing that is a \fullterm{contravening
  packing}{contravening}.  At this stage, we also make $W$ into a
graph by defining a set of edges $E$ with nodes in $W$.

For example, the value of $\CalL$
depends only on the norms $\normo{\w}$, and $L$ is a decreasing
function, so that any rearrangement of the points of $W$ that does not
increase the norms strengthens the inequality \eqref{eqn:LW}.

The finite packing $W$ determines a graph $(W,E)$ with node set $W$.  The set
of edges is defined by $\{\v,\w\}\in E$ if 
\[2\le\norm{\v}{\w}\le 2.52.\] This graph is called the \newterm{standard
  fan} of $W$.

We can get a crude idea about what $W$ must look like by studying the
set of normalized points $\w/\normo{\w}$ in the unit sphere.  These
points are extreme points of spherical polygons that partition the unit sphere.
  As we know that the sum of the areas of the polygons equals
the area $4\pi$ of the sphere, we can extract bits of information
about $W$ from estimates of the areas of the polygons.  Analysis along
these lines leads to the conclusion that some finite packing $W$
has the following 
properties.
\begin{enumerate}\wasitemize 
\item $W\subset B(\orz,2.52)$.
\item $\CalL(W) > 12$.
\item The cardinality of $W$ is thirteen, fourteen, or fifteen.
\item $W$ maximizes the function $\CalL$.
\item Join points $\v/\normo{\v}$ and $\w/\normo{\w}$ with a geodesic arc on the
unit sphere if $\{\v,\w\}\in E$.  Then the arcs do not meet except at the endpoints and
give a planar graph.  Moreover, the angle between each pair of consecutive arcs at a vertex is less
that $\pi$.  In particular, the spherical polygons cut out by the arcs are 
geodesically convex.
\end{enumerate}\wasitemize 
A finite packing $W$ with these properties is called a \newterm{contravening} packing.


\subsection{tame hypermap}

The starting point of the third stage of the proof is a contravening
packing $W$ and the corresponding planar graph $(W,E)$.  The result of
this stage is a \fullterm{tame hypermap}{tame!hypermap} (described below).

By definition, a \fullterm{planar graph}{planar!graph} is a graph that admits a
\newterm{planar} embedding.  By contrast, a graph, endowed with
a fixed embedding into the plane, is a \fullterm{plane graph}{plane!graph}.  A
planar graph has too little structure for our purposes because it
does not single out a particular embedding and the plane graph has too
much structure because it gives a topological object where combinatorics
alone should suffice.  A hypermap gives just the right amount of
structure.  It is a purely combinatorial notion, yet encodes the
relations among nodes, edges, and faces determined by the embedding.
An entire chapter of this book is about hypermaps.


The graph $(W,E)$ of a contravening packing $W$ determines a planar hypermap
$\op{hyp}(W,E)$. We study the following question: what  purely
combinatorial properties of the hypermap $\op{hyp}(W,E)$ can be derived from
the assumption  that
$W$ is a contravening packing?  For example, the cardinality of a
contravening packing $W$ is thirteen, fourteen, or fifteen.  Hence, the hypermap
has thirteen, fourteen, or fifteen nodes.   Later chapters of the book
revolve around the combinatorial properties of the
hypermap.

The final chapter of the proof compiles all of these combinatorial
properties into a long list.  
Although the exact details of the list are not significant,
%The list of properties is every bit as
%artificial as a top ten list of world wonders or unsolved mysteries.
%This The idea is to produce -- with minimal effort -- any list of
the list of combinatorial properties severely constrains the set of possible
hypermaps.  

Any hypermap satisfying all of these properties is said to be
\newterm{tame}.  This list of properties appears in
Definition~\ref{def:tame}.

%There is little to be gained by extra efforts at this stage because
%the final stage gives more efficient means to constrain the set of
%possibilities.

\subsection{linear programming}

The fourth and final stage completes the proof the nonexistence of
the contravening packing $W$.  At the beginning of this stage,
$\op{hyp}(W,E)$ is a tame hypermap.  The list of defining properties
of a tame hypermap are sufficiently restrictive that an explicit finite
list can be generated of every tame hypermap, up to isomorphism.  
This list is generated by computer.  The details of the algorithm are
described in the chapter on hypermaps.

Equipped with an explicit list of possible combinatorial structures,
we move to the proof's end game.  At this stage, because of the computer
generated list of tame hypermaps, the cardinality and
combinatorial structure of $W$ are explicit.

Certain properties of $W$ (and its associated hypermap)
 can be encoded as a system of linear inequalities.  For each tame hypermap,
a computer solves one or more linear programs that test for feasible
solutions to the system of linear inequalities.  In each case, the
computer produces a certificate that shows that no feasible solution
exists.  It follows that no tame hypermap can be realized in the form
$\op{hyp}(W,E)$.  Each tame hypermap, which represents a
combinatorially feasible arrangement, is geometrical infeasible.  It
follows that $W$, and hence also $V$, do not exist.

As no counterexample exists, the proof of the Kepler conjecture ensues.

