%\chapter{Essays}


%% XX Write essay on Formal Proof.
%% XX Finish Mathematica calc on dodec.

\chapter{Close Packing}
\section{Face Centered Cubic}



The face-centered cubic packing is the familiar pyramid arrangement
of balls on a square base.  It is also the pyramid arrangement on 
a triangular base.  The square base packing and triangular base
packing differ only in their orientation in space.  
Figure~\ref{fig:tri-square-cannonballs} 
shows how the triangular base packing fits between the peaks
of two adjacent square base pyramids.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The square and triangular based packings of cannonballs}
  \label{fig:tri-square-cannonballs}
\end{figure}

Density, defined as a ratio of volumes, is insensitive to changes
of scale.  For convenience, we will always work with balls of unit radius.
This means that the distance between centers of balls in a packing
will always be at least $2$.  We identify a packing with
its set of centers.  Thus, for our purposes a packing is just
a set of points in $\ring{R}^3$, whose elements are separated by
distances at least $2$.


% based on page 28 of kepler research scan/scan0001.tif
The fcc packing is an alternating tiling of regular
tetrahedra and regular octahedra.  See Figure~\ref{fig:tet-oct}.
%If the balls have
%unit radius, each tetrahedron and octahedron has edge length $2$.
The figure has one
tetrahedron at each vertex and one octahedron in the center.
By similarity, the total volume is $8 = 2^3$ times the volume of each
smaller tetrahedron.
This dissection exhibits
the volume of a regular octahedron as exactly four times
the volume of a regular tetrahedron of the same edge length.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The fcc as a tiling of tetrahedra and octahedra}
  \label{fig:tet-oct}
\end{figure}









The face-centered cubic packing is the packing obtained
from a cubic lattice, with a ball at each vertex and adding
a ball at the center of each face.  The name `face-centered cubic' comes from this construction.  The edge of each cube is
$2\sqrt2$, and the diagonal of each face $4$, for balls
of unit diameter.  The density of the packing is equal to the density
within each cube.  The cube has volume $(2\sqrt2)^3 = 16\sqrt2$.
It contains a total of four balls:  half a ball along each
of six faces and one eighth a ball at each of eight corners.
Thus, the density is
   $$
   \frac{   4 (4\pi/3)}{16\sqrt2} = \frac{\pi}{\sqrt{18}}.
   $$
See Figure~\ref{fig:fcc-cube}.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The face-centered cubic structure}
  \label{fig:fcc-cube}
\end{figure}


The alternating arrangement of regular tetrahedra and octahedra can be
superimposed on the cubic picture.  There is one tetrahedron at each vertex
of the cube, extending to the centers of the three adjacent faces.
An octahedron sits the center of the cube, a vertex
at the center of each face.  There is an additional quarter of an
octahedron along each edge, extending to the midpoints of the two adjacent
faces.  This gives a total of eight tetrahedra and four octahedra.  
As each
octahedron has the volume of four tetrahedra, exactly $1/3$ of
the cube is filled with tetrahedra, the other $2/3$ with octahedra.
This decomposition determines the volume $2\sqrt2/3$ of a tetrahedron.
%(pretend we didn't know). The volume $16\sqrt2$ 
%of the cube equals $24$ tetrahedra $\ldots$, giving each a volume
%of 
%$2\sqrt{2}/3$.

The density of the face-centered cubic packing is the weighted density
of the densities of the tetrahedron and octahedron.  Write $\dtet$
and $\doct$ for these densities.  For example, $\dtet$ is the ratio
of the volume
of the part within the tetrahedron of the unit balls (at the four vertices)
to the volume of the tetrahedron.  As the cube is $1/3$ filled  with
tetrahedra and $2/3$ filled with octahedra, we have
$$
  \frac{\pi}{\sqrt{18}} = \frac{1}{3}\dtet + \frac{2}{3}\doct.
$$

The Voronoi cell of a point $v$ 
in a packing $\Lambda$ consists of
all points in $\ring{R}^3$ that are closer to $v$ than to any
other point of $\Lambda$.
Each Voronoi cell of the face-centered cubic
packing is a rhombic dodecahedron (Figure~\ref{fig:rhombic}).   %% not drawn.
The rhombic dodecahedron can be constructed from a cube by placing a
square based pyramid (with height half as great as an edge of its square
base) on each of the six faces (Figure~\ref{fig:rhombic-cube}).  %% not drawn. 
For the scale to be correct, the
initial cube should have edge $\sqrt{2}$. 

The Voronoi cells can be superimposed on the cube of side $2\sqrt2$.  If we center
a cube of side $\sqrt2$ at each ball in the packing. These cubes fill
the black grid of an infinite three dimensional checkerboard,
leaving a second grid of white cubes unfilled.  Each
white cube can be partitioned into  pyramids along
its faces with apex at the center of the cube.  Attaching these pyramids
along their bases to the adjoining black cubes gives the Voronoi cell.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The rhombic dodecahedron as Voronoi cell}
  \label{fig:rhombic}
\end{figure}

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The rhombic dodecahedron constructed from a cube}
  \label{fig:rhombic-cube}
\end{figure}

Each Voronoi cell contains one black cube of side $\sqrt2$ and a total
of one white cube, for a total volume of $4\sqrt2$.  This constant is one of the
fundamental constants in this book.  The volume of every Voronoi cell
is compared against the volume of the rhombic dodecahedron.
The density of the face-centered
cubic is the ratio of the volume of a ball to the volume of its Voronoi
cell, which gives $\pi/\sqrt{18}$, yet again.





\section{Hexagonal-close packing}

There
is a popular and persistent misconception in the popular press
that the face-centered cubic packing is the only packing with
density $\pi/\sqrt{18}$. 

In the face-centered cubic packing, each ball is tangent to twelve
others.  For each ball in the packing, this arrangement of twelve
tangent balls is the same.  We call it the fcc pattern. 
In the
hexagonal-close packing, each ball is tangent to twelve others
(Figure~\ref{fig:hcp}).
For each ball in the packing, the arrangement of twelve tangent
balls is again the same.  We call it the hcp pattern.  The fcc
pattern is different from the hcp pattern.  In the fcc pattern,
there are four different planes through the center of the central
ball that contain the centers of six other balls at the vertices
of a regular hexagon.  In the hcp pattern, there is only one such
plane.  We call the arrangement of balls tangent to a given ball
the {\it local tangent arrangement} of the ball.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The fcc and hcp patterns}
  \label{fig:hcp}
\end{figure}

There are uncountably many packings of density $\pi/\sqrt{18}$
that have the property that every ball is tangent to twelve others
and such that the tangent arrangement around each ball is either
the fcc pattern or the hcp pattern.

By {\it hexagonal layer}, we mean a translate of the two-dimensional
lattice of points $M$ in the $A_2$ arrangement. That is, $M$ is a
translate of the planar lattice generated by two vectors of length
$2$ and angle $2\pi/3$.  The face-centered cubic packing is an
example of a packing built from hexagonal layers.

If $M$ is a hexagonal layer, a second hexagonal layer $M'$ can be
placed parallel to the first so that each lattice point of $M'$ has
distance $2$ from three different vertices of $M$.  When the second
layer is placed in the manner, it is as close to the first layer as
possible. Fix $M$ and a unit normal to the plane of $M$. The normal
allows us to speak of the second layer $M'$ as being ``above'' or
``below'' the layer $M$. There are two different positions in which
$M'$ can be placed closely above $M$ and two different positions in
which $M'$ can be placed closely below $M$  (Figure~\ref{fig:two-holes}). As we build a packing,
layer by layer, ($M$, $M'$, $M''$, and so forth), there are two
choices at each stage of the close placement of the layer above the
previous layer. Running through different sequences of choices gives
uncountably many packings.  In each of these packings the tangent
arrangement around each ball is that of the twelve balls in the
face-centered cubic or the twelve balls in the hexagonal-close
packing.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The two positions of hexagonal layers}
  \label{fig:two-holes}
\end{figure}

Let $\Lambda$ be a packing built as a sequence of close-packed
hexagonal layers in this fashion.  If $P$ is any plane parallel to
the hexagonal layers, then there are at most three different
orthogonal projections of the layers $M$ to $P$.  Call these
projections $A$, $B$, $C$.  Each hexagonal layer has a different
projection than the layers immediately above and below it.  In the
fcc packing, the successive layers are $A,B,C,A,B,C,\ldots$.  In
the hcp packing, the successive layers are $A,B,A,B,\ldots$.  If
we represent $A$, $B$, and $C$ as the vertices of a triangle, then
the succession of hexagonal layers can be described by a walk
along the vertices of the triangle. Different walks through the
triangle describe different packings (Figure~\ref{fig:fcc-tri}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{Describing layers by walks through a triangle}
  \label{fig:fcc-tri}
\end{figure}

% In the face-centered
%cubic packing, every local tangent arrangement of $12$ tangent
%balls is the same.  We call this local tangent arrangement the
%fcc-pattern. Similarly, the local tangent arrangement of the
%hexagonal-close packing will be called the hcp-pattern.  These
%patterns are uniquely determined up to rigid motion.

The different walks through a triangle give all packings of
infinitely many equal balls in which the tangent arrangement around
every ball is either the fcc pattern of twelve balls or the hcp
pattern of twelve balls.



We prove that different walks through a triangle give all
such packings. Assume first 
that $\Lambda$ does not contain any balls whose local
tangent arrangement is the hcp pattern.  Then every local tangent
arrangement is the fcc pattern, and $\Lambda$ itself is then the
face-centered cubic packing.  This completes the proof in this case.

Now assume that a packing $\Lambda$ contains some ball
(centered at $v_0$) in the hcp pattern. The hcp pattern contains a
uniquely determined plane of symmetry. This plane contains $v_0$ and
the centers of six others arranged in a regular hexagonal. If $v$ is
the center of one of the six others in the plane of symmetry, its
local tangent arrangement of twelve balls must include $v_0$ and an
additional four of the twelve balls around $v_0$. These five centers
around $v$ are not a subset of the fcc pattern. They can be uniquely
extended to twelve centers arranged in the hcp pattern. This hcp
pattern has the same plane of symmetry as the hcp pattern around
$v_0$. In this way, as soon as there is a single center with the hcp
pattern, the pattern propagates along the plane of symmetry to
create a hexagonal layer $M$.

Once a packing $\Lambda$ contains a single hexagonal layer, the
condition that each ball be tangent to twelve others forces a
hexagonal layer $M'$ above $M$ and another hexagonal layer below
$M$.  Thus, a single hexagonal layer forces an infinite sequence of
close-packed hexagonal layers.  This completes the proof.



\section{Gauss}

Gauss proved that the face-centered packing has the greatest density
of any lattice packing in three dimensional Eulidan space.  
There is a short proof that
does not require any calculations.

Start with an arbitrary lattice $\Lambda$ in which every point has
distance at least two from every other.  Center a unit ball at each
point in the lattice.  A lattice of greatest density has the property that some pair of balls touch.  The lattice property
then forces the the balls into parallel infinite linear strings
like beads on a string.  The lattice of greatest
density has the property that two of these 
infinite parallel strings touch.  The lattice property then arranges the strings into parallel sheets.  On each sheet the touching parallel
strings form a rhombic tiling.  The lattice of greatest density
has the property that each parallel sheet should sit
as snugly as possible on the sheet below.  That means that some ball (centered at $A$) of
one sheet touches three balls (centered at $B,C,D$) 
on a the next layer down (Figure~\ref{fig:rhombus}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{A ball from one sheet touches three balls centered at points of a rhombus.}
  \label{fig:rhombus}
\end{figure}

As the balls on each sheet form a rhombic tile, two of the distances
between $B,C,D$, corresponding to two edges of the rhombus, 
are equal to $2$.  This means that $A$ together with
two of $B,C,D$ form an equilateral triangle.  From the perspective of the plane
containing this equilateral triangle, the lattice property forces this entire
plane, as well as parallel planes, to be tiled with equilateral triangles.
From the earlier argument, each plane sits as snugly as possible on
the sheet below.  Some ball of one sheet touches the three balls forming
an equilateral triangle in the layer below.  These four balls form a regular
tetrahedron.  This tetrahedron 
uniquely identifies the lattice as the face-centered cubic.






\section{Thue}\label{sec:thue}


As mentioned, 
Thue solved the  packing problem for congruent disks in the plane.
The optimal packing is the hexagonal packing (Figure~\ref{fig:2D-hex}). 
The density of this packing is $\pi/\sqrt{12}$: the ratio of the
area of a unit disk to the area of a hexagon of inradius one.
It admits an elementary solution that we sketch here.  B. Casselman
has an animated interactive demo of this solution \cite{BC00}.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The optimal packing in two dimensions}
  \label{fig:2D-hex}
\end{figure}

Let $\Lambda$ be the set of centers of a collection of unit disks.
Take the Voronoi cell around each disk.  It is enough to show that
each Voronoi cell has area at least $\sqrt{12}$.  For simplicity,
we may assume that $0\in\Lambda$ is the center of our Voronoi cell.  

We truncate the Voronoi cell by intersecting it with a disk of radius
$\rho=2/\sqrt3$.  It is enough to show that the truncated Voronoi cell has
density  at most $\pi/\sqrt{12}$.  

There is not a point $w$ in the plane that has distance less than $\rho$
from three disk centers $v_1,v_2,v_3$.  Otherwise, one of the three
angles $\gamma$ at $w$ is at most $2\pi/3$; and $\cos\gamma\ge -0.5$  
The law of cosines applied
to the triangle $w,v_i,v_j$ with angle $\gamma$ gives the contradiction:
   $$
   4 \le c^2 = a^2 + b^2 - 2 a b \cos\gamma 
   \le a^2 + b^2 + a b < 3\rho^2 = 4.
   $$
Thus, the boundary of the truncated Voronoi cell consists of circular
arcs and chords of the circle of radius $\rho$ (see Figure~\ref{fig:2D-proof}).

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The sectors and triangles of a truncated Voronoi cell}
  \label{fig:2D-proof}
\end{figure}

The
parts of the Voronoi cell that lie within a circular sector have density
$1/\rho^2 = 3/4 < \pi/\sqrt{12}$.  The
parts of the Voronoi cell that
lie within a triangle have density
   \begin{equation}\label{eqn:rog2d}
   \frac{\theta}{\rho^2 \cos\theta\sin\theta}
   \end{equation}
% checked 3/31/2008.
where $0 \le \theta\le \pi/6$.  An easy optimization gives the maximum
at $\theta=\pi/6$ with value $\pi/\sqrt{12}$.

In some ways it it unfortunate that the problem in two dimensions is so
elementary.  It gives meager hints about how to solve the problem in
three dimensions.   It suggests the
introduction of Voronoi cells and the usefulness of truncation.
The little optimization problem on triangles in Equation~\ref{eqn:rog2d}
generalizes to $n$-dimensions.  This is Rogers's lemma.
It appears as Lemma~\ref{lemma:rogers} in this book.  It is a tremendously useful lemma in the study of packing densities.

%\subsection{two dimensions}

\bigskip

There are many proofs of Thue's theorem.  Here we present a second proof
that is due to L. Fejes T\'oth.  Section~\ref{sec:13s} 
introduces the Delaunay
triangulation of a finite set $C$ of points on a sphere.
There is a corresponding Delaunay triangulation for infinite sets $\Lambda$
of points in the plane (or more generally in $n$-dimensions).  We
assume that $\Lambda$ is the set of centers of packing so that
distances between points of $\Lambda$ are at least two.  
If we enlarge a packing
$\Lambda\subset\Lambda'$, then the density can only go up.  In issues
of density, it does no harm to assume that the packing is {\it saturated}; that is, it is not a proper subset of another packing.  A saturated
packing of the plane (or $n$-space) has a Delaunay triangulation.  It
is a triangulation in which the circumscribing circle of each triangle
contains no points of $\Lambda$ in its interior.   Each Delaunay
triangle has
radius at most $2$, for otherwise the packing is not saturated: an additional point can be placed at the center of the circumscribing circle.

\begin{proof}
Admitting the existence of the Delaunay triangulation, the proof 
of the packing problem in two dimensions is
elementary.  Each Delaunay triangle contains a portion of a disk at each of
its three vertices.  The interior angles of a triangle sum to $\pi$, giving
half a disk per triangle.  If we show that each triangle has area at least
$\sqrt{3}$, then the density of the packing is at most
 $(\pi/2)/(\sqrt{3}) = \pi/\sqrt{12}$.  To minimize the area of Delaunay
triangle $ABC$, we first replace it with a smaller similar triangle whose
shortest edge (say $BC$) has length $2$.  The third vertex $A$ is constrained
to have distance at least $2$ from $B$ and $C$, and to give circumradius at most $2$.  The constraints on $A$ form three circular
arcs as shown in Figure~\ref{fig:2D-FT} % not drawn.

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{The constraints on the point $A$, vertex of a Delaunay triangle}
  \label{fig:2D-FT}
\end{figure}

The minimizing triangle is determined by the point $A$ closest to the
line $BC$.  There are three such points, all giving triangles of area
exactly $\sqrt3$.  This completes the proof.
\end{proof}

This proof suggests that the solution to the packing problem
in three dimensions might also make use of the Delaunay
decomposition.  This was the starting point of my work on the
problem, to find a three dimensional approach to the packing
problem that generalizes the proof just presented \cite{remarks}.



\clearpage






