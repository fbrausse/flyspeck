% File added May 15, 2012

%\chapter{Supplementary Notes}\label{sec:supplement}

\newpage
\section{Appendix on the main estimate}\label{sec:sup-local-fan}

This appendix was written in May 2012 in response to Hoang Le Truong's observation that the dependent type $\BB_s\subset \ring{R}^k$, with variable $k$, is unpleasant to deal with in HOL Light.  Lemmas have been reworded to involve a single $\BB_s$
rather than a collection of them, whenever possible.

 It also grew out of an Objective CAML program that checks the completeness of the arguments in Section~\ref{sec:weight}, at an informal level.  This involved translating metric properties of local fans into combinatorial
properties of augmented constraint systems, and then checking the combinatorial
relations by computer.  As a result, the verification of the main estimate
can now largely be viewed as a combinatorial proof that $S_{init}\Ra S_{term}$.
This appendix documents the program \verb!check_completeness.hl!.

One other improvement in exposition has been to replace the (inexplicit)
function $\ell$, which was used to guarantee finite termination of algorithms,
with a relation $(\Ra)$, whose essential features are captured by
finitely
many iterations of a few basic operations.

\begin{definition}\guid{ZBJCZHI}
Let $s$ be a constraint system.  We say that $s$ is \newterm{tri-stable}, if $k(s)=3$
and if the
following conditions hold.
\begin{enumerate}
\item 
\[
0 = a_{ii}\text{ and }2\le a_{ij} \text{ for all }  i,j\in I \text{ such that } i\ne j.
\]  
\item
  Also, 
\[
  b_{i,i+1} < 4.
\]  
\item
If $\{i,j\}\in J$, then $\leftclosed
  a_{ij},b_{ij}\rightclosed=\leftclosed\sqrt{8},\stab\rightclosed$.
\end{enumerate}
(Note that these are the same as stability conditions, except that
%the stability condition $a_{ij}\le \stab$ has been dropped, 
%and 
$b_{i,i+1}\le \stab$ has been relaxed to $b_{i,i+1}<4$.)
\end{definition}

If $s$ is a tri-stable constraint system, we modify the definition
of $\BB_s$ by dropping the condition requiring $(V_\v,E_\v,F_\v)$ 
to be a local fan.  In other words, $\BB_s$ is the set of all functions
$\v:I(s)\to\BB$ that have the following property.
\begin{equation}\label{eqn:tri-stable}
a_{ij}(s)\le\norm{\v_i}{\v_j}\le b_{ij}(s), \text{ for all } i,j\in I(s).
\end{equation}


\begin{definition}\guid{RIUGHVX} 
An \newterm{augmented  constraint system} is
a stable or tri-stable constraint system $s$ together with subsets of $I(s)$:
$I_{lo}$, and $I_{str}$, and constants $\alpha_{ij},\beta_{ij}\in \ring{R}$, for
$\{i,j\}\subset I(s)$ such that the following conditions hold.
\begin{enumerate}
\item $d(s) \le 0.9$.
\item  $m+k(s)\le 6$, where 
$m$ is the number of edges $\{i,j\}\subset I(s)$ such that
$b_{i j}(s)> 2h_0$ or $a_{i j}(s)>2$. 
\item $a_{ij}\le\alpha_{ij}\le \beta_{ij}\le b_{ij}$. 
\end{enumerate}
\end{definition}

\begin{example}\label{ex:extend-cs}
Each stable or tri-stable constraint system for which the first two conditions
hold may be extended to an augmented constraint system with
$I_{lo}=I_{str}=\emptyset$, $\alpha_{ij}(s)=a_{ij}(s)$,
$\beta_{ij}(s)=b_{ij}(s)$. 
\end{example}

If $s$ is an augmented constraint system,
there is an associated constraint system that forgets the components
$I_{lo}$, $I_{str}$, $\alpha_{ij}$, and $\beta_{ij}$. In this case, we
let $\BB_s$ be the set previously defined for the underlying stable or
tri-stable constraint system. We also let $\tau^*(s,\wild)$ be the
previously defined function on the underlying constraint system. In
the tri-stable case, we do not insist on local fans, but allow
simplices that may degenerate to planar configurations. By the
constraint $b_{ij}(s)<4$, we have well-defined dihedral angles, so
that $\tau^*(s,\wild)$ is defined.


%\begin{definition}  Let $\sigma$ be an augmented constraint system, with
%associated unaugmented constraint system $s'$.
%We have defined $\BB_{s'}$. Let $\BB_{s}$ be the subset of all  $\v\in\BB_{s'}$ such that
%\begin{enumerate}
%\item If $i\in I_{str}$,  then $\v_i$ is straight.
%\item If $i\in I_{lo}$,  then $\normo{\v_i}=2$.
%\item If $i\in I_{hi}$,  then $\normo{\v_i}=2h_0$.
%\end{enumerate}
%\end{definition}




\begin{lemma}\guid{PCRTTID} \label{lemma:aug-compact}
Let $s$ be an augmented constraint system. Then
$\BB_s$ is compact (as a subset of
$\BB^k \subset \ring{R}^{3k}$).
\end{lemma}

\begin{proof}  This holds when $s$ is a stable or tri-stable constraint
system.
\end{proof}


\begin{lemma}[continuity]\guid{HDPLYGYv2}\label{lemma:compact-fan}
Let $s$ be an augmented constraint system.  Then the function 
\[
\v\mapsto \tau^*(s,\v)
\]
is a continuous function on $\BB_s$.  Moreover, if $\BB_s$ is
nonempty, then the function attains a minimum.
\end{lemma}

\begin{proof} This follows easily from Lemma~\ref{lemma:compact-fan} and
Lemma~\ref{lemma:aug-compact}.
\end{proof}

\begin{lemma}\guid{JKQEWGV}\label{lemma:not-circular}
Let $s$ be an augmented constraint system.  Let $\v\in \BB_s$.
Suppose that
\[
\sol(V_\v,E_\v,F_\v) \ge \pi.
\]
Then $\tau^*(s,\v)>0$.
In particular, if 
$\tau^*(s,\v)\le0$, then the azimuth angle of some dart of
$(V_\v,E_\v,F_\v)$ is 
less than $\pi$.  In particular, in this case, the local fan is not circular.
\end{lemma}

\begin{proof} By the definition of augmented constraint system,
we have $d(s)\le 0.9$. The proof of Lemma~\ref{lemma:09} extends readily
to this context.
\end{proof}

A \newterm{diagonal} of a constraint system $s$ is a pair $\{p,q\}\subset I(s)$
such that $\{p,q\}$ is not a singleton and does not have the form $\{i,i+1\}$.



Departing from the presentation of Section~\ref{sec:weight}, we do not
use level functions and minimal counterexamples.  Rather, we proceed
as follows.


\begin{definition}[index,~$\iota$,~$\MM_s$]\guid{FNUEPJW}
Let $s$ be an augmented constraint system.
Let $\MM_{s}\subset \BB_{s}$ be defined as follows.
Let $\BB'_{s}$ be the set of all $\v\in \BB_{s}$ such that
\begin{enumerate}
\item $\tau^*(s,\v)$ is equal to the minimum of $\tau^*(s,\wild)$ over $\BB_{s}$.
\item $\tau^*(s,\v)\le 0$.
\end{enumerate}
Define the \newterm{index} of $\v\in \BB_s$ to be the number of edges of $\v$
that attain its minimum bound $a_{i j}(s)$.  Let $\iota(s)$ be the minimum
of the index of $\v$ as $\v$ runs over $\BB'_s$.  
We let $\BB''_{s}$  be the set of $\v\in \BB'_{s}$ that attain
the smallest possible index $\iota(s)$,
and let $\MM_s$ be the subset of all $\w\in\BB''_s$ satisfying the additional
constraints.
\begin{enumerate}
\item If $i\in I_{str}$,  then $\v_i$ is straight.
\item If $i\in I_{lo}$,  then $\normo{\v_i}=2$.
%\item If $i\in I_{hi}$,  then $\normo{\v_i}=2h_0$.
\item $\alpha_{ij}(s)\le \norm{\w_i}{\w_j}\le \beta_{ij}(s)$ for all $i,j$.
\end{enumerate}
\end{definition}

%(Obviously, if $I_{hi}\cap I_{lo}\ne \emptyset$, then $\MM_s=\emptyset$.)


\begin{definition}[$S_{init}$] \guid{BTKIQGE}
For each of the cases of Theorem~\ref{lemma:empty-d} and \ref{lemma:tau3}, we fix a
stable constraint system that encodes its parameters, as described in Example~\ref{ex:main}. 
We extend each $s$ to an augmented constraint system
as in Example~\ref{ex:extend-cs}.
Let $S_{init}$ be this set of  augmented constraint systems.
\end{definition}

We have the following analogue of Lemma~\ref{lemma:esm}.

\begin{lemma}\guid{AYQJTMD}\label{lemma:init}
Let $s\in S_{init}$ be such that
\eqref{eqn:main:sv} fails to hold.
Then $\MM_s$ is nonempty.
\end{lemma}

\begin{proof}  Assume that \eqref{eqn:main:sv} fails to hold for
$s$.  By compactness and continuity, the set 
$\BB'_s$ of minimizers is nonempty.   
The subset $\BB''_s$ on which the index is as small as possible
is then also nonempty.  By our conventions in extending a constraint
system to an augmented constraint system, $\BB''_s = \MM_s$.
\end{proof}

Lemma~\ref{lemma:min-crit} is not used directly in this supplement.
Instead, the criteria of the lemma will be presented somewhat differently
in the treatment that follows.
We have the following variant of Lemma~\ref{lemma:odx}.
It is not necessary to formalize that lemma.  We use this instead.

\begin{lemma}\guid{ODXLSTCv2}\label{lemma:odx2} 
Let $s$ be an augmented constraint system,
and assume that $\w\in \MM_s$.  Let $i\in I(s)$.
Assume  that $\w_i$ is not the pole of a lunar local fan $(V_\w,E_\w,F_\w)$.
Assume that $4h_0 < b_{iq}(s)$ for every diagonal $\{i,q\}$ at $i$.
Then one of the following   constraints hold.
\begin{enumerate}
\item $\norm{\w_i}{\w_j}$ attains its lower bound $a_{i j}(s)$, for
  some $j\ne i$.
\item $\normo{\w_i}$ attains its lower bound $2$.
\item There exists $j$ adjacent to $i$ such that $\{i,j\}\in J(s)$.
\end{enumerate}
\end{lemma}

\begin{proof} 
We assume that the constraint on $J$ does not hold and
that $a_{p q}(s)<\norm{\v_p}{\v_q}$ for all diagonals, then continue as in the proof of
Lemma~\ref{lemma:odx}.  
By Lemma~\ref{lemma:not-circular}, we may assume  
that one of the following hold of the local fan $(V_\w,E_\w,F_\w)$.
\begin{enumerate}
\item The local fan is generic.
\item The local fan is lunar, the pole has azimuth
angle less than $\pi$, and $\w_i$ is not a pole.  
\end{enumerate}
The constraints on generic and local fans
allow us to use Lemmas~\ref{lemma:fan-open-lunar} and
\ref{lemma:fan-open-generic}, showing that fan conditions are preserved.
\end{proof}





We have the following variant of Lemma~\ref{lemma:imj}.
It is not necessary to formalize that lemma.  We use this instead.

\begin{lemma}\guid{IMJXPHRv2}\label{lemma:imj2}
Let $s$ be an augmented constraint system.  Assume $i\in I_{str}(s)$ and
that $\w\in \MM_s$.  
Assume  that $\w_i$ is not the pole of a lunar local fan $(V_\w,E_\w,F_\w)$.
Assume that $4h_0 < b_{iq}(s)$ for every diagonal $\{i,q\}$ at $i$.
Then one of the following conditions holds.
\begin{enumerate}
\item $\norm{\w_i}{\w_{i+1}}$ attains its lower bound $a_{i,i+1}(s)$, and
 $\norm{\w_i}{\w_{i-1}}$ attains its lower bound $a_{i,i-1}(s)$.
\item $\normo{\w_i}$ attains its lower bound $2$.
\item There exists $j$ adjacent to $i$ such that $\{i,j\}\in J(s)$.
\item Some diagonal $\{i,q\}\subset I(s)$ at $i$ satisfies
$\norm{\w_i}{\w_q}=a_{i q}(s)$.
\end{enumerate}
\end{lemma}

\begin{proof} We assume that the constaint on $J$ does not hold and
that $a_{p q}(s)<\norm{\v_p}{\v_q}$ for all diagonals, then continue as in the proof of
Lemma~\ref{lemma:imj}.
By Lemma~\ref{lemma:not-circular}, we may assume that one of the
following
conditions hold.
\begin{enumerate}
\item The local fan is generic, or
\item The local fan is lunar, the pole has azimuth
angle less than $\pi$, and $\w_i$ is not a pole.  
\end{enumerate}
The constraints on generic and local fans
allow us to use Lemmas~\ref{lemma:fan-open-lunar} and
\ref{lemma:fan-open-generic}, showing that fan conditions are preserved.
\end{proof}

We have the following variant of Lemma~\ref{lemma:nux}.
It is not necessary to formalize that lemma.  We use this instead.

\begin{lemma}\guid{NUXCOEAv2}\label{lemma:nux2}
Let $s$ be an augmented constraint system.  Assume $i\in I_{str}(s)$
and that $\w\in \MM_s$.   
Assume that $\norm{\w_i}{\w_j}=a_{ij}(s)$ for
some $j$ is adjacent to $i$.  
Assume  that $\w_i$ is not the pole of a lunar local fan $(V_\w,E_\w,F_\w)$.
Assume that $4h_0 < b_{iq}(s)$ for every diagonal $\{i,q\}$ at $i$.
Then
one of the following conditions holds.
\begin{enumerate}
\item If $\ell\in I(s)$ is adjacent to $i$, then $\norm{\w_i}{\w_\ell}=a_{ik}(s)$
(for both choices of $\ell$ adjacent to $i$).
\item There exists $j$ adjacent to $i$ such that $\{i,j\}\in J(s)$.
\item Some diagonal $\{i,q\}\subset I(s)$ at $i$ satisfies
$\norm{\w_i}{\w_q}=a_{i q}(s)$.
\end{enumerate}
\end{lemma}

\begin{proof} 
Let $s$ and $\w$ be as given.  The lemma is a special
case of the previous lemma, unless $\normo{\w_i}=2$, which we assume.
Let $\ell\ne j$ be the other index adjacent to $i$.
Assume that the final
two conditions do not hold.
Assume for a contradiction that 
\[
\norm{\w_i}{\w_\ell}>a_{i \ell}(s)
\]
We consider a curve $\v$ of the form \eqref{eqn:move1} that moves $\v_i$
in a circular arc with center $\orz$ through the point $\w_i$ and in
the fixed plane determined by $\{\orz,\w_i,\w_j,\w_{\ell}\}$.  
The function $\tau^*(s,\wild)$ is
constant along this curve.  We orient the curve to be increasing
in $\norm{\w_i}{\w_{j}}$.  For sufficiently, small $t$, we find that
$\v(t)\in\BB'_s$ has smaller index than $\w$.  This is contrary to the minimizing
properties of $\w\in\MM_s$.

As in the proofs of the previous lemmas, the constraints on generic and local fans
allow us to use Lemmas~\ref{lemma:fan-open-lunar} and
\ref{lemma:fan-open-generic}, showing that fan conditions are preserved.
\end{proof}

In the preceding three lemmas, we specifically allow the deformations
$\v(t)$ to occur within a lunar fan, moving a single node that is not a pole
of the lunar fan, as given by Lemma~\ref{lemma:fan-open-lunar}.
We are now ready to eliminate  lunar and circular
fans.

\begin{lemma}\guid{BJOQBJU}\label{lemma:bjo} 
Let $s$ be an augmented constraint system.
Assume that $k(s)>3$.
If $k(s)=6$, then assume additionally that
$\stab\le a_{pq}(s)$, for every diagonal $\{p,q\}\subset I(s)$.
Then for every  $\w\in\MM_s$,  the local fan $(V_\w,E_\w,F_\w)$ is generic.
\end{lemma}

\begin{proof}
By the definition of augmented constraint system, $4\le k(s)$ implies
that $s$ is stable, so that for every edge $\{i,j\}\in I$, we have
$b_{i j}(s) \le\stab$.

Let $w\in \MM_s$.  By Lemma~\ref{lemma:09}, the local fan of $\w$  is not circular.
To show that the local fan is generic, it is enough to show that it is not lunar.
We assume for a contradiction that $\{\v_i,\v_j\}$ is the pole of a lunar fan.

We first treat the case  $4\le k(s)\le 5$,
and afterward we will return to the case $k(s)=6$. 
Assuming that  $k(s)\le 5$, the indices $i,j$ differ by at most two.
Also, the assumptions give $m\le 6-k(s)\le 2$, so there is a path from
$i$ to $j$ involving at most one edge with $b_{i j}(s)>2h_0$.
Then by the spherical triangle inequality (Lemma~\ref{lemma:sph-tri-ineq}),
\begin{equation}\label{eqn:pole}
\op{arc}_V(\orz,\v_i,\v_j) \le \op{arc}(2,2,2h_0) + \op{arc}(2,2,\stab) < \pi,
\end{equation}
showing that $\{\v_i,\v_j\}$ is not parallel and not a pole.

Now consider the case $k(s)=6$.  Here, $m=0$, so that $b_{\ell,\ell+1}(s)\le 2h_0$
and $a_{\ell,\ell+1}(s)=2$
for every edge. Equation~\ref{eqn:pole} shows that the indices $i$ and $j$
must be opposite in the hexagon: $j = i+3$.  By the structure of lunar fans
(Lemma~\ref{lemma:lunar}), $\w_\ell$ is straight for $\ell\ne i,j$.  Without
loss of generality, we may
pass to a stricter augmented constraint system $s'$ such that
$\ell\in I_{str}(s')$, for $\ell\ne i,j$.  We then have $\w\in \MM_{s'}$.

Recall that $i$ is fixed at a pole. 
\claim{We claim that for any edge $\{i,\ell\}$, 
 if  $\norm{\w_{\ell}}{\w_i}>a_{ik}(s)=2$, then
$\normo{\w_\ell}=2$.}  Indeed, this follows directly from the preceding deformation
lemmas.  Thus, the tetrahedron with extreme points
$\{\orz,\w_{i-1},\w_i,\w_{i+1}\}$ has two edges
of length $2$ and a diagonal $\{\w_{i-1},\w_{i+1}\}$ of length at least
$\stab$, by hypothesis.  By a \cc{1117202051~4559601669}{}, 
the azimuth angle at the pole $i$ is at least $\pi/2$.
Hence the solid angle of the lune is at least $\pi$.  By Lemma~\ref{lemma:09},
we have $\tau^*(s',\w)>0$, which contradicts $\w\in \MM_{s'}$.
\end{proof}



\subsection{operations}

This section describes some operations on augmented constraint
systems.

\begin{definition}[restriction]\guid{PFEOBSC}
Let $s$ be an augmented constraint system.
We say that $s'$ is a restriction of $s$ if there are sets $A$, $B$ of
edges such that
\[
a_{ij}(s') = 
\begin{cases}
 \alpha_{ij}(s) & \{i,j\}\in A,\\
  a_{ij}(s) & \text{otherwise}
  \end{cases}
  \qquad\qquad
b_{ij}(s') = 
\begin{cases} \beta_{ij}(s) & \{i,j\}\in B,\\
  b_{ij}(s) & \text{otherwise}
\end{cases}
\]
and all other parameters $I_{lo}$, $I_{str}$, $J$, $\alpha$, $\beta$
are
the same for $s$ and $s'$.
\end{definition}


\begin{definition}[subdivision]\guid{YYKMEWW} 
Let $s$ be an augmented constraint system,
and let $i,j\in  I(s)$, with $i\ne j$.  Select $c$ such that $a_{ij}(s)\le c\le b_{ij}(s)$.
The subdivision of $s$ is the pair $\{s_1,s_2\}$ 
of augmented constraint systems, where all the parameters for $s_1$ and $s_2$
are the same as those of $s$, except that
\[
a_{ij}(s_1)=a_{ji}(s_1) = c, \text{ and } b_{ij}(s_2) = b_{ji}(s_2)=c.
\]
and
\[
\leftclosed\alpha_{ij}(s_\ell),\beta_{ij}(s_\ell)\rightclosed =
\leftclosed\alpha_{ij}(s),\beta_{ij}(s)\rightclosed\cap
\leftclosed a_{ij}(s_\ell),b_{ij}(s_\ell)\rightclosed.
\]
\end{definition}
The subdivision thus corresponds to splitting an interval 
$\leftclosed a_{ij},b_{ij}\rightclosed$ into
\[
\leftclosed a_{ij},c\rightclosed \cup \leftclosed c,b_{ij}\rightclosed.
\]

\begin{definition}[attribute free]\guid{SDJTENL}
An augmented constraint system $s$ is \newterm{attribute-free}, if
$I_{str}(s)=I_{lo}(s)=\emptyset$, as well as
$a_{ij}(s)=\alpha_{ij}(s)$ and $b_{ij}(s)=\beta_{ij}(s)$ for all
$i,j$.
\end{definition}


\begin{definition}\guid{LCTBALA}  
We say that an augmented constraint system $s$
\newterm{transfers} to an augmented constraint system $s'$ if
\begin{enumerate}
\item If $s$ is an ear, then $s=s'$.
\item $s'$ is attribute free.
\item $I(s) = I(s')$.
\item $d(s)\le d(s')$.
\item For all $i,j$, we have $a_{ij}(s')\le a_{ij}(s)\le b_{ij}(s)\le b_{ij}(s')$.
\item $J(s')\subset J(s)$.
\item $I_{str}(s')\subset I_{str}(s)$  and
$I_{lo}(s')\subset I_{lo}(s)$.
\end{enumerate}
\end{definition}


\begin{definition}\guid{TEQQCLX}
 The \newterm{opposite} $I'$ of a torsor $I$ is the torsor with the
same underlying set and the action is composed with the group automorphism
$\ring{Z}/k\ring{Z}\to\ring{Z}/k\ring{Z}$, sending $i\mapsto -i$.
Two torsors are \newterm{equivalent} if they are isomorphic or if 
one is isomorphic to the opposite of the other.
\end{definition}

If $s$ is an augmented constraint system with torsor $I(s)$, and if
$I'$ is any equivalent torsor, then we can use the bijection between $I(s)$ and $I'$
to obtain an augmented constraint system $s'$ with $I' = I(s')$.  An
augmented constraint system $s'$ related in this way to $s$ is said
to be \newterm{equivalent} to $s$.  An \newterm{equi-transfer} of $s$
to $s'$ is a transfer from $s$ to an augmented constraint system that
is equivalent to $s'$.


\begin{definition}[slice]\guid{CJMHFAT}
 Let $s$ be an augmented constraint system and let $p,q\in I(s)$ where $p$ and
  $q$ are not adjacent.  (In particular, $k(s)=\card(I(s))>3$, and $s$ is stable.)  We
  say that a pair $\{s',s''\}$ of augmented constraint systems is an
\newterm{slice} of  the
  diagonal $\{p,q\}$ of $s$, if the following conditions hold.
\begin{enumerate}
\item $\{s',s''\}$ covers the diagonal $\{p,q\}$ of $s$ in the sense of unaugmented
constraint systems.  In fact, we use the stricter condition
\[
a_{p q}(s)=a_{p q}(t), \text{ and } b _{p q}(s) = b_{p q}(t),
\]
for all $t\in \{s',s''\}$.
\item
\[
\alpha_{i j}(t) = a_{i j}(t), \text{ and } \beta_{i j}(t) = b_{i j}(t),
\]
for all $t\in\{s',s''\}$ and all $i,j\in I(s)$.
%\item For $t=s',s''$,
%\[
%b_{pq}(s) \in \leftclosed a_{pq}(t),b_{pq}(t)\rightclosed.
%\]
%%!! Removed b_{pq}(s) in cover def on Jan 23, 2012. Restored here!
%% XX May 17, 2012 restored there.
\item
$I_{lo}(t)=I_{str}(t)=\emptyset$ for all  $t\in \{s',s''\}$.
\end{enumerate}
\end{definition}



The word
{\it slice} is used for related operations on the indexing set, the
local fan, and the augmented constraint system.
A slice of an augmented constraint system is used in parallel with the
slice a fan of cardinality $k$ into two smaller fans with
cardinalities $k(s')$ and $k(s'')$.  All of the edge length
constraints are to be preserved under slicing.
Note that the data $\alpha_{ij}$, $\beta_{ij}$, $I_{lo}$, $I_{str}$
for $s'$ and $s''$ have been {\it reset} to default values. 

If $\{s',s''\}$ is an slice of a diagonal $\{p,q\}$, then we can use the inclusions $I(s')\subset I(s)$ and $I(s'')\subset I(s)$ to restrict an element $\v:I(s)\to\BB$ to $\v':I(s')\to \BB$ and $\v'':I(s'')\to \BB$.  The inequality $d(s)\le d(s') + d(s'')$ of a covered diagonal implies a related inequality.

\begin{lemma}\guid{QKNVMLB}\label{lemma:cover2}
Let $s$ be an augmented constraint system with diagonal $\{p,q\}$ and slice
 $\{s',s''\}$. 
Let $\v\in \BB_s$ and let $\v'$ and $\v''$ be constructed from $\v$ as above.
Then  $\v'\in \BB_{s'}$ and $\v''\in \BB_{s''}$.
Moreover,
\begin{equation}
d(s,\v) \le d(s',\v') + d(s'',\v'')
\end{equation}
and
\begin{equation}
\tau^*(s,\v)\ge \tau^*(s,\v')+\tau^*(s,\v'').
\end{equation}
\end{lemma}

\begin{proof} See Lemma~\ref{lemma:cover}.
\end{proof}

\subsection{propagation}

The proof of the main lemma consists in showing that the nonemptiness
of $\MM_s$ propagates in an orderly way under the operations of
restriction, slicing, equi-transfer, and subdivision.

\begin{definition}[$\ra$~$\Ra$] \guid{AZGJNZO}
Let $\op{ACS}$ be the set of augmented constraint systems
and let $P(\op{ACS})$ be the set of finite subsets of $\op{ACS}$. 
 We define a relation $(\ra)$ on $\op{ACS}\times P(\op{ACS})$.
We write $s\ra T$ if the following condition holds.
\begin{enumerate}
%\item $k=1$ and $s$ transfers to an augmented constraint system equivalent to $s_1$.
%\item $k=2$ and $\{s_1,s_2\}$ is an slice along some diagonal of $s$.
%\item $k=2$ and $\{s_1,s_2\}$ is a subdivision of $s$.
\item If $\MM_s\ne\emptyset$, then 
$\MM_t\ne\emptyset$ for some $t\in T$.
\end{enumerate}
We define a binary relation $(\Ra)$ on $P(S)$ by
$S_1\Ra S_2$ if for every $s\in S_1$, we have $s\ra S_2$.
%$s\ra S''$.  We define a binary relation $\Ra^*$ on $P(S)$ as the reflexive
%transitive closure of $\Ra$.
\end{definition}

\begin{lemma}\guid{FZIOTEF}
The relation $(\Ra)$  is reflexive and transitive.
\end{lemma}

\begin{proof}  Clearly, $s\ra \{s\}$, and this implies reflexivity.
Transitivity is a simple matter.  Assume
$S_1\Ra S_2$ and $S_2\Ra S_3$.  Select any $s_1\in S_1$, then select
$s_2\in S_2$ such that $s_1\ra \{s_2\}$, and $s_3\in S_3$ such
that $s_2\ra \{s_3\}$.  Then $s_1\ra\{s_3\}$.  So $S_1\Ra S_3$.
\end{proof}

\begin{lemma}\guid{IEWZAVH}\label{lemma:propagate}
Let $S$  and $T$ be finite sets of augmented constraint systems such that
$S\Ra T$.  Assume that $\MM_s\ne\emptyset$ for some $s\in S$.
Then $\MM_t\ne\emptyset$ for some $t\in T$.
\end{lemma}

\begin{proof} This follows directly from the definitions. 
\end{proof}

\begin{example}[restriction]\guid{EQTTNZI}
If $t$ is a restriction of $s$, then $\BB_t\subset \BB_s$.
A global minimizer over all of $\BB_s$ satisfying constraints $s$ is
a global minimizer over the subset $\BB_t$ and satisfies the
constraints $t$.  Hence $s\ra\{t\}$.
\end{example}

\begin{example}[subdivision]\guid{UAGHHBM}
Let $\{s_1,s_2\}$ be a subdivision of $s$.  We have $\BB_s =
\BB_{s_1}\cup \BB_{s_2}$.  A global minimizer in $\MM_s$ lies in
either $\BB_{s_1}$ or $\BB_{s_2}$.  Hence $s\ra\{s_1,s_2\}$.
\end{example}

\begin{example}[transfer, equi-transfer]\guid{YXIONXL}  Let $t$ be a transfer of
an augmented constraint system $s$.  Assume that $\MM_s\ne\emptyset$.
Let $\w\in \MM_s$.
We have $w\in \BB_s\subset\BB_t$, and $\d(t,\w) \ge d(s,\w)$,
as well as $\tau^*(t,\w)\le\tau^*(t,\w)\le 0$.   By compactness, there
exists a global minimizer,
$\v\in\BB''_t\ne\emptyset$.  It satisfies
$\tau^*(t,\v)\le\tau^*(t,\w)\le 0$.  By the definition of transfer,
$t$
is attribute free, so that $\BB''_t=\MM_t$.  (Note that $\MM_s$ and
$\MM_t$
might be disjoint.)  This shows that
$\MM_t\ne\emptyset$.
Hence $s\ra\{t\}$.  Similarly, if $t$ is an equi-transfer of $s$,
then we again have $s\ra\{t\}$.
\end{example}

\begin{example}[slice]\guid{LKGRQUI}  Let $\{s',s''\}$ be a slice of
an augmented constraint system $s$ along
a diagonal $\{p,q\}$.  Assume that $\w\in\MM_s$.
Let $\w'\in \BB_{s'}$ and $\w''\in \BB_{s''}$ be obtained
by restriction of parameters.  From Lemma~\ref{lemma:cover2},
we have $\tau^*(s',\w')\le 0$ or $\tau^*(s'',\w'')\le0$.  To be
concrete, say $\tau^*(s',\w')\le 0$.  The global minimizer
$\v'\in\BB_{s'}$
then also satisfies $\tau^*(s',\v')\le 0$.  By the definition of
slice, $s'$ is attribute free, so that $\BB''_{s'}=\MM_{s'}$ and
$\v'\in \MM_{s'}$.  Hence $s\ra\{s',s''\}$.
\end{example}

\begin{remark}[non-generic fans]\guid{KEOMGHK}
We have seen that a set $\MM_s$ does not contain any circular fans.
Assume that $\MM_s$ contains a lunar fan.
By a process of subdivision and Lemma~\ref{lemma:bjo}, we may assume
that it has some diagonal $\norm{\w_i}{\w_j}\le\stab$.  By slicing
along
the diagonal $\{i,j\}$, we obtain $\{s_1,s_2\}$ that are generic, with
$s\ra\{s_1,s_2\}$.  In this way, we may easily dispose of non-generic
fans.  I what follows, we may assume that every member of $\MM_s$ is
generic.
\end{remark}

The deformation lemmas can be expresed relational
arrows $s\ra T$.  The following example shows how this goes
for the first deformation lemma, Lemma~\ref{lemma:odx2}.  
In the example, we assume
that the members of $\MM_s$ are generic, to avoid the assumption
on poles of lunar fans in the lemma.

\begin{example}[deformation] \guid{KESHTYS} 
Let $s$ be an augmented constraint
  system, with $\MM_s\ne\emptyset$.  Let $i\in I(s)$.
Assume that for both $j$ adjacent to $i$, we have $\{i,j\}\not\in
J(s)$.
Assume further that $4h_0 < b_{iq}(s)$ for every diagonal $\{i,q\}$ at
$i$.  Let $s'$ be an augmented constraint system with all parameters
the same as $s$, except that $I_{lo}(s') = \{i\}\cup I_{lo}(s)$.
Keeping $i$ fixed, we
let $D=D_i\subset I(s)$ be the set of $j\ne i$ such that 
$\alpha_{ij}(s)=a_{ij}(s)$. 
Let $S_1$ be the set of augmented constraint systems indexed by $j\in
D$,
obtained by
modifying $s$, setting $\beta_{ij}(s)=a_{ij}(s)$, with other
parameters unchanged.

We claim that there is an arrow $s\ra \{s'\}\cup S_1$.  Indeed, let
$\w\in \MM_s$.  For it to be minimal, there must be a constraint
that blocks the  deformation described in the proof of
Lemma~\ref{lemma:odx2}.
According to the lemma, this forces $\normo{\w_i}=2$ or
$\norm{\w_i}{\w_j}=a_{ij}(s)$ for some $j\ne i$.  This latter
condition
is incompatible with $\w\in \MM_s$, unless $j\in D$.  The result
follows.
\end{example}


In a similar way, the deformations of Lemmas~\ref{lemma:imj2} and \ref{lemma:nux2} and
the lateral deformations (Remark~\ref{rem:contract}) give arrows
\[
s\ra S.
\]

We have specified a set $S_{init}$ of initial augmented constraints systems.
We specify a second set $S_{term}=\{s_{(6)},s_{(5)},\ldots\}$ 
of terminal augmented constraint systems, where
 $s_{(k)}$, for $k=5,6$,  are given by
\[
I=\ring{Z}/k\ring{Z}, J=I_{lo}=I_{str}=\emptyset, d(s_{(5)})=0.616, d(s_{(6)})=0.712,
\]
and $a_{ij}=b_{ij}=2$ for all edges, 
and $a_{ij}=\stab$, $b_{ij}=6$ for all diagonals.

We do not list all of the elements of $S_{term}$.  There are about twenty
elements of $S_{term}$ with $k=3$ and four elements with $k=4$.  The elements
$s_{(5)}$ and $s_{(6)}$ are the only two with $k\ge 5$.
They are list explicitly
in the computer code (\verb!check_completeness.hl!).



\begin{remark}[Proof outline of main estimate]
The verification of 
Theorem~\ref{lemma:empty-d} and \ref{lemma:tau3} can now be
carried out as follows.  We assume for a contradiction that
one of the cases of these theorems is false.  By Lemma~\ref{lemma:init}, we have
$\MM_s\ne\emptyset$ for some $s\in S_{init}$.  

We prove by computer search
 that 
\begin{equation}\label{eqn:init-term}
S_{init}\Ra S_{term}.
\end{equation}
   By the definition of this
relation in terms of minimization problems over the compact sets
$\BB_s$,
it appears that some analysis might be required in the proof
of \eqref{eqn:init-term}.  However, this is not the case.  The
preceding
examples show how to construct many relational arrows $S_1\Ra S_2$
from equi-transfer, subdivision, slicing, and deformation.
We know that the relation is symmetric and transitive.   The computer
program makes a purely combinatorial search for the arrow
\eqref{eqn:init-term}
as a transitive composition of equi-transfers, subdivisions, slices,
and
deformations.  Hence no further nonlinear optimization is required
beyond
what has already been presented in this text.

There is a trivial amount of real arithmetic in the code that comes
from the triangle inequality.   (If
the constraints $\alpha_{ij},\beta_{ij}$ are such that the triangle
inequality cannot hold, we can conclude that $\MM_s=\emptyset$.)
Similarly, we use the spherical triangle inequality and the inequality
$\Delta\ge0$ in a few places to conlude that $\MM_s=\emptyset$.
But we insist that the proof of \eqref{eqn:init-term} is essentially
a combinatorial search.  The computer code makes no reference
to local fans, working consistently at the level of abstraction of augmented
constraint
systems.


By Lemma~\ref{lemma:propagate}, and \eqref{eqn:init-term}, we have
$\MM_s\ne\emptyset$ for some $s\in S_{term}$.  When $s\in S_{term}$
with $k(s)\le 4$, by a \cc{various inequalities}{}, we show
that $\tau^*(s,\v) >0$ for all $\v\in \BB_s$.  This implies for such $s$
that $\MM_s=\emptyset$.  The two cases $s_{(5)}$ and $s_{(6)}$ remain.
They are treated in Secton~\ref{sec:computer-main}, where it is shown
that $\MM_s=\emptyset$ for $ s=s_{(5)}$ and $s_{(6)}$.  This
contradiction shows that $\MM_s=\emptyset$ for all $s\in S_{init}$,
so that $\tau^*(s,\v)>0$.  This proves the main estimate.

We remark that the verifications of  different cases in $S_{init}$ become
highly intertwined through the relation $(\Ra)$.  Each augmented
constraint
system in $S_{term}$ contributes to the proof of many different cases
of the main estimate.
\end{remark}