% ------------------------------------------------------------ 
% Author:
% Thomas C. Hales 
% Format: LaTeX Book Chapter: Dense Sphere Packings
% ------------------------------------------------------------

\chapter{Further Results}\label{sec:further}


The same methods that have been used to prove the Kepler conjecture
can be used to prove some other longstanding conjectures in discrete
geometry.  This chapter gives proofs of the strong dodecahedral
conjecture and Fejes T\'oth's full contact conjecture.

Earlier chapters are written in a formal blueprint style.
Complete proofs are provided, even for statements that might be
viewed as geometrically obvious.  In this chapter, we relax our
standards of proof just a bit.  What we write is still a proof by
traditional mathematical standards, but not as detailed as earlier
chapters.

\section{Strong Dodecahedral Theorem}

Bezdek has conjectured that the Voronoi cell of smallest surface is
the regular dodecahedron with inradius $1$.  This is known as the
\newterm{strong dodecahedral conjecture}~\cite{Bezdek00}, \cite{Bezdek05}.  
%
\indy{Index}{Bezdek, K.}%
\indy{Index}{Voronoi cell}%


\begin{theorem}[strong dodecahedral conjecture]\guid{HKJSPQG}
  The surface area of a Voronoi cell in a packing is at least the
  surface area of the regular dodecahedron with inradius $1$.
\end{theorem}
\indy{Index}{dodecahedral conjecture}
\indy{Index}{dodecahedral conjecture!strong}

This section gives a proof of this theorem.  We
begin with some simple observations.

\begin{remark}
  If a packing is  saturated, then the surface area of a Voronoi
  cell is finite.  \claim{We may assume without loss of 
    generality that the packing is saturated.}
  Indeed, consider a new facet $F$ that is created on a Voronoi cell
  by the addition of a new point to the packing $V$.  Let $X$ be the
  polygonal boundary of the new facet.  The area minimizing surface
  that has $X$ as a boundary is the facet $F$.  Thus the new facet
  replaces a surface of larger area with a surface of smaller area.
  That is, by saturating a packing, the surface area of a Voronoi cell
  can only decrease.
\end{remark}

\begin{remark}
As in the proof of the Kepler conjecture, the truncation of a Voronoi cell is easier
to study than the Voronoi cell itself.  In order to obtain sharp bounds, the truncation
must have no effect on the optimal Voronoi cell.  This constraint forces the
 truncation parameter to be at least
the circumradius $\sqrt{3}\tan{\pi/5}\approx 1.258$ of the regular dodecahedron.   The truncation parameter $\sqrt{2}$
that we use in the proof of the Kepler conjecture satisfies this constraint and is
therefore  well-suited for the strong dodecahedral
conjecture.
\end{remark}

\begin{lemma}[]\guid{JXVEXYV}  % X->Y
  The surface area of the Voronoi cell $\Omega(V, \u_0)$ is at least
  that of $\Omega(V, \u_0)\cap B(r_0)$, where $B(r_0)$ is the ball of radius
  $r_0$ centered at $ \u_0$.  
\end{lemma}
\indy{Index}{surface area}%
\indy{Index}{Dodecahedral Conjecture}%

\begin{proof} The surface element for a parameterized surface
  $r(\theta,\phi)$ in spherical coordinates is
\[
  % ff = {r[theta, phi] Cos[theta]Sin[phi], r[theta, phi]
  %   Sin[theta]Sin[phi], r[theta, phi] Cos[phi]}; n = Cross[D[ff,
  % theta], D[ff, phi]]; n.n // Simplify
%
  r \sqrt{r_\theta^2 + (r^2 + r_\phi^2)\sin^2\phi } \,\,d\theta\,d\phi,
\]
which is at least the surface element $r_0^2 \sin\phi\, d\theta\,d\phi$
of a sphere of radius $r_0$, provided
$r(\theta,\phi)\ge r_0$.   Hence, projection of a surface outside
sphere onto the sphere is area decreasing.
\end{proof}


Fejes T\'oth's classical dodecahedral conjecture is the corresponding conjecture
about volumes rather than surface areas, asserting that  the
Voronoi cell of smallest volume is the regular dodecahedron of
inradius $1$.  \indy{Index}{fejestoth@Fejes T\'oth, L.}%
\indy{Index}{Dodecahedral Conjecture}%
The strong dodecahedral conjecture yields the dodecahedral conjecture
as a corollary.

\begin{lemma}[]\guid{QRBKJAW}
  If the surface area of a Voronoi cell is at least the surface area
  of a regular dodecahedron with inradius $1$, then its volume is also
   at least that  of a regular dodecahedron.
\end{lemma}

\begin{proof} Let $A_1,\ldots,A_n$ be the areas of the facets of a
  Voronoi cell.  Let $h_1,\ldots,h_n$ be the distances from the affine
  hulls of the facets to the center of the Voronoi cell.  Then $h_i\ge
  1$.  Assume that $\sum A_i \ge A_D$, where $A_D$ is the surface area
  of a regular dodecahedron.  Then its volume is
\[
\op{vol} = \sum A_i h_i/3 \ge \sum A_i/3 \ge A_D/3 = \op{vol}_D,
\]
where $\op{vol}_D$ is the volume of the regular dodecahedron.
\end{proof}
\indy{Index}{regular dodecahedron!volume}%
\indy{Notation}{A@$A$ (Voronoi cell face area)}%
\indy{Notation}{V@$\op{vol}_D$ (volume of dodecahedron)}%


\subsection{$D$-cells}



The notation follows Section~\ref{sec:rogers}.  Let $V$ be a saturated
packing. If $\bu =[\u_0;\u_1;\u_2;\u_3]\in \bV(3)$, then let $b(\bu) = h([
\u_0; \u_1; \u_2])$.  
Let $\Omega( V,\u_0)$ be a Voronoi cell with  Rogers's partition 
\[
\Omega(V, \u_0) = \bigcup \ \{ R( \bu) \mid { \bu\in  \bV(3), \trunc{\bu}{0}= [\u_0] }\}.
\]
\indy{Notation}{ZZZomega@$\Omega$ (Voronoi cell)}%
\indy{Index}{Rogers's partition}%

\begin{definition}[$B$,~$D_k$-cell]
  Let $B$ be the ball of radius $\sqrt2$ centered at
  $\u_0$.  We define $D_k$-cells for $k=1,2,3,4$ for each $
  \bu=[\u_0;\ldots;\u_3]\in \bV(3)$ by
\[
D_k(\bu) = \Omega(V,\u_0)\cap \cell(\bu,k),
\]
where $\cell(\bu,k)$ is the  Marchal $k$-cell of $\bu$.
\end{definition}
%
\indy{Notation}{D@$D_k$}%
\indy{Index}{D-cell}%


A $D_k$-cell, which is a subset of
$\Omega(V,\u_0)\cap B$, is the adaptation of a Marchal $k$-cell to the
geometry of the strong dodecahedral conjecture.  

\begin{lemma}[]\guid{ZERRZRM}
  Let $V$ be a saturated packing and let $\u_0\in V$.  If the intersection
of a $D_i$-cell with a $D_j$-cell is not a null set, then $i=j$ and the two
cells are equal.   The union
  of all the $D_k$-cells at $\u_0$ is $\Omega(V, \u_0)\cap B$.
\end{lemma}
\indy{Index}{null set}%

\begin{proof} This follows from the corresponding facts for cells in
  Lemma~\ref{lemma:marchal-equal}.  Each null set is in fact a subset
  of a plane.
\end{proof}


\subsection{surface area and dihedral angle}

Every cell $D_k(\bu)$ is eventually radial at $ \u_0$ and has a
well-defined solid angle $\sol(\u_0,D_k(\bu))$.  Every cell $D_k(\bu)$ has
an \newterm{exposed} surface area $\op{surf}(D_k(\u))$, the area of
the intersection of $D_k(\bu)$ and the boundary of $\Omega(V,
\u_0)\cap B$.  It consists of the sum of the areas of the analytic
facets (linear or spherical surfaces) that do not meet the point $
\u_0$.  The total surface area of $\Omega(V,\u_0) \cap B$ is the sum of the
exposed surface areas $\op{surf}(D_k(\u))$.  \indy{Index}{exposed}%

We use the functions $\dih_i$ in
\eqref{eqn:dihi} to introduce a function of six variables $y=(y_1,y_2,\ldots,y_6)$:
\[
\op{soly}(y)=
\dih_1(y)+\dih_2(y)+\dih_3(y)-\pi.
\]
By Girard's formula for the solid angle of a simplex 
(Lemma~\ref{lemma:prim-volume}),
\[
\op{soly}(y_1,y_2,y_3,y_4,y_5,y_6)=
\sol(\u_0,\op{conv}\{\u_0,\u_1,\u_2,\u_3\})
\]
when
\[
y_i = \begin{cases}
\norm{\u_0}{\u_i}, & i\in\{1,2,3\},\\
\norm{\u_j}{\u_k}, & i\in\{4,5,6\}\textand\{i-3,j,k\} = \{1,2,3\}.\\
\end{cases}
\]
\indy{Index}{surface area!exposed}%
\indy{Notation}{surf@$\op{surf}$ (surface area)}%
\indy{Notation}{solid@$\sol$ (solid angle)}%
\indy{Notation}{solid@$\op{soly}$ (solid angle as a function of edges)}%


Every cell $D_k(\bu)$ has a set $E(k,\bu)$ of distinguished edges
(that is, the edges of the cell that extend from $\u_0$ to a midpoint $(\u_0+\u_i)/2$) and a
dihedral angle $\dih(e)$ for $e\in E(k,\bu)$.  Each edge has a length
$h(e)\in\leftclosed1,\sqrt2\rightclosed$.  \indy{Index}{angle!dihedral}%
\indy{Notation}{dih}%
\indy{Index}{edge!length}%
\indy{Notation}{E@$E$ (edge)}%

\subsection{local inequality}

We reduce the strong dodecahedral conjecture to an estimate from an earlier
chapter \eqref{conj:L12} and a
local inequality.  



\begin{definition}[$a_D$,~$b_D$,~$y_D$,~$v_D$,~$f$]\guid{TCOSFNQ}
  Define constants $a_D$, $b_D$, $y_D$, and functions $v_D$, $f$ as
  follows.  Let $y_D\approx 2.1029$ be defined by the condition
\[
\op{soly}(2,2,2,y_D,y_D,y_D) = \pi/5.
\]
For any $\u_i\in\ring{R}^3$, let $g(\u_0,\u_1,\u_2,\u_3)$ be the
volume of the intersection of the convex hull of
$S=\{\u_0,\ldots,\u_3\}$ with set of points closer to $ \u_0$ than to
any other point in $S$.  When
\begin{equation}\label{eqn:uy}
  \norm{\u_0}{\u_i}=2\textand \norm{ \u_i}{ \u_j} = y\text{ for }i,j\ge 1,
\end{equation} 
this volume depends only on $y$. Write $v(y) = g(\u_0,\ldots,\u_3)$.
Set
\[
  f(y;a,b) = v(y) + a\, \op{soly}(2,2,2,y,y,y) + 3 b \dih(2,2,2,y,y,y).
\]
The linear system
\begin{equation}\label{eqn:fyD}
f(y_D;a,b) = 0,\quad f'(y_D;a,b) = 0
\end{equation}
has a unique solution in $a,b$ with values $a=a_D\approx -0.581$,
$b=b_D\approx 0.0232$.
\end{definition}
\indy{Notation}{a@$a_D$ (dodecahedral parameter)}%
\indy{Notation}{b@$b_D$ (dodecahedral parameter)}%
\indy{Notation}{yd@$y_D$ (dodecahedral parameter)}%
\indy{Notation}{yd@$v_D$ (dodecahedral function)}%
\indy{Index}{convex hull}%
\indy{Index}{regular dodecahedron!volume}%

Note that the regular dodecahedron has volume $20 v(y_D)$ and surface
area $60 v(y_D)$.  Also,
\begin{equation}
  2\,\op{soly}(2,2,2,y_D,y_D,y_D) =\dih(2,2,2,y_D,y_D,y_D)=2\pi/5.
\end{equation}
\indy{Index}{regular dodecahedron}%
\indy{Index}{regular dodecahedron!surface area}%

\begin{lemma}[local inequality]\guid{PWVDMPT}\label{lemma:D-local}
For any cell $D_k(\bu)$
\[
  \op{surf}(D_k(\bu)) + 3 a_D \sol(D_k(\bu)) 
+ 3 b_D \sum_{e\in E(k,\bu)} L(h(e)) \dih(e) \ge 0,
\]
where $L$ is the function of Definition~\ref{def:L}.  Equality holds
precisely when the cell is a null set or a $4$-cell with edges
$(2,2,2,y_D,y_D,y_D)$.
\end{lemma}
\indy{Index}{local inequality}%



For a cell $D_4(\bu)$ with parameters of the form
  \eqref{eqn:uy}, the local inequality reduces to the inequality
  $f(y;a_D,b_D)\ge 0$.  The constants $a_D$ and $b_D$ are chosen so that
  $y=y_D$ is a critical point of $f$ with value $f(y_D;a_D,b_D)=0$.  In
  particular, the local inequality asserts that $f$ has a local
  minimum at $y=y_D$.


\begin{proof} 
  The dimension of a $D_k$-cell is $\tbinom{k}{2}$, which is at most $6$.  
This cell inequality is a nonlinear inequality in a small number of variables
and is verified by a 
\cc{TNVWUGK}{}.  % The $D_4$-inequality is 9627800748 and $D_3$ is 6938212390.
\end{proof}

\begin{lemma}[]\guid{OIEKCEZ}
  The local inequality and the estimate \eqref{conj:L12}
\[
\sum L(h) \le 12
\]
imply the strong dodecahedral conjecture.
\end{lemma}

\begin{proof} 
  Sum the local inequality over all the $D_k$-cells in a Voronoi cell.
  The solid angles sum to $4\pi$ and the dihedral angles around each
  edge sum to $2\pi$:
\begin{align*}
  \op{surf}(\Omega) &\ge \op{surf}(\Omega\cap B)\\
  &=\sum_{k,\bu} \op{surf}(D_k(\bu))\\
  &\ge -12\pi a_D - 6\pi\, b_D  \sum L(h)\\
  &\ge -12\pi a_D - 72\pi\, b_D\\
  &= -60 \op{soly}(2,2,2,y_D,y_D,y_D) a_D - 180 \dih(2,2,2,y_D,y_D,y_D) b_D\\
  &= 60 (v(y_D) - f(y_D;a_D,b_D))\\
  &= 60 v(y_D).\\
\end{align*}
The final term is the surface area of a regular dodecahedron.
\end{proof}

Thus, the strong dodecahedral conjecture follows from the same
estimate~\eqref{eqn:L12} that is used to prove the Kepler conjecture.
The case of equality occurs only for the regular dodecahedron.

\newpage
\section{Fejes T\'oth's Full Contact Conjecture}


On December 26, 1994, L Fejes T\'oth wrote to me, ``I suppose that you will
be interested in the following conjecture: In $3$-space any packing of
equal balls such that each ball is touched by twelve others consists
of hexagonal layers.  In the enclosed papers a strategy is described
to prove this conjecture''~\cite{Fejes-Toth:89},
~\cite{Fejes-Toth:69}.

Call a nonempty packing $V$ in $\ring{R}^3$ in which every point has
distance  $2$ from twelve other points a \newterm{packing with full
  contact}.   We affirm Fejes-T\'oth's conjecture in the following form.  Section~\ref{sec:hcp} shows that the theorem is enough to guarantee that a packing with full
contact consists
of hexagonal layers.
\indy{Index}{packing!full contact}%
\indy{Index}{full contact}%
\indy{Notation}{V@$V$ (packing)}%


\begin{theorem}[Packings with Full Contact]\guid{BDEDUTL}\label{thm:fc} 
  Let $V$ be a packing with full contact.  Then for every point $\u\in
  V$, the set of twelve around that point is arranged in the pattern
  of the HCP or FCC packing.
\end{theorem}
\indy{Index}{HCP}%
\indy{Index}{FCC}%
\indy{Index}{kissing configuration}%



\begin{lemma}[]\guid{LIHVTRE} \label{lemma:gap}
  Let $V$ be any packing with full contact and let $\u\ne\v\in V$.
  Then $\norm{\u}{\v}=2$ or $\norm{\u}{\v} \ge 2.52$.
\end{lemma}
\indy{Index}{packing!full contact}%
\indy{Index}{full contact}%

\begin{proof} Let $ \u_1,\ldots, \u_{12}$ be the twelve kissing points
  around $\u$.  Assume that $\v\ne \u_i$.  By
  Assertion~\ref{conj:L12},
\[
   L(h( \u, \v))  + 12 
  =  L(h( \u, \v)) + \sum_{i=1}^{12} L(h( \u, \u_i))  \le 12.
\]
This implies that $L(h( \u, \v))\le 0$, so $\norm{ \u}{ \v}\ge 2.52$.
\end{proof}

A packing $V$ may always be translated so that $\orz\in V$.  We study
the structure of a kissing configuration centered at $\orz$ that
has the separation property of Lemma~\ref{lemma:gap}.

\begin{definition}[$S^2(2)$,~$\CalV$]
  Let $S^2(2)$ be the sphere of radius $2$, centered at $\orz$.  Let
  $\CalV$ be the set of packings $V\subset \ring{R}^3$ such that
\begin{enumerate}\wasitemize 
\item $\card(V) = 12$,
\item $V\subset S^2(2)$.
\item $\norm{\u}{\v} \in \{0,2\}\cup
  \leftclosed2.52,4\rightclosed$ for all $\u,\v\in V$.
\end{enumerate}\wasitemize 
\indy{Notation}{V@$\CalV$ (twelve sphere configurations)}%
\indy{Notation}{S@$S^2(r)$ (sphere of radius $r$)}%
\end{definition}

The strategy of the proof is to classify the hypermaps of contact
fans $(V,E_{ctc})$ for $V\in \CalV$ and to show that there are only two
possibilities: the contact hypermaps of the FCC and the HCP.  From
this, the proof of Fejes T\'oth's conjecture ensues.

The classification result is analogous to the one that we have already
obtained for tame hypermaps.  This suggests developing a proof along
exactly the same lines as earlier chapters.  We define a new
collection of hypermaps with properties that are analogous to those
defining a tame hypermap and call them \newterm{hypermaps with tame
  contact}.  A computer generated classification of these hypermaps
shows gives only a few possibilities.  Those other than the FCC and
HCP hypermaps are eliminated by linear programming methods.

\subsection{main estimate}




\begin{remark}[Lexell's theorem]
According to Lexell's theorem, for any two points $\u,\v\in S^2(2)$,
the locus of points $\w\in S^2(2)$, along which
the spherical triangle with vertices $\u,\v,\w$ has fixed area, is a circular arc
%The circle is centered on the bisector of $\u$ and $\v$, and 
with endpoints at the antipodes of $\u$ and $\v$.



Lexell's theorem is an aid in finding the minimum of
  $\sol(U_F)$.
  It is a consequence of Lexell's theorem that the area of a spherical
  triangle (viewed as a function of its edge lengths) does not have a
  interior point local minimum, when the edge lengths are
  constrained to lie in given intervals.  The minimum occurs at a
  point where each edge length lies at an endpoint of its interval.
%
\indy{Index}{Lexell's theorem}
\end{remark}

\begin{remark}[Leech's solution of the Newton-Gregory problem]
During a famous discussion with Gregory, Newton asserted that 
if $V\subset S^2(2)$ is any packing, then $\card(V)\le 12$. That is, at most
twelve nonoverlapping balls can touch a fixed central ball.  The first proper
proofs of Newton's assertion did not appear until the twentieth century.
%
\indy{Index}{Newton-Gregory problem}%
\indy{Index}{Leech}%
\indy{Index}{thirteen spheres problem}%
\indy{Index}{13@$13$ spheres problem}%
  
A proof by Leech is particularly
noteworthy~\cite{Leech:1956:MG}.  Assuming the existence of a packing
$V\subset S^2(2)$ of cardinality $13$, Leech associates a planar graph
$(V,E)$ with $V$, which is nearly the same as our standard fan.  In
our notation, he estimates the solid angle of each topological
component $U_F$.  He does not write the details of these solid angle
estimates, although we may presume they are based on Lexell's theorem.
Next, he classifies the planar graphs $(V,E)$ that satisfy various
combinatorial constraints obtained from the solid angle estimates. He
finds that no such planar graph exists, in confirmation of Newton's
claim.
\end{remark}

We use the function $\tau(V,E,F)$ from Definition~\ref{def:tau}.  Under the 
special conditions that 
$V$ is a packing, $(V,E)$ is a \newterm{biconnected} graph, and
$V\subset S^2(2)$, we have 
\[
\tau(V,E,F) = \sol(U_F) + (2-k(F)) \sol_0.
\]
Thus, we estimate $\tau$ by estimating $\sol(U_F)$, which can be done
following Leech's lead with Lexell's theorem.
% \indy{Notation}{ZZtauf@$\tau(V,E,F)$ (contact fans)}%
% \indy{Index}{kissing configuration}%


The next theorem is main estimate for packings with full contact.
(Compare  Theorem~\ref{lemma:empty-d}.)  
%It is similar to the main
%estimate in Leech's proof of the problem of thirteen spheres~\cite{Leech:1956:MG}.  
We recall that $\op{tgt}=1.541$.
%
\indy{Notation}{tgt@$\op{tgt}=1.541$}%


\begin{theorem}[main estimate]\guid{VGJDQJV}\label{lemma:main-estimate-12}
  Let $V$ be a packing in $S^2(2)$, $E$ a set of edges, and $F$ a face
  of $\op{hyp}(V,E)$ such that $(V,E,F)$ is a local fan (but not
  necessarily nonreflexive).
   %Assume that
  %$(V,E)$ is a biconnected graph.  %% redundant for local fan, which is a Dihedral grp.
  Assume that $F$ has at least three
  darts Assume that every edge in $E$ has length at most $3$.  Let
  $S$ be a subset of $E$ such that the length of every edge in $S$ is
  at least $2.52$.  Let $U=U_F$ be the topological component of
  $Y(V,E)$ corresponding to $F$.  Assume that if $\{\u,\v\}\subset V$
  with $C^0\{\u,\v\}\subset U$, then % and $2\le\norm{\u}{\v} \le 2.52$, then
 % $\{\u,\v\}\in E$.  
  $\norm{\u}{\v}\ge 2.52$.
  Let $r=\card(E\setminus S)$ and $s = \card(S)$.
Then
\[\tau(V,E,F) \ge \min(d(r,s),\op{tgt}),\]
where 
\[ d(r,s) = 
\begin{cases}
0.103 (2-s) + 0.2759 (r+2s-4), & r + 2s > 3\\
0, & r + 2s \le 3.\\
\end{cases}
\] 
%\[
%d(r,s) = 0.103 (2-s) + 0.277 (r+2s-4),\ \ 
%s = \card(S),\textand  r = \card(E)-\card(S).
%\]
%\indy{Notation}{d@$d$ (contact weight constant)}
\end{theorem}

\begin{proof} This proof imitates the proof of the main estimate from
  \cite{Hales:2006:DCG}.   (Compare
  Chapter~\ref{sec:local}.)

  For a contradiction, let the local fan $(V,E,F,S)$ violate the given
  inequality.  Among all counterexamples to the theorem, we may assume
  that $(V,E,F,S)$ is a counterexample that minimizes $k=r+s$.  Let
  $k_{min}$ be the smallest value attained.



  \claim{There exists a counterexample that minimizes
\begin{equation}\label{eqn:td}
\tau(V,E,F)-\min(d(r,s),\op{tgt})
\end{equation}
among all counterexamples that have parameters that satisfy
$k_{min}=k$.}  Indeed, a compactness argument shows that a sequence
tending to the minimum value has a convergent subsequence.  (Compare
Lemma~\ref{lemma:compact-fan} and Lemma~\ref{lemma:compact:bs}.)

We may assume that the counterexample $(V,E,F,S)$ is minimal
in this sense.

\claim{In a minimal counterexample, all edges of length at least
  $2.52$ belong to $S$.}  Indeed, $d(r-1,s+1)>d(r,s)$.

\claim{A minimal counterexample $(V,E,F,S)$ does not have any edges
  $\{\u,\v\}\subset V$, satisfying $C^0\{\u,\v\}\subset U$ and
  $\norm{\u}{\v}\le 3$.}  Otherwise, $\{\u,\v\}$ may be added to the edge
set of the fan to slice $F$ into two faces $F_1$ and $F_2$.
The constants $d(r,s)$ are additive under slicing
For some constants $d_1$
and $d_2$,
\begin{align}\label{eqn:drs}
d(r,s) &= d_1 (2 - s) + d_2 (r + 2 s-4) \nonumber\\
&= d_1 (2-s') + d_2 (r'+2 s'-4) + d_1 (2-s'') + d_2 (r''+2s''-4)\nonumber\\
&= d(r',s') + d(r'',s'').
\end{align}
Because of this additivity, one of the two faces $F_1$ or $F_2$ is a
counterexample as well with a small parameter:
$k(F_1),k(F_2)<k_{min}=k(F)$.  This is contrary to the assumed
minimality of $k$.



Call a node $\v\in V$ of a local fan \newterm{reflexive} or \newterm{nonreflexive}, according
to whether $\op{azim}(x)\ge\pi$ or $\op{azim}(x)<\pi$, where $x$ is
the dart of $F$ at $\v$.  \indy{Index}{reflexive node}%
\indy{Index}{nonreflexive node}%

\claim{In a minimal counterexample $(V,E,F)$, if $\v\in V$ is a
  reflexive node, then both edges at $\v$ have length $3$.}  Indeed,%
\footformal{In the original proof of the Kepler conjecture 
  various geometrical subtleties appear in this part of the
  proof.  None of these subtleties appear here.  In fact, the
  deformation remains a packing because in the notation of~\cite{Hales:2006:DCG},
 we have
\[
{\mathcal E}(2,2,2,2,2,2,2,2,2)> 3.
\]
The deformation remains a fan, because of the calculation
\[
\Delta(4,4,4,3^2,4,4)>0.
\]
Once it is established that the edges at a reflexive node $\v$ have length $3$, it
follows that all the vertices in 
\[
W(\orz,\v,\rho\v,\rho^{-1}\v)\cap (V\setminus\{\v\})
\]
have distance at least $3$ from $\v$.  It follows that a half-disk
of radius $\arc(2,2,3)$ fits inside the region.  Indeed, since
$\arc(2,2,3)>\pi/2$, the edges bow away from the reflexive node, so
that the point on the boundary of $U$ closest to the node is another
node.  A nonreflexive node adjacent to the reflexive node has angle $>\pi/2$
because of dihedral angle estimates $\dih(2,2,2,3,3,2)>\pi/2$, and
so forth.  } if both edges at $\v$ have length less than $3$, there
exists a deformation of the local fan $(V,E,F)$ that fixes every node
except $\v$ and decreases the solid angle $U_F$.  This cannot be a
minimizing counterexample.  Now assume that one of the edges
$\{\v,\u\}$ has length $3$.  Let $\{\v,\w\}\in E$ be the other edge.
%By minimality it has extremal length $2,2.52$, or $3$.  
Let
$y=\norm{\u}{\w}$.  We check by a symbolic
\cc{}{\newterm{Mathematica} 8649676161} that
\begin{align}\label{eqn:dsol}
\Delta(2,2,2,y_1,y_2,y_3)^{1/2}\dfrac{d\,\op{soly}(2,2,2,y_1,y_2,y_3)}{dy_1} &= 
% for 3.2: \dfrac{4t(256 - 25t^2 + 25y^2)}{25(16 - t^2)} >0,
\dfrac{4 y_1 (y_2^2 + y_3^2- y_1^2)}{16- y_1^2}.
\end{align}
 Recall that $\Delta>0$.
This is positive
when $y_1=t\le3$, $y_2=y\ge 2$, and $y_3=3$. 
Hence, the region
$\op{aff}^0_+(\orz,\{\u,\v,\w\})$ of greatest
solid angle occurs when $\norm{\v}{\w}=3$.  This solid angle is greatest when
when the solid angle of $U_F$ is least because  the two regions are complementary.


\claim{In a minimal counterexample, some node is reflexive.}  Otherwise,
every node is nonreflexive.  Every edge has arclength at least
$\arc(2,2,2)=\pi/3$.  By Lemma~\ref{lemma:convex-hyp}, the cardinality
$k$ of $E$ satisfies $(\pi/3)k < 2\pi$, so $k<6$.  (The perimeter inequality is
strict for a generic fan.)  By Lexell's theorem, the each edge has
extremal length;  that is, every edge in $S$ has length $2.52$ or
$3$ and every edge in $E\setminus S$ has length $2$.  In fact, derivative
arguments similar to \eqref{eqn:dsol} show that the smaller area always
corresponds to the shorter edge length.  The only
remaining degrees of freedom are the lengths of the diagonals.  As the
polygon has at most five sides, we have reduced the proof  to a
finite \cc{ZVLLGZK} % old:9267276091. 
{The triangle case is done in Mathematica.} of dimension at
most two.

\claim{In a minimal counterexample some node of the local fan
  $(V,E,F)$ is nonreflexive.}  Otherwise, the region that is complementary
to $U_F$ is nonreflexive.  The perimeter estimate for nonreflexive regions again
gives $k<6$.  The complementary region lies in a hemisphere.  Thus,
the solid angle of $U_F$ is at least that of the other hemisphere,
$2\pi$.
%
%One
%half of $\op{rcone}(\orz,\v,\cos\theta)$, where
%$\theta=\arc(2,2,3)\approx ?$ fits inside the region.  The
%half-cone has solid angle
%\[
%\sol=\pi(1-\cos\theta)\approx 4.02.
%\]
This gives
\[
\tau(V,E,F) = \sol(U_F) + (2-k)\sol_0 \ge 2\pi - 3\sol_0 > \op{tgt}.
\]


\claim{In a minimal counterexample, there cannot be both a reflexive
and a nonreflexive  node.} 
The nonreflexive node adjacent to a reflexive node $\v$ has interior angle greater
than $\pi/2$ and can be deformed by decreasing the distance between it
and $\v$ in order to decrease the solid angle of $U$.  This shows that the
function $\tau$ has no local minimum among such arrangements.


The various claims show that no minimal counterexample exists.  This
completes the proof.
\end{proof}

\subsection{biconnected fans}


We may create  fans that are biconnected graphs in the same way as in
\cite{Hales:2006:DCG}.  Here is a review
of the construction.



\begin{lemma}\guid{NJFWRPQ}\label{lemma:V'-bi} 
Let $V\in \CalV$.  Then there exists $V'\in \CalV$ with
  the following  properties:
\begin{enumerate}\wasitemize 
\item There is a bijection $\phi:V'\mapsto V$ that induces a bijection
  of contact graphs:
\[
\phi_*:(V,E_{ctc}) \cong (V',E'_{ctc}).
\]
\item Let $E'$ be the set of all pairs $\{\u,\v\}\subset V'$
  such that $2.52\le\norm{\u}{\v} <\sqrt8$.  Set $E =
  E'_{ctc}\cup E'$.  Then $(V',E)$ is a fan.
\item The graph $(V',E)$ is biconnected.
\end{enumerate}\wasitemize 
\end{lemma}

\begin{definition}[$\CalV'$,~$E_V$]\guid{ZTONFGU}
\indy{Notation}{V@$\CalV'$}
\indy{Notation}{EV@$E_V$}
Let $\CalV'\subset\CalV$ be the subset of packings $V'\in\CalV$ that
satisfy the final two enumerated properties of the lemma.  Write
$E_V$ for the set of pairs $\{\u,\v\}\subset V$
  such that $2\le\norm{\u}{\v} <\sqrt8$.
\end{definition}

\begin{proof}
  Begin with the contact fan $(V,E_{ctc})$.  Let $E'$ be the set
  of all pairs $\{\u,\v\}\subset V$ such that
  $2.52<\norm{\u}{\v}<\sqrt8$.

  \claim{We claim that $(V,E_{ctc}\cup E')$ is a fan.} Indeed, it is checked by
  \cite[Lemma~4.30]{Hales:2006:DCG} that the blades satisfy the
  intersection property of fans, except possibly when two new blades
  are the diagonals of a quadrilateral face in $(V,E_{ctc})$.  (The
  cited lemma uses the constant $2.51$ instead of $2.52$, but this
  does not affect the reasoning of the lemma.)  The diagonals of a quadrilateral face
  in $(V,E_{ctc})$ is a spherical rhombus and one of its diagonals is
  necessarily at least $\sqrt8$ (with extreme case a square of side
  $2$).  The other fan properties are easily checked.

  If the hypermap $\op{hyp}(V,E_{ctc}\cup E')$ is not connected,
  the set of nodes $V_1\subset V$ in one combinatorial component can
  be moved closer to another combinatorial component until a new edge
  is formed.  This can be done in a way that the deformation of $V$
  remains in $\CalV$ and no new edges of length at most $2.52$ are formed.
  Continuing in this fashion, a connected hypermap is obtained.

A biconnected hypermap is produced by  further
 deformations of the fan around each \newterm{articulation node}  (that is, a node 
whose deletion increases the number of combinatorial components).
\end{proof}


\begin{lemma}\guid{CTJYKFZ}\label{lemma:dj}
Let $(D,e,n,f)$ be a connected plain hypermap with more than
two darts.  Assume that the hypermap has no  double joins. Assume that the
two darts of each edge lie at different nodes.
Then
every face has at least three darts.
\end{lemma}

\begin{proof}
Otherwise, if some face is a singleton $\{x\}$, then both darts
of the edge $\{x,e x\}$ lie at the same node, which is contrary to
assumption.

  Furthermore, if some face has only two darts, then because of the no
  double join condition, the two edges meeting the face, $\{x, e x\}$
  and $\{ e^{-1} f^{-1} x, f^{-1} x\}$, which join the same two nodes,
 must actually be equal.  That
  is, $ x = f e x = n^{-1} x$, so that $x$ is a fixed point of the node
  map.  Similarly, $f x$ is a fixed point of the node map.  Then $\{x,
  f x\}$ is a combinatorial component, which is contrary to the
  assumption that the hypermap is connected with more than two darts.
\end{proof}


\begin{definition}[$D_U$,~$m_U$,~$r_U$,~$s_U$,~$k_U$,~$\tau(U)$]
  Let $V\in \CalV$.  Let $U$ be a topological component of
  $Y(V,E_{ctc})$ and let $D_U$ be the set of all darts of $\op{hyp}(V,E_{ctc})$
 that lead into
  $U$.   For each
  $x\in D_U$, let $m(x) >0$ be the smallest natural number such that
  $f^{m} x$ and $x$ lie at the same node.  Let $m_U$ be the maximum of
  $m(x)$  as $x$ runs over $D_U$.  The constant $m_U$ can be viewed as
  a \newterm{simplified face size}.  
Let $r_U = \card(D_U)$, and let $s_U$ be twice the
  number of combinatorial components of $\op{hyp}(V,E_{ctc})$ that
  meet $D_U$.  Let $k_U=r_U+s_U$.  Overloading the symbol $\tau$, we
  set $\tau(U) = \sol(U) +  (2-k_U)\sol_0$.   (If a single  face $F$ leads into
  $U$ and if the face is simple, then the overloaded notation is consistent
with the earlier notation: $\tau(U) = \tau(V,E_{ctc},F)$.)
%
   \indy{Index}{contact!full}%
  \indy{Index}{fan}%
  \indy{Notation}{m@$m$ (simplified face size)}%
  \indy{Notation}{DU@$D_U$ (the set of darts leading into $U$)}
\end{definition}

\begin{lemma}\guid{NOKWBKT}\label{lemma:tauU'}
  Let $V\in \CalV'$.
Let $U$ be a topological component of
  $Y(V,E_{ctc})$.   Then $\tau(U)\ge \min(d(r_U,s_U),\op{tgt})$.
\end{lemma}

\begin{proof}
Up to a null set (given by the finite union of blades $C^0(\ee)$ for
$\ee\in E_V\setminus E_{ctc}$), the region $U$ is the union of topological
components $U_F$ of $Y(V,E_V)$, which are in bijection with the faces
$F$ of $\op{hyp}(V,E_V)$.  The function $\tau(U)$ is additive:
\begin{equation}\label{eqn:tau-additive}
\tau(U) = \sum_{U_F\subset U} \tau(V,E_V,F).
\end{equation}
By the biconnectedness of $(V,E_V)$, each value $\tau(V,E_V,F)$ is the
same before and after localization.
Lemma~\ref{lemma:main-estimate-12} gives a lower bound on the
constants $\tau(V,E_V,F)$.  The constants $d(r_U,s_U)$ are superadditive:
\[
d(r_U,s_U) \le \sum_{U_F\subset U} d(r(F)),s(F)),
\]
where $s(F)$ is the cardinality of the set of edges of $E_V\setminus
E_{ctc}$ that meet $F$, and $r(F) = \card(F)-s(F)$.  Thus, the 
lower bound on $\tau(U)$ follows from the main estimate
(Lemma~\ref{lemma:main-estimate-12}).
\end{proof}

\begin{lemma}[]\guid{UCEUZYO} Let $V\in \CalV'$.  Then
\[
\sum_{U\in [Y(V,E_{ctc})]} \tau(U) = (4\pi - 20\sol_0)
\]
\end{lemma}

\begin{proof} For a packing of twelve points $V\subset S^2(2)$, we have
$12=\CalL(V)$.   From this equality, following~\eqref{eqn:delta0}, we have
\[
  \sum \tau (V,E_{ctc},F) = (4\pi - 20\sol_0). 
\]
The result follows by additivity~\eqref{eqn:tau-additive}.
\end{proof}

Recall from Remark~\ref{rem:tgt} that the constant $\op{tgt}$ is slightly
larger than $(4\pi-20\sol_0)$.  The constants $d(r_U,s_U)$ are nonnegative, so that
$\tau(U)$ is as well.  This means that for every subset
$A$ of $[Y(V,E_{ctc})]$, we have
\begin{equation}\label{eqn:subtgt}
\sum_{U\in A} \tau(U) < \op{tgt}.
\end{equation}



\begin{lemma}[biconnected]\guid{BTZPFMU}\label{lemma:biconnected}
  Let $V\in \CalV$.  Then $\op{hyp}(V,E_{ctc})$ is biconnected.
\end{lemma}

\begin{proof}
  By Lemma~\ref{lemma:V'-bi}, we may replace $V$ with a new set in
  $\CalV$ if necessary so that $(V,E_V)$ is a biconnected fan.
   We  show that the smaller
  fan $(V,E_{ctc})$ is also biconnected.

  Let $U$ be a topological component of $Y(V,E_{ctc})$.  Lemma~\ref{lemma:tauU'}
   implies that $\tau(U)\ge \min(d(r_U,s_U),\op{tgt})$.

   \claim{If $m_U\le 5$, then $D_U$ is a simple face.} Otherwise,
   either $D_U$ is a face that is not simple, or it consists of more than
   one face.  Either way, some node $\v$ lies in the interior to the
   $m_U$-gon.  Let $\u,\w$ be consecutive nodes around the $m_U$-gon.
   By a \cc{} % old: 6621965370
  {Mathematica derivative calculation number 6621965370.} the angles
   $\op{azim}(\orz,\v,\u,\w)$ are each less than $2\pi/5$. The angles
   around $\v$ cannot sum to $2\pi$ as required.

   \claim{We claim that $D_U$ is a simple face.}  Otherwise, assume
   for a contradiction that $D_U$ is not simple, $m_U\ge 6$, and
   $d(r_U,s_U)<\op{tgt}$.  From the classification of
   \cite[p.~126,~Fig.~12.1]{Hales:2006:DCG}, and the inequalities
   $d(9,0) > \op{tgt}$, $d(6,2) > \op{tgt}$, it follows that the set
   $D_U$ has cardinality eight and $m_U=6$.  The set $D_U$ meets seven
   nodes: the six nodes counted by $m_U$ and a node in the interior of
   the hexagonal arrangement.  At each node there is a face of the
   hypermap $\op{hyp}(V,E_{ctc})$ that is not a triangle, because
   $2\pi$ is not an integer multiple of the dihedral angle of a
   regular tetrahedron.  As the packing has twelve nodes in all, five
   nodes remain, each meeting a nontriangular topological component of
   $Y(V,E_{ctc})$.  Thus, by counting nodes, the hypermap has at least
   one pentagon or two quadrilaterals.  We find that $\sum_{U}
   \tau(U)$ is at least
\[
d(8,0) + d(5,0) > \op{tgt}, \text{ or }\quad d(8,0) + 2 d(4,0) > \op{tgt},
\]
which is contrary to~\eqref{eqn:subtgt}.
Thus, $D_U$ is a simple face.
\indy{Index}{weight!total}%
\indy{Index}{weight}%

\claim{The hypermap is biconnected.}  Otherwise, if the hypermap is
not connected, then we can find two faces of the hypermap that lead
into the same topological component of $Y(V,E_{ctc})$.  If the
hypermap is connected but not biconnected, then some face of the
hypermap is not simple.  Both possibilities contradict the fact that
$D_U$ is a simple face.
\end{proof}



\subsection{tame contact}

This subsection modifies the notion of tameness to cover hypermaps
that arise as the contact fan of a packing with full contact.  In the
definition of tame hypermap in Chapter~\ref{sec:tame}, a function $b$
is used.  In this section we replace $b$ with a new function, which is
again called $b$ because we have no further use for the former
function.  Recall that $\op{tgt}=1.541$.  \indy{Index}{tame}%
\indy{Index}{hypermap!tame}%

\begin{definition}[b]\guid{IHRZTPV}
  Define $b:\ring{N}\times \ring{N}\to \ring{R}$ by
  $b\pqr{(p,q)}=\op{tgt}$, except for the following values:
\[
b(0,3)=b(1,3)=0.618,\quad b(2,2)=0.412.
\]
\end{definition}
\indy{Notation}{b@$b$ (contact weight parameter)}%

\begin{definition}[d]\guid{VUJQZCG}
Define $d:\ring{N}\to \ring{R}$ by
\[d(k) = \begin{cases}
0, & k\le 3, \\
%0.206 + 0.277 (k-4),& k=4,\ldots,8,\\ changed 5/18/2010.
0.206 + 0.2759 (k-4),& k=4,\ldots,8,\\
%0.206 & k=4, \\
%0.483 & k=5, \\
%0.760 & k=6, \\
%1.037 & k=7, \\
%1.314 & k=8,\\
\op{tgt},& k>8.\\
\end{cases}
\]
%(In particular, $d(k) = 
\end{definition}
\indy{Notation}{d@$d$ (contact weight parameter)}%

The function $d$ is related to the two-variable function in
Lemma~\ref{lemma:main-estimate-12}: $d(k) = d(k,0)$, when $4\le k\le
8$.

\begin{definition}[weight~assignment]\guid{GLIQSFM}
%
  Recall that a \newterm{weight assignment\/} on a hypermap $H$ is a
  function $\tau$ on the set of faces of $H$ taking values in the set
  of nonnegative real numbers. A weight assignment $\tau$
is a \newterm{contact}
  weight assignment if the following two properties hold:
%
  \indy{Index}{weight assignment}%
  \indy{Index}{contact!weight assignment}%
  \indy{Notation}{ZZtau@$\tau$ (weight assignment)}%
\begin{enumerate}
\item If the face $F$ has cardinality $k$, then
$\tau(F) \ge d(k)$.
\item If a node $\v$ has type $(p,q,0)$, then
  \[\sum_{F:\,\v\cap F\ne\emptyset} \tau(F) \ge
    b{\pqr{(p,q)}}.\]
\end{enumerate}
The sum $\sum_F \tau(F)$ is called the \newterm{total weight} of $\tau$.
\indy{Index}{total weight}%
\end{definition}


\begin{definition}[tame contact]\guid{XJPQTIV}
  A hypermap has \newterm{tame contact\/} if it satisfies the following 
  conditions:
%
\indy{Index}{tame contact}%
\indy{Index}{contact!tame}%
\indy{Index}{planar}%
\indy{Index}{biconnected}%
\indy{Index}{nondegenerate}%
\indy{Index}{loop}%
\indy{Index}{double join}%
%
\begin{enumerate}
%\label{definition:tame}
%1
\item \case{planar} The hypermap is plain and planar.
\item \case{biconnected} The hypermap is biconnected.  In particular,
  each face meets each node in at most one dart.
\item \case{nondegenerate} The edge map $e$ has no fixed points.
\item \case{no loops} The two darts of each edge lie in different
  nodes.
\item \case{no double join} At most one edge meets any two given
  nodes.
\item \case{face count} The hypermap has at least two faces.
\item \case{face size} The cardinality of each face is at least three
  and at most eight.
%\label{definition:tame:length}
\item \case{node count} The hypermap has twelve nodes.
\item \case{node size} The cardinality of every node is at least two  and at most four.
%\label{definition:tame:degree}
%    \item \case{node} {\tt NO CONDITION}
%\label{definition:tame:degreeE}
\item \case{weights} There exists a contact weight assignment of total
  weight less than $\op{tgt}$.
%\label{definition:tame:squander}
\end{enumerate}
%
\end{definition}


%\subsection{tame contact}

\begin{theorem}\guid{ZXZSVPH} The contact hypermap of a 
  packing $V\in \CalV$ is a hypermap with tame contact.
\end{theorem}
\indy{Index}{hypermap!tame}%
\indy{Index}{hypermap!contact}%
\indy{Index}{hypermap}%
\indy{Index}{contact!full}%

\begin{proof} It is enough to go through the list of properties that
  define a tame contact hypermap and to verify that the contact
  hypermap satisfies each one.  We use the weight assignment $F\mapsto
  \tau(V,E_{ctc},F)$.

\begin{enumerate}
\item \case{planar} The contact hypermap is plain and planar by the
  general properties of fans.\footnote{Earlier chapters give a long
    discussion of planarity.  In this chapter, we are not attempting
    to give a formalizable blueprint, so we relax our standards and
    regard planarity as an obvious feature of fans.}
\item \case{biconnected} The hypermap is biconnected by
  Lemma~\ref{lemma:biconnected}.
\item \case{nondegenerate} The
  edge map has no fixed points by the general properties of fans.
\item \case{no loops}
  There are no loops or double joins by the general properties of
  fans.
\item \case{no double join} 
\item \case{face count} Each node has at least two darts by
  biconnectedness. Each face is simple; so the two darts at a node lie
  in different faces.  Thus, the hypermap has at least two faces.
\item \case{face size} The cardinality of each face is at least three
  because the hypermap has no loops or double joins (Lemma~\ref{lemma:dj}).
  The cardinality of a face is at most eight because of the estimate
  $d(9,0)>\op{tgt}$.
\item \case{node count} There are twelve nodes by the definition of a
  packing with full contact.
\item \case{node size} We have already established that the cardinality
  of each node is at least two.  The proof that the cardinality is
  never  greater than four appears in Lemma~\ref{lemma:no-5}.
\item \case{weights} Theorem~\ref{lemma:main-estimate-12} establishes 
 the inequality $\tau(V,E_{ctc},F)\ge d(k)$.
   \indy{Notation}{ZZtauf@$\tau(V,E_{ctc},F)$}%
  The total weight of the weight assignment is given by
  equation~\eqref{eqn:delta0}:
\[
  \sum_F \tau(V,E_{ctc},F) = (4\pi - 20\sol_0) < \op{tgt}.
\]
\indy{Index}{weight!total}%
Let $\v$ be a node of type $(p,q,0)$.  
%Let $A$ be the set of faces
%that meet the node $\v$. 
Then
\[
\sum_{F\mid F\cap \v\ne\emptyset}\tau(V,E_{ctc},F) > d(4)~q.
\]
This gives the nonzero entries in the table of bounds $b(p,q)$.  The
remaining entries follow from Lemma~\ref{lemma:no-5}.
\end{enumerate}
\end{proof}




\begin{lemma}[]\guid{CQRHDZE}\label{lemma:no-5} 
  Let $V\in \CalV$.  Every node of $(V,E_{ctc})$ has degree at most
  four.  Furthermore, suppose the type of a node is $(p,q,0)$.  Then
  $(p,q)$ must be
\[
(0,3),~(1,3),~\text{ or}~~(2,2).
\]
\end{lemma}

\begin{proof} The interior angles of a spherical polygon in the
  contact graph have the following lower $\alpha_k$ and upper bounds
  $\beta_k$, as a function of the number of sides $k$.
\begin{equation}
\begin{array}{lllll}
  \phantom{\ge}k~~&\alpha_k & \beta_k\\
  \phantom{\ge}3~~&\op{azim}(2,2,2,2,2,2)  &\op{azim}(2,2,2,2,2,2)\\
  \phantom{\ge}4~~&\op{azim}(2,2,2,2.52,2,2) &2\,\op{azim}(2,2,2,2,2.52,2)\\
  {\ge}5~~& \op{azim}(2,2,2,2.52,2,2) ~~~& 2\pi.
\end{array}
\end{equation}
Thus,
\[
  p\,\alpha_3 + q\,\alpha_4 +r\, \alpha_5 
\le 2\pi \le p\,\beta_3 + q\,\beta_4 + r \,\beta_5.
\]
There are no solutions for
$(p,q,r)$ in natural numbers when $p+q+r\ge 5$ and
 only the three given solutions in $(p,q,r)$ with $r=0$.
\end{proof}



\subsection{classification}

The website for the computer code  contains a list of eight hypermaps
that have been obtained by running the classification algorithm with
the tame contact parameters~\cite{website:FlyspeckProject}.

\begin{lemma}[tame hypermap classification]\guid{AZYOJBE}\cutrate{}
  \label{lemma:contact-classification} Every hypermap with tame
  contact is isomorphic to a hypermap in the given list of eight
  hypermaps, or is isomorphic to the opposite of a hypermap in the
  list.  \indy{Index}{isomorphic}%
\end{lemma}

\begin{proof}
  By a \cc{}{fejesToth.properties file with output fejesToth.txt}, 
 the set of all hypermaps has been classified by the same
  algorithm described in Section~\ref{sec:proof-classification}.
  \indy{Index}{contact!tame}%
  \indy{Index}{hypermap}%
  \indy{Index}{hypermap!tame}%
\end{proof}



\begin{lemma}[]\guid{MWWSZTX}\label{lemma:fcc-ft} Let $V\in \CalV$.
  Suppose that $H=\op{hyp}(V,E_{ctc})$ is a hypermap with tame
  contact.  Then $H$ is the FCC or HCP contact hypermap.
\end{lemma}

\begin{proof} The explicit enumeration of hypermaps with tame
  contact has eight cases.  Two are the hypermaps of the
  FCC and HCP.  The remaining six must be eliminated.  
A geometrical argument  eliminates one of these cases and linear programming
eliminates the other five.

\claim{One case with a hexagonal cannot be realized geometrically as a contact fan
(Figure~\ref{fig:fthex}).}  Indeed, the perimeter of a hexagon with sides $\pi/3$
is $2\pi$.  However, the hexagons are nonreflexive, and $2\pi$ is a strict upper bound on the perimeter of a nonreflexive
hexagon.  Thus, this case does not exist.
\tikzfig{fthex}
{This hypermap is not a contact fan.}
{
[scale=0.004]
% java render/Gentikz "125913905253 14 6 0 1 2 3 4 5 3 0 5 6 3 6 5 7 3 7 5 4 3 7 4 8 3 8 4 3 3 8 3 9 3 9 3 2 3 9 2 10 3 10 2 1 3 10 1 11 3 11 1 0 3 11 0 6 6 6 7 8 9 10 11 "
%tikz format auto generated by Gentikz, then hand edited.
%in LaTeX file, enclose code in tikzpicture environment
% invariant: 125913905253
%Set the coordinates of the points:
\tikzstyle{every node}=[draw,shape=circle];
\path ( 400,0) node (P0) {};
\path (60:400)  node (P1) {};
\path (120:400) node (P2) {};
\path ( -400,0) node (P3) {};
\path ( -200,-346) node (P4) {};
\path ( 200,-346) node (P5) {};
\path (330:220) node (P6) {};
\path (270:220) node (P7) {};
\path(210:220) node (P8) {};
\path (30:220) node (P11) {};
\path (150:220) node (P9) {};
\path (90:220) node (P10) {}; 
%Draw edges:
\draw
  (P0) -- (P5)
  (P0) -- (P1)
  (P0) -- (P11)
  (P0) -- (P6)
  (P1) -- (P2)
  (P1) -- (P10)
  (P1) -- (P11)
  (P2) -- (P3)
  (P2) -- (P9)
  (P2) -- (P10)
  (P3) -- (P4)
  (P3) -- (P8)
  (P3) -- (P9)
  (P4) -- (P5)
  (P4) -- (P7)
  (P4) -- (P8)
  (P5) -- (P6)
  (P5) -- (P7)
  (P6) -- (P11)
  (P6) -- (P7)
  (P7) -- (P8)
  (P8) -- (P9)
  (P9) -- (P10)
  (P10) -- (P11)
;
}


There are some linear
  programming constraints that are immediately available to us:
\begin{enumerate}\wasitemize 
\item The angles around each node sum to $2\pi$.
\item Each angle of a triangle is $\alpha_3$.
\item Each angle of each rhombus lies between $\alpha_4$ and $\beta_4$.
\item The opposite angles of each rhombus are equal.
% not needed
%\item The sum of two adjacent angles of a rhombus lies between
%\[
%  \alpha_4 + \beta_4 \text{~~and~~} 2\,\op{azim}(2,2,2,\sqrt8,2,2).
%\]
\end{enumerate}\wasitemize 
By a linear programming \cc{}{See the glpk directory at the code repository.},
these systems of constraints are infeasible in the remaining five cases.
\end{proof}


\begin{lemma}[]\guid{YRTPQXK}\label{lemma:kiss-fcc}
  Let $V\in \CalV$ be a packing such that $\op{hyp}(V,E_{ctc})$ is
  isomorphic to the FCC or HCP contact hypermap.  Then $V$ is
  congruent to the FCC or HCP configuration in $S^2(2)$.
\end{lemma}
\indy{Index}{HCP}%
\indy{Index}{FCC}%
\indy{Index}{kissing configuration}%
\indy{Index}{contact!full}%
\indy{Index}{hypermap}%

\begin{proof} Every face of the hypermap of $(V,E_{ctc})$ is a
  triangle or quadrilateral.  The eight triangles in the FCC or HCP
  contact hypermap determine eight equilateral triangles in $V$ of
  edge length $2$.  The eight triangles rigidly determine $V$ up to
  congruence.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:fc}]  %[Packings with Full
  % Contact]
  The contact hypermap of a packing with full contact has tame
  contact.  By Theorem~\ref{lemma:fcc-ft}, this hypermap is that of
  the FCC or HCP.  By Lemma~\ref{lemma:kiss-fcc}, the kissing
  configuration of the packing is congruent to the FCC or HCP.  As the
  center of the packing may be chosen at an arbitrary point in the
  packing, every point in the packing is congruent to one of these two
  arrangements.  The result ensues.
\end{proof}


\begin{exer}
  Recently, Musin and Tarasov solved the Tammes problem for $k=13$
  points on a sphere in dimension $n=2$~\cite{Musin-Tarasov}.  In
  parting, we leave it as a challenging problem to adapt their
  solution to the framework of this book to obtain an independent
  solution to the Tammes problem.
\end{exer}
