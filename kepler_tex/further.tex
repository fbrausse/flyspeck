%------------------------------------------------------------
% Author: Thomas C. Hales
% Format: LaTeX
% Book Chapter: Dense Sphere Packings
%------------------------------------------------------------

\chapter{Two Further Results}


\section{Strong Dodecahedral Theorem}

K. Bezdek has conjectured that the Voronoi cell of smallest surface is
the regular dodecahedron with inradius $1$.  This is known as the
strong dodecahedral conjecture.  
\indy{Index}{Bezdek, K.}%
\indy{Index}{Voronoi cell}%


\begin{theorem}[strong dodecahedral conjecture]\guid{CODE}
The surface area of a Voronoi cell in a packing is at least the surface area of the regular dodecahedron
with inradius $1$.
\end{theorem}
\indy{Index}{dodecahedral conjecture}
\indy{Index}{dodecahedral conjecture!strong}

This section sketches a proof of the strong dodecahedral theorem.    We begin with some
simple observations.

\begin{remark}
If a packing is not saturated, then the surface area of a Voronoi cell may be infinite.  \claim{In fact,
there is no loss of generality in restricting our attention to saturated packings.} Indeed,
consider a new facet $F$ that is created on a Voronoi cell 
by the addition of a new point to the packing $V$.
Let $X$ be the polygonal boundary of the new facet.  
The area minimizing surface that has $X$ as a boundary is the facet $F$.  Thus the new facet
replaces a surface of larger area with a surface of smaller area.
That is, by saturating a packing,
the surface area of a Voronoi cell can only decrease.  
\end{remark}


\begin{lemma}[]\guid{JXVEXXV}
The surface area of the Voronoi cell $\Omega(V, \u_0)$ is at least that
of $\Omega(V, \u_0)\cap B$, where
 $B$ is the ball of radius $1.26$ centered at $ \u_0$.
\end{lemma}
\indy{Index}{surface area}%
\indy{Index}{Dodecahedral Conjecture}%

\begin{proof} The surface element for a parametrized surface $r(\theta,\phi)$ in
spherical coordinates is
\begin{displaymath}
% ff = {r[theta, phi] Cos[theta]Sin[phi], r[theta, phi] Sin[theta]Sin[phi], r[theta, phi] Cos[phi]};
%n = Cross[D[ff, theta], D[ff, phi]];
%n.n // Simplify
%
r \sqrt{r_\theta^2 + (r^2 + r_\phi^2)\sin^2\phi } \,\,d\theta\,d\phi \ge r_0^2 \sin\phi\, d\theta\,d\phi,
\end{displaymath}
when $r(\theta,\phi)\ge r_0$.
The right-hand side is the surface element of a sphere of radius $r_0$.
Hence projection of a surface outside sphere onto the sphere is area decreasing.
\end{proof}


L. Fejes T\'oth's classical
dodecahedral conjecture asserts that the Voronoi cell of smallest
volume is the regular dodecahedron of inradius $1$.
\indy{Index}{fejestoth@Fejes T\'oth, L.}%
\indy{Index}{Dodecahedral Conjecture}%
The strong dodecahedral conjecture yields the dodecahedral conjecture as a corollary.

\begin{lemma}[]\guid{QRBKJAW}
If the surface area of a Voronoi cell is at least the surface area of a regular dodecahedron with
inradius $1$,
then the volume of a Voronoi cell is at least the volume of a regular dodecahedron.
\end{lemma}

\begin{proof} Let $A_1,\ldots,A_n$ be the areas of the faces of a
  Voronoi cell.  Let $h_1,\ldots,h_n$ be the distances of the faces
  from the center of the Voronoi cell.  Then $h_i\ge 1$.  Assume that
  $\sum A_i \ge A_D$, where $A$ is the surface area of a dodecahedron.
  Then its volume is
\begin{displaymath}
\op{vol} = \sum A_i h_i/3 \ge \sum A_i/3 = \op{vol}_D,
\end{displaymath}
where $\op{vol}_D$ is the volume of the regular dodecahedron.
\end{proof}
\indy{Index}{regular dodecahedron!volume}%
\indy{Notation}{A@$A$ (Voronoi cell face area)}%
\indy{Notation}{V@$\op{vol}_D$ (volume of dodecahedron)}%


\subsection{$D$-cells}



The
notaton follows Section~\ref{sec:rogers}.  Let $V$ be a saturated packing.

Let $\Omega( V,\u_0)$ be a Voronoi cell.  Rogers's partition of the cell
is
\begin{displaymath}
\Omega(V, \u_0) = \bigcup_{ \bu\in  \bV(3), \trunc{\bu}{0}= [\u_0] } R( \bu).
\end{displaymath}
\indy{Notation}{ZZZomega@$\Omega$ (Voronoi cell)}%
\indy{Index}{Rogers's partition}%


Define $D_k$-cells for $k=2,3,4$, for each $ \bu=[\u_0;\ldots;\u_3]\in \bV(3)$.
Recall that $B$ is the ball of radius $1.26$ centered at $ \u_0$.  If $\bu =[\u_0;\u_1;\u_2;\u_3]\in \bV(3)$, let
$b(\bu) = h([ \u_0; \u_1; \u_2])$.
\indy{Notation}{D@$D_k$}%
\indy{Index}{D-cell}%

\begin{definition}[$D_4$]
Define a $D_4$-cell to be empty unless $h(\bu)<1.3$.  If
$h(\bu)<1.3$ define it to be
\begin{displaymath}
D_4(\bu)=\bigcup_{\omega( \bu)=\omega(\bv),  \v\in  \bV(3),\ \trunc{\v}{0}= \trunc{\u}{0}}  R(\v)\cap B.
\end{displaymath}
\indy{Index}{edge!length}%
\end{definition}

The $D_4$-cell is equal to
\begin{displaymath}
\op{conv}\{ \u_0, \u_1, \u_2, \u_3\} \cap \Omega(V, \u_0)\cap B.
\end{displaymath}
The circumradius function ($\rad$) is monotonic in the edge lengths when $h(\bu)<1.3$.  If
any edge $\norm{ \u_i}{ \u_j}$ is greater than $2.52$, then 
\begin{displaymath}
h(\bu) > \rad(2,2,2,2,2,2.52) > 1.3.
\end{displaymath}  
Hence all edges of $\op{conv}\{\u_0,\ldots,\u_3\}$ have
length at most $2.52$.

\begin{definition}[$D_3$]
Define the $D_3$-cell to be empty unless $h(\bu)\ge 1.3$ and
$b(\bu)< 1.26$.  If $h(\bu) \ge 1.3$ and $b(\bu)< 1.26$, there is a unique point $\xi$
on the segment from $\omega( \trunc{\bu}{2})$ to $\omega(\bu)$ at distance $1.3$ from $
\u_0$.  Let
\begin{displaymath}
R_1( \u) = \op{conv}(\{ \u_0,\omega( \trunc{\bu}{1}),\omega( \trunc{\bu}{2}),\xi\} ),\ 
R_2( \u) = \op{conv}(\{ \u_0,\omega( \trunc{\bu}{1}),\xi,\omega( \u)\} ).
\end{displaymath}
Let $ \bu' = [ \u_0; \u_2; \u_1; \u_3]$.
Define the $D_3$-cell to be
\begin{displaymath}
D_3(\bu) = (R_1( \bu) \cup R_1( \bu'))\cap B.
\end{displaymath}
\end{definition}

The condition $b(\bu)< 1.26$ implies the constraint $\norm{ \u_i}{ \u_j}<
2.62$, for $i,j\in\{0,1,2\}$.

\begin{definition}[$D_2$]
If the $D_4$ cell and $D_3$ cell of $\bu$ are empty (that is, if $b(\bu)\ge 1.26$), then
let the $D_2$ cell be $D_2(\bu)=R(\bu)\cap B$.  Otherwise $b(\bu)< 1.26$ and $h(\bu) \ge 1.3$.
In this case, let the $D_2$ cell be the remainder: $D_2(\bu)=R_2(\bu)\cap B$.
\end{definition}

\begin{lemma}[]\guid{ZERRZRM}
Let $V$ be a saturated packing and let $\u_0\in V$.
 The intersection of two distinct $D_k$-cells is a null set.  The union
  of all the $D_k$-cells at $\u_0$ is $\Omega(V, \u_0)\cap B$.
\end{lemma}
\indy{Index}{null set}%

\begin{proof} This is clear from the construction.  Each null set is in fact a subset of a plane.
\end{proof}

Every cell $D_k(\bu)$ is eventually radial at $ \u_0$ and has
a well-defined solid angle $\sol(D_k(\bu))$.
Every cell $D_k(\bu)$ has an {\it exposed} surface area $\op{surf}(D_k(\u))$.
This is the area of the intersection of the boundary of 
$\Omega(V, \u_0)\cap B$ with $D_k(\bu)$.  It consists of the sum of the
areas of the analytic facets (linear or spherical surfaces) that do not meet the point $ \u_0$.
The total surface area of $\Omega(V,\u_0)$ is the sum of the exposed surface
areas $\op{surf}(D_k(\u))$.
\indy{Index}{exposed}%
\indy{Index}{surface area!exposed}%
\indy{Notation}{surf@$\op{surf}$}%
\indy{Notation}{solidangle@$\sol$ (solid angle)}%


Every cell $D_k(\bu)$ has a set $E(k,\bu)$ of distinguished edges (that is, the edges of the
cell that have an endpoint at $\u_0$)  and a
dihedral angle $\dih(e)$ for $e\in E(k,\bu)$.  Each edge has a length
$h(e)\in\leftclosed1,1.26\rightclosed$.  \indy{Index}{angle!dihedral}%
\indy{Notation}{dih}%
\indy{Index}{edge!length}%
\indy{Notation}{E@$E$ (edge)}%

\subsection{local inequality}

The strong dodecahedral conjecture reduces to a kissing estimate and a local inequality.
\indy{Index}{kissing estimate}%


\begin{definition}[$a_D$,~$b_D$,~$y_D$,~$v_D$,~$f$]\guid{TCOSFNQ}
Define constants $a_D$, $b_D$, $y_D$, and functions $v_D$, $f$ as follows.  Let $y_D$ be defined
by the condition
\begin{displaymath}
\sol(2,2,2,y_D,y_D,y_D) = \pi/5.
\end{displaymath}
For any $\u_i\in\ring{R}^3$,   let $g(\u_0,\u_1,\u_2,\u_3)$ be
the volume of the intersection of the convex hull of $S=\{\u_0,\ldots,\u_3\}$ with set of
points closer to $ \u_0$ than to any other point in $S$.  
When 
\begin{equation}\label{eqn:uy}
\norm{\u_0}{\u_i}=2\text{ and }\norm{ \u_i}{ \u_j} = y\text{ for }i,j\ge 1,
\end{equation} 
this
volume depends only on $y$. Write $v(y) = g(\u_0,\ldots,\u_3)$.  Set
\begin{displaymath}
f(y) = v(y) + a \sol(2,2,2,y,y,y) + 3 b \dih(2,2,2,y,y,y).
\end{displaymath}
The linear system
\begin{equation}\label{eqn:fyD}
f(y_D) = 0,\quad f'(y_D) = 0
\end{equation}
has a unique solution in $a,b$ with values $a=a_D=-0.581\ldots$,
$b=b_D=0.0232\ldots$.
\end{definition}
\indy{Notation}{a@$a_D$ (dodecahedral parameter)}%
\indy{Notation}{b@$b_D$ (dodecahedral parameter)}%
\indy{Notation}{yd@$y_D$ (dodecahedral parameter)}%
\indy{Notation}{yd@$v_D$ (dodecahedral function)}%
\indy{Index}{convex hull}%
\indy{Index}{regular dodecahedron!volume}%

Note that the regular dodecahedron has volume $20 v(y_D)$ and surface
area $60 v(y_D)$.  Also,
\begin{equation}
2\sol(2,2,2,y_D,y_D,y_D) =\dih(2,2,2,y_D,y_D,y_D)=2\pi/5.
\end{equation}
\indy{Index}{regular dodecahedron}%
\indy{Index}{regular dodecahedron!surface area}%

\begin{lemma}[local inequality]\guid{CODE}\label{lemma:D-local}  
For any cell $D_k(\bu)$
\begin{displaymath}
\op{surf}(D_k(\bu)) + 3 a_D \sol(D_k(\bu)) + 3 b_D \sum_{e\in E(k,\bu)} L(h(e)) \dih(e) \ge 0,
\end{displaymath}
where $L$ is the function of Definition~\ref{def:L}.
Equality  holds precisely when the cell is a $4$-cell with edges
$(2,2,2,y_D,y_D,y_D)$.
\end{lemma}
\indy{Index}{local inequality}%

\begin{remark}
  The dimension of a $k$-cell is at most $6$.  The local cell inequality is
within reach of interval arithmetic computer calculations.  
For a cell $D_4(\bu)$ whose parameters have the
form \eqn{eqn:uy},  the local inequality reduces to the inequality $f(y)\ge 0$.  The 
constants $a_D$ and $b_D$ were chosen so that $y=y_D$ is a critical point of $f$ with value
$f(y_D)=0$.  In particular, the local inequality asserts that $f$ has a local minimum at $y=y_D$.
\end{remark}

\begin{lemma}[]\guid{OIEKCEZ}
  The local inequality and the kissing number estimate \eqn{conj:L12} 
\begin{displaymath}
\sum L(h) \le 12
\end{displaymath}
imply the strong dodecahedral conjecture.
\end{lemma}

\begin{proof} 
  Sum the local inequality over all the $D_k$-cells in a Voronoi cell.
  The solid angles sum to $4\pi$ and the dihedral angles around each
  edge sum to $2\pi$:
\begin{eqnarray*}
\op{surf}(\Omega) &\ge& \op{surf}(\Omega\cap B)\\
&=&\sum_{k,\bu} \op{surf}(D_k(\bu))\\
&\ge& -12\pi a_D - 6\pi\, b_D  \sum L(h)\\
&\ge& -12\pi a_D - 72\pi\, b_D\\
&=& -60 \sol(2,2,2,y_D,y_D,y_D) a_D - 180 \dih(2,2,2,y_D,y_D,y_D) b_D\\
&=& 60 (v(y_D) - f(y_D))\\
&=& 60 v(y_D).\\
\end{eqnarray*}
The final term is the surface area of a regular dodecahedron.
\end{proof}

Thus, the strong dodecahedral conjecture follows from the same kissing
number estimate that is used to prove the Kepler conjecture.  The case
of equality in these inequalities occurs only for the regular
dodecahedron.

\newpage
\section{Fejes T\'oth's Full Contact Conjecture}



Call a nonempty packing $ V$ in $\ring{R}^3$ in which every point has
distance $2$ from $12$ other points a {\it packing with full
  contact}. L Fejes T\'oth has conjectured the following.
\indy{Index}{packing!full contact}%
\indy{Index}{full contact}%
\indy{Notation}{V@$V$ (packing)}%


\begin{theorem}[Packings with Full Contact]\guid{BDEDUTL}\label{thm:fc} 
Let $ V$ be a packing with full
  contact.  Then for every point $ \u\in V$, the arrangement of $12$
  around that point is the kissing configuration of the face-centered
  cubic or hexagonal-close packing.
\end{theorem}
\indy{Index}{packing!hexagonal}%
\indy{Index}{packing!face-centered cubic}%
\indy{Index}{kissing configuration}%

This section  sketches a proof of this result.  


\begin{lemma}[]\guid{LIHVTRE} \label{lemma:gap}
Let $V$ be any packing with full contact, and let $\u\ne\v\in V$.
Then $\norm{\u}{\v}=2$ or $\norm{\u}{\v} \ge 2.52$.
\end{lemma}
\indy{Index}{packing!full contact}%
\indy{Index}{full contact}%

\begin{proof} Let $ \u_1,\ldots, \u_{12}$ be the twelve kissing
  points around $\u$.   Assume that $\u\ne \u_i$.  By Assertion~\ref{conj:L12}, 
\begin{displaymath}
  12 + L(h( \u, \v)) 
= \sum_{i=1}^{12} L(h( \u, \u_i)) + L(h( \u, \v)) \le 12.
\end{displaymath}
This imples that $L(h( \u, \v))\le 0$, so $\norm{ \u}{ \v}\ge 2.52$.
\end{proof}

A packing $V$ may always be translated so that $\orz\in V$.   We study the structure
of a kissing configuration centered at $\orz$ whose points have the 
separation property of Lemma~\ref{lemma:gap}.

\begin{definition}[$S^2(2)$,~$\CalV$]
Let $S^2(2)$ be the sphere of radius $2$, centered at $\orz$.
Let $\CalV$ be the set of packings $V\subset \ring{R}^3$ such that
\begin{itemize}
\item $\card(V) = 12$,
\item $V\subset S^2(2)$.
\item $\norm{\u}{\v} \in \{0,2\}\cup \leftclosed2.52,\infty\rightopen$, for all $\u,\v\in V$.
\end{itemize}
\indy{Notation}{V@$\CalV$ (twelve sphere configurations)}%
\indy{Notation}{S@$S^2(2)$ (sphere of radius $2$)}%
\end{definition}

The strategy of the proof will be to
classify the hypermaps of the contact fan $(V,E_{ctc})$, for $V\in \CalV$.  The classification will contain two
hypermaps, the contact hypermap of the face-centered cubic (FCC) and the contact hypermap of
the hexagonal close packing (HCP).  From this, the proof of Fejes T\'oth's conjecture will follow.

The classification result is analogous to the classification result that we have already obtained
for tame hypermaps.  This suggests that we should develop a proof along exactly the same lines
as earlier chapters.  We will define a new collection of hypermaps whose properties are
analogous to those defining a tame hypermap.  We will define \newterm{hypermaps with tame contact}
to be hypermaps in this new collection.  A computer generated classification of these hypermaps
will show that there are only a few possibilities.  Those other than the FCC and HCP hypermaps
will be eliminated by linear programming methods.

\subsection{main estimate}




We use the function $\tau(V,E,F)$ from Definition~\ref{def:tau}.  When
$V$ is a packing, $(V,E)$ is a biconnected graph, and $V\subset S^2(2)$,
the function $\tau(V,E,F)$ takes the following form:
\begin{displaymath}
\tau(V,E,F) = \sol(U_F) + (2-k(F)) \sol_0,
\end{displaymath}
%\indy{Notation}{ZZtauf@$\tau(V,E,F)$ (contact fans)}%
%\indy{Index}{kissing configuration}%

\begin{remark}[Lexell's theorem]
It is a consequence of Lexell's theorem that the area of a spherical triangle, viewed
as a function of its edge lengths, does not have a interior point local minimum when the
the edge lengths are constrained to lie in given intervals.  The minimum occurs at a point where
each edge length lies at an endpoint of its interval.  Lexell's theorem is a considerable
aid in finding the minimum of $\sol(U_F)$ or $\tau$.
\end{remark}

The next theorem is the analogue for packings with full contact of the
main estimate (Lemma~\ref{lemma:empty-d}).  It is similar to the
main estimate in Leech's proof of the problem of $13$-spheres
\cite{Leech:1956:MG}.


\begin{theorem}\guid{VGJDQJV}\label{lemma:main-estimate-12} 
Let $V$ be a packing in $S^2(2)$, $E$ a set of edges, and $F$ a face of $\op{hyp}(V,E)$ such
that  $(V,E,F)$ is a local fan.
Assume that $(V,E)$ is a biconnected graph.  
Assume that  $F$ has at leas three darts
Assume that  every edge in $E$ has
length at most $3.2$.
 Let $S$ be a subset of $E$ such that the length of every edge in $S$
is at least $2.52$.
Let $U=U_F$ be the topological
component of $Y(V,E)$ corresponding to $F$.
   Assume that if $\{\u,\v\}\subset V$ with
$C^0\{\u,\v\}\subset U$ and $2\le\norm{\u}{\v} \le 2.52$, then $\{\u,\v\}\in E$.
Then
\begin{displaymath}\tau(V,E,F) \ge \min(d(r,s),\op{tgt})\end{displaymath}
where 
\begin{displaymath}
d(r,s) = 0.103 (2-s) + 0.277 (r+2s-4),
\end{displaymath}
$\op{tgt}=1.541$, 
$s = \card(S)$, and $r = \card(E)-\card(S)$.
%\indy{Notation}{d@$d$ (contact weight constant)}
\indy{Notation}{tgt@$\op{tgt}=1.541$}
\end{theorem}

\begin{proof} This proof imitates the proof of the main estimate from
  \cite{Hales:2006:DCG}.  Here is a review of the method.  (Compare Chapter~\ref{sec:local}.)

  For a contradiction, let the packing $(V,E,F,S)$  violate the given inequality.
  Among all counterexamples to the theorem, we may assume that $(V,E,F,S)$ is a counterexample that
  minimizes $k=r+s$.  Let $k_{min}$ be the smallest value attained.



\claim{There exists a counterexample that minimizes
\begin{equation}\label{eqn:td}
\tau(V,E,F)-\min(d(r,s),\op{tgt})
\end{equation}
among all (local) counterexamples that have parameters that satisfy $k_{min}=r+s$.}  Indeed,
a compactness argument shows that a sequence tending to the minimum value has a convergent
subsequence.  (Compare Lemma~\ref{lemma:compact-fan} and Lemma~\ref{lemma:c-bound}.) 

We may assume that the counterexample $(V,E,F,S)$ is local and minimal in this sense.

\claim{In a minimal counterexample, all edges of length at least $2.52$ belong to $S$.}  Indeed,
$d(r-1,s+1)>d(r,s)$.

  \claim{A minimal counterexample $(V,E,F,S)$ does not have any edges
  $\ee=\{\u,\v\}\subset V$, satisfying $C^0(\ee)\subset U$ and $\norm{\u}{\v}\le 3.2$.}
  Otherwise, $\ee$
  may be added to the edge set of the
  fan.    The face $F$ splits into two faces $F_1$ and $F_2$.
  By  the additivity of the constants $d(r,s)$ (analogous to
  Equation~\ref{eqn:drs}), one of the two faces $F_1$ or $F_2$ is a counterexample as well.
  This is contrary to the assumed minimality of $F$: $k(F_1),k(F_2)<k_{min}=k(F)$.  

%\claim{In a minimal counterexample $(V,E,F,S)$ every edge is extremal.  That is every edge
%in $S$ has length $2.52$ or $3.2$ and every edge in $E\setminus S$ has length $2$.}
%Indeed, this follows by Lexell's theorem.

  Call a dart $x\in F$ \newterm{concave} or \newterm{convex}, according to whether
  $\op{azim}(x)\ge\pi$ or $\op{azim}(x)<\pi$.  
\indy{Index}{concave dart}%
\indy{Index}{convex dart}%

\claim{In a minimal counterexample $(V,E,F)$, if $x$ is a concave dart at a node $\v\in V$, then
both edges at $\v$ have length $3.2$.}  Indeed, if both edges at $\v$ have length less than $3.2$,
there exists a deformation of the local fan $(V,E,F)$ that fixes every node except $\v$, and
decreases the solid angle $U_F$.  This cannot be a minimizing counterexample.  Now assume that
one of the edges $\{\v,\u\}$ has length $3.2$.  Let $\{\v,\w\}\in E$ be the other edge.  By minimality
it has extremal length $2,2.52$, or $3.2$.  Let $y=\norm{\u}{\w}$.  We compare the areas of the possibilities
as a function of $y$, and check that the largest area occurs when $\norm{\v}{\w}=3.2$.  (The triangle has largest area when $U_F$ has smallest area because we are at a concave dart.)
%% CALC XX  Calculation.

\claim{In a minimal counterexample,  some dart is concave.}  Otherwise, every dart is convex.
Every edge has
arclength at least $\arc(2,2,2)=\pi/3$.  By
Lemma~\ref{lemma:convex-hyp}, the cardinality $k$ of $E$ satisfies
$(\pi/3)(r+s) < 2\pi$, so $r+s\le5$.   (The inequality is strict for a generic fan.)  
By Lexell's theorem, the five edges have extremal lengths.
That is every edge
in $S$ has length $2.52$ or $3.2$ and every edge in $E\setminus S$ has length $2$.
The only remaining degrees of freedom are the lengths of
diagonals.  As the polygon is at most a pentagon, the proof has now
been reduced to a finite number of interval arithmetic verifications
of dimension at most $2$.  
%% CALC XX Calculation.

\claim{The theorem holds when $r+s\le6$ and there is a concave dart.}  Indeed, a
  half disk of arcradius $\arc(2,2,3.2)=1.854\ldots$ fits inside the
  region.  It has area
\begin{displaymath}
\pi(1-\cos(\arc(2,2,3.2)))=4.02\ldots.
\end{displaymath}
This gives
\begin{displaymath}
\tau(V,E,F) > 4.02 + (2-k)\sol_0 \ge 4.02 -4 \sol_0 > \op{tgt}.
\end{displaymath}
\indy{Index}{arcradius}%


\claim{The theorem holds when $r+s>6$ and there are at least two concave darts.} Indeed, 
let $k'',k'$ be the number of concave and convex darts respectively.
Calculations~\cite[cc:lft]{hales:2009:nonlinear} show that the azimuth
angle at each convex darts is at least $1.73$.  Place a (wedge if
angle $1.73$ of a) disk at each convex dart of arcradius $\pi/6$, and
a half disk at each concave dart of arcradius $\arc(2,2,3.2)-\pi/6$.
These regions are disjoint and their combined area is less than
$\sol(F)$.  Hence
\begin{displaymath}
\begin{array}{lll}
\tau(V,E,F)&=\sol(F)+(2-k''-k')\sol_0 \\
&\ge \pi k'' (1-\cos(\arc(2,2,3.2)-\pi/6)) \\
&\qquad+ 1.73 k' (1-\cos(\pi/6)) + (2-k''-k')\sol_0.
\end{array}
\end{displaymath}
The total number of darts is at most the total number of nodes, which
is at most $12$.  The rightmost term is at least $\op{tgt}$ if $k''\ge
2$.   

\claim{The theorem holds when $r+s>6$ and there is one concave dart.} Indeed,
as in~\cite{Hales:2006:DCG}, $k''=1$ implies that the region is star
convex about the concave node.  This allows us to deform without
obstruction from other nodes.  The dart $y$ adjacent to the concave
dart $z$ can be deformed by decreasing the distance between it and
$z$, to decrease the solid angle of $U$.  In turn, the concave dart
can be deformed further to increase the distance between it and $y$,
to decrease the solid angle of $U$.  This shows that the function
$\tau$ has no local minimum among such arrangements, and the proof
necessarily reduces to a case previously considered.  
\indy{Index}{star convex}%
\indy{Index}{convex!star}%


The various claims cover all possible cases.  This completes
the proof.
\end{proof}


\subsection{aggregate fans}

One may create aggregate fans in the same way as in
\cite{Hales:2006:DCG} so that each face is simple.  Here is a review
of the construction.  

\begin{definition}
If $V\in\CalV$, with contact fan $(V,E_{ctc})$, then we say that $E$ is \newterm{admissible} if
\begin{itemize}
\item $(V,E)$ is a fan,
\item $E_{ctc}\subset E$, and
\item if $\{\u,\v\}\in E\setminus E_{ctc}$, then $2.52\le\norm{\u}{\v}\le 3.2$.
\end{itemize}
\indy{Index}{fan}%
\indy{Index}{fan!aggregate}%
\end{definition}

\begin{lemma} Let $V\in \CalV$.  Then there exists  $V'\in \CalV$ with the following
properties.
\begin{itemize}
\item There is a bijection $\phi:V'\mapsto V$ that induces a bijection of contact graphs:
\[
\phi_*:(V,E_{ctc}) \cong (V',E'_{ctc}).
\]
\item Let $E'_{cut}$ be the set of all pairs $\{\u,\v\}\subset V'$ such that $2.52\le\norm{\u}{\v} <\sqrt8$.
Set $E'_{agg} = E'_{ctc}\cup E'_{cut}$.
Then $(V',E'_{agg})$ is a fan.
\item $\op{hyp}(V',E'_{agg})$ is biconnected.
\end{itemize}
\end{lemma}

\begin{proof}
Begin with the contact fan $(V,E_{ctc})$.
Let $E_{cut}$ be the set of all pairs $\{u,\v\}\subset V$ such that $2.52<\norm{\u}{\v}<\sqrt8$.

\claim{$(V,E_{ctc}\cup E_{cut})$ is a fan.} Indeed, it is checked by
\cite[Lemma~4.30]{Hales:2006:DCG} that the blades satisfy the
intersection property of fans, except possibly when two new blades are
the diagonals of a quadrilateral face in $(V,E_{ctc})$.  (The cited lemma
uses the constant $2.51$ instead of $2.52$, but this does not affect
the outcome.)  The diagonals of a quadrilateral face in $(V,E_{ctc})$
is a spherical rhombus and one of its diagonals is necessarily at
least $\sqrt8$ (with extreme case a square of side $2$).  The other
fan properties are easily checked.

If the hypermap $\op{hyp}(V,E_{ctc}\cup E_{cut})$ is not connected,
the set of nodes $V_1\subset V$ in one combinatorial component can be
moved closer to another combinatorial component until a new edge is
formed.  This can be done in a way that the deformation of $V$ remains
in $\CalV$ and no new edges $E_{ctc}$ are formed.  Continuing in this
fashion, a connected hypermap is obtained.

Further deformations within a connected hypermap produce a biconnected
hypermap with the given properties.
\end{proof}

It is better to work with the packing $V'$ and fan $(V',E'_{agg})$
rather than $V$.  For simplicity, we now drop the primes from the
notation.  Call $(V,E_{agg})$ the \newterm{aggregate fan},
$\op{hyp}(V,E_{agg})$ the \newterm{aggregate hypermap}, and so forth.
By Lemma~\ref{lemma:fan-plain}, the hypermap is plain, has no loops or
double joins.  The edge permutation $e$ of the hypermap has no fixed
points.  Each face has at least two darts.  In a biconnected planar graph, each face is a simple polygon.
The blades of the fan satisfy the \case{intersection} property, and this implies that the hypermap
is planar.

\claim{We claim that every face has at least three darts.}  Otherwise, if some face
has only two darts, then because of the no double join condition, the
two edges $\{x, e x\}$ and $\{ e^{-1} f^{-1} x, f^{-1} x\}$ must actually
be equal.  That is $ x = f e x = n^{-1} x$, so that $x$ is a fixed
point of the node map.  Similarly, $f x$ is a fixed point of the node map.  Then
$\{x, f x\}$ is a combinatorial component, which is contrary to the assumption that
the hypermap is connected with twelve nodes.

In summary, we may work without generality with packings in the following collection.

\begin{definition}[$\CalV_1$]
  Let $\CalV_{agg}$ be the set of packings $V$ in $\CalV$ such that
  $H=\op{hyp}(V,E_{agg})$ has the following properties:
\begin{itemize}
\item $H$ is  biconnected.
\item $H$ is plain, has no loops or double joins.
\item The edge map $e$ of $H$ has no fixed points.
\item Every face of $H$ has at least three darts.
\item Every face of $H$ is simple.
\item $H$ is planar.
\end{itemize}
\end{definition}



\subsection{biconnectedness}

Let $V\in \CalV_1$.  Let $U$ be a topological component of
$Y(V,E_{ctc})$ and let $D_U$ be the set of all darts that lead into
$U$.  It is a union of faces of $\op{hyp}(V,E_{ctc})$.  For each $x\in
D_U$, let $m = m(x) >0$ be the smallest natural number such that $f^m
x$ and $x$ lie at the same node.  The constant $m$ can be viewed as
{\it simplified face size}.  Let $m_U$ be the maximum of $m(x)$, as
$x$ runs over $D_U$.  \indy{Index}{contact!full}%
\indy{Index}{fan}%
\indy{Notation}{m@$m$ (simplified face size)}

\begin{lemma}[]\guid{VDUBAWF}\label{lemma:DU} If $m_U\le 5$, then 
$D_U$ is a simple face.
\end{lemma}
\indy{Index}{face!simple}%

\begin{proof} Assume to the contrary that either the face is not
  simple or there is more than one face that leads into $U$.  Then
  there is some node $\v$ interior to the $m(x')$-gon.  The azimuth
  angles at $\v$ are each less than $2\pi/5$. They cannot sum to $2\pi$
  as required.
\end{proof}

Consider possible aggregates with $m_U\ge 6$ and $d(r,s)<\op{tgt}$.
From the classification of \cite[p.~126,~Fig.~12.1]{Hales:2006:DCG},
and the inequalities $d(9,0) > \op{tgt}$, $d(6,2) > \op{tgt}$, it
follows that the set $D_U$ is either simple with at most $8$ darts, or
a nonsimple face $F$ with $8$ darts and $m_U=6$.

\begin{lemma}[]\guid{BTZPFMU}\label{lemma:simple} $D_U$ is a
simple face.
\end{lemma}
\indy{Index}{face!simple}%
\indy{Index}{hypermap}%

\begin{proof} One case remains: $8$ darts and $m_U=6$.  Suppose this
  occurs in a contravening fan.  This arrangement involves $7$ nodes:
  the six nodes counted by $m_U$ and the node in the center of the
  hexagonal arrangement.  As there are $12$ nodes in all, there are
  five additional nodes.  Each of these five nodes meets a
  non-triangular region.  The total weight is then at least
\begin{eqnarray*}
d(8,0) + d(5,0) &>& \op{tgt}\hbox{ or }\\
d(8,0) + 2 d(4,0) &>& \op{tgt}\\
\end{eqnarray*}
\end{proof}
\indy{Index}{weight!total}%
\indy{Index}{weight}%

\begin{lemma}[biconnected]\guid{CODE}\label{lemma:biconnected}
Let $V\in \CalV_1$.  Then $\op{hyp}(V,E_{ctc})$ is biconnected.
\end{lemma}

\begin{proof}
  If the hypermap is not connected, then two faces of the hypermap
  lead into the same topological component of $Y(V,E_{ctc})$.  If the
  hypermap is connected but not biconnected, then some face of the
  hypermap is not simple.  Thus, Lemma~\ref{lemma:simple} implies the
  results.
\end{proof}




\begin{remark}\label{rem:local-same} %XX move
  Localize the fan $(V,E)$ along the face $F$, so that without loss of generality
   the packing $V$ consists of
  nodes that meet the face $F$.  
The assumption of biconnectedness
 implies that $\tau(V,E,F)$ takes the same value, before and after localization.
\end{remark}






\subsection{tame contact}

This subsection modifies the notion of tameness to cover hypermaps that arise as
the contact fan of a packing with full contact.  In the definition of tame hypermap, two functions
$b$ and $d$ are used.  In this section we define two new functions that are used to define
tame contact.  They will also be called $b$ and $d$ because
we have no further use for the old functions.  Recall that $\op{tgt}=1.541$.
\indy{Index}{tame}%
\indy{Index}{hypermap!tame}%

\begin{definition}[b]\guid{IHRZTPV}
  Define $b:\ring{N}\times \ring{N}\to \ring{R}$ by
  $b\pqr{(p,q)}=\op{tgt}$, except for the following values:
\begin{displaymath}
b(0,3)=b(1,3)=0.618,\quad b(2,2)=0.412.
\end{displaymath}
\end{definition}
\indy{Notation}{b@$b$ (contact weight parameter)}%

\begin{definition}[d]\guid{VUJQZCG}
Define $d:\ring{N}\to \ring{R}$ by
\begin{displaymath}d(k) = \begin{cases}
0 & k\le 3, \\
0.206 + 0.277 (k-4),& k=4,\ldots,8,\\
%0.206 & k=4, \\
%0.483 & k=5, \\
%0.760 & k=6, \\
%1.037 & k=7, \\
%1.314 & k=8,\\
\op{tgt},& k>8.\\
\end{cases}
\end{displaymath}
%(In particular, $d(k) = 
\end{definition}
\indy{Notation}{d@$d$ (contact weight parameter)}%

\begin{definition}[weight~assignment]\guid{GLIQSFM}
%
Recall that  a {\it weight assignment\/} on a hypermap $H$ is a function $\tau$
  on the set of faces of $H$, taking values in the set of non-negative
  real numbers. A weight assignment is a {\it contact} weight
  assignment if the following two properties hold:
%
\indy{Index}{weight assignment}%
\indy{Index}{contact!weight assignment}%
\indy{Notation}{ZZtau@$\tau$ (weight assignment)}%
\begin{enumerate}
\item If the face $F$ has cardinality $k$, then
$\tau(F) \ge d(k)$
\item If a node $v$ has type $(p,q,0)$, then
  \begin{displaymath}\sum_{F:\,v\cap F\ne\emptyset} \tau(F) \ge
    b{\pqr{(p,q)}}.\end{displaymath}
\end{enumerate}
The sum $\sum_F \tau(F)$ is called the {\it total weight} of $\tau$.
\indy{Index}{total weight}%
\end{definition}


\begin{definition}[tame contact]\guid{CODE}
A hypermap has {\it tame contact\/} if it satisfies the following
conditions.
%
\indy{Index}{tame contact}%
\indy{Index}{contact!tame}%
\indy{Index}{planar}%
\indy{Index}{biconnected}%
\indy{Index}{nondegenerate}%
\indy{Index}{loop}%
\indy{Index}{double join}%
%
\begin{nomerate}
%\label{definition:tame}
%1
\item \case{planar} The hypermap is plain, planar.
\item \case{biconnected} The hypermap is  biconnected.
  In particular, every face meets every node in at most one dart.
\item \case{nondegenerate} The edge map $e$ has no fixed points.
\item \case{no loops} The two darts of each edge lie in different nodes.
\item \case{no double join} At most one edge meets any two given nodes.
%The set of edges meeting any two given
%  nodes has cardinality at most $1$.
%\label{definition:tame:40}
%      \item\case{blank}
%      \item \case{triangles} If $L$ is a contour loop with $3$ face
%        steps, and if there exists a node in the exterior of $L$,
%        then $L$ is a face of the hypermap.
%\item \case{blank}
  % \item \case{quadrilaterals} If $L$ is a $4$-step contour loop, and
  %   there is at least one node in the exterior of $L$, then the
  %   interior of $L$ takes one of the forms illustrated in Figure
  %   \ref{fig:fourcircuit-FT}.
%    %\label{definition:tame:4-circuit-FT}
%    \begin{figure}[htb]
%        \centering
%        \myincludegraphics{\pdfp/fourcircuitFT.eps}
%        \caption{Tame $4$-circuits}
%        \label{fig:fourcircuit-FT}
%    \end{figure}
\item \case{face count} There are at least two faces.
\item \case{face size} The cardinality of each face is at least $3$
  and at most $8$.
%\label{definition:tame:length}
\item \case{node count} There are $12$ nodes.
\item \case{node size} The cardinality of every node is at least $2$
  and at most $4$.
%\label{definition:tame:degree}
%    \item \case{node} {\tt NO CONDITION}
%\label{definition:tame:degreeE}
\item \case{weights} There exists a contact weight assignment
of total weight less than $\op{tgt}$.
%\label{definition:tame:squander}
\end{nomerate}
%
\end{definition}


%\subsection{tame contact}

\begin{theorem}\guid{ZXZSVPH} The contact hypermap of a 
  packing $V\in \CalV_1$  is a tame contact hypermap.
\end{theorem}
\indy{Index}{hypermap!tame}%
\indy{Index}{hypermap!contact}%
\indy{Index}{hypermap}%
\indy{Index}{contact!full}%

\begin{proof} It is enough to go through the list of properties that
  define a tame contact hypermap and to verify that the contact
  hypermap satisfies each one.  

\begin{nomerate}
\item \case{planar} The contact hypermap is plain and planar by the
  general properties of fans.
\item \case{biconnected} The hypermap is biconnected because of
  Lemma~\ref{lemma:biconnected}. 
\item \case{nondegenerate}, \case{no loops}, \case{no double join} The
  edge map has no fixed points by the general properties of fans.
  There are no loops or multiple joins by the general properties of
  fans.
\item \case{face count} Each node has at least two darts by
  biconnectness. Each face is simple; so the two darts at a node lie
  in different faces.  Thus, there are at least two faces.
\item \case{face size} The cardinality of each face is at least three
  because there are no loops or multiple joins.  The cardinality of a
  face is at most $8$ because of the estimate $d(9,0)>\op{tgt}$.
\item \case{node count} There are twelve nodes by the definition of a
   packing with full contact.
\item \case{node size} It is already established that the cardinality
  of each node is at least two.  The proof that the cardinality is
  never five or greater appears in Lemma~\ref{lemma:no-5}.
\item \case{weights} The inequality $\tau(F)\ge d(k)$ is
  Theorem~\ref{lemma:main-estimate-12}.
  \indy{Notation}{ZZtauf@$\tau(F)$}%
  The total weight of the weight assignment is given by
  equation~\eqn{eqn:delta0}:
\begin{displaymath}
\sum_F \tau(F) = (4\pi - 20\sol_0) < \op{tgt}.
\end{displaymath}
\indy{Index}{weight!total}%
Let $v$ be a node of type $(p,q,0)$.  Let $A$ be the set of faces that
meet the node $v$. Then
\begin{displaymath}
\sum_{F\in A}\tau(F) > d(4)~q.
\end{displaymath}
This gives the nonzero entries in the table of bounds $b(p,q)$.  The
remaining entries follow from Lemma~\ref{lemma:no-5}.
\end{nomerate}
\end{proof}




\begin{lemma}[]\guid{CQRHDZE}\label{lemma:no-5} 
  Every node has degree at most four.  Furthermore, suppose the
  hypermap of a  packing with full contact has node of type
  $(p,q,0)$.  Then $(p,q)$ must be one of the following values:
\begin{displaymath}
(0,3)~(1,3)~(2,2).
\end{displaymath}
\end{lemma}

\begin{proof} Let $\alpha_0 = \op{azim}(2,2,2,2,2,2)$.  The azimuth
  angle of a rhombus lies between $\beta_0 =
  \op{azim}(2,2,2,2.52,2,2)$ and $\beta_1 =
  2\op{azim}(2,2,2,2,2.52,2)$.  That of an region with at least $5$
  sides is at least $\beta_0$ and at most $2\pi$.  Thus,
\begin{displaymath}
p\alpha_0 + (q+r) \beta_0 \le 2\pi \le p\alpha_0 + q\beta_1 + r 2\pi.
\end{displaymath}
The only three solutions to these inequalities among the natural
numbers $(p,q)$ with $r=0$ are those given. There is no solution for
$(p,q,r)$ in natural numbers, if $p+q+r\ge 5$.
\end{proof}






\subsection{classification}


\begin{lemma}[tame hypermap classification]\guid{CODE}\rating{ZZ}
  \label{lemma:contact-classification} Every hypermap with tame contact is isomorphic to
  a hypermap in the following list of eight hypermaps, or is
  isomorphic to the opposite of a hypermap in the list.
  \indy{Index}{isomorphic}%
\end{lemma}

\begin{proof}
The set of all hypermaps has been classified by the same computer algorithm described in
Section~\ref{sec:proof-classification}.  \indy{Index}{contact!tame}%
\indy{Index}{hypermap}%
\indy{Index}{hypermap!tame}%
\end{proof}

\begin{lemma}[]\guid{YRTPQXK}\label{lemma:kiss-fcc} Let $H$ be the
  hypermap of the face-centered cubic or hexagonal-close packing.
  Assume that it occurs as the contact hypermap of a  packing $V\in\CalV$
  with full contact.  Then the kissing configuration of the 
  packing is congruent to that of the face-centered cubic or hexagonal
  close packing.
\end{lemma}
\indy{Index}{packing!hexagonal}%
\indy{Index}{packing!face-centered cubic}%
\indy{Index}{kissing configuration}%
\indy{Index}{contact!full}%
\indy{Index}{hypermap}%

\begin{proof} Every face of the hypermap is a triangle or
  quadrilateral.  The hypermap is the same as the contact hypermap.
  The contact hypermap of the face-centered cubic and hexagonal-close
  packings fixes the eight regular triangles in the kissing
  arrangement.  The eight regular triangles fix the kissing
  arrangement up to congruence.
\end{proof}

\begin{lemma}[]\guid{MWWSZTX}\label{lemma:fcc-ft} Let $H$ be a hypermap
  with tame contact.  Assume that it occurs as the aggregate fan of a
   packing $V\subset\BB$  with full contact.  Then $H$ is the contact
  hypermap of the face-centered cubic or hexagonal-close packing.
\end{lemma}

\begin{proof} According to the classification of hypermaps with tame
  contact, there are eight hypermaps.  Two are the hypermaps of the
  FCC and HCP.  The remaining six must be eliminated.
\end{proof}

\begin{note}%%XX
  I have not eliminated the other six, but it seems fairly trivial in
  comparison with the linear programming that is required for the
  proof of the Kepler Conjecture.  There are some obvious linear
  programming constraints:
\begin{itemize}
\item the angles around each node sum to $2\pi$.
\item each angle of a triangle is $\alpha_0$.
\item each angle of each rhombus is between $\beta_0$ and $\beta_1$.
\item the opposite angles of each rhombus are equal.
\item the sum of two adjacent angles of a rhombus are between
\begin{displaymath}
\beta_0 + \beta_1 \hbox{ and } \op{azim}(2,2,2,\sqrt8,2,2)2.
\end{displaymath}
\end{itemize}
I suspect that these inequalities together possibly with equally
trivial inequalities for a pentagon will show that all but the HCP and
FCC are not feasible linear programs.
\end{note}

%\begin{theorem}[packings with full contact]\guid{ANSXBOJ}  
%Fejes T\'oth's conjecture on packings with full contact holds.
%\end{theorem}
%\indy{Index}{packing}%

\begin{proof}[Proof of Theorem~\ref{thm:fc}]  %[Packings with Full Contact] 
The contact hypermap of a  packing with full
  contact has tame contact.  By Theorem~\ref{lemma:fcc-ft}, this
  hypermap is that of the FCC or HCP.  By Lemma~\ref{lemma:kiss-fcc},
  the kissing configuration of the  packing is congruent to
  the FCC or HCP.  As the center of the packing may be chosen at an
  arbitrary point in the packing, every point in the packing is
  congruent to one of these two arrangements.  The result follows.
\end{proof}


