% global graphics definitions.

% keywords: shorten (shorten lines), pos (placing nodes on a curve)
%  positioning (for anchors)

\def\smalldot#1{\draw[fill=black] (#1) node [inner sep=1.3pt,shape=circle,fill=black] {}}
\def\graydot#1{\draw[fill=gray] (#1) node [inner sep=1.3pt,shape=circle,fill=gray] {}}
\tikzset{dartstyle/.style={fill=black,rotate=-90,inner sep=0.7pt,dart,shape border uses incircle}}

%\def\dart#1{{\node[fill=black,rotate=-90,inner sep=1.3pt,dart,shape border uses incircle] at (#1) {$a$}}}

\pgfmathsetmacro\cmofpt{(2.54/72.0)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TRIG CHAPTER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\odpcvgh{
\tikzfig{trig}{\guid{ODPCVGH} Trigonometric and inverse trigonometric
functions}
%
%arctangent function on the domain \leftopen -4,4\rightopen\ 
%and the $\arccos$ function on $\leftclosed-1,1\rightclosed$.}}
{
[scale=0.5]
\draw[gray] (-2*1.57,0) sin (-1.57,-1) cos (0,0) sin (1.57,1) cos (3.14,0) sin (3*1.57,-1);
\draw   (-2*1.57,-1) cos (-1.57,0) sin  (0,1) cos (1.57,0) sin (2*1.57,-1) cos (3*1.57,0); 
\draw[help lines,<->] (-3.3,0) -- (3*1.57 + 0.2,0);
\draw[help lines,<->] (0,-1) -- (0,2.0);
%omit tan
%\draw plot[smooth] file {tikz/tan.table};
%\node at (-0.5,-1.8) {$\tan$};
\node at (3.0,0.9) {$\sin$};
\node at (2,-1.3) {$\cos$};
% GG need axis labels and ticks, base points of labels should be precisely aligned.
\begin{scope}[xshift=10cm]
\draw plot[smooth] file {tikz/arctan.table};
\node at (2.5,1.8)  {$\arctan$};
%omit arccos:
%\draw plot[smooth] file {tikz/arccos.table};
%\node at (-1.4,1.8) {$\arccos$};
%\draw[gray,->,very thin] (-1.2,0) -- (1.4,0);
\draw[help lines,<->] (0,-1.6) -- (0,2.0);
\draw[help lines,<->] (-4,0) -- (4,0);
\end{scope}
}}

\def\ruessgq{
\tikzfig{cosadd}{\guid{RUESSGQ} A geometric derivation of the cosine addition law comes
by writing the rectangle area $(s_x+c_y)(s_y+c_x)$ as the sum of the shaded rhombus
$c_{x+y}$ and unshaded pieces
$2 s_x s_y + c_y s_y + c_x s_x$, where $s_x =\sin x$, $c_y = \cos y$, etc. The
derivation in the text is less intuitive, but avoids measure.
}
{
[scale=2.8]
\coordinate (R11) at (1.50881, 1.26604);
\coordinate (R11x) at (1.50881, 0);
\coordinate (R11y) at (0, 1.26604);
\coordinate (Rh1) at (0.866025, 0.5);
\coordinate (Rh2) at (0.642788, 0.766044);
\coordinate (Rh1x) at (0.866025, 0.0);
\coordinate (Rh1y) at (1.50881,0.5);
\coordinate (Rh2x) at (0.642788,1.26604);
\coordinate (Rh2y) at (0,0.766044);
\draw (0,0) rectangle (R11);
\draw[fill=black!40] (0,0) --(Rh1)--(R11)--(Rh2)--cycle;
%\draw[fill=black!40] (Rh1x)--(R11x)--(Rh1y)--(Rh1)--cycle;
%\draw[fill=black!40] (Rh2)--(Rh2x)--(R11y)--(Rh2y)--cycle;
\draw (Rh1x)--(Rh1)--(Rh1y);
\draw (Rh2x)--(Rh2)--(Rh2y);
\node at (0.26,0.06) {$y$};
\node at (0.07,0.2) {$x$};
\node at (1.43,1.1)  {$x$};
\node at (1.3,1.2) {$y$};
\node at (-0.1,0.37) {$c_x$};
\node at (-0.1,1.0) {$s_y$};
\node at (0.32   ,1.34) {$s_x$};
\node at (1.0,1.34) {$c_y$};
}}


\def\itgcyif{
\tikzfig{affset}{\guid{ITGCYIF}  When $\card(V)+\card(V')-1\in\{1,2\}$,
the set
$\op{aff}_+(V,V')$ 
 is a segment, ray, or line; simplex, blade, half-plane, or plane.}
{
[scale=3.0]
\begin{scope}[shift={(0,0)}]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\draw (P0)--(P1);
\smalldot{P0};\smalldot{P1};
\end{scope}
\begin{scope}[shift={(1.2,0)}]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\draw[->] (P0)--(P1);
\smalldot{P0};
\end{scope}
\begin{scope}[shift={(2.4,0)}]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\draw[<->] (P0)--(P1);
\end{scope}
\begin{scope}[shift={(0.1,-0.6)},scale=0.3]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\coordinate (P2) at (60:1);
\draw[fill=gray!40] (P0)--(P1)--(P2)--cycle;
\smalldot{P0};\smalldot{P1};\smalldot{P2};
\end{scope}
\begin{scope}[shift={(0.8,-0.6)},scale=0.3]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\coordinate (P2) at (60:1);
\begin{scope}
\clip (P0) -- (0:1.4) arc (0:60:1.4)--cycle;
\shade[fill=gray!40,shading=radial] (P0) circle (1.4); % -- (0:1.2) arc (0:60:1.2)--cycle;
\end{scope}
\smalldot{P0};\smalldot{P1};\smalldot{P2};
\draw[->] (P0) -- (P1) -- +(0.3,0);
\draw[->] (P0) -- (P2) -- +(60:0.3);
\end{scope}
\begin{scope}[shift={(1.7,-0.6)},scale=0.3]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\coordinate (P2) at (60:1);
\begin{scope}
\clip (P0) -- (0:1.75) arc (0:180:1.25)--cycle;
\shade[fill=gray!40,shading=radial] (0.5,0) circle (1.5);
%\draw[fill=gray!40,draw=gray!40] (P0) -- (0:1.7) arc (0:180:1.2)--cycle;
\end{scope}
\smalldot{P0};\smalldot{P1};\smalldot{P2};
\draw[<->] (-1,0,0) -- (2,0);
\end{scope}
\begin{scope}[shift={(2.8,-0.6)},scale=0.3]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\coordinate (P2) at (60:1);
\shade[fill=gray!40,shading=radial] (0.5,0) circle (1.5);
%\draw[fill=gray!40,draw=gray!40] (P0) -- (0:1.7) arc (0:360:1.2)--cycle;
\smalldot{P0};\smalldot{P1};\smalldot{P2};
%\draw[<->] (-1,0,0) -- (2,0);
\end{scope}
}
}


\def\likeurf{
\tikzfig{arcV}{\guid{LIKEURF} The angle $\theta =\op{arc}_V(\u,\{\v,\w\})=\op{arc}(a,b,c)$
}
{
[scale=1]
\coordinate (P0) at (0,0);
\coordinate (P1) at (1,0);
\coordinate (P2) at (60:1);
\draw[fill=gray!20,draw=gray!20] (P0) -- (0:1.3) arc (0:60:1.3)--cycle;
\smalldot{P0} node[anchor=north] {$\u$} node[anchor=south west] {~~$\theta$};
\smalldot{P1} node[anchor=north] {$\v$};
\smalldot{P2} node[anchor=south east] {$\w$};
\draw (P1)-- node[anchor= south west,fill=gray!20] {$c$} (P2) ;
\draw (P0)-- node[anchor= north] {$b$} (P1) ;
\draw (P0)-- node[anchor= south east] {$a$} (P2) ;
\draw[->] (P0) -- (P1) -- +(0.3,0);
\draw[->] (P0) -- (P2) -- +(60:0.3);
}}


\def\gjrslpt{ \tikzfig{dih}{\guid{GJRSLPT} The dihedral angle
    $\theta=\dih_V(\{\v_0,\v_1\},\{\v_2,\v_3\})$ between two planes is
    calculated by projection to a plane $P$ with normal $\v_1-\v_0$.
    The azimuth angle $\theta$ (Definition~\ref{def:azim}) is closely
    related to the dihedral angle, but depends on the ordering
    $(\v_0,\v_1,\v_2,\v_3)$ and takes values between $0$ and $2\pi$,
    unlike the dihedral angle, which takes values between $0$ and
    $\pi$.} 
{ [scale=2] 
\tikzset{sample plane/.estyle={cm={0,1,-0.5,0.5,(0,0)}}}
\begin{scope}
[sample plane,z={(-1cm,2cm)}]
\coordinate (P3) at (0,0);
\coordinate (v3) at (0,0,2) ;
\coordinate (P2) at (1.0cm,0.2cm);
\coordinate (v2) at (1,0.2,1.5);
\coordinate (P01) at (0.5,0.7);
\coordinate (v0) at (0.5,0.7,1);
\coordinate (v1)  at (0.5,0.7,2.3) ;
\node[anchor=east] at (v1) {$\v_1$};
\node[anchor=north] at (v3) {$\v_2$};
\node[anchor=south] at (v2) {$\v_3$};
\node[anchor=west] at (P01) {$\theta$};
\draw[thin,draw=white,fill=gray!30] (v1)-- (v3)-- (P3) -- (P01) -- cycle;
\draw[thin,draw=white,fill=gray!80] (v1)-- (v2)-- (P2) -- (P01) -- cycle;
\begin{scope}
\clip (P01) -- (P2) -- (v2) -- (v1) -- (v3) -- (P3) -- cycle;
\foreach \x in {0.1,0.2,...,1.0}
  {
  \draw[gray!0.2] ($(P01)!\x!(v1)$) -- ++ ($(P2)-(P01)$);
  \draw[gray!0.2] ($(P01)!\x!(v1)$) -- ++ ($(P3)-(P01)$);
  \draw[gray!0.2] ($(P01)!\x!(P2)$) -- ++ ($(v1) - (P01)$); 
  \draw[gray!0.2] ($(P01)!\x!(P3)$) -- ++ ($(v1) - (P01)$); 
  }
\end{scope}
\draw[thick] (P3) -- (P2) -- (P01) -- cycle;
\draw[thick] (P2)--(v2) -- (v1) -- (v3) -- (P3);
\draw[thick] (P01) -- (v1);
\node[anchor=north] at (v0) {$\v_0$};
\foreach \x in {{v0},{v1},{v2},{v3},{P01},{P2},{P3}} \smalldot{\x};
\draw[->,thick] (P01) -- ($(P01)!0.5!(v0)$);
\end{scope}
}}

\def\setellipseplane#1#2#3#4#5{
 % calculate great circle through p,q lying on sphere of radius R.
 % project to ellipse in xy-plane.
 \pgfmathsetmacro\r{#1} % radius of sphere, centered at origin.
 \pgfmathsetmacro\px{#2} % p = point on sphere of radius R.
 \pgfmathsetmacro\py{#3}
 \pgfmathsetmacro\pz{sqrt(\r*\r - (\px*\px + \py*\py))}
 \pgfmathsetmacro\qx{#4} % q = second point on sphere of radius R.
 \pgfmathsetmacro\qy{#5}
 \pgfmathsetmacro\qz{sqrt(\r*\r - (\qx*\qx + \qy*\qy))}
 \pgfmathsetmacro\rx{\py*\qz -\pz*\qy} % r = p x q.
 \pgfmathsetmacro\ry{\pz*\qx -\px*\qz}
 \pgfmathsetmacro\rz{\px*\qy -\py*\qx}
 \pgfmathsetmacro\nr{sqrt(\rx*\rx+\ry*\ry+\rz*\rz)} % n = unit vector direction p x q.
 \pgfmathsetmacro\nx{\rx/\nr}
 \pgfmathsetmacro\ny{\ry/\nr}
 \pgfmathsetmacro\nz{\rz/\nr}
 \pgfmathsetmacro\mx{\r*\ny/veclen(\nx,\ny)} % m= vector orth. to n in plane z=0.
 \pgfmathsetmacro\my{-\r*\nx/veclen(\nx,\ny)} % m= major axis of ellipse.
 \pgfmathsetmacro\mz{0}
 \pgfmathsetmacro\vx{\my*\nz-\mz*\ny} % v = m x n= projects to minor axis of ellipse.
 \pgfmathsetmacro\vy{\mz*\nx-\mx*\nz}
 \pgfmathsetmacro\ellrotate{atan2(\vx,\vy)}
 \pgfmathsetmacro\ellx{veclen(\vx,\vy)}
 \pgfmathsetmacro\elly{veclen(\mx,\my)}
 \tikzset{ellipse plane/.estyle={cm={\mx,\my,\vx,\vy,(0,0)}}}
}

\def\NUPFYMD{
\tikzfig{sloc}{\guid{NUPFYMD} The spherical law of cosines
gives the angle $\gamma$ of a spherical triangle in terms of
its edge lengths $a$, $b$, and $c$.  The polar form of the spherical
law of cosines gives the side $c$ in terms of the angles $\alpha$, $\beta$, and $\gamma$.}
{
[scale=1]
\def\R{1.5}
\draw[ball color=gray!10,draw=gray] (0,0) circle (\R);
\def\r{veclen(1,2)}
\coordinate (O) at (0,0);
\coordinate (A) at (0.6,-0.6);
\coordinate (B) at (0.2,0.8);
\coordinate (C) at (-0.6,-0.4);
\node[anchor=south west] at ($(C) + (1.1ex,-0.3ex)$) {$\gamma$};
\node[anchor=south east] at ($(A) + (-0.5ex,0.2ex)$) {$\alpha$};
\node[anchor=north] at ($(B) + (-0.3ex,-0.6ex)$) {$\beta$};
\path (A) -- node[anchor=north] {$b$} (C);
\path (B) -- node[anchor=east] {$a~$} (C);
\path (B) -- node[anchor=west] {$~c$} (A);
\smalldot{A};
\smalldot{B};
\smalldot{C};
\begin{scope}
\setellipseplane{\R}{0.6}{-0.6}{0.2}{0.8}
\clip (0,0) -- ($(O)!3!(A)$) -- ($(O)!3!(B)$) -- cycle;
\draw[ellipse plane] (0,0) circle (1);
\end{scope}
\begin{scope}
\setellipseplane{\R}{0.2}{0.8}{-0.6}{-0.4}
\clip (0,0) -- ($(O)!3!(B)$) -- ($(O)!3!(C)$) -- cycle;
\draw[ellipse plane] (0,0) circle (1);
\end{scope}
\begin{scope}
\setellipseplane{\R}{0.6}{-0.6}{-0.6}{-0.4}
\clip (0,0) -- ($(O)!3!(A)$) -- ($(O)!3!(C)$) -- cycle;
\draw[ellipse plane] (0,0) circle (1);
\end{scope}
}
}


\def\figROHSJRP{
\tikzfig{polarcycle}{\guid{ROHSJRP} The polar cycle is the cyclic permutation of a finite
set of nonzero points in the plane in a counterclockwise direction.
}
{
[scale=1]
\coordinate (O) at (0,0);
\node[anchor=north] at (O) {$\orz$};
\smalldot{O};
\foreach \p in {0,30,...,330}
 {
 \pgfmathrandominteger{\a}{-15}{15};
 \pgfmathrandominteger{\b}{4}{10};
 \coordinate (V\p) at (\p+\a:0.2*\b);
 \smalldot{V\p};
 }
\coordinate (V360) at (V0);
\foreach \p in {0,30,...,330}
  \pgfmathsetmacro\q{\p+30}
  \draw[->,shorten >= 2.5pt] (V\p) -- (V\q);
}
}

\def\figHOUNZSY{
\tikzfig{azimuthcycle}{\guid{ROHSJRP} The azimuth cycle is a cyclic permutation of a finite
set $V$ of points in $\ring{R}^3$ that projects orthogonally to the polar cycle in the plane.
}
{
[scale=1]
\coordinate (O) at (0,0);
%\node[anchor=north] at (O) {$\orz$};
\smalldot{O};
\foreach \t in {0,60,...,300}
 {
 \pgfmathrandominteger{\a}{-15}{15};
 \pgfmathrandominteger{\b}{4}{9.8};
 \coordinate (V\t) at (\t+\a:0.15*\b);
 \smalldot{V\t};
 \pgfmathrandominteger{\c}{18}{28};
 \path 
  let \p1 = (V\t) in 
   coordinate (W\t) at (\cmofpt*\x1,\cmofpt*\y1,0.2*\c);
 %
 \smalldot{W\t};
 \draw[gray] (V\t)--(W\t);
 }
\begin{scope}
\clip (V0) -- (V60) -- (V120) -- (V180) -- (V240) -- (V300) -- cycle;
\draw[help lines,step=0.2] (-2,-2) grid (2,2);
\end{scope}
\coordinate (V360) at (V0);
\coordinate (W360) at (W0);
\draw[help lines] (0,0,0) -- (0,0,0.2*28);
\foreach \t in {0,60,...,300}
  {
  \pgfmathsetmacro\s{\t+60}
  \draw[->,shorten >= 2.5pt] (V\t) -- (V\s);
  \draw[->,shorten >= 2.5pt,black,thick] (W\t) -- (W\s);
  }
\node[anchor=west] at (W300) {$V$};
}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% VOLUME CHAPTER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\figWQBMWZO{
\tikzfig{tarskislice}{\guid{WQBMWZO} To first order approximation in $\delta$,
the surface area $2\pi y\, \ell$ of rotation of a
slice of width $\delta$ 
of a unit sphere equals the area $2\pi y\, (\delta\sec\alpha)=2\pi\,\delta$
of the surface area of the cone tangent to the sphere, which is independent
of $y$ and $\alpha$.  It follows that the surface
area of the part of a unit sphere between two parallel planes depends only on the separation
of the two planes.}
{
[scale=1]
\pgfmathsetmacro\r{2.5};
\pgfmathsetmacro\alphav{40};
\pgfmathsetmacro\beta{90-\alphav};
\pgfmathsetmacro\deltav{0.2*\r};
\coordinate (A) at ({\r/sin(\alphav)},0);
\coordinate (B) at (\beta:\r);
\coordinate (C) at ({\r*cos(\beta)},0);
\coordinate (D) at ($(C)+(\deltav,0)$);
\smalldot{0,0};
\draw (0,0) -- node[anchor=east] {$1$} (B) 
  -- node[anchor=east] {$y$} (C);
\node[anchor=north east] at ($(B) + (0ex,-2ex)$) {$\alpha$} ;
\path [name path=lineAB] (A)--(B);
\path [name path=lineDvert] (D)-- ++(0,2);
\draw [fill=black!20,name intersections={of=lineAB and lineDvert, by=E}] 
  (C) -- node[anchor=north] {$\delta$} (D) -- (E)  -- node[anchor=south west] {$\ell$} (B) -- cycle;
\draw (\r,0) arc (0:180:\r);
\draw (E)-- ($(E)!3!(B)$);
%
}
}


\def\figLWQUMHN{
\tikzfig{abcmpi}{\guid{WQUMHN} The area 
of a spherical triangle $T$ is determined by inclusion-exclusion:  six
lunes with areas $2\alpha,2\alpha,2\beta,2\beta,2\gamma,2\gamma$ cover both $T$ and the congruent
 antipodal
triangle three times and the rest of the unit sphere once.  This gives the
equation 
$6\,\op{area}(T)+(4\pi-2\,\op{area}(T)) = 4\alpha+4\beta+4\gamma$, or
 $\op{area}(T) = \alpha+\beta+\gamma-\pi$.}
{
[scale=1]
\def\R{1.5}
\draw[ball color=gray!10,draw=gray] (0,0) circle (\R);
\def\r{veclen(1,2)}
\coordinate (O) at (0,0);
\coordinate (A) at (0.6,-0.6);
\coordinate (B) at (0.2,0.8);
\coordinate (C) at (-0.6,-0.4);
\node[anchor=south west] at ($(C) + (1.1ex,-0.3ex)$) {$\gamma$};
\node[anchor=south east] at ($(A) + (-0.5ex,0.2ex)$) {$\alpha$};
\node[anchor=north] at ($(B) + (-0.3ex,-0.6ex)$) {$\beta$};
\node[anchor=north east] at ($(C) + (-1.0ex,-0.3ex)$) {$\gamma$};
\node[anchor=north west] at ($(A) + (0.0ex,0.0ex)$) {$\alpha$};
\node[anchor=south] at ($(B) + (0.4ex,0.6ex)$) {$\beta$};
\foreach \i/\j in {I/30,II/80,III/140,IV/200,V/265,VI/315} \node at (\j:1.25*\R) {$\i$};
\smalldot{A};
\smalldot{B};
\smalldot{C};
\begin{scope}
\setellipseplane{\R}{0.6}{-0.6}{0.2}{0.8}
\draw (-\mx,-\my) arc [start angle=-90,end angle=90,x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\end{scope}
\begin{scope}
\setellipseplane{\R}{0.2}{0.8}{-0.6}{-0.4}
\draw (-\mx,-\my) arc [start angle=-90,end angle=90,x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\end{scope}
\begin{scope}
\setellipseplane{\R}{0.6}{-0.6}{-0.6}{-0.4};
\draw (\mx,\my) arc [start angle=-90,end angle=90,x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\end{scope}
}
}

\def\figHFHVHSV{
\tikzfig{primitive}{\guid{HFHVHSV}  All solids in this book can be constructed from
the rectangle, tetrahedron, solid spherical triangle, 
and wedges of a frustum, conic cap, and ball.
}
{
[scale=1]
\pgfmathsetmacro\boxsize{2.3}
\def\R{0.90}
\def\RR{1.1*\R}
\begin{scope} %% solid spherical triangle.
[shift={(2*\boxsize,0)}]
\coordinate (O) at (0,0);
\pgfmathsetmacro\Ax{-\R*0.2};
\pgfmathsetmacro\Ay{\R*0.6};
\pgfmathsetmacro\Bx{-\R*0.8};
\pgfmathsetmacro\By{\R*0.2};
\pgfmathsetmacro\Cx{-\R*0.3};
\pgfmathsetmacro\Cy{-\R*0.3};
\pgfmathsetmacro\argA{atan2(\Ax,\Ay)};
\pgfmathsetmacro\argB{atan2(\Bx,\By)};
\pgfmathsetmacro\argC{atan2(\Cx,\Cy)};
\coordinate (A) at (\Ax,\Ay);
\coordinate (B) at (\Bx,\By);
\coordinate (C) at (\Cx,\Cy);
%\smalldot{A};
%\smalldot{B};
%\smalldot{C};
\smalldot{O};
\draw[ball color=gray!50,draw=gray] (0,0) circle (\R);
%\draw (0,0) circle (\R);
\draw[nearly transparent,help lines] (O)--(A) -- (B) --(C) --cycle;
\draw[help lines] (O)--(B);
\begin{scope}
%\path
%\clip (0,0) circle (\R);
\setellipseplane{\R}{\Ax}{\Ay}{\Bx}{\By};
\clip (-\mx,-\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate] -- (0,-\RR) -- cycle;
\setellipseplane{\R}{\Bx}{\By}{\Cx}{\Cy};
\clip (-\mx,-\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate] --  (\RR,\RR) -- cycle;
\setellipseplane{\R}{\Cx}{\Cy}{\Ax}{\Ay};
\clip (\mx,\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate] -- (\RR,-\RR)  -- (-\RR,-\RR) -- (-\RR,\RR) --  cycle;
\draw[ball color=gray,draw=gray] (0,0) circle (\R);
% \draw (B) arc [start angle={\argB-\ellrotate},end angle={\argC-\ellrotate},x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\setellipseplane{\R}{\Ax}{\Ay}{\Bx}{\By};
\draw (-\mx,-\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\setellipseplane{\R}{\Bx}{\By}{\Cx}{\Cy};
\draw (-\mx,-\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\setellipseplane{\R}{\Cx}{\Cy}{\Ax}{\Ay};
\draw (\mx,\my) arc [start angle={-90},end angle={90},x radius=\ellx,y radius=\elly,rotate=\ellrotate];
\end{scope}
\end{scope} %% end solid spherical triangle
\begin{scope} %% conic cap
[shift={(\boxsize,-\boxsize)}]
\coordinate (O) at (0,0);
\draw[ball color=gray!50,draw=gray] (0,0) circle (\R);
\pgfmathsetmacro\ry{0.6*\R}
%\pgfmathsetmacro\cx{0.55*\R}
\pgfmathsetmacro\cx{0.62*\R}
\pgfmathsetmacro\z{sqrt(\R*\R - \ry*\ry - \cx*\cx)} % (\cx,\ry,\z) is a point on sphere.
\pgfmathsetmacro\rx{\ry*\z/(sqrt(\cx*\cx + \z*\z))} % computed minor axis of elliptic projection.
%\pgfmathsetmacro\rx{0.2*\R}
\pgfmathsetmacro\xc{\cx - \rx*\rx/\cx}
\pgfmathsetmacro\yc{\ry * sqrt(1.0 - \rx*\rx/(\cx*\cx))}
\draw[semitransparent,help lines] (-\xc,\yc) --(O) -- (-\xc,-\yc)--cycle;
\begin{scope}
\path[clip,draw] (180:\cx) circle[x radius = \rx,y radius = \ry];
\draw[ball color=gray] (0,0) circle (\R);
\end{scope}
\path [draw,help lines] (180:\cx) circle[x radius = \rx,y radius = \ry];
\draw[help lines] (O)-- (-\xc,\yc);
\draw[help lines] (O)-- (-\xc,-\yc);
\end{scope}
\begin{scope} %% ball
[shift={(2*\boxsize,-\boxsize)}]
\draw[ball color=gray!50,draw=gray] (0,0) circle (\R);
\end{scope}
\begin{scope} %% rectangle
[shift={(0,0)}]
%\def\zx{-0.3*\R}
%\def\zy{-0.4*\R}
\draw[help lines,->] (0,0) -- (1.5*\R,0);
\draw[help lines,->] (0,0) -- (0,\R);
\draw[help lines,->] (0,0,0) --  (0,0,2*\R);
\draw[fill=gray!50,nearly transparent] (0,0,\R)-- ++ (\R,0,0) -- ++(0,0,-\R) -- ++ (0,0.5*\R,0) -- ++ (-\R,0,0) -- ++ (0,0,\R)
 -- cycle;
\draw (0,0.5*\R,\R) -- ++ (\R,0,0) -- ++ (0,0,-\R);
\draw (\R,0,\R) -- ++ (0,0.5*\R,0);
\end{scope}
\begin{scope} %% tetrahedron
[shift={(\boxsize,0)}]
\pgfmathsetmacro\r{0.7*\R};
\coordinate (A) at (-0.7*\r,-0.2*\r,\r);
\coordinate (B) at (1.2*\r,-0.2*\r,1.5*\r);
\coordinate (C) at (0.2*\r,\r,-0.8*\r);
\coordinate (D) at (1.2*\r,-0.5*\r,-0.5*\r);
\draw[fill=gray!50,nearly transparent,help lines] (A)--(B)--(D)--cycle;
\draw[fill=gray!30,nearly transparent] (A)--(B)--(C)--cycle;
\draw[fill=gray!90,nearly transparent] (B)--(D)--(C)--cycle;
\coordinate (zABC) at (barycentric cs:A=0.54,B=0.28,C=0.16);
\coordinate (xBCD) at (barycentric cs:B=0.29,C=0.275,D=0.433);
\coordinate (yABC) at (barycentric cs:A=0.32,B=0.09,C=0.58);
\draw[help lines] (0,0,0) --  (zABC);
\draw[->]  (zABC) -- (0,0,2*\R);
\draw[help lines] (0,0) -- (xBCD);
\draw[->] (xBCD) -- (1.2*\R,0);
\draw[help lines] (0,0) -- (yABC);
\draw[->] (yABC)-- (0,\R);
%\node at (A) {$A$};
%\node at (C) {$C$};
%\node at (B) {$B$};
%\node at (D) {$D$};
\draw[help lines] (A) -- (D);
\end{scope}
\begin{scope} %% frustum
[shift={(0,-\boxsize+0.8*\R)}]
\coordinate (origin) (0,0);
\pgfmathsetmacro\a{0.8*\R};
\pgfmathsetmacro\b{1.6*\R};
\pgfmathsetmacro\ra{0.1*\R};
\pgfmathsetmacro\sa{0.4*\R};
\pgfmathsetmacro\sb{\sa*\b/\a};
\pgfmathsetmacro\rb{\ra*\b/\a};
\pgfmathsetmacro\tanAx{\sa* sqrt(1 - \ra*\ra/(\a* \a))};
\pgfmathsetmacro\tanAy{\a - \ra*\ra/ \a};
\coordinate (tanA1) at (-\tanAx ,-\tanAy);
\pgfmathsetmacro\ang{atan2(\tanAx,\tanAy-\a)}; 
\coordinate (tanA2) at ( {\sa* sqrt(1 - \ra*\ra/(\a* \a))},-{\a - \ra*\ra/ \a});
\coordinate (tanB1) at (- {\sb* sqrt(1 - \rb*\rb/(\b* \b))},-{\b - \rb*\rb/ \b});
\coordinate (tanB2) at ( {\sb* sqrt(1 - \rb*\rb/(\b* \b))},-{\b - \rb*\rb/ \b});
%\node at (origin) {$0$};
%\node at (0,-\a) {$a$};
%\node at (0,-\b) {$b$};
\draw[help lines] (origin)-- (tanA1);
\draw[help lines] (origin)-- (tanA2);
\draw (tanA1)-- (tanB1);
\draw (tanA2)-- (tanB2);
\draw[fill=gray!30] (0,-\a) circle[x radius=\sa,y radius = \ra];
%\draw[help lines] (0,-\b) circle[x radius=\sb,y radius = \rb];
%\begin{scope}
%\clip (tanB1)--(tanB2)-- ++(0,-0.5*\R) -- ++(-2*\R,0) -- cycle;
%\draw (0,-\b) circle[x radius=\sb,y radius = \rb];
%\end{scope}
\begin{scope}
\draw (tanB1) arc[x radius=\sb,y radius=\rb,start angle={180+\ang},end angle={360-\ang}];
\clip (tanB1) arc[x radius=\sb,y radius=\rb,start angle={180+\ang},end angle={360-\ang}]
 -- (tanA2)
 arc[x radius=\sa,y radius=\ra,start angle={-\ang},delta angle={-(180+2*\ang)}] -- cycle;
%\shade [upper left=white,lower left=gray!20,lower right=black,upper right=gray]
% (-\R,-2*\R) rectangle (R,-0.5*\R);
\shade [upper left=black!30,lower left=black!60,upper right=gray!40,lower right=white]
 (-\R,-2*\R) rectangle (0,-0.5*\R);
\shade [lower left=white,upper left=gray!40,lower right=black,upper right=gray]
 (0,-2*\R) rectangle (\R,-0.5*\R);
\draw[help lines] (tanB2) arc[x radius=\sb,y radius=\rb,end angle={180+\ang},start angle={-\ang}];
%\draw (0,-\b) circle[x radius=\sb,y radius = \rb];
%\node at (origin) {$\ang$};
\end{scope}
\end{scope}
}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% HYPERMAP CHAPTER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tikzset{darrow/.style={->,shorten >=0.5ex,shorten <= 0.5ex,thick}}
\tikzset{rarrow/.style={<-,shorten >=0.5ex,shorten <= 0.5ex,thick}}
\tikzset{barrow/.style={<->,shorten >=0.5ex,shorten <= 0.5ex,thick}}

\def\figZGPXAWJ{
\tikzfig{hypermap_ex}{\guid{ZGPXAWJ} A plane graph is given by the gray edges
and circular nodes as shown.  Twelve darts mark the angles of the plane graph.  Darts may be
  permuted about faces ($f$), nodes ($n$), and edges ($e$) of the plane graph to form a hypermap.
}
{
[scale=1]
\def\planargraph{%
%\coordinate (A) at (0,0);
%\coordinate (B) at 
\def\r{1.1}
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(30:0.4*\r)$);
\coordinate (C) at ($(B)+(0:\r)$);
\coordinate (D) at ($(C)+(-30:0.4*\r)$); % (2,0);
\coordinate (E) at ($(B)+(60:\r)$); % (1.0,1.4);
\coordinate (F) at ($(E)+(90:0.4*\r)$); % (1.0,2.0);
%\node (A) at (0,0) {};
%\node (B) at (1,0.5) {};
%\node at (C) {$C$};
%\node at (D) {$D$};
%\node at (E) {$E$};
%\node at (F) {$F$};
\draw[help lines] (A)--(B)--(C)--(D)--(C)--(E)--(F)--(E)--(B);
\smalldot{A}; \smalldot{B}; \smalldot{C}; \smalldot{D}; \smalldot{E}; \smalldot{F};
}
%\tikzstyle{every node}=[]
\def\dartlist{
\pgfmathsetmacro\sep{1.7};
\node[dartstyle]  (A1) at ($(B)!1.4!(A)$) {};
\node[dartstyle]  (B1) at ($(B)+(270:\sep ex)$) {};
\node[dartstyle]  (B2) at ($(B)+(150:\sep ex)$) {};
\node[dartstyle]  (B3) at ($(B)+(30:\sep ex)$) {};
\node[dartstyle]  (C1) at ($(C)+(270:\sep ex)$) {};
\node[dartstyle]  (C2) at ($(C)+(30:\sep ex)$) {};
\node[dartstyle]  (C3) at ($(C)+(150:\sep ex)$) {};
\node[dartstyle]  (E1) at ($(E)+(150:\sep ex)$) {};
\node[dartstyle]  (E2) at ($(E)+(30:\sep ex)$) {};
\node[dartstyle]  (E3) at ($(E)+(270:\sep ex)$) {};
\node[dartstyle]  (D1) at ($(C)!1.4!(D)$) {};
\node[dartstyle]  (F1) at ($(E)!1.4!(F)$) {};
}
%darts
%\dart{(0,0.2)};
\def\boxsize{3.0}
\def\boxA{2.4}
\begin{scope}
[shift={(0,0)}]
\planargraph
\end{scope}
\begin{scope} %% f
[shift={(\boxA,0)}]
\planargraph;
\dartlist;
\draw[darrow] (A1) .. controls +(90:2ex) .. (B2);
\draw[darrow] (B2) -- (E1);
\draw[rarrow] (F1) .. controls +(210:2ex).. (E1);
\draw[darrow] (F1) .. controls +(330:2ex) .. (E2);
\draw[darrow] (E2) -- (C2);
\draw[rarrow] (D1) .. controls +(90:2ex).. (C2);
\draw[darrow] (D1) .. controls +(210:2ex).. (C1);
\draw[darrow] (C1) -- (B1);
\draw[rarrow] (A1) .. controls  +(330:2ex).. (B1);
\draw[darrow] (B3) -- (C3);
\draw[darrow] (C3) -- (E3);
\draw[darrow] (E3) -- (B3);
\node at ($(A)!.5!(D) +(-90:2ex)$) {$f$};
\end{scope}
\begin{scope} %% n
[shift={(\boxA+\boxsize,0)}]
\planargraph;
\dartlist;
\draw[barrow] (A1) .. controls ($(A1)+(180:4ex)$) and ($(A1)+(240:4ex)$) .. (A1);
\draw[darrow] (B1) .. controls ($(B)+(-30:2ex)$).. (B3);
\draw[darrow] (B3) .. controls ($(B)+(90:2ex)$).. (B2);
\draw[darrow] (B2) .. controls ($(B)+(210:2ex)$).. (B1);
\draw[barrow] (F1) .. controls ($(F1)+(60:4ex)$) and ($(F1)+(120:4ex)$).. (F1);
\draw[darrow] (E1) .. controls ($(E)+(210:2ex)$).. (E3);
\draw[darrow] (E3) .. controls ($(E)+(-30:2ex)$).. (E2);
\draw[darrow] (E2) .. controls ($(E)+(90:2ex)$).. (E1);
\draw[darrow] (C1) .. controls ($(C)+(-30:2ex)$).. (C2);
\draw[darrow] (C2) .. controls ($(C)+(90:2ex)$).. (C3);
\draw[darrow] (C3) .. controls ($(C)+(210:2ex)$).. (C1);
\draw[barrow] (D1) .. controls ($(D1)+(300:4ex)$) and ($(D1)+(360:4ex)$).. (D1);
\node at ($(A)!.5!(D) +(-90:2ex)$) {$n$};
\end{scope}
\begin{scope} %% e
[shift={(\boxA+2*\boxsize,0)}]
\planargraph;
\dartlist;
\draw[barrow] (A1) .. controls  +(330:2ex).. (B1);
\draw[barrow] (B3) -- (C1);
\draw[barrow] (D1) .. controls +(90:2ex).. (C2);
\draw[barrow] (B2) -- (E3);
\draw[barrow] (C3) -- (E2);
\draw[barrow] (F1) .. controls +(210:2ex).. (E1);
\node at ($(A)!.5!(D) +(-90:2ex)$) {$e$};
\end{scope}
}
}

%% baselines don't align here.
\def\figLMGQYKG {
\tikzfig{dart+}{\guid{LMGQYKG} A fragment of a hypermap showing a dart $x$ and its entourage.
 The node map is given by the horizontal arrows, the edge map by arrows descending towards the
  lower left, and the face map by arrows rising towards the upper left.}
{
[scale=1.0]
\def\r{1.1}
\node (X) at (0,0) {$x$};
\node (NX) at (0:\r) {$n\,x$};
\node (FMX) at (-60:\r) {$f^{-1}\,x$};
\node (EX) at (-120:\r) {$e\,x$};
\node (NMX) at (180:\r) {$n^{-1}\,x$};
\node (FX) at (120:\r) {$f\,x$};
\node (EMX) at (60:\r) {$e^{-1}\,x$};
\draw[darrow] (X) --  % node[anchor=south,gray] {$\scriptsize{n}$} 
  (NX);
\draw[darrow] (NX)-- % node[anchor=west] {$e$} 
(FMX);
\draw[darrow] (FMX)-- % node[anchor=east] {$f$}
 (X);
\draw[darrow] (X)-- % node[anchor=west] {$e$} 
(EX);
\draw[darrow] (EX)-- % node[anchor=east] {$f$} 
 (NMX);
\draw[darrow] (NMX)-- %node % [anchor=south] {$n$}
  (X);
\draw[darrow] (X)-- %node % [anchor=east] {$f$}
  (FX);
\draw[darrow] (FX)-- %node % [anchor=south] {$n$}
  (EMX);
\draw[darrow] (EMX)-- %node % [anchor=west] {$e$}
  (X);
}
}


\def\figANDKKER{
\tikzfig{dart-fix}{\guid{ANDKKER} A fragment of a hypermap showing a dart $x$ and its entourage
when $x$ is fixed by the permuation $f$.  The arrow on the left pointing upward has type $f$.
The two arrows pointing to the right along the top of the diagram have type $n$.  The
two arrows pointing to the left along the bottom of the diagram have type $e$.
}
{
[scale=1.0]
\def\r{1.0}
\node (X) at (0,0) {$x$};
\node (NX) at (0:1.1*\r) {$n\,x$}; % = e^{-1}\,x$};
\node (EX) at (-140:\r) {$e\,x$};
\node (NMX) at (140:\r) {$n^{-1}\,x$};
\draw[darrow] (X) -- (EX);
\draw[darrow] (EX)-- (NMX);
\draw[darrow] (NMX) -- (X);
\draw[darrow] (X) .. controls +(1.1*\r/2,3ex).. (NX);
\draw[darrow] (NX).. controls +(-1.1*\r/2,-3ex).. (X);
}
}


\def\figGFJIBZV{
\tikzfig{walk}{\guid{GFJIBZV} A fragment of a hypermap in its original state,
and three modified fragments after applying a face walkup $W_f$, edge walkup $W_e$, 
and node walkup $W_n$ at the dart $x$ at the center.
Each walkup eliminates the dart $x$.  The other darts 
are the same as in the original, but undergo modified permutations $e$, $n$, and $f$.}
{
[scale=1.0]
\def\r{1.1}
\begin{scope}
\node[dartstyle] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {$x$};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\draw[darrow] (X) --  node[anchor=south] {$n$} 
  (NX);
\draw[darrow] (NX)--  node[anchor=west] {$e$} 
(FMX);
\draw[darrow] (FMX)--  node[anchor=west] {$f$}
 (X);
\draw[darrow] (X)--  node[anchor=east] {$e$} 
(EX);
\draw[darrow] (EX)--   node[anchor=south] {$f$}  (NMX);
\draw[darrow] (NMX)-- node  [anchor=west] {$n$}
  (X);
\draw[darrow] (X)-- node  [anchor=west] {$f$}
  (FX);
\draw[darrow] (FX)-- node  [anchor=east] {$n$}
  (EMX);
\draw[darrow] (EMX)-- node  [anchor=south] {$e$}
  (X);
\end{scope}
\def\boxA{2.8}
\begin{scope}
[shift={(\boxA,0)}]
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\node at ($(FX)!.5!(FMX) +(-90:1.5ex)$) {$W_f$};
\draw[darrow] (NX)--  node[anchor=west] {$e$} 
(FMX);
\draw[darrow] (FMX)--  node[anchor=east] {$f$}
 (NMX);
\draw[darrow] (EX)--  node[anchor=west] {$f$} 
 (FX);
\draw[darrow] (NMX)-- node  [anchor=west] {$n$}
  (NX);
\draw[darrow] (FX)-- node  [anchor=east] {$n$}
  (EMX);
\draw[darrow] (EMX)-- node  [anchor=east] {$e$}
  (EX);
\end{scope}
\begin{scope}
[shift={(2*\boxA,0)}]
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\node at ($(NX)!.5!(FMX)$) {$W_e$};
\draw[darrow] (NX)--  node[anchor=north] {$e$} 
(EX);
\draw[darrow] (FMX)--  node[anchor=north] {$f$}
 (FX);
\draw[darrow] (EX)--  node[anchor=south] {$f$} 
 (NMX);
\draw[darrow] (NMX)-- node  [anchor=west] {$n$}
  (NX);
\draw[darrow] (FX)-- node  [anchor=east] {$n$}
  (EMX);
\draw[darrow] (EMX)-- node  [anchor=south] {$e$}
  (FMX);
\end{scope}
\begin{scope}
[shift={(3*\boxA,0)}]
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\node at ($(FX)!.5!(EMX)$) {$W_n$};
\draw[darrow] (NX)--  node[anchor=west] {$e$} 
(FMX);
\draw[darrow] (FMX)--  node[anchor=north] {$f$}
 (FX);
\draw[darrow] (EX)--  node[anchor=south] {$f$} 
 (NMX);
\draw[darrow] (NMX)-- node  [anchor=north] {$n$}
  (EMX);
\draw[darrow] (FX)-- node  [anchor=south] {$n$}
  (NX);
\draw[darrow] (EMX)-- node  [anchor=east] {$e$}
  (EX);
\end{scope}
}
}



\def\figLNIZBPW{
\tikzfig{walkdegen}{\guid{LNIZBPW} All three walkup transformations have
the same effect at a dart $x$ that is degenerate, regardless of whether
the degeneracy is a face-, edge-, or node-degeneracy.  The three different kinds
of degenerate darts are shown in the hypermap fragments on the outside of the figure, and
the hypermap fragment after applying a walkup is shown at the center of the diagram.}
{
[scale=1.0]
\def\r{0.75}
\def\R{1.8}
\begin{scope}
[shift={(0,0)}]
\node[dartstyle] (NT) at (0:\r) {};
\node[dartstyle] (ET) at (240:\r) {};
\node[dartstyle] (FT) at (120:\r) {};
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\draw[darrow] (FT)-- node[anchor=south] {$n$} (NT);
\draw[darrow] (NT)-- node[anchor=north] {$e$} (ET);
\draw[darrow] (ET)-- node[anchor=east] {$f$} (FT);
\node (T) at (0:2.4*\r) {post-walkup};
\end{scope}
\begin{scope}
[shift={(180:\R)}]
\node[dartstyle] (EX) at (-120:\r) {};
\node[dartstyle] (NMX) at (120:\r) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (X) at (0,0) {};
\node (X1) at (-1.1ex,0ex) {$x$};
\draw[darrow] (X)-- node[pos=0.2,anchor=north] {$\,\,e$} (EX);
\draw[darrow] (EX)-- node[anchor=east] {$f$} (NMX);
\draw[darrow] (NMX)-- node[anchor=south] {$~~~n$} (X);
\draw[darrow] (X) ..controls +(\r/2,2ex).. node[anchor=south] {$n$} (NX);
\draw[darrow] (NX) ..controls +(-\r/2,-2ex).. node[anchor=north] {$e$} (X);
\node (T) at (-90:1.4*\r) {$f\,x =x$};
\end{scope}
\begin{scope}
[shift={(60:\R)}]
\node[dartstyle] (EX) at (-120:\r) {};
\node[dartstyle] (FX) at (120:\r) {};
\node[dartstyle] (EMX) at (0:\r) {};
\node[dartstyle] (X) at (0,0) {};
\node (X1) at (0.5ex,1.08ex) {$x$};
\draw[darrow] (X) ..controls +(-90:1.3*\r/2) .. node[pos=0.4,anchor=north west] {$e$} (EX);
\draw[darrow] (EX) ..controls +(90:1.3*\r/2).. node[pos=0.4,anchor=east] {$f$} (X);
\draw[darrow] (EMX)-- node[anchor=north] {$e$} (X);
\draw[darrow] (X) -- node[pos=0.2,anchor=east] {$f\,$} (FX);
\draw[darrow] (FX) -- node[anchor=south] {$n$} (EMX);
\node (T) at (-30:1.6*\r) {$n\,x=x$};
\end{scope}
\begin{scope}
[shift={(-60:\R)}]
\node[dartstyle] (FMX) at (-120:\r) {};
\node[dartstyle] (FX) at (120:\r) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (X) at (0,0) {};
\node (X1) at (0.7ex,-1.0ex) {$x$};
\draw[rarrow] (X) ..controls +(90:1.3*\r/2) .. node[anchor=west] {$n$} (FX);
\draw[rarrow] (FX) ..controls +(-90:1.3*\r/2).. node[anchor=east] {$f$} (X);
\draw[darrow] (X) -- node[anchor=south] {$n$} (NX);
\draw[darrow] (NX)-- node[anchor=north] {$e$} (FMX);
\draw[darrow] (FMX) -- node[anchor=east] {$f$} (X);
\node (T) at (-20:1.6*\r) {$e\,x=x$};
\end{scope}
}
}


\def\figILWHXTE{
\tikzfig{split}{\guid{ILWHXTE} When darts $x$ and $e\,x$ lie in the same orbit of $f$ (upper left),
the face walkup $W_f$ at $x$ splits the orbit into two (lower left).  
But when the 
darts $x$ and $e\,x$ lie in different orbits of $f$ (upper right), the edge walkup $W_f$ at $x$
merges the two orbits into one (lower right).}
{
[scale=1.0]
\def\r{1.1}
\tikzset{ellipsis/.style={
{decoration={
   markings,
   mark=between positions 0.43 and 0.57 step 0.07
   with
   {
    \draw[fill=white,draw=white]  (0,0) circle (0.8ex) {};
    \node[dartstyle] at (0,0) {};
     }
   }
  }
}}
\begin{scope}
[shift={(0,0)}]
\node[dartstyle] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {$x$};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[anchor=south east] at ($(EX)+(180:0ex)$) {$e x$};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\draw[darrow,thin,gray] (X) --  node[anchor=south,gray] {$n$}   (NX);
\draw[darrow,thin,gray] (NX)--  node[anchor=west,gray] {$e$} (FMX);
\draw[darrow,thick] (FMX)--  node[anchor=west] {$f$}  (X);
\draw[darrow,thin,gray] (X)--  node[anchor=east] {$e$} (EX);
\draw[darrow,thick] (EX)--   node[anchor=south] {$f$}  (NMX);
\draw[darrow,thin,gray] (NMX)-- node  [anchor=west] {$n$}   (X);
\draw[darrow,thick] (X)-- node  [anchor=west] {$f$}   (FX);
\draw[darrow,thin,gray] (FX)-- node  [anchor=east] {$n$}   (EMX);
\draw[darrow,thin,gray] (EMX)-- node  [anchor=south] {$e$}   (X);
\draw[darrow,ellipsis,postaction={decorate}] (NMX) ..controls (0:2*\r).. node[anchor=west] {$f$} (FMX);
\draw[darrow,ellipsis,postaction={decorate}] (FX) .. controls (180:2*\r).. node[anchor=east] {$f$} (EX);
\end{scope}
\def\boxA{3.5}
\begin{scope}
[shift={(0,-\boxA)}]
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\node at ($(FX)!.5!(FMX) +(-90:1.5ex)$) {$W_f$};
\draw[darrow,thin,gray] (NX)--  node[anchor=west] {$e$} (FMX);
\draw[darrow,thick] (FMX)--  node[anchor=east] {$f$}  (NMX);
\draw[darrow,thick] (EX)--  node[anchor=west] {$f$}  (FX);
\draw[darrow,thin,gray] (NMX)-- node  [anchor=west] {$n$}   (NX);
\draw[darrow,thin,gray] (FX)-- node  [anchor=east] {$n$}   (EMX);
\draw[darrow,thin,gray] (EMX)-- node  [anchor=east] {$e$}  (EX);
\draw[darrow,ellipsis,postaction={decorate}] (NMX) ..controls (0:2*\r).. node[anchor=west] {$f$} (FMX);
\draw[darrow,ellipsis,postaction={decorate}] (FX) .. controls (180:2*\r).. node[anchor=east] {$f$} (EX);
\end{scope}
%% Right column of diagram
\tikzset{ellipsisB/.style={
{decoration={
   markings,
   mark=between positions 0.4 and 0.6 step 0.1
   with
   {
    \draw[fill=white,draw=white]  (0,0) circle (0.67ex) {};
    \node[dartstyle] at (0,0) {};
     }
   }
  }
}}
\begin{scope}
[shift={(1.4*\boxA,0)}]
\node[dartstyle] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {$x$};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[anchor=south east] at ($(EX)+(180:0ex)$) {$e x$};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\draw[darrow,thin,gray] (X) --  node[anchor=south,gray] {$n$}   (NX);
\draw[darrow,thin,gray] (NX)--  node[anchor=west,gray] {$e$} (FMX);
\draw[darrow,thick] (FMX)--  node[anchor=west] {$f$}  (X);
\draw[darrow,thin,gray] (X)--  node[anchor=east] {$e$} (EX);
\draw[darrow,thick] (EX)--   node[anchor=south] {$f$}  (NMX);
\draw[darrow,thin,gray] (NMX)-- node  [anchor=west] {$n$}   (X);
\draw[darrow,thick] (X)-- node  [anchor=west] {$f$}   (FX);
\draw[darrow,thin,gray] (FX)-- node  [anchor=east] {$n$}   (EMX);
\draw[darrow,thin,gray] (EMX)-- node  [anchor=south] {$e$}   (X);
\draw[darrow,ellipsisB,postaction={decorate}] (NMX) ..controls +(120:\r).. node[anchor=south] {$f$} (EX);
\draw[darrow,ellipsisB,postaction={decorate}] (FX) .. controls +(-60:\r).. node[anchor=north] {$f$} (FMX);
\end{scope}
\begin{scope}
[shift={(1.7*\boxA,-\boxA)}]
\node[dartstyle,draw=gray,fill=white] (X) at (0,0) {};
\node[anchor=south] at ($(X)+(90:1.3ex)$) {};
\node[dartstyle] (NX) at (0:\r) {};
\node[dartstyle] (FMX) at (-60:\r) {};
\node[dartstyle] (EX) at (120:\r) {};
\node[dartstyle] (NMX) at (60:\r) {};
\node[dartstyle] (FX) at (-120:\r) {};
\node[dartstyle] (EMX) at (180:\r) {};
\node at ($(FX)!.5!(FMX) +(-90:1.5ex)$) {$W_f$};
\draw[darrow,thin,gray] (NX)--  node[anchor=west] {$e$} (FMX);
\draw[darrow,thick] (FMX)--  node[anchor=east] {$f$}  (NMX);
\draw[darrow,thick] (EX)--  node[anchor=west] {$f$}  (FX);
\draw[darrow,thin,gray] (NMX)-- node  [anchor=west] {$n$}   (NX);
\draw[darrow,thin,gray] (FX)-- node  [anchor=east] {$n$}   (EMX);
\draw[darrow,thin,gray] (EMX)-- node  [anchor=east] {$e$}  (EX);
\draw[darrow,ellipsisB,postaction={decorate}] (NMX) ..controls +(120:\r).. node[anchor=south] {$f$} (EX);
\draw[darrow,ellipsisB,postaction={decorate}] (FX) .. controls +(-60:\r).. node[anchor=north] {$f$} (FMX);
\end{scope}
}
}

\def\figYKJFZEB{
\tikzfig{doublenode}{\guid{YKJFZEB} When a hypermap comes from a plane graph, the double
{\it node} walkup at the two darts of an edge contracts the
corresponding edge of the graph.
}
{
[scale=1.0]
\def\r{1.0}
\def\planargraph{%
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(90:\r)$);
\coordinate (C) at ($(B)+(30:\r)$);
\coordinate (D) at ($(A)+(-30:\r)$); 
\coordinate (E) at ($(A)+(-150:\r)$); 
\coordinate (F) at ($(B)+(150:\r)$); 
\draw[help lines] (E)--(A)--(D);
\draw[help lines] (F)--(B)--(C);
\draw[help lines] (A)--(B);
\draw[help lines] (A)--(B);
\foreach \i in {C,F} {
 \draw[help lines] (\i)-- +(90:2.5ex);
 \draw[help lines] (\i)-- +(-30:2.5ex);
 \draw[help lines] (\i)-- +(-150:2.5ex);
}
\foreach \i in {D,E} {
 \draw[help lines] (\i)-- +(-90:2.5ex);
 \draw[help lines] (\i)-- +(30:2.5ex);
 \draw[help lines] (\i)-- +(150:2.5ex);
}
\foreach \i in {A,B,C,D,E,F} \graydot{\i};
}
\def\dartlist{
\pgfmathsetmacro\sep{1.7};
\foreach \i in {F,C,A} {
 \node[dartstyle] at ($(\i)+(-90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(150:\sep ex)$) {};
}
\foreach \i in {B,D,E} {
 \node[dartstyle] at ($(\i)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-150:\sep ex)$) {};
}
}
\planargraph
\dartlist
\draw ($(A)+(150:\sep ex)$) circle (0.9ex);
\draw ($(B)+(-30:\sep ex)$) circle (0.9ex);
%\node at ($(E)+(-90:4ex)$) {};
\begin{scope}
[shift={(4,0)}]
\def\planargraphB{%
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(90:\r)$);
\coordinate (C) at ($(B)+(30:\r)$);
\coordinate (D) at ($(A)+(-30:\r)$); 
\coordinate (E) at ($(A)+(-150:\r)$); 
\coordinate (F) at ($(B)+(150:\r)$); 
\coordinate (AB) at ($(A)!0.5!(B)$);
\draw[help lines] (E)--(AB)--(D);
\draw[help lines] (F)--(AB)--(C);
%\draw[help lines] (A)--(B);
\foreach \i/\j in {C/-30,F/-150} {
 \draw[help lines] (\i)-- +(90:2.5ex);
 \draw[help lines] (\i)-- +(\j:2.5ex);
}
\foreach \i/\j in {D/30,E/150} {
 \draw[help lines] (\i)-- +(-90:2.5ex);
 \draw[help lines] (\i)-- +(\j:2.5ex);
}
\foreach \i in {AB,C,D,E,F} \graydot{\i};
%\graydot{A}; \graydot{B}; \graydot{C}; \smalldot{D}; \smalldot{E}; \smalldot{F};
}
\def\dartlistB{
\pgfmathsetmacro\sep{1.7};
\foreach \i in {F,C} {
 \node[dartstyle] at ($(\i)+(-90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(150:\sep ex)$) {};
}
\foreach \i in {D,E} {
 \node[dartstyle] at ($(\i)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-150:\sep ex)$) {};
}
\foreach \j in {0,90,180,270} {
 \node[dartstyle] at ($(AB)+(\j:\sep ex)$) {};
}
}
\planargraphB
\dartlistB
\end{scope}
}
}

\def\figRVNJBTK{
\tikzfig{doubleface}{\guid{RVNJBTK} When a hypermap comes from a plane graph, the double
{\it face} walkup at the two darts of an edge deletes the
corresponding edge from the graph.
}
{
[scale=1.0]
\def\r{1.0}
\def\planargraph{%
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(90:\r)$);
\coordinate (C) at ($(B)+(30:\r)$);
\coordinate (D) at ($(A)+(-30:\r)$); 
\coordinate (E) at ($(A)+(-150:\r)$); 
\coordinate (F) at ($(B)+(150:\r)$); 
\draw[help lines] (E)--(A)--(D);
\draw[help lines] (F)--(B)--(C);
\foreach \i in {C,F} {
 \draw[help lines] (\i)-- +(90:2.5ex);
 \draw[help lines] (\i)-- +(-30:2.5ex);
 \draw[help lines] (\i)-- +(-150:2.5ex);
}
\foreach \i in {D,E} {
 \draw[help lines] (\i)-- +(-90:2.5ex);
 \draw[help lines] (\i)-- +(30:2.5ex);
 \draw[help lines] (\i)-- +(150:2.5ex);
}
\foreach \i in {A,B,C,D,E,F} \graydot{\i};
}
\def\dartlist{
\pgfmathsetmacro\sep{1.7};
\foreach \i in {F,C,A} {
 \node[dartstyle] at ($(\i)+(-90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(150:\sep ex)$) {};
}
\foreach \i in {B,D,E} {
 \node[dartstyle] at ($(\i)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-150:\sep ex)$) {};
}
}
\planargraph
\draw[help lines] (A)--(B);
\dartlist
\draw ($(A)+(150:\sep ex)$) circle (0.9ex);
\draw ($(B)+(-30:\sep ex)$) circle (0.9ex);
%\node at ($(E)+(-90:4ex)$) {};
\begin{scope}
[shift={(4,0)}]
\def\dartlistB{
\pgfmathsetmacro\sep{1.7};
\foreach \i in {F,C} {
 \node[dartstyle] at ($(\i)+(-90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(150:\sep ex)$) {};
}
\foreach \i in {D,E} {
 \node[dartstyle] at ($(\i)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-30:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-150:\sep ex)$) {};
}
\foreach \i in {A,B} {
 \node[dartstyle] at ($(\i)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(-90:\sep ex)$) {};
}
}
\planargraph
\dartlistB
\end{scope}
}
}

\def\figCBQQAKM{
\tikzfig{doubleedge}{\guid{CBQQAKM} When a hypermap comes from a plane graph, the double
{\it edge} walkup at the two darts of a node deletes the
corresponding node from the graph.
}
{
[scale=1.0]
\def\r{1.0}
\def\planargraph{%
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(-10:\r)$);
\coordinate (C) at ($(B)+(10:\r)$);
\draw[help lines] (A)--(B)--(C);
\draw[help lines] (C)-- +(60:2.5ex);
\draw[help lines] (C)-- +(-60:2.5ex);
\draw[help lines] (A)-- +(120:2.5ex);
\draw[help lines] (A)-- +(-120:2.5ex);
\foreach \i in {A,B,C} \graydot{\i};
}
\def\dartlist{
\pgfmathsetmacro\sep{1.7};
\foreach \i/\j/\k/\l in {A/30/150/270,C/0/120/240} {
 \node[dartstyle] at ($(\i)+(\j:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(\k:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(\l:\sep ex)$) {};
}
 \node[dartstyle] at ($(B)+(90:\sep ex)$) {};
 \node[dartstyle] at ($(B)+(-90:\sep ex)$) {};
}
\planargraph
\dartlist
\draw ($(B)+(90:\sep ex)$) circle (0.9ex);
\draw ($(B)+(-90:\sep ex)$) circle (0.9ex);
\begin{scope}
[shift={(4,0)}]
\def\planargraphB{%
\coordinate (A) at (0,0);
\coordinate (B) at ($(A)+(-10:\r)$);
\coordinate (C) at ($(B)+(10:\r)$);
\draw[help lines] (A)--(C);
\draw[help lines] (C)-- +(60:2.5ex);
\draw[help lines] (C)-- +(-60:2.5ex);
\draw[help lines] (A)-- +(120:2.5ex);
\draw[help lines] (A)-- +(-120:2.5ex);
\foreach \i in {A,C} \graydot{\i};
}
\def\dartlistB{
\pgfmathsetmacro\sep{1.7};
\foreach \i/\j/\k/\l in {A/30/150/270,C/0/120/240} {
 \node[dartstyle] at ($(\i)+(\j:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(\k:\sep ex)$) {};
 \node[dartstyle] at ($(\i)+(\l:\sep ex)$) {};
}
}
\planargraphB
\dartlistB
\end{scope}
}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% FINAL CHAPTERS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%
\def\sampleA{
\tikzfig{circle}{\guid{HGMTQFG} Lemma~\ref{lemma:circle} as a special case of the Pythagorean theorem}
{
[scale=0.2]
\draw (0,0)  --(12,0) --  (12,5) --  cycle;
\draw[very thin] (11,0) -- (11,1) -- (12.0,1);
\path (5,-1.5) node {$\cos x$};
\path (16,2.5) node {$\sin x$};
\path (6,5)  node {$1$};
}
}

%
\def\sampleB{
\tikzfig{tan}{\guid{GQQAKYI} 
The tangent function on $\leftopen-\pi/2,\pi/2\rightopen$}
{
[scale=0.2]
\draw plot[smooth] file {tikz/tan.table};
\draw[help lines,->] (-1.57,0) -- (1.57,0);
\draw[help lines,->] (0,-6.0) -- (0,6.0);
}
}

\def\sampleC{
\tikzfig{arctrig}{\guid{RUJPPWJ} 
The arctangent function on the domain \leftopen -4,4\rightopen\ 
and the $\arccos$ function on $\leftclosed-1,1\rightclosed$.}
{
[scale=0.4]
\draw plot[smooth] file {tikz/arctan.table};
\draw plot[smooth] file {tikz/arccos.table};
%\draw[gray,->,very thin] (-1.2,0) -- (1.4,0);
\draw[help lines,->] (0,-0.2) -- (0,3.2);
\draw[help lines,->] (-4,0) -- (4,0);
}
}

\def\sampleD{
\tikzfig{atn-polar}{\guid{YOXQFUB} 
The function $\atn$ gives the polar angle $\theta$ of $(x,y)$.}
{
[scale=0.15]
\draw[gray,->,very thin] (-4,0) -- (14,0);
\draw[gray,->,very thin] (0,-2) -- (0,5);
\draw (0,0)  --(12,0) --  (12,5) --  cycle;
\draw[very thin] (11,0) -- (11,1) -- (12.0,1);
\path (6,-1.5) node {$x$};
\draw[very thin] (4,0) arc (0:22.62:4);
\path (14,2.5) node {$y$};
\path (2,3) node {$\theta$};
}
}

\def\tuligly{
\tikzfig{M}{\guid{TULIGLY} The quartic polynomial $M$}
{
[xscale=10.0,yscale=2.0]
\draw[help lines,->] (1.0,0) -- (1.5,0);
\draw[help lines,->] (1,0) -- (1,1.2);
\node[anchor=north] (C) at (1,0) {$1$};
\node[anchor=east] (O) at (1,0) {$0$};
\node[anchor=east] (A) at (1,1) {$1$};
\node[anchor=north] (B) at (1.41,0) {$\sqrt2$};
\draw plot[smooth] file {tikz/TULIGLY.table};
}}

\def\bjliekb{
\tikzfig{L}{\guid{BJLIEKB} Detail of the quartic $M$ and piecewise linear function $L$ on
the domain $\leftclosed1.2,1.35\rightclosed$}
{
[scale=12.0]
\draw plot[smooth] file {tikz/BJLIEKB.table};
\draw[help lines,<->] (1.18,0) -- (1.37,0);
\draw[help lines,<->] (1.2,-0.01) -- (1.2,0.25);
\draw[help lines] (1.23175,0.25) -- (1.23175,-0.01) node[anchor=north,black] {$h_-$};
\draw[help lines] (1.26,0.25) -- (1.26,-0.01) node[anchor=north,black] {$~~\hm$};
\draw[help lines] (1.3254,0.25) -- (1.3254,-0.01) node[anchor=north,black] {$h_+$};
\draw (1.2,0.230769 ) -- (1.26,0);  %
\draw (1.26,0) -- (1.35,0);
}}
%


\def\jxehxqy{
\tikzfig{fg}{\guid{JXEHXQY} The functions $g$ takes negative values,
but the function $f$ remains positive, as predicted by the cell cluster
inequality.  The nondifferentiability at $2h_0$ is inherited from the
nondifferentiability of $L$.}
{
[xscale=12.0,yscale=100.0]
\draw plot[smooth] file {tikz/jxehxqy1a.table};
\draw plot[smooth] file {tikz/jxehxqy1b.table} node[anchor=west,black] {$f$};
\draw plot[smooth] file {tikz/jxehxqy2a.table};
\draw plot[smooth] file {tikz/jxehxqy2b.table} node[anchor=west,black]{$g$};
\draw[help lines,<->] (2.46,0) -- (2.66,0);
%\draw[help lines] (2.4635,-0.004) -- (2.4635,0.01);
\draw[help lines] (2.4635,0.01) -- (2.4635,-0.004) node[anchor=north,black] {$2h_-$};
\draw[help lines] (2.6508,0.01) -- (2.4635,0.01) node[anchor=east,black] {$0.01$};
\draw[help lines] (2.6508,0.00) -- (2.4635,0.00) node[anchor=east,black] {$0.00$};
\draw[help lines] (2.52,0.01) -- (2.52,-0.004) node[anchor=north,black] {$2\hm$};
\draw[help lines] (2.6508,0.01) -- (2.6508,-0.004) node[anchor=north,black] {$2h_+$};
}}
%



\def\pqfexqn{
\tikzfig{fg1}{\guid{PQFEXQN} The functions $\beta_0$}
{
[xscale=20.0,yscale=150.0]
\draw plot[smooth] file {tikz/pqfexqn.table};
\draw[help lines,<->] (1.23,0) -- (1.33,0);
%\draw[help lines] (1.2318,-0.004) -- (1.2318,0.01);
\draw[help lines] (1.2318,0.005) -- (1.2318,-0.002) node[anchor=north,black] {$h_-$};
\draw[help lines] (1.3254,0.005) -- (1.2318,0.005) node[anchor=east,black] {$0.005$};
\draw[help lines] (1.3254,0.00) -- (1.2318,0.00) node[anchor=east,black] {$0.000$};
\draw[help lines] (1.26,0.005) -- (1.26,-0.002) node[anchor=north,black] {$\hm$};
\draw[help lines] (1.3254,0.005) -- (1.3254,-0.002) node[anchor=north,black] {$h_+$};
}}
%



\def\rrkrgpvjw#1#2{\shade[ball color=gray](#1,#2) circle (1);  }
\def\KRGPVJW{
\tikzfig{svdw}
{\guid{KRGPVJW} The Sch\"utte-van der Waerden contact graph and packing.  
Four edges that
belong to the standard graph but not the contact graph are shown in gray.  Twelve
balls in the packing are centered near the centers of the edges of a cube.}
{
{
\begin{scope}[scale=0.004]
%Set the coordinates of the points:
%\tikzstyle{every node}=[draw,shape=circle];
\path (45:400) coordinate (P0) ;
\path (135:400)  coordinate (P1) ;
\path (225:400) coordinate (P2) ;
\path (315:400) coordinate (P3) ;
\path (0:200) coordinate (P4) ;
\path (90:200) coordinate (P5) ;
\path (180:200) coordinate (P6) ;
\path (270:200) coordinate (P7) ;
\path(45:150) coordinate (P8) ;
\path (135:150) coordinate (P9) ;
\path (225:150) coordinate (P10) ;
\path (315:150) coordinate (P11) ; 
\path (0,0) coordinate (P12) ;
\foreach \i in {0,...,12}
{
  \fill (P\i) circle (15);
}
%Draw edges:
\draw
  (P12) -- (P8)
  (P12) -- (P9)
  (P12) -- (P10)
  (P12) -- (P11)
  (P8) -- (P4)
  (P4) -- (P11)
  (P11) -- (P7)
  (P7) -- (P10)
  (P10) -- (P6)
  (P6) -- (P9)
  (P9) -- (P5)
  (P5) -- (P8)
%
  (P0) -- (P1)
  (P1) -- (P2)
  (P2) -- (P3)
  (P3) -- (P0)
%
  (P0) -- (P5)
  (P5) -- (P1)
  (P1) -- (P6)
  (P6) -- (P2)
  (P2) -- (P7)
  (P7) -- (P3)
  (P3) -- (P4)
  (P4) -- (P0);
\draw[gray,very thin]
  (P8) -- (P9)
  (P9) -- (P10)
  (P10)--(P11)
  (P11)--(P8);
\end{scope}
%
\begin{scope}[scale=0.5,xshift=8cm]
\def\rr{\rrkrgpvjw}
\rr{-0.504725}{0.79793}
\rr{0.987379}{-0.530059}
\rr{-0.406371}{-1.76776}
\rr{-1.8337}{-0.370827}
\rr{1.68242}{1.01951}
\rr{0.}{2.0538}
\rr{1.35457}{-1.58937}
\rr{0.}{0.}
\rr{-1.68242}{1.20943}
\rr{-1.35457}{-1.43645}
\rr{1.8337}{0.000711695}
\rr{0.504725}{1.431}
\rr{0.406371}{-1.25805}
\rr{-0.987379}{0.159943}
\end{scope}
%\shade[ball color=blue] (2,2) circle (1); % color = gray
%\shade[ball color=blue] (2.5,2) circle (1); % color = gray
}
}}