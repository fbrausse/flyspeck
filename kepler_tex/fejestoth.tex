
\chapter{Packings with Full Contact}

\begin{note}%XX 
The results sketched in this chapter are still preliminary.  A number of the estimates that have been stated have not yet been rigorously proved by computer. 
\end{note}

We call a nonempty packing $\Lambda$ in $\ring{R}^3$ in which every vertex has distance $2$ from  $12$ other vertices a {\it packing with full contact}. L Fejes T\'oth has made the following conjecture.

\begin{conjecture}  Let $\Lambda$ be a packing with full contact.  Then for every vertex $\lambda\in\Lambda$, the arrangement of $12$ around that vertex is the kissing configuration of the face-centered cubic or hexagonal-close packing. 
\end{conjecture}



\begin{lemma}\guid{LIHVTRE}  Conjecture~\label{conj:m2} implies that for every vertex $\lambda\in\Lambda$ in a packing with full contact, $\norm{\lambda'}{\lambda}\ge 2.52$, whenever $\norm{\lambda'}{\lambda}> 2$.
\end{lemma}

\begin{proof} Let $\lam_1,\ldots,\lam_{12}$ be the twelve kissing vertices.  The conjecture gives
$$
12 + M_2(h(\lam,\lam')) = \sum_{i=1}^{12} M_2(h(\lam,\lam_i)) + M_2(h(\lam,\lam')) \le 12.
$$
This imples that $M_2(h(\lam,\lam'))\le 0$, so $\norm{\lam}{\lam'}\ge 2.52$.
\end{proof}

Thus, the contact fan is the same as the standard fan (using a cutoff for edges that is strictly less than $2.52$) for any vertex in a packing with full contact.  We consider the hypermap attached to the fan.


\section{hypermaps with tame contact}

We modify the notion of tameness to cover hypermaps that arise as the standard fan of centered packing with full contact.  

\begin{definition}[b]
Define $b:\ring{N}\times \ring{N}\to \ring{R}$ by $b\pqr{(p,q,0)}=1.541$,   except for the following values:
$$
b(0,3,0)=b(1,3,0)=0.618,\quad b(2,2,0)=0.412.
$$
\end{definition}

\begin{definition}[d]
    Define $d:\ring{N}\to \ring{R}$ by
  $$d(n) = \begin{cases}
    0 & n=3, \\
    0.206 & n=4, \\
    0.483 & n=5, \\
    0.760 & n=6, \\
    1.037 & n=7, \\
    1.314 & n=8,\\
    \op{tgt}=1.541 & \text{otherwise}.
  \end{cases}
  $$
(In particular, $d(n) = 0.206 + 0.277 (n-4)$, for $n=4,\ldots,8$.)
\end{definition}

\begin{definition}[weight~assignment]
%
A {\it weight assignment\/} of a hypermap $H$ is a function $\tau$ on
the set of faces of $H$, taking values in the set of non-negative
real numbers. A weight assignment is a {\it contact} weight assignment if the
following properties hold:
%
 \indy{Index}{weight assignment}
 \indy{Index}{contact (weight assignment)}
\begin{enumerate}
  \item If the face $F$ has cardinality $n$, then
        $\tau(F) \ge d(n)$
  \item If a node $v$ has type $(p,q,0)$, then
        $$\sum_{F:\,v\cap F\ne\emptyset} \tau(F) \ge b{\pqr{(p,q,0)}}.$$
        \label{admissible:b}
        \label{definition:admissible:excess}
\end{enumerate}
The sum $\sum_F \tau(F)$ is called the {\it total weight} of $\tau$.
\indy{Index}{total weight}
\end{definition}



We say that a hypermap has {\it tame contact\/} if it satisfies the following
conditions.
%
 \indy{Index}{tame}

\begin{enumerate}
    \label{definition:tame}
    %1
    \item {\bf (planar)} The hypermap is plain, planar.
    \item {\bf (biconnected)} The hypermap is connected and biconnected.  In particular, every face meets every node in at most one dart.
    \item {\bf (nondegenerate)} The edge map $e$ has no fixed points.
    \item {\bf (no loops)} The two darts of each edge lie in different nodes.
    \item {\bf (no double joins)} The set of edges meeting any two given nodes has cardinality at most $1$.
    \label{definition:tame:40}

    \item {\bf (triangles)} If $L$ is a contour loop with $3$ face steps, and if there exists a node in
    the exterior of $L$, then $L$ is a face of the hypermap.
    \label{definition:tame:3-circuit}

    \item {\bf (quadrilaterals)} If $L$ is a $4$-step contour loop, and there is at least one nodes
    in the exterior of $L$, then the interior of $L$ takes one of the forms
    illustrated in Figure
    \ref{fig:fourcircuit-FT}.
    \label{definition:tame:4-circuit-FT}
    \begin{figure}[htb]
        \centering
        \myincludegraphics{\ps/tame4circuitFT.eps}
        \caption{Tame $4$-circuits}
        \label{fig:fourcircuit}
    \end{figure}
  \item {\bf (face)} There are at least two faces.
    \item {\bf (face)} The cardinality of each face is at least $3$ and at most $8$.
    \label{definition:tame:length}
    \item {\bf (node)} There are $12$ nodes.
    \item {\bf (node)} The cardinality of every node is at least $2$ and at most    $4$.
    \label{definition:tame:degree}
    \item {\bf (node)} {\tt NO CONDITION}
    \label{definition:tame:degreeE}
    \item {\bf (weights)} There exists a contact weight assignment
        of total weight less than the target, $\op{tgt}=1.541$.
    \label{definition:tame:squander}
\end{enumerate}
%

The set of all hypermaps with tame contact have been classified (up to isomorphism, possibly reversing orientation).  There are $8$ such hypermaps.  They have been classified by the same process described in Section~\ref{sec:proof-classification}.


\section{aggregate fans}

We may create aggregated fans in the same way as in the 1998 proof of the Kepler conjecture so that each face is simple.  We review the construction. 

Extend the length of the edges in the fan to anything less than  $\sqrt8$ to create a new fan.  The blades of the new fan do not meet and give a new planar hypermap.  We call the newly added edges {\it cut edges}.  By moving different connected components closer together (without creating any new edges to the stadard fan), we may assume that the new hypermap is connected.  Similarly, we may assume it is biconnected.  We call this the aggregate fan, aggregate hypermap, and so on.  Each face is now simple with a certain number $r$ of standard edges (length exactly $2$) and a number $s$ of cut edges (length at least $2.52$ and less than $\sqrt8$), for a total of $r+s$ edges.  
We have $0\le s$ and $3-s \le r$.


\subsection{main estimate}

The function $\tau(F)$, when restricted to kissing configurations, takes the following form:
$$
\tau(F) = \sol(F) + (2-n(F)) \Delta_0.
$$
The following is the analogue for packings with full contact of the main estimate:

\begin{theorem}\guid{VGJDQJV}\label{lemma:main-estimate-12}  If a face $F$ of the aggregate hypermap has $r$ standard edges and $s$ cut edges, then 
$$\tau(F) \ge \min(d(r,s),\op{tgt})$$
where 
$$
d(r,s) = 0.103 (2-s) + 0.277 (r+2s-4).
$$
\end{theorem}

\begin{proof} We may imitate the proof of the main estimate from the 1998 proof.  We recall the method.

It is enough to consider a single simple face of the aggregate hypermap, so without generality, we may assume that the vertices $V$ are all nodes that meet the face.  Let $U\subset Y(\orgn,V,E)$ be the connected component corresponding to the face $F$.

Additional internal blades $C^0(\orgn,e)\subset U$ may be added to the fan of length at most $3.2$ as long as the blades do not cross.  By the additivity of the constants $d(r,s)$ of (\ref{eqn:drs-add}), we may consider a counterexample that minimizes $r+s$.  Such a counterexample will not have any blades of length at most $3.2$ and none will be created as the example is deformed to decrease $\tau(F)$.  When $r$ and $s$ are fixed, deformations that decrease the solid angle $\sol(F)$, decrease $\tau(F)$.

We call a dart $x\in F$ concave or convex, according to whether $\op{azim}(x)\ge\pi$ or $\le\pi$.  Edges may be stretched (to decrease solid angle) at a concave dart until both edges at that vertex have length $3.2$. Assume this.

{\bf Case 1}:
{\it Assume $r+s\le6$ and there is a concave dart.}  We may fit half a disk of arcradius $\arc(2,2,3.2)=1.854\ldots$ inside the region.  It has area
$$\pi(1-\cos(\arc(2,2,3.2)))=4.02\ldots.$$
This gives
$$\tau(F) > 4.02 + (2-n)\Delta_0 \ge 4.02 -4 \Delta_0 > \op{tgt}.$$

{\bf Case 2:}
{\it Assume that every dart is convex.}
Every edge has arclength at least $\arc(2,2,2)=\pi/3$.  By Lemma~\ref{lemma:convex-hyper}, the number of sides $r+s$ satisfies $(\pi/3)(r+s) < 2\pi$, so $r+s\le5$.  By Lexell, we may assume that every edge is as long or as short as possible.  For cut edges, this means the length is $2.52$ or $3.2$, and for uncut edges, this means the length is $2$ or $3.2$.  (If the Lexell deformations produce a concave dart, then it falls back into case 1.)  The only remaining degrees of freedom are the lengths of diagonals.  As the polygon is at most a pentagon, the proof has now been reduced to a finite number of interval arithmetic verifications of dimension at most $2$.

{\bf Case 3:}
{\it Assume that $r+s>6$ and there is a concave dart.}  Let $v,x$ be the number of concave and convex darts respectively.  Calculations~\cite[cc:lft]{hales:2009:nonlinear} show that the azimuth angle at each convex darts is at least $1.73$.  We place a (wedge if angle $1.73$ of a) disk at each convex dart of arcradius $\pi/6$, and a half disk at each concave dart of arcradius $\arc(2,2,3.2)-\pi/6$.  These regions are disjoint and their combined area is less than $\sol(F)$.  Hence
$$
\tau(F)=\sol(F)+(2-v-x)\Delta_0 \ge \pi v (1-\cos(\arc(2,2,3.2)-\pi/6)) + 1.73 x (1-\cos(\pi/6)) + (2-v-x)\Delta_0.
$$
The total number of darts is at most the total number of nodes, which is at most $12$.  The rightmost term is at least $\op{tgt}$ if $v> 1$. Thus, $v=1$.

As in~\cite{hales:2006:DCG}, $v=1$ implies that the region is star convex about the concave vertex.  This allows us to deform without obstruction from other vertices.  The dart $y$ adjacent to the concave dart $z$ can be deformed by decreasing the distance between it and $z$, to decrease the solid angle of $U$.  In turn, the concave dart can be deformed further to increase the distance between it and $y$, to decrease the solid angle of $U$.  This shows that the function $\tau$ has no local minimum among such arrangements and we can always reduce to a case previously considered.  This completes the proof.
\end{proof}

\subsection{no aggregates}

Let $(\orgn,V,E)$ be the standard fan of a centered packing with full contact.  Let $U$ be a connected component of $Y(\orgn,V,E)$ and let $D'$ be the set of all darts that lead into $U$.  For each $x\in D'$, let $j = j(x) >0$ be the smallest natural number such that $f^j x$ and $x$ lie at the same node.  Pick $x'\in D'$ that maximizes $x\mapsto j(x)$.  

\begin{lemma}\guid{VDUBAWF}\label{lemma:DU}  If $j(x')\le 5$, then the darts of $D'$ all belong to the same simple face $F$.
\end{lemma}

\begin{proof} Assume to the contrary that either the face is not simple or there is more than one face that leads into $U$.  Then there is some vertex $v$ interior to the $j(x')$-gon.  The azimuth angles at $v$ are each less than $2\pi/5$. They cannot sum to $2\pi$ as required.
\end{proof}

We consider possible aggregates with $j(x')\ge 6$ and $d(r,s)<\op{tgt}$.
Following the classification of \cite[p.~126,~Fig.~12.1]{hales:2006:DCG}, and noting that $d(9,0) > \op{tgt}$, $d(6,2) > \op{tgt}$, we find that the set $D'$
is either simple with at most $8$ darts, or a nonsimple face $F$ with $8$ darts and $j(x')=6$.

\begin{lemma}\guid{BTZPFMU}\label{lemma:simple} The set of darts of the standard hypermap that lead into each connected component $U$ is a simple face $F$.
\end{lemma}

\begin{proof} We must eliminate the one remaining case: $8$ darts and $j(x')=6$.  Suppose this occurs in a contravening fan.  This arrangement involves $7$ vertices: the six vertices counted by $j(x')$ and the vertex in the center of the hexagonal arrangement.  As there are $12$ vertices in all, there are five additional vertices.  Each of these five vertices meets a quadrilateral or exceptional region.  The total weight is then at least
$$
\begin{array}{lll}
d(8,0) + d(5,0) &> \op{tgt}\hbox{ or }\\
d(8,0) + 2 d(4,0) &> \op{tgt}\\
\end{array}
$$
\end{proof}









\section{contravention gives tame contact}

\begin{theorem}\guid{ZXZSVPH} The standard hypermap of a centered packing with full contact is a tame contact hypermap.
\end{theorem}

\begin{proof}  We go through the list of properties that define a tame contact hypermap and verify that the standard hypermap satisfies each one.

\begin{itemize}
\item The standard hypermap is plain and planar by the general properties of fans.
\item The hypermap is connected because of Lemma~\ref{lemma:DU} which establishes that the faces are in bijection with the connected components of $Y(\orgn,V,E)$.  It is biconnected, because every face is simple by Lemma~\ref{lemma:simple}.
\item The edge map has no fixed points by the general properties of fans.  There are no loops or multiple joins by the general properties of fans.
\item  Each node has at least two darts by biconnectness. Each face is simple; so the two darts at a node lie in different faces.  Thus, we have at least two faces.
\item The cardinality of each face is at least three because there are no loops or multiple joins.  The cardinality of a face is at most $8$ because of the estimate $d(9,0)>\op{tgt}$.  
\item There are twelve nodes by the definition of a centered packing with full contact.
\item We have already remarked that the cardinality of each node is at least two.  The proof that the cardinality is never five or greater appears in Lemma~\ref{lemma:no-5}.
\item The inequality $\tau(F)\ge d(n)$ is Theorem~\ref{lemma:main-estimate-12}.
\item The total weight of the weight assignment is given by equation~(\ref{eqn:delta0}):
$$
\sum_F \tau(F) = (4\pi - 20\Delta_0) < \op{tgt}.
$$
\item Let $v$ be a vertex of type $(p,q,0)$.  Let $A$ be the set of faces that meet the vertex $v$. Then 
$$
\tau_{F\in A}\tau(F) > d(4)~q.
$$
This gives the nonzero entries in the table of bounds $b(p,q,0)$.  The remaining entries follow from Lemma~\ref{lemma:no-5}.
\end{itemize}
\end{proof}




\begin{lemma}\guid{CQRHDZE}\label{lemma:no-5} 
Every node has degree at most four.
Furthermore, suppose the hypermap of a centered packing with full contact has vertex of type $(p,q,0)$.  Then $(p,q)$ must be one of the following values:
$$
(0,3)~(1,3)~(2,2).
$$
\end{lemma}

\begin{proof} Let $\alpha_0 = \op{azim}(2,2,2,2,2,2)$.  The azimuth angle of a rhombus lies between $\beta_0 = \op{azim}(2,2,2,2.52,2,2)$ and
$\beta_1 = 2\op{azim}(2,2,2,2,2.52,2)$.  That of an exceptional region is at least $\beta_0$ and at most $2\pi$.  Thus,
$$
p\alpha_0 + (q+r) \beta_0 \le 2\pi \le p\alpha_0 + q\beta_1 + r 2\pi.
$$
The only three solutions to these inequalities among the natural numbers $(p,q)$ with $r=0$ are those given. There is no solution for $(p,q,r)$ in natural numbers, if $p+q+r\ge 5$.
\end{proof}





\section{linear programs and conclusion}

\begin{lemma}\guid{YRTPQXK}\label{lemma:kiss-fcc} Let $H$ be the hypermap of the face-centered cubic or hexagonal-close packing.   Assume that it occurs as the standard hypermap of a centered packing with full contact.  Then the kissing configuration of the centered packing is congruent to that of the face-centered cubic or hexagonal close packing.
\end{lemma}

\begin{proof} Every face of the hypermap is a triangle or quadrilateral.  The  hypermap is the same as the contact hypermap.  The contact hypermap of the face-centered cubic and hexagonal-close packings fixes the eight regular triangles in the kissing arrangement.  The eight regular triangles fix the kissing arrangement up to congruence.
\end{proof}

\begin{lemma}\guid{MWWSZTX}\label{lemma:fcc} Let $H$ be a hypermap with tame contact.  Assume that it occurs as the aggregate fan of a centered packing with full contact.  Then $H$ is the contact hypermap of the face-centered cubic or hexagonal-close packing.
\end{lemma}

\begin{proof} According to the classification of hypermaps with tame contact, there are eight hypermaps.  Two are the hypermaps of the fcc and hcp.  We must eliminate the remaining six.
\end{proof}

\begin{note}%%XX
I have not eliminated the other six, but it seems fairly trivial in comparison with the linear programming that is required for the proof of the Kepler Conjecture.  There are some obvious linear programming constraints:
\begin{itemize}
\item the angles around each vertex sum to $2\pi$.
\item each angle of a triangle is $\alpha_0$.
\item each angle of each rhombus is between $\beta_0$ and $\beta_1$.
\item the opposite angles of each rhombus are equal.
\item the sum of two adjacent angles of a rhombus are between
$$
\beta_0 + \beta_1 \hbox{ and } \op{azim}(2,2,2,\sqrt8,2,2)2.
$$
\end{itemize}
I suspect that these inequalities together possibly with equally trivial inequalities for a pentagon will show that all but the hcp and fcc are not feasible linear programs.
\end{note}

\begin{theorem}\guid{ANSXBOJ}[packings with full contact]  
Fejes T\'oth's conjecture on packings with full contact holds.
\end{theorem}

\begin{proof} The standard hypermap of a centered packing with full contact has tame contact.  By Theorem~\label{lemma:fcc}, this hypermap is that of the fcc or hcp.  By Lemma~\ref{lemma:kiss-fcc}, the kissing configuration of the centered packing is congruent to the fcc or hcp.  As the center of the packing may be chosen at an arbitrary vertex, every vertex is congruent to one of these two arrangements.  The result follows.
\end{proof}

\begin{note}%XX
I wish to acknowledge some discussions with Catalin Anghel regarding the material of this chapter.  His forthcoming thesis describes $12$-sphere kissing arrangements in much greater depth.
\end{note}