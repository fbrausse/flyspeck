% May 15, 2013.  Unsorted Appendices.

\newpage

\section{Appendix on the definition of FAN}

John Harrison has pointed out a simplified approach to showing that
the fan properties are satisfied.

\newpage
\section{Appendix on the proof of BGMIFTE}

This page contains some notes on the verification that the polar $(V',E',F')$ is
a local fan.   This is an expanded version of  the last paragraph
of the proof of Lemma BGMIFTE.
We check the intersection property of fans, the dihedral property
of local fans, and the face property of local fans.

Since we are treating the last paragraph of the
proof, we may assume that all the other parts of that lemma dealing
with arcs and azimuth angles have been established.

We place ourselves in the context of Lemma BGMIFTE, adopting the
notation from that lemma.  
In particular, $\v_i = \rho^i\v$ and
$\w_i = \v_i \times \v_{i+1}$.  
We take the indices modulo $k=\card(V)$, so that $\v_{i+k}=\v_i$.
By earlier parts of the proof, we have
\begin{equation}\label{eqn:wj'}
\w_j\in W^0(\orz,\w_{i},\w_{i+1},\w_{i-1}),\quad j\ne i-1, i, i+1
\end{equation}
and
\begin{equation}\label{eqn:colw'}
\{\orz,\w_i,\w_j\} \text{ is not collinear, when } i\ne j
\end{equation}  
and
\begin{equation}\label{eqn:arcV'}
\arc_V(\orz,\{\w_i,\w_{i+1}\}) 
=\pi - \angle(\v_{i+1}) >0
\end{equation}
and
\begin{equation}\label{eqn:angle'}
\angle'(\w_{i+1}) 
=\pi -\arc_V(\orz,\{\v_{i+1},\v_{i+2}\})  \in\leftopen 0,\pi\rightopen.
\end{equation}

We verify the fan intersection property of $(V',E',F')$.  Remark GMLWKPK gives
some hints about verifying the intersection property, and notes that it comes
down to two cases:
\begin{enumerate}
\item $\ee\cap \ee' = \emptyset$ implies $C(\ee)\cap C(\ee') = \emptyset$.
\item $\ee\cap\ee' = \{\v\}$ implies $C(\ee)\cap C(\ee') = C\{v\}$.
\end{enumerate}
If $\ee$ and $\ee'$ are both singletons then the intersection property
follows from \eqref{eqn:colw'}.  Without loss of generality assume that $\ee$ is
not a singleton.  By the definition of $E'$, we have 
 $\ee=\{\w_i,\w_{i+1} \}$, for some $i$.  We may partition $C(\ee)$ as
\[
C(\ee) = C^0(\ee) \cup C^0(\w_i) \cup C^0(\w_{i+1})\cup \{\orz\}.
\]
Since we know the intersection property for singletons, we are reduced to showing
the following.
\begin{enumerate}
\item if $\ee'=\{\w_j,\w_{j+1}\}\ne\ee$ is also an edge, then  $C^0(\ee)\cap C^0(\ee')=\emptyset$.
\item for every $\w_j\in V'$, we have $C^0(\ee) \cap C^0(\w_j)=\emptyset$.
\end{enumerate}

Consider the first of these two enumerated 
cases.  Exhanging $i$ with $j$ if necessary,
we may assume that $j\ne i,i+1$.  
Set $\alpha(\p)=\op{azim}(\orz,\w_i,\w_{i+1},\p)$.  For every point
$\p$ in $C^0(\ee)$ we have
$\alpha(\p)=0$ and
$C^0(\ee)\subset A:= \op{aff}\{\orz,\w_i,\w_{i+1}\}$.
We separate this from $C^0(\ee')$ by showing that
$C^0(\ee')\subset A_+^0:= \op{aff}_+^0(\{\orz,\w_i,\w_{i+1}\},\{\w_{i-1}\})$,
and using the disjointness of this open half-space $A_+^0$ from its bounding
plane $A$.

 If $j=i-1$, then by \eqref{eqn:angle'}, for every $\q\in C^0(\ee')$, 
we have 
\[
\alpha(\q)=\alpha(\w_j) = \alpha(\w_{i-1}) \in\leftopen 0,\pi\rightopen.
\]
The values of $\alpha$ separate $C^0(\ee)$ from $C^0(\ee')$.  Note also
that this gives 
\begin{equation}\label{eqn:a+}
\w_{i-1}\in A_+^0
\end{equation}

If $\ell\ne i,i+1$, then by \eqref{eqn:wj'} and \eqref{eqn:a+}, we have
$\w_\ell\in A_+^0$.  From this, we obtain $\ee'\subset A_+^0$ and from
the conic structure of the halfspace $A_+^0$, it follows that $C^0(\ee')\subset A_+^0$.


The second enumerated case is similar,  if $j\in\{i,i+1\}$, then the empty
intersection property $C^0\{\w_i,\w_{i+1}\}\cap C^0(\w_j)=\emptyset$
follows from the strict inequality in the definition of $C^0$ and the
linear independence of $\w_i$ and $\w_{i+1}$.  For example,
\[
t_0 \w_i + t_1 \w_{i+1} = s \w_i,
\]
has no solution in positive real numbers $t_0,t_1,s$.
Otherwise, if $j\not\in\{i,i+1\}$,
we separate $C^0(\ee)$ from $C^0(\w_j)$ by the disjointness of $A_+^0$ and $A$, 
as in the first case.

This completes the proof of the intersection property of fans for the polar.
Next we verify the dihedral property of local fans. 


For this, we review how
a hypermap is attached to the fan $(V',E',F')$.
We have sets $(V',E',F')$ defined to be
\[
V' = \{ \w_i = \v_i \times \v_{i+1}\mid i\},
\]
\[
E' = \{\{\w_i,\w_{i+1}\}\mid i\},
\]
\[
F' = \{(\w_i,\w_{i+1})\mid i\}.
\]
The set of darts of the hypermap consists of all orderings of edges:
\[
D  =\{(\w_i,\w_{i+1}) \mid i\} \cup \{(\w_{i+1},\w_i)\mid i\} = F' \cup F'' \text{ say }.
\]
The set $E'(\w_i)$, with overloaded notation, is defined as the set
\[
\{\w\in V' \mid \{\w,\w_i\}\in E'\},
\]
which in this situation reduces to
\[
E'(\w_i) = \{\w_{i-1},\w_{i+1}\}.
\]
The permutation $\sigma(\w_i)$ of $E'(\w_i)$ is defined as the azimuth
cycle on this set.  Since the set has only two elements, the permutation is
forced to swap $\w_{i-1}$ and $\w_{i+1}$.
The hypermap is a tuple $(D,e,n,f)$, where the permutations of $D$ are
generally defined as follows.
\begin{align*}n(\v,\w) &= (\v,\sigma(\v,\w)),\\
f (\v,\w) &= (\w,\sigma(\w)^{-1} \v),\\
e (\v,\w) &= (\w,\v).
\end{align*}
In the present context, this reduces to
\begin{align*}n(\w_i,\w_{i\pm 1}) &= (\w_i,\w_{i\mp 1}),\\
f (\w_i,\w_{i\pm1}) &= (\w_{i\pm1},\w_{i\pm2}),\\
e (\w_i,\w_{i\pm 1}) &= (\w_{i\pm 1},\w_i).
\end{align*}

To prove the dihedral property, by Lemma QQYVCFM, it is enough
to prove the following properties
\begin{enumerate}
\item the hypermap is connected.
\item the number of darts is $2k$.
\item the orders of $f,n,e$ are $k$, $2$, $2$, respectively.
\end{enumerate}

We have 
\[
f^j(\w_i,\w_{i\pm1}) = (\w_{i\pm j},\w_{i\pm (j+1)}).
\]
Note that the orbit of $f$ on $(\w_i,\w_{i\pm1})$ is $F'$ or $F''\subset D$.
(This proves in particular the face property of local fans: $F'$ is a face of the
hypermap.)
and $n$ exchanges darts in $F'$ and $F''$.  Hence the hypermap is connected.

The sets $F'$ and $F''$ are disjoint and each contain $k$ darts.  Hence
the number of darts is $2k$.

The smallest positive $j$ such that $f^j(\w_i,\w_{i\pm1}) = (\w_i,\w_{i\pm1})$
is $k$.  Hence $f$ has order $k$.  The orders of $e$ and $n$ are $2$ by
inspection.  This completes the verification of the dihedral property of
local fans.

While proving the dihedral property, the face property fell out as well.

This completes the verification of properties intersection, fan, and dihedral.



\newpage
\section{Appendix on deformations of local fans}\label{sec:sup-deformation}

This appendix gives further details about the proof of the wedge property in DSP Lemma 7.25 (ZLZTHIC).

\begin{lemma} \guid{FSQKWKK}\label{lemma:rot}
If $\op{azim}(\orz,\v_1,\v_2,\v_3)\le \pi$ then $\op{azim}(\orz,\v_2,\v_3,\v_1)\le\pi$.
\end{lemma}

\begin{proof}  
$\azim(\orz,\v_1,\v_2,\v_3)\le\pi$  iff $0\le\sin(\azim(\orz,\v_1,\v_2,\v_3))$ iff
$0\le (\v_1\times \v_2)\cdot \v_3$.  The final condition is invariant under even permutations of
the subscripts.
\end{proof}

Recall that $\op{azim}(\orz,\v_1,\v_2,\v_3)\le \pi$ and noncollinearity constraints imply that
$\op{azim}(\orz,\v_1,\v_2,\v_3) = \op{dih}_V (\orz,\v_1,\v_2,\v_3)$.

\begin{lemma} \guid{MKIFWJT}\label{lemma:sum3-azim-fan}
Let $\v,\w_1,\w_2,\w_3\in\ring{R}^3$. Assume that none of the set $\{\orz,\v,\w_i\}$ are collinear
and that $\op{azim}(\orz,\v,\w_1,\w_2)+\op{azim}(\orz,\v,\w_2,\w_3)< 2\pi$.  Then
\[
\op{azim}(\orz,\v,\w_1,\w_2)+\op{azim}(\orz,\v,\w_2,\w_3) = \azim(\orz,\v,\w_1,\w_3).
\]
\end{lemma}

\begin{proof} This is (Fan.sum3\_azim\_fan).
\end{proof}

\begin{lemma}[deform-wedge] \label{lemma:deform-wedge} 
Let $\w_0,\ldots,\w_{n}\in \ring{R}^3$.  Assume that $i\ne j$ implies
$\{\orz,\w_i,\w_j\}$ is not collinear.   Let $r<n$.
Set
\[
d(i,j,k)=\op{dih}_V(\orz,\w_i,\w_j,\w_k) \quad\text{and}\quad a(i,j,k) = \azim(\orz,\w_i,\w_j,\w_k).
\]
Let $c\in\ring{R}^3$ satisfy $0 < 2 c < a(i,i+1,i-1)$, for $i=1,\ldots,r-1$.
Assume that $d(p,q,q+1)<c$ for all distinct triples $\{p,q,q+1\}\subset \{0,\ldots,r\}$.
Assume that $d(p,p+1,q)<c$ for all distinct triples $\{p,p+1,q\}\subset \{0,\ldots,r\}$.
Then for all $k$ we have the statement $S_k$: 
for all $j\le r - k$ we have $\w_j\in \Wdart(\w_{j+k})$ and $\w_{j+k}\in \Wdart(\w_j)$.
\end{lemma}

\begin{proof} We prove $S_k$ by induction on $k$.  The cases $k=0,1$ are trivially satisfied.
Assume that $S_k$.  We show $S_{k+1}$.  Fix $j\le r-(k+1)$.

By induction, $\w_j\in \Wdart(\w_{j+k})$, giving
\[
a(j+k,j+k+1,j)\le a(j+k,j+k+1,j+k-1)\le\pi.
\]
By Lemma~\ref{lemma:rot}, $a(j,j+k,j+k+1)\le\pi$, and converting to dihedral, $a(j,j+k,j+k+1)< c$.

By induction, $\w_{j+k}\in \Wdart(\w_j)$, giving
\[
a(j,j+1,j+k)\le a(j,j+1,j-1)\le \pi,
\]
and converting to dihedral, $a(j,j+1,j+k)<c$.

Since $2c < 2\pi$, we can add the angles,
\[
a(j,j+1,j+k) + a(j,j+k,j+k+1) = a(j,j+1,j+k+1) < 2c < a(j,j+1,j-1).
\]
This says that $\w_{j+k+1}\in \Wdart(\w_j)$.

The proof that $\w_j\in \Wdart(\w_{j+k+1})$ is similar.

By induction, $\w_{j+k+1}\in \Wdart(\w_{j+1})$, giving
\[
a(j+1,j+k+1,j)\le a(j+1,j+2,j)\le \pi.
\]
By Lemma~\ref{lemma:rot}, $a(j+k+1,j,j+1)\le \pi$, and converting to dihedral $a(j+k+1,j,j+1)<c$.

By induction, $\w_{j+1}\in \Wdart(\w_{j+k+1})$, giving
\[
a(j+k+1,j+1,j+k)\le a (j+k+1,j+k+2,j+k)\le \pi,
\]
and converting to dihedral $a(j+k+1,j+1,j+k) < c$.

Since $2c < 2\pi$, we can add angles,
\[
a(j+k+1,j,j+1) + a(j+k+1,j+1,j+k) = a(j+k+1,j,j+k) < 2 c < a(j+k+1,j+k+2,j+k).
\]
This says that $\w_{j}\in \Wdart(\w_{j+k+1})$.
\end{proof}

\begin{proof}
We apply this lemma to prove the wedge property in ZLZTHIC (DSP Lemma 7.25).
As in the proof in DSP, the proof of the wedge property reduces to the case $\v\in \Wdart(\u)\setminus \Wdarto(\u)$.
We have a sequence $\v_0,\ldots,\v_r$, where all of the terms $\v_i$ ($i=1,\ldots,r-1$) are straight.
Pick $c$ such that  $0 < 2c < \azim(\v_i,\v_{i+1},\v_{i-1})$ for $i=1,\ldots,r-1$.
By continuity, there is some $\epsilon > 0$ such that
$2c < \azim(\v_i(t),\v_{i+1}(t),\v_{i-1}(t))$ for $i=1,\ldots,r-1$ when $|t|<\epsilon$.

When $t=0$, the straight conditions give
\[
\dih(\v_p,\v_q,\v_{q+1}) = 0,
\]
for distinct triples $\{p,q,q+1\} \subset \{0,\ldots,r\}$,
and
\[
\dih(\v_p,\v_{p+1},\v_q)=0,
\]
for distinct triples $\{p,p+1,q\}\subset \{0,\ldots,r\}$.
By continuity, shrinking $\epsilon$ as needed, we may assume the corresponding
dihedral angles are less than $c$, when evaluated at $\v_i(t)$, for $|t|<\epsilon$.

All of the conditions of Lemma~\ref{lemma:deform-wedge} are satisfied for
$\w_i = \v_i(t)$ for any $|t|<\epsilon$.  Hence for all $i$ and all $j$ such that $i,j\le r$, we have
\[
\v_i(t) \in \Wdart(\v_{j}(t)).
\]
This is the wedge condition.
\end{proof}

