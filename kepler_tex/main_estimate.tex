%%%%%%%%%%%%%%%%  LOCAL BOUNDS %%%%%%%%%%%%%%%%


\chapter{Assembly}
\label{sec:assembly}

The previous structure gives the details of the geometric structures
that are required in the proof.  Euclidean space has been partitioned
into  $V$-cells.  $V$-cells have been further partitioned according
to fans, simplices in the $Q$-system, fitted crowns, and
the alphabet simplices
of types $\SA$, $\SB$, $\SC$, and $\SD$.   We have developed explicit
volume formulas for these various regions.  The function $\sigma$
has been expressed as a sum of terms, indexed by the various regions.

The previous chapter completes the analysis.  This chapter begins the
synthesis.
This section develops bounds on $\sigma$, by estimating the individual
terms and then summing over the contributions.  We call these assembly
problems, because the 
algebraic sum over the individual terms of $\sigma$
can be viewed as a geometric assembly of regions.

This synthetic phase of the proof is more formal than the analytic phase.
All of the objects are laid out in front of us.  For any given bound, 
we merely have to choose the most suitable
from a wide assortment of objects.  Eventually, we use linear programming
to assemble the bounds.  But even before we turn to linear programming,
these assembly problems can be highly automated.

The chapter starts with a detailed examination of a single assembly
problem, and describes its essential structure.  Once we have convinced
ourselves that solutions to assembly problems can be mass-produced,
we relegate a long list of asssembly problems to an appendix.


\section{Sample Proof}

A large number of bounds on the function
$\sigma$ are required in this book.  In fact, the main
point of the book is to prove the bound
  $$
  \sigma(\Lambda,v)\le 8\,\pt,
  $$
for any centered packing $(\Lambda,v)$.
Hundreds of pages of texts in \cite{DCG} are devoted to
proving various bounds on $\sigma$.  A careful analysis of
this text reveals that these arguments are largely repetitive.
Through further examination of this text, we can replace these
long arguments with various structures that permit the automation
of these proofs.  This process may seem artificial at first.
However, the savings will be significant.  We will succeed in
trivializing over a hundred of pages of estimates from \cite{DCG}.

To ease our way into this new way of presenting estimates, 
we make a detailed analysis of
one proof from \cite{DCG}.  The following lemma and its proof are
based on \cite{DCG}[Lemma~12.4].  The proof will quote results that
have not yet been proved.  We will accept these results 
as established facts for the time being, 
so that we can concentrate on the structure
of the proof as presented.


\begin{lemma}\label{lemma:nonagon}  
Let $(\Lambda,v_0)$ be a centered packing.
Let $(v_0,V,E)$ be the standard fan associated with $(\Lambda,v_0)$,
and let $H=\op{hyp}(v_0,V,E)$ be the associated hypermap.  
Suppose that there is a contour loop $C$ in $H$ that visits
at most nine nodes.  Assume that the contour loop does not make
repeat visits to the same node.
Let $\{V_1,\ldots,V_r\}$ be the components of $Y(v_0,V,E)$ that
are interior to the contour loop $C$.\FIXX{Explain terminology.}
Set 
   $$
   \begin{array}{lll}
   \sigma_C &= \sum_{i=1}^r \sigma(\Lambda,v_0,V_i),\\
   \tau_C &= \sum_{i=1}^r \tau(\Lambda,v_0,V_i).\\
   \end{array}
   $$
Assume that
    $$
    \sigma_C \le s_9,\quad \text{ and } \quad \tau_C \ge t_9,
    $$
where 
    $$
    s_9 = -0.1972 \quad \text{ and } t_9 = 0.6978.
    $$
Then, $(\Lambda,v_0)$ does not contravene.  That is,
$$
\sigma(\Lambda,v_0) \le 8\,\pt - \epsilon_0.
$$
\end{lemma}

First we will give the proof in the same form as \cite{DCG}.
After presenting the proof, we will add further commentary and analysis.


\begin{proof}  
By Lemma~\ref{XX},
  $$
  \sigma(\Lambda,v_0) = \sum_{R}\sigma(\Lambda,v_0,R),
  $$
as $R$ runs over the components of $Y(\Lambda,v_0,V)$.
We wish to show that
  $$
  \sum_{R}\sigma(\Lambda,v_0,R)\le 8\,\pt -\epsilon_0,
  $$
By Lemma~\ref{XX}, this is equivalent to
  \begin{equation}
  \sum_{R} \tau(\Lambda,v_0,R)\ge (4\pi\zeta-8)\,\pt+\epsilon_0.
  \label{eqn:targeted}
  \end{equation}
By Lemma~\ref{XX}, we have $\tau(\Lambda,v_0,R)\ge0$, for
each component $R$.  Thus, it is enough to show that
Inequality~\ref{eqn:targeted} holds when the sum is restricted
to some subset of the components.

The given bounds on $\sigma_C$ and $\tau_C$ are
already sufficient to conclude that all other components of
$Y(v_0,V,E)$ are triangles:
   $$
   t_9 + t_4 > (4\pi\zeta -8)\,\pt + \epsilon_0.
   $$
(The lower bound $t_4$ on a component that is not a triangle apepars
in Theorem~\ref{thm:the-main-theorem}.)
The hypermap has no nodes of type $\pqr{(4,0,0)}$ or $\pqr{(6,0,0)}$:
$$
   t_9 + 4.14\,\pt > (4\pi\zeta-8)\,\pt + \epsilon_0.
$$
(The lower bound $4.14\,\pt$ on the $p$ triangles at a vertex
of type $\pqr{(p,0,0)}$ appears in Table~\ref{eqn:old5.1}.)

Suppose that there are $\ell$ nodes of type $\pqr{(5,0,0)}$.  The
contour cycle has visits  $m\le 9$ nodes and does
not make repeat visits to the same node.  By Lemma~\ref{XX},\FIXX{Not yet typed.}
there are $m-2 + 2\ell\le 7+2\ell$ 
triangular components $U_1,\ldots,U_{m-2+2\ell}$
disjoint from $V_1,\ldots,V_r$, such that
   $$
   \{U_1,\ldots,U_{m-2+2\ell},V_1,\ldots,V_r\}
   $$
are all the components of $Y(v_0,V,E)$.

If $\ell\le 3$, then the result follows by the estimate
   $$
   s_9 + [(7+2\ell)\,\pt - 0.48\,\ell\,\pt] < 8\,\pt - \epsilon_0.
   $$
(The upper bound in square brackets follows from Lemma~\ref{lemma:0.55}.)
If, on the other hand, $\ell\ge 4$, then the result follows from
the estimate
   $$
   t_9 + 4 (0.55)\,\pt > (4\pi\zeta -8)\,\pt + \epsilon_0.
   $$
(The upper bound $4(0.55)\,\pt$ is found in Lemma~\ref{lemma:0.55}.)
This completes the proof.
\end{proof}

\subsection{initial analysis}

We turn to an analysis of the lemma and proof.  This type of result is what
we will call an ``assembly problem.''  This type of result
assembles estimates that have been established elsewhere, without
any attempt to improve the estimates.  The proof
does not require any deep geometric understanding.  The geometry
has been entirely encapsulated in the basic framework of
fans, the hypermap, and the components
of $Y(v_0,V,E)$.  The one combinatorial fact that is needed
(the number of triangles is $m-2+2\ell$) 
has been established elsewhere.  It is not necessary
to understand anything about the nonlinear functions $\sigma(\Lambda,v_0,R)$
and $\tau(\Lambda,v_0,R)$, other than the cited estimates.   
The displayed inequalities are inequalities of real numbers,
which are easily checked by computer
or even a hand-held calculator.  There is no arithmetic beyond
the displayed equations.
In summary,
the proof is nearly void of any substance.   This emptiness
works to our advantage.

At the same time, some intelligence is required to discover the
correct way to assemble the estimates into a proof.   There are
many ways that we might attempt to assembly the proof from estimates
established elsewhere, and various blind attempts at assembly will
fail.  

In the example we provide the search space for the proof
branches in two ways.  First of all, there is the usual branching
into various cases.  Either, there is a component other than
$R_1,\ldots,R_r$ with more than three sides, or there isn't.
Either there is a node of type $\pqr{(p,0,0)}$, with $p\ne 5$; or there isn't.
Either the number of nodes of type $\pqr{(5,0,0)}$ is less than four; or it isn't.

The second type of variation among possible proofs comes from
the grouping of standard components and the choice of which estimate
to apply to each group.  In the case, $t_9+t_4$ of the proof, the
standard components are combined into three groups:
the group surrounded by the contour loop $C$ in the hypermap
(leading to the term $t_9$), the single component that is not triangular
(leading to the term $t_4$), and all other components (which have
the unmentioned lower bound of $0$).  The term
   $$
   t_9 + 4(0.55)pt 
   $$
comes from a combination of three groups:
the components surrounded by the contour loop $C$, the triangular
components around four of the nodes of type $\pqr{(5,0,0)}$, and all other
components (which have the unmentioned lower bound of $0$).
As we will see, the choice of whether to use a bound based on
the function $\sigma$, or a bound based on $\tau$ can be
viewed as a variation of this second type.

\subsection{list form of the proof}

The main outline of this proof can be put into a list:
\bigskip

\centerline{\it centered packings whose standard hypermap has nonagonal face\hss}

\begin{itemize}
\item {\tt if:} there is a non-triangular face:
\begin{itemize}
\item $-t_9$,
\item $-t_4$,
\item $4\pi\zeta\,\pt$.
\end{itemize}
\item {\tt else if:} there is a node of type $\pqr{(p,0,0)}$, with $p\ne 5$.
\begin{itemize}
\item $-4.14\,\pt$,
\item $-t_9$,
\item $4\pi\zeta\,\pt$.
\end{itemize}
\item {\tt else if:} the number $\ell$ of type $\pqr{(5,0,0)}$ nodes is at most $3$.
\begin{itemize}
\item $s_9$
\item $[(7+2\ell)\,\pt - 0.48\,\ell\,\pt]$
\end{itemize}
\item {\tt else:} the number of type $\pqr{(5,0,0)}$ nodes is at least $4$.
\begin{itemize}
\item $-t_9$,
\item $-4(0.55)\,\pt$,
\item $4\pi\zeta\,\pt$.
\end{itemize}
\end{itemize}

Note that we have made use of the identity
$\sigma = 4\pi\zeta\,\pt - \tau$
explicitly by inserting the constant $4\pi\zeta\,\pt$ wherever
appropriate, and negating the $\tau$-terms.

The two types of variation in the proof can be seen by the way
we have presented the list.  The branching according to cases
is labeled with {\tt if} and {\tt else} keywords.  The variation
that comes by the grouping of terms is found in the lists without
these keywords.  

The entire list can be {\it evaluated}.  The value of
a sublist marked with $\star$ is the sum of the items in the list.
For example, the value of 
\begin{itemize}\item[]
\begin{itemize}
\item $-t_9$,
\item $-4(0.55)\,\pt$,
\item $4\pi\zeta\,\pt$.
\end{itemize}
\end{itemize}
is just $-t_9 - 4(0.55)\,\pt + 4\pi\zeta\,\pt$.
The value of a list with bulleted items
is the maximum of the items in the list.
The main conclusion of the lemma is that the maximum value from all
the various cases at the outermost level is at most $8\,\pt -\epsilon_0$.


\subsection{assembly proof as a rooted tree}

We continue with an informal analysis of the proof of Lemma~\ref{lemma:nonagon}.
A well-known construction allows us to associate a rooted
tree with our nested list.  We simply create a node in the tree
for every item that appears at any level of the nested list.  We
draw an edge from each item to each item nested beneath it.
The root of the tree is the outermost entry.  In our example, the
outermost entry is the centered packing with a nonagonal face.
The leaves (sinks) sinks in the tree correspond to innermost list
items, that is, those with no sublists.  In our example, the graph
appears as Figure~\ref{fig:rooted-tree}. 

%% WW not yet done.
\begin{figure}[htb]
  \centering
  \myincludegraphics{noimage.eps}
  \caption{A proof represented as a rooted tree}
  \label{fig:rooted-tree}
\end{figure}

Up to this point, we have clarified the structure of the proof in
our example.  However, we wish to carry this analysis much further.
We wish give a careful specification of the preceding construction
so that a large number of proofs 
can be represented as rooted trees, then
expressed as a piece of computer code, and finally automatically evaluated.
With this in mind, we give a careful definition of the rooted
trees and their nodes.

%% http://en.wikipedia.org/wiki/Tree_%28graph_theory%29 

\begin{definition}[tree,~source,~sink,~leaf,~rooted,~labeling]
A tree is a graph in which any two vertices are joined by a unique path.
A directed tree is a directed graph in whose underlying graph is a tree.
A source in a directed graph is a node that is not the terminal node
of any directed edge.  A sink is a node that is not the initial node
of any directed edge.  We use the term leaf as a synonym of sink.
A directed tree is rooted if there is a unique node (called
the root) that is a source.
A labeling of a graph $G$ from a set $X$ is a map from $X$ to the set
of vertices of $G$.
\end{definition}

Any tree with a distinguished node can be made into a directed
tree in a unique way that makes the distinguished node the root. 
For that reason, we write {\it rooted tree} rather than
{\it rooted directed tree}.

The labels on the nodes much be a data structure that is sufficiently
rich to keep track of the {\it state} of whatever estimates are
being made.
We will consider finite labeled rooted trees, whose label set
is a product $LA=\{{\tt sum, max}\} \times {\cal C}$.   The first
component of the label identifies its {\it type} as either a sum
node or product node. 
The second component of the label is what we call a {\it cluster}.
The set of clusters is defined as a disjoint union of three different sets
of clusters:  vertex clusters, LP clusters, and constant clusters.
Constant clusters are the easiest to define: a constant cluster
is a real number $x\in\ring{R}$.  

\begin{definition}[vertex~cluster]
A vertex
cluster is a tuple
    $$
    (v,V,E,\Lambda,{\cal R},{\cal Q},\ell,x,b),
    $$
where $(v,V,E)$ is a fan that is compatible with
the centered packing $(\Lambda,v)$.  
The set ${\cal R}$ is a subset of the set of components of $Y(v,V,E)$,
${\cal Q}$ is a set of quarters and quasi-regular tetrahedra,
$\ell\in I$ is a discrete index from some set $I$ (which we can
take to be $\ring{Z}$, for example), 
$x$ is a real number, and
$b$ is either true or false.
\end{definition}

Intuitively, we consider $\Lambda$ as the packing under
consideration, with center $v$, and fan $(v,V,E)$.
The purpose of the set ${\cal R}$ is to specify which components
enter into the approximation.  The purpose of $\ell$ is to specify
which (of finitely many) approximation functions to use on the
components ${\cal R}$.  The parameter $x$ is a constant that in \cite{DCG}
is called a {\it penalty}.  The cluster approximation is to be
thought of as $x$ plus the value of the function $\ell$ on ${\cal R}$.
Finally, the boolean parameter $b$ keeps track of the branching into
cases.

We delay the definition of LP clusters.  They are approximations
obtained through linear programs.



There is to be an evaluation function $\op{val}$, which assigns a value
to each cluster.  The value of a constant cluster $x$ is defined to be $x$.
The evaluation function will eventually encompass a large number of
separate cases, distinguished by the index $\ell$.  
In fact, virtually every approximation
to any of the functions $\sigma$ and $\tau$ that appears anywhere
in this book appears as case of the evaluation function for some index
$\ell$.

The set of values of the evaluation function is 
$\ring{R}^\star = \ring{R}\cup\{-\infty\}$.
Addition, $\max$, and inequalities are to be extended from
$\ring{R}$ to $\ring{R}^\star$ in the usual way.  For example,
  $$
  \begin{array}{lll}
    -\infty + x &= -\infty,\\
    -\infty &< & x,\\
    \max(-\infty,x) &= x,\\
    \end{array}
  $$

The purpose of the value $-\infty$ is the following.  Various
clusters may carry the {\it false} boolean flag $b$.  Or the
LP clusters may represent an infeasible linear program.  When
this happens, the most convenient way to handle evaluation is
to assign the value $-\infty$.

\begin{definition}[compatible~valuation]
Let $\op{val}$
be a function $LA\to \ring{R}^\star$.  We say that
a rooted tree $T$ is compatible with $\op{val}$ if for every
node $t$ in the tree, we have
   $$
   \begin{array}{lll}
     \end{array}
   $$
\end{definition}

Either max or sum condition depending on the type:\FIXX{Insert.}






\section{Upright Quarters}


This section brings the upright quarters in the $Q$-system
under control. 
The brick wall analogy explains the purpose of quarters in the
$Q$-system.  An uneven brick wall is evened out by shifting the
bricks along the top of the wall.  The quarters are bricks.  A flat quarter
transfers volume into the Voronoi cell from a neighboring Voronoi
cell where it stands upright.  Quarters are designed to pump extra
volume into undervolumed Voronoi cells such as the pentahedral prisms,
borrowing against cells with volume to spare.  Flat quarters are always
welcome, because they improve the estimates.  Upright quarters are
unwelcome, worsen
the estimates, and are avoided wherever possible. This section
makes the reckoning of upright quarters.

Upright quarters are unwelcome, and we will try to remove them whenever
possible.  Let $Q=\{v_0,v_1,v_2,v_3\}$ be an upright quarter in the $Q$-system.   Recall the estimate of $\sigma(\Lambda,v_0)$.  It consists of a function
$\sigma$ on simplices in the $Q$-system, fitted crowns, special truncation rules on the alphabet simplices and pure quad clusters.  Outside these special structures, the Voronoi cell is truncated at radius $t_0$.
In inexact form, this means we compare $\sigma(Q,v_0,c)$, which
is the contribution from an upright quarter $Q$ to $\sigma(\Lambda,v_0)$, against what
we get by the truncation of a Voronoi cell at radius $t_0$.  We attempt
to show that the truncated Voronoi cell gives an upper bound on $\sigma(Q,v_0,c)$.  If so, we drop the quarter $Q$ from the $Q$-system and revert to
the default scoring rule given by the truncated Voronoi cell.  This
is a process that we call {\it erasing an upright quarter}.  

The strategy, as just described, remains inexact for various reasons.  
First of all, the upright quarters
come in batches along a shared upright diagonal.  We always want 
to treat the batch of upright
quarters along a diagonal as a group, erasing them all, or keeping them all.
Second, often there are fitted crowns along the same upright diagonal.
These can be brought into the estimates in a helpful way.
Third, there are often flat quarters (which are not in the $Q$-system) 
whose convex hulls
meet the convex hulls of the upright quarters in the $Q$-system.  
We call such flat quarters {\it masked flat quarters}.  When an upright
quarter is erased, the flat quarter becomes exposed or {\it unmasked}.
Approximating such unmasked flat by the $t_0$-truncated Voronoi cell
yields overly weak estimates.  Thus, stricter
approximations must be provided for unmasked flat quarters.
Fourth, sometimes we fall short desired upper bound on
$\sigma(Q,v_0,c)$,  where the shortfall is an explicit constant $\pi_0$.
This shortfall $\pi_0$ is called a {\it penalty}.  We include it into the
estimates and move forward.


With these modifications,  strategy of erasing upright quarters
works remarkably well.  
Next, we turn to the implementation details of erasing and expunging.





\subsection{erase and expunge}

We give a precise definition of what it means to erase.  We always
erase all the upright quarters around a given diagonal at once.  Thus
we can express definitions in terms of the upright diagonal.


\begin{definition}[erase]  Let $(\Lambda,v_0)$ be a centered packing.
Let $d=\{v_0,v_1\}$ be
an upright system diagonal.  Let $c$ be its context.  We say that $d$
can be erased with penalty $\pi_0$ if
$$
\sum_{Q\mapsto d}(\sigma(Q,c,v_0) - \op{sv}_0(...)) + 
\sum_{S\mapsto d}(\sigma(S...) - \op{sv}_0(...)) +
\sum_{K\mapsto d}\sigma(K...)
< \pi_0
$$
The first sum runs over upright quarters with diagonal $d$.  The
second sum runs over alphabet simplices of type $C$ with diagonal $d$.
The third sum runs over fitted crowns with diagonal $d$.
We say that $d$ can be erased, if it can be erased with penalty $0$.
\end{definition}

The strategy is to erase as many upright system diagonals as possible.
In the presence of masked flat quarters,  erasing is not the appropriate
action.  We must 
accommodate the flat quarters.  We call this {\it expunging} the upright diagonal.  


\begin{definition}[mask]
Let $(\Lambda,v_0)$ be a centered packing.
A flat quarter $\{v_0,\ldots\}$ is masked by an upright system diagonal $\{v_0,v_1\}$ if there is an upright quarter $Q\in\CalQ(\Lambda,v_0)$ 
along the diagonal such that
$\op{conv}^0(S)$ meets $\op{conv}^0(Q)$.
\end{definition}


Next we define a function $\op{mask}(Q)$ on flat quarters.
This function contains everything
but the kitchen sink.  It was obtained by analyzing the 
1998 solution of the packing problem, listing
every estimate ever used
on a masked flat quarter $Q$, and packaging it all into a definition.

\begin{definition}[mask function]
Let $\op{mask}(Q)$, defined on the set of all flat quarters, be
given as follows.  Consider the following five functions
$f_i$ on slightly different domains $C_i$:
$$
\begin{array}{llll}
  i & f_i & C_i \\
  1 & \Gamma{}{}   & \eta_{234},\eta_{456}\le \sqrt2\\
  2 & \op{sv} & \eta_{234}\ge \sqrt2\\
  3 & \op{sv}_0 - 0.0063 & y_4\ge 2.6, y_1\ge 2.2\\
  4 & \op{sv}_0 - 0.0114 & y_4 \ge 2.7\\
  5 & \op{bound}_{456} & \eta_{456}\ge \sqrt2.\\
  \end{array}
$$
where
  $$
  \op{bound}_{456}(Q) = \min
  \begin{cases}
  \op{sv}_0(Q) &\\
  Z_{3,1} &\\
  \op{sol}(Q)\zeta\,\op{pt} - D_{3,1}.&\\
  \end{cases}
  $$
and
  $$
  Z_{3,1} = 0.00005,\qquad  D_{3,1} = 0.06585.
  $$
\indy{Index}{D@\ensuremath{D(\y{(3,1)})}}
\indy{Index}{Z@\ensuremath{Z(\y{(3,1)})}}
\indy{Index}{D@\ensuremath{D_{3,1}}}
\indy{Index}{Z@\ensuremath{Z_{3,1}}}
For each flat quarter $Q$, let $I_Q$ be the set of indices such
that $Q\in C_i$, for $i\in I_Q$.  Then set
  $$
  \op{mask}(Q) = \max_{i\in I_Q} f_i(Q).
  $$
It is trivial to see that $I_Q\ne\emptyset$.
% (compare $\hat\sigma$ defined in Sec~11.10).  (Imagine each of the
%cases as taking the value $-\infty$ outside
%the constraint of the case constraint.)
\end{definition}


\begin{definition}[expunge]
When an upright system diagonal 
masks flat quarters $Q_1,\ldots,Q_r$,
then we say that we can {\it expunge} the upright system diagonal with penalty $\pi_0$, if 
  $$
  \sum_{S\mapsto d}^k (\sigma^*(S) -\op{sv}_0(S))  + \text{ fitted crown }
  < \pi_0 
   +\sum_{i=0}^r (\op{mask}(Q_i) - \op{sv}_0(Q_i)).
  $$
We take $\sigma^*(S)$ to be $\sigma(S)$ when $S$ is an upright quarter; $\sigma(V_S(t_S))$ when it is a simplex of type $C$; and $\op{sv}_0(S)$ otherwise.
\end{definition}

When we merely erase rather than expunge, the sum over $r$ is absent. 
%Compare p.112, Section~11.1.
If there are no masked flat quarters,  there is no distinction between erasing and expunging.   In general, we try to expunge rather than just erase.
Here are a few basic results about expunging upright diagonals.

\begin{lemma}
Let $(\Lambda,v_0)$ be a centered packing.  Let $d=\{v_0,v_1\}$ be an upright
system diagonal.  Suppose that $d$ is enclosed over  
a flat quarter $Q=\{v_0,\ldots\}$ (which is necessarily masked).  
Then either
\begin{itemize}
  \item $d$ is a loop, having context $\x{(3,1)}$, and such that
    $|v_0-v_1| < 2.91$; or
  \item $d$ can be expunged.
\end{itemize}
\end{lemma}

\begin{proof} This is Lemma~\ref{lemma:ex-x31}.
\end{proof}



\begin{lemma}
Let $(\Lambda,v_0)$ be a contravening centered packing.  Let $d$ be an
upright system diagonal (enclosed over an exceptional standard component)
whose context is $\x{(p,r)}$, with $p+r\ne 4,5$.  Then,
$d$ can be expunged.
\end{lemma}

\begin{proof}
Expunge context $\x{(1,1)}$ as in Lemma~\ref{lemma:mixed-vor0}.
Expunge contexts $\x{(2,1)}$ and $\x{(1,2)}$
as in Section~\ref{lemma:mixed-vor0} %DCG 11.3 
(or Lemma~\ref{XX} % DCG 11.26 
if there is a masked flat
quarter).  Lemma~\ref{lemma:context6-erase} % DCG 11.4 
shows that six or more anchors do not contravene.
\end{proof}



\subsection{slice}
\label{sec:slice}  % was sec:anchored-simplex

This subsection  describes the strategy that
we follow when erasing fails.  
When we are unable to erase or expunge, the strategy will be to
add additional simplices around the upright diagonal, to ``fill it out''
if possible.   This section describes these new simplices (called {\it slices}).
When we are able to surround an upright diagonal with slices, the upright diagonal is called a {\it loop}.  

The definition of these simplices
depends on a constant $3.2$.  Computer experiments  suggest that
when this constant is allowed to be much bigger than this, the
numerical properties of these simplices become unstable, of little
value for estimates.  Thus, we cap the length of the edges on these simplices.
This constant appear throughout this chapter.

\begin{definition}[slice,~loop,~gap]
Let $d=\{v_0,v_1\}$ be an upright diagonal, let $w_1$ be an anchor
of $d$, and let $w_2$ be the anchor that follows $w_1$ in the azimuth
cycle with respect to $(v_0,v_1)$.  If $\op{azim}(v_0,v_1,w_1,w_2)\le\pi$
and $|w_1-w_2|\le 3.2$, we call $\{v_0,v_1,w_1,w_2\}$ a slice of $d$.
We say that $d$ is a loop if for every anchor $w_1$ of $d$, and
following anchor $w_2$, the simplex $\{v_0,v_1,w_1,w_2\}$ is a slice of $d$.
If $\{v_0,v_1,w_1,w_2\}$ is not a slice of $d$, we say that there
is a gap along $d$ between $w_1$ and $w_2$.
%% Gap redefined, not precisely consistent with DCG.
\indy{Index}{slice}\indy{Index}{loop}\indy{Index}{gap}
\end{definition}


\begin{lemma}  Let $(\Lambda,v_0)$ be a centered packing with upright
system diagonal $d=\{v_0,v_1\}$.  Suppose that there is some slice
$S$ with diagonal $d$ and some flat quarter $Q$ with vertex $v_0$ such
that $\op{conv}^0(S)$ meets $\op{conv}^0(Q)$.  Then $Q$ is masked by
$d$.
\end{lemma}

\begin{proof} \FIXX{Insert}
\end{proof}



\begin{definition}[enhanced context]
% Def'n copied from linprog.tex
Suppose that no flat quarter
is masked by the upright system diagonal $d$, whose context is
$\x{(3,1)}$.  Suppose further that there 
is a gap and that its azimuth angle is less than $\pi$.  We extend
notation for contexts, writing
 $\xtazimlt$ for this context.  % 3-unconfined.
If there is a gap with azimuth angle at least $\pi$, we say it
has context $\xtazimge$.  % 3-crowded.
We write $\xfgap$ for context $\x{(4,1)}$, when there is
a gap. % 4-crowded
More generally, we embellish the notation for context with symbols that
denote specialized contexts, such at $\x{(p,r : \op{loop})}$ if
the context is a loop, or $\x{(p,1 : \op{gap})}$ if there is a gap.
\end{definition}

%Sections~\ref{x-3.4} and \ref{x-3.5}
%reduce everything to contexts with four or five anchors around each
%vertex.  If there are $5$ darts, 
%Remark~\ref{rem:5dart} shows that we can assume at most one
%gap. This gives contexts $\x{(5,0)}$ and $\x{(4,1)}$.  If there are four
%anchors, then Lemma~\ref{x-3.9.1} will dismiss all contexts except
%$\x{(4,0)}$ and $\x{(3,1)}$. Thus, every upright diagonal will
%reduce to exactly one of
%the following: a loop, $\x{(3,1,:\op{azim}(\op{gap})<\pi)}$,
%$\x{(3,1: \op{azim}(\op{gap}) \ge \pi)}$,
%$\x{(4,1:\op{gap})}$



\begin{lemma}  Let $(\Lambda,v_0)$ be a centred packing.  
Let $\CalR$ be the set of alphabet simplices and simplices in the $Q$-system.
Let $(v_0,V,E)=(v_0,V_{std}(\CalR),E_{std}(\CalR))$ be the standard fan, extended
by $\CalR$.  Let $U\in[Y(v_0,V,E)]$.
Let $d = \{v_0,v_1\}$ be an upright system diagonal, and $(v_0,v_1,w_1,w_2)$
a dart that leads into $U$.  Assume that $S=\{v_0,v_1,w_1,w_2\}$ is a slice.
Assume that $S\not\in\CalR$; that is, $S$ is not an alphabet simplex or
an upright quarter.  Then $\op{aff}_+^0(v_0,\{v_1,w_1,w_2\})\subset U$.
Morover $$\op{conv}^0(S) \cap \op{conv}^0(S') =\emptyset$$
for every $S'\in \CalR$.
\end{lemma}





The next lemma is a consequence of the two others that follow
(Lemma~\ref{lemma:slice-quarter}, Lemma~\ref{lemma:3-crowded}).
\FIXX{Extract the geometry as a lemma that is independent.}




\begin{lemma}\tlabel{lemma:anchor-no-overlap}
Let $(\Lambda,v_0)$ be a centered packing.  Assume that $U$ is a
standard component in which ever upright system diagonal has four
or five anchors, and does not have context $\xtazimge$.  Let
$d = \{v_0,v_1\}$, $d'=\{v_0,v_1'\}$ be upright system diagonals
with $v_1,v_1'\in U$.
Let $S$ be an slice along $d$, and $S'$ one along $d'$.
If $S\ne S'$, then 
$$\op{conv}^0\,S \cap \op{conv}^0\,S' = \emptyset.$$
\end{lemma}

\begin{proof}
Let $w$ and the
slice $S=\{v_0,v,v_1,v_2\}$ be as in Section~\ref{sec:slice}.
Our object is to describe the local geometry when an upright
diagonal is enclosed over a slice. If $|v_1-v_2|\le
2\sqrt{2}$, by Tarski arithmetic\tarf{double-face},
there can be no enclosed upright diagonal with $\ge 4$ anchors
over the slice $S$.

Assume  $|v_1-v_2|>2\sqrt{2}$. Let $w_1,\ldots,w_k$, $k\ge4$, be the
anchors of $\{v_0,w\}$, indexed consecutively. The anchors of $\{v_0,w\}$ do not
lie in $C(S)$, and the triangles $\{v_0,w,w_i\}$ and $\{v_0,v,v_j\}$ do not
overlap. Thus, the plane $\{v_0,v_1,v_2\}$ separates $w$ from
$\{w_1,\ldots,w_k\}$. Set $S_i=\{v_0,w,w_i,w_{i+1}\}$.
By a calculation\footnote{\calc{83777706}} %A8
%$\A_8$,
    $$\pi\ge \dih(S_1)+\cdots+\dih(S_{k-1})\ge (k-1)0.956.$$

Thus, $k=4$. The common upright diagonal  of the three simplices
$\{S_i\}$ has context {\it $\xtazimge$}.  We claim that
$\{v_1,v_2\}=\{w_1,w_4\}$. Suppose to the contrary that, after
reindexing as necessary, $S_0=\{v_0,w,w_1,v_1\}$ is a simplex, with
$v_1\ne w_1$, that does not overlap $S_1,\ldots,S_3$. Then $\pi\ge
\dih(S_0)+\cdots+\dih(S_3)$. So
    $0.28\ge \pi-3(0.956)\ge \dih(S_0)$.
A calculation\footnote{\calc{83777706}} %A8
now implies that $|w-v_1|\ge 2\sqrt{2}$.

By Tarski arithmetic\tarf{336}, the four vertices
$\{v_0,w,v_1,v_2\}$ cannot be coplanar.
We have that $2\sqrt{2}\ge|w-v_0|$ and by Tarski arithmetic\tarfE{E:part4:1},
we also have $|w-v_0|>2\sqrt2$.
This contradiction establishes that $v_1=w_1$.
\end{proof}





\subsection{five anchors}

\FIXX{Rewrite}

We review the results on five anchors. 
Lemmas~11.4, 11.5 show that in the five anchored situation there is at most one  gap in a contravening star.  When there is one  gap (Lemma~11.18), the four slices are all upright quarters. If the five anchors form a loop, the parameters are $\x{(p,r)}=\x{(5,0)}$ or $\x{(4,1)}$.  (The proof that we are over target in cases $(5,\ge2)$ relies on drawing an edge of length up to length $3.2$.  However, since this immediately puts the figure over target, so that the deformation argument is not needed, and there is no need to restrict to lengths $\le 2.91$.) Also, in the case $\x{(5,0)}$, the standard region is a polygon to begin with and no deformation is required.  Thus, the only two cases in which the deformation argument is relevant are one  gap $\x{(4,1:\op{gap})}$ and a loop $\x{(4,1:\op{loop})}$.g

\begin{lemma}
Consider an upright system diagonal with one gap $\x{(4,1:\op{gap})}$.
It can be erased with penalty $3\xi_\Gamma$.  Also, the material
from the upright diagonal squanders more than $\op{squander-target}/2$.
\end{lemma}

\begin{proof}
 When there is one gap and five anchors, we have estimates of the score and squander
from Lemmas~11.18 and Lemmas~11.19.  
In particular, the material from the upright diagonal squanders at least 
  $$(0.4 + 0.02274) > \op{squander-target}/2.$$  
We can expunge with penalty
  $$\max \left(\begin{array}{lll}
  3\xi_\Gamma + \xi_{\kappa,\Gamma}\\
  2\xi_\Gamma + 0.0114 - 0.02274_\kappa\\
  2 (0.0114) - 0.02274_\kappa\\
  \end{array}
   \right)\le 0.03344 < 3\xi_\Gamma.$$
\end{proof}
  
\begin{lemma}  When there is an upright system diagonal with context
$\x{(4,1:\op{loop})}$, then \FIXX{Insert from proof.}
\end{lemma}

\begin{proof}
The material from the loop satisfies by the table
of page 155
  $$
  \tau > 0.5941 > \op{squander-target}/2,\quad \sigma < -0.376.
  $$
When the upright diagonal has height $h$, and there exists an slice
with $y_4 > 2.91$, we can expunge with penalty
  $$
  \begin{cases}
  2 \max(2\xi'_\Gamma,0.0114+2\xi_V) < 3\xi_\Gamma, & h \ge 2.57\\
  2 \max(2\xi_\Gamma,0.0114+2\xi_V) - 0.0201_\kappa < 3 \xi_\Gamma, & h < 2.57\\
  \end{cases}
  $$
\end{proof}

Write $\x{(4,1:\op{loop}:2.91+)}$ for with some $y_4 > 2.91$ and $\x{(4,1:\op{loop}:2.91-)}$, otherwise.

\subsection{four anchors}

We review four anchors.
Lemma~\ref{XX} % DCG 11.21 
treats two  gaps.  If there is one  gap and a masked flat, then it can be expunged (Lemma~\ref{XX}).  % DCG 11.23).  
If there
is no masked flat (OLGA4), 
the slices can be erased with penalty $0.008$ (or even $0.0022$ if some slice is not a quarter) by Lemma~\ref{XX}. % DCG 11.23.  
For loops, the context $\x{(4,0)}$
is not relevant for deformation, because it is a quad cluster.  This leaves contexts $\x{(3,1)}$, $\x{(2,2)}$, $\x{(1,3)}$, 
described in Section~\ref{XX}\FIXX{loop table, page 155, DCG}. 


\begin{lemma}
Let $(\Lambda,v_0)$ be a centered packing.  
Let $d = \{v_0,v_1\}$ be an upright
system diagonal with context $\x{(3,1)}$.  
Assume that $\op{azim}(v_0,v_1,w_1,w_2)\ge\pi$ for some pair of consecutive anchors $w_1,w_2$ of $d$.   Then $d$ can be expunged.
\end{lemma}

\begin{proof} This is Lemma~\ref{lemma:ex-xtazimge}.
\end{proof}



$\x{(1,3:\op{loop})}$.  We can expunge an $\x{(1,3)}$ loop if there is an slice with $y_4\ge 2.91$.  (There is no masked quarter and no distinction between erasing and expunging.)  We use Equation~\ref{eqn:0201} and $\xi_\Gamma - 0.0201 < 0$.  So on a $\x{(1,3)}$ loop we may assume that the slices satisfy $y_4 < 2.91$.

$\x{(2,2:\op{loop})}$. Consider an $\x{(2,2)}$ loop when there is an slice with $y_4\ge 2.91$.  
If there is a masked flat (wlog we can take the diagonal not to be enclosed, since we have treated enclosed already),  we can expunge the diagonal $2\xi_V - 0.0201_\kappa < \min(-0.0063,-0.0114)$.  If the height of the diagonal satisfies $y_1\ge 2.57$, we can erase: $2\xi_V - 0.0201_\kappa < 0$.  We introduce the following
hypothesis on slices with $y_1 \le 2.57$ and $y_4 \ge 2.91$:
  \begin{equation}
  \kappa(S) < - 0.022\qquad\text{(HYPOTHESIS I 8220246614)}
  \end{equation}
Also, if $2.57\le y_1\le\sqrt8$ and $y_4\ge 2.91$, then
  \begin{equation}
  \kappa(S) < - 0.03\qquad\text{(HYPOTHESIS I 2333917810)}
  \end{equation}
(These are stronger inequalities than the hypthesis Equation~\ref{eqn:0201} mentioned earlier, so a separate proof of the earlier inequality is not needed.)
Then the material squandered around the loop is, by the chart of page 155, at least 
  $$
  0.3992 + 0.022_\kappa > \op{squander-target}/2.
  $$
We can expunge with penalty $\max(2\xi_\Gamma,0.0114+2\xi_V)$.
Write $\x{(4,2:\op{loop}:2.91-)}$ for a loop such that all $y_4\le 2.91$ and  
$\x{(4,2:\op{loop}:2.91+)}$ for a loop
42 such that some $y_4>2.91$.

  
$\x{(3,1:\op{loop})}$.   Consider an $\x{(3,1)}$ loop when there is an slice with $y_4\ge 2.91$ and the upright diagonal has height at least $2.57$.  If there is a masked
flat quarter, we may assume that the diagonal is not enclosed (that case
has been treated above).  It can be expunged: $$-0.03_\kappa + \xi'_\Gamma + 2\xi_V < \min(-0.0063,-0.0114).$$  If there is no masked flat quarter, it can
still be expunged (erased):  $3\xi'_\Gamma - 0.03_\kappa < 0$.  What remains are loops $\x{(3,1:\op{loop})}$ with $y_4\le 2.91$ or diagonal height at most $2.57$.


($\x{(3,1:\op{loop}:2.91+:2.57-)}$) consider an $\x{(3,1)}$ loop with $y_4>2.91$ for some slice $S_0$ and diagonal
height at most $2.57$.  (Call these $\x{(3,1:\op{loop}:2.91+:2.57-)}$.)  
\begin{lemma}
If the dihedral angle of $S_0$ is at least $2\pi - 3.3$, and if $\kappa(S_0)< -2\xi_\Gamma$
then the loop can be expunged.
\end{lemma}
\begin{proof}
Note that in this context there is not a masked flat with enclosed diagonal, because $\pi + 0.956 > 3.3$.  If there is a masked flat
we can expunge: $-0.029 + \xi_\Gamma < -0.0114$.  We follow Case~1 of the argument used to expunge $\xtazimge$ configurations. 
When all three upright quarters have compression type, we use
$\sum_{(3)} \op{dih}(S) \le 3.3$ to get
   $$\kappa(S_0) + \sum_{(3)}(\sigma-\op{vor}_0) < 
      - 2\xi_\Gamma + [0.5 (3.3) - 3 (0.54125)] < 0.$$
When one or more of the three uprights have Voronoi type, we use
  $$\kappa(S_0) + \sum_{(3)}(\sigma - \op{vor}_0 ) <
    -2 \xi_\Gamma
    +2 \xi_\Gamma
     =0.$$
\end{proof}
Assume that all loops satisfying these conditions have been expunged.



There is at most one of $\x{(4,1:\op{gap})}$, $\x{(4,1:\op{loop}:2.91+)}$, $\x{(4,2:\op{loop}:2.91+)}$  because any two add up to more
than the squander target.  We can expunge the $\x{(4,1:\op{gap})}$, $\x{(4,1:\op{loop}:2.91+)}$, or $\x{(4,2:\op{loop}:2.91+)}$ together
with all the OLGA4's with penalty at most $\pi_{max}=0.06688$ (Lemma~12.6 continues
to hold in this slightly modified situation.)  When we expunge all this,
we are only left with loops such that every $y_4\le 2.91$ (call these constricted loops) and with loops $\x{(3,1)}$
with diagonal height at most $2.57$.    We subdivide the subregions first with
distinguished edges of length at most $2\sqrt2$, then out to $2.91$ (provided
that it doesn't form a special simplex and provided the edge doesn't cross another distinguished edge).  Doing this separates off all the
constricted loops.  

As in DCG, we work with a single standard region, 
removing all vertices and edges
external to the region.

\section{Deformation}

It is in this setting that we finally apply the reduction to polygon argument of
Section~12.7.  The deformation should move rigidly all the slices around each $\x{(3,1:\op{loop}:2.91+:2.57-)}$.  
The stopping condition for the deformations is any of the three
following.  (A) A new edge develops of length $\le2.91$ between two vertices
of height $\le 2.51$ such that (a1) does not cross any other such edge or anchor and such that (a2) is not a special diagonal.  (B) An upright diagonal in a $\x{(3,1:\op{loop}:2.91+:2.57-)}$ acquires a new anchor
(with distance exactly $2t_0$ to the top of the diagonal).  (C) The distance
between tops of upright diagonals becomes $2$.  In general, there
may be several connected components of the boundary of the subregion.
When a stopping condition brings two components together, other deformation is carried out bringing other components components together until stopping
conditions are reached for each component.  Similar remarks apply
to single components whose boundaries are not simple.

\begin{lemma}
We claim edges of types $A,B,C$ do not cross.
\end{lemma}

\begin{proof}
The proof goes as follows.
By assumption edges of type $A$ do not cross one another.
There is no $CC$, $BC$, or $BB$ crossing by geometric considerations:
   $$
   \begin{array}{lll}
   {\CalE}(2,2,2,2.57,2.57,2,2,2,2) &> 2.86 > \sqrt8.\\
   {\CalE}(2,2,2,2.57,2.51,2.51,2,2,2) &> 2.73 > 2.51.\\
   \end{array}
   $$
An $A$ edge does not cross over a $B$ or $C$ edge by geometric considerations:
   $$
   {\CalE}(2,2,2,2.51,2.91,2.51,2,2,2) > 2.51.
   $$
In a crossing of an edge of type $A$ under an edge of type $C$, we
may assume that some endpoint of the $A$-edge has distance at least $2.51$
from some endpoint of the $C$-edge.  (Otherwise, the stopping condition
is already met with $B$-edges before the $A$-edge had a chance to form.)
This $AC$-crossing cannot form by geometric considerations:
   $$
   {\CalE}(2,2,2,2.57,2.57,2,2.51,2,2) > 2.91.
   $$
Similar remarks apply for an $A$ under $B$ crossing.  We may assume that
the distance from the anchor to an endpoint of $A$ is at least $\sqrt8$
or that the distance from the top of the upright diagonal to $A$ is
at least $2.51$.  Otherwise the stopping conditions prevent the formation.
We have
   $$
   \begin{array}{lll}
   \CalE(2,2,2,2.57,2.51,2.51,\sqrt8,2,2) > 2.91\\
   \CalE(2,2,2,2.57,2.51,2.51,2,2.51,2) > 2.91\\
   \end{array}
   $$
This completes the proof of the claim.
\end{proof}

Recall that by Corollary~11.6, a vertex of height at most $2t_0$ is
never enclosed over an slice.  We can also assert that
a vertex of height at most $2.57$ is never enclosed over a slice.
  In fact, if this occurs, in view of what has been expunged,
the vertex is part of a $\x{(3,1:\op{loop}:2.91+:2.57-)}$.  In view of the results on the non-crossing
of edges, an anchor of that loop  would also be enclosed over the
slice, which is impossible by Corollary~11.6.

\begin{lemma}
We claim that the stopping condition with type
$B$ edges never occurs.
\end{lemma}

\begin{proof}
Let $\{0,v\}$ be the upright diagonal, and let $\{v_1,\ldots,v_4\}$ be the anchors.  let $v_0$ be a new anchor that forms, say between $v_1$ and $v_4$.  If $|v_0-v_1|< 3.2$ and $|v_0-v_4|<3.2$, then we have distinguished edges $\{v_0,v_1\}$ and $\{v_0,v_4\}$.  This makes $v_0$ rigidly attached to the other anchors, so that the deformation cannot have occurred.  Thus, we may assume that $|v_0-v_1|\ge 3.2$.  This is an impossible geometric situation.  In fact, geometric considerations show we cannot simultaneously have
  $$
  \op{dih}(0,v,v_1,v_0) + \op{dih}(0,v,v_0,v_4)\le 3.0
  $$
and $\{v_4,v_1\}$ has length at most $3.2$ and passes through $\{0,v,v_0\}$.  

We add a few details.  Recall, we have expunged loops $\x{(3,1:\op{loop}:2.91+:2.57-)}$ in which there is an slice with $y_4\ge 2.91$, $\kappa(S)<-2\xi_\Gamma$ and $\op{dih}(S)\ge 2\pi-3.3$.  The new anchor (from type B) breaks the slice into two
pieces.  
In this situation, we have that $\kappa = \kappa_1 + \kappa_2$, where $\kappa_1 < -0.029$ as usual.  Assume that
$y_1\in[2.51,2.57]$, $y_4\in[2,2.51]$, $y_5=2.51$, then (compare $(y_1,\ldots,y_6) = (2.51,2,2.51,2,2.51,2)$: 
   $$\kappa_2 =\kappa(S_2) < -2\xi_\Gamma + 0.029.\qquad 
      \text{(HYPOTHESIS I 6863978831)}$$
So $\kappa < -2\xi_\Gamma$.  We may then assume that on an unexpunged
loop, we have $\op{dih}(S)\le 2\pi-3.3\approx 2.98319 < 3.0 - 2(0.0084)$.
So the result follows from the calculations on the given domain:
    $$
    \begin{array}{lllll}
    \op{dih}(y_1,\ldots,y_6) > \op{dih}(2.51,2.51,y_3,y_4,y_5,2.51) - 0.0084&\\
    \Delta(2.51^2,x_2,x_3,3.2^2,x_5,x_6) &\ge 0 \\ \quad \Rightarrow 
    \op{dih}(2.51,2.51,y_3,2,y_5,2.51) + \op{dih}(2.51,y_2,2.51,3.2,2.51,y_6) &\ge 3.0\\
    \text{(HYPOTHESES I 6410186704, I 3008133607, I 5617427593)}
    \end{array} 
    $$
\end{proof}

\begin{lemma}
We claim that the stopping condition with type $C$ edges never
occurs.
\end{lemma}

\begin{proof}
Assume to the contrary that such an edge forms.
Let $\{0,v\}$ and $\{0,w\}$ be the upright diagonals of height at most
$2.57$.  let $v_1,\ldots,v_r$ be the anchors of $\{0,v\}$.  By argument on $B$-edges in the previous
paragraph, we may assume that $r=4$, the number of anchors in a $\x{(3,1:\op{loop}:2.91+:2.57-)}$ loop.  Order the anchors so
that the edge $C$ between $v$ and $w$ appears
between $v_1$ and $v_4$.  We claim that the
conditions $|w-v_1|\ge 2.51$ and $|w-v_4|\ge 2.51$ cannot
both hold for geometric reasons.
Otherwise we have a configuration $\{0,v,w,v_1,v_4\}$ with the edge $\{v_1,v_4\}$ passing through $\{0,v,w\}$ and $|v_1-v_4|\le 3.2$.  Geometric considerations show that this cannot happen.  At the other extreme, if $|w-v_1|<2.51$ and $|w-v_4|<2.51$, then $v_1,v_4$ are anchors of $w$.  This is a rigid situation that could not have been deformed; so it never arises.  

Thus, we have (say) $|w-v_1|<2.51$ and $|w-v_4|\ge 2.51$.  Let $w_4$ be the anchor of $w$ following $v_1$ in the cyclic order around $w$.
We have a configuration of six point $\{0,v,w,v_1,v_4,w_4\}$.  The edges $\{v_1,v_4\}$ and $\{v_1,w_4\}$ pass through $\{0,v,w\}$ and have length at most $3.2$.  If the distance $|v_4-w_4|<\sqrt8$, then we have a distinguished edge $(v_4,w_4)$.  This creates a rigid configuration that admits no deformation.  So it could not have occurred.  We may assume that $|v_4-w_4|\ge 3.2$.  Then a calculation shows $\op{dih}(0,v_1,w_4,v_4) > 1.2$ (HYPOTHESIS I 2377396571).    Another calculation shows that
$\op{dih}(0,v_1,w,v) < 1.2$ (HYPOTHESIS I 3656545285).  However, this is a contradiction, because
  $$
  \op{dih}(0,v_1,w,v)+\op{dih}(0,v_1,w_4) + \op{dih}(0,v_1,v,v_4) = \op{dih}(0,v,v_4,w_4).
  $$
This completes the proof that the $C$ edge cannot form.
\end{proof}



Thus, deformation only creates new $A$ edges.  We continue deformations until each polygon is simple.  Then we continue in DCG as before.  We add additional edges up to length $3.2$; break off $\x{(3,1:\op{loop}:2.91+:2.57-)}$ loops; and obtain estimates as in DCG.







\subsection{distinguished blades} %DCG 12.3, p128
    \oldlabel{4.2}

Take an exceptional cluster.  We prepare the cluster by erasing
upright diagonals, including those that in context $\xtazimlt$,
$\xtazimge$, or $\xfgap$.  The only upright diagonals that we
leave unerased are loops.  When the upright diagonal is erased, we
score with the truncated function $\op{sovo}(\cdot,\lambda_{oct})$ 
away from flat
quarters.  Flat quarters are scored with the function
$\hat\sigma$. The exceptional clusters in this chapter and Chapter~\ref{x-5} 
are assumed to be prepared in this way.


\begin{definition}[special]
A simplex $S$ is {\it special\/} if the fourth edge has length at
least $2\sqrt{2}$ and at most $3.2$, and the others have length at
most $2t_0$. The fourth edge will be called its diagonal.
\end{definition}

We create a fan.  Each vertex will have
height at most $2t_0$.  The blades of the fan
will divide the standard component into substandard components. We
call an (open) blade {\it nonexternal\/} if it
edge lies entirely in the exceptional component.

\begin{enumerate}
\item Draw all nonexternal blades from edges of length at most $2\sqrt{2}$
except those between nonconsecutive anchors of a remaining upright
diagonal. These blades do not cross (Tarski arithmetic\tarf{skew-quad}).
These blades do not cross the blades of slices
(Tarski arithmetic\tarf{qrtet-pair-pass} and
Tarski arithmetic\tarfE{pass-anchor}).

\item Draw all blades of (remaining) slices
that are opposite the upright diagonal, except when the blade gives
a special simplex. The interiors of distinct slices do
not meet (Lemma~\ref{lemma:anchor-no-overlap}), so these (open) blades do
not meet. They are are nonexternal 
(Lemma~\ref{lemma:anc-simplex-not-enc} and
Tarski arithmetic\tarfE{2t0-doesnt-pass-through}).

\item Draw as many additional nonexternal blades as possible of
length at most $3.2$ subject to not meeting another blade, not
crossing any blade of a slice, and not coming from  the
diagonal of a special simplex.
\end{enumerate}

We fix once and for all a maximal collection of edges subject to
these constraints. Edges in this collection are called {\it
distinguished\/} edges.  They form a fan.  The components of the complement
of this fan are
called the {\it substandard components}.  Each standard component is a union of
substandard components (together with separating blades). 
The vertices of height at most $2t_0$ and the vertices
of the remaining upright diagonals are said to form a {\it
subcluster}.


By construction, the special simplices and slices
around an upright quarter form a subcluster.  Flat quarters in the
$Q$-system, flat quarters of an isolated pair, and simplices of
type $\SA$ and $\SB$ are subclusters.  Other subclusters are
scored by the function $\op{sovo}(\cdot,\lambda_{oct})$. 
For these subclusters,
Formula~\ref{eqn:3.7} extends without modification.


\subsection{convex deformation} %DCG 13.1, p143
    \oldlabel{5.1}
We divide the bounding edges over the polygon according to length
$[2,2t_0]$, $[2t_0,2\sqrt{2}]$, $[2\sqrt{2},3.2]$. The deformations of
Section~\ref{x-4.9} contract edges to the lower bound of the intervals
($2,2t_0$, or $2\sqrt{2}$) unless a new distinguished edge is formed. By
deforming the polygon, we assume that the bounding edges have length
$2,2t_0$, or $2\sqrt{2}$. (There are a few instances of triangles or
quadrilaterals that do not satisfy the hypotheses needed for the
deformations. These instances will be treated in Sections~\ref{x-5.7}
and \ref{x-5.8}.)



Lemma~\ref{lemma:convex-deform-ht} 
implies that $f$ does not have an interior point local maximum
for $x_1\in[2^2,2t_0^2]$.  Fix three consecutive corners, $v_1,v_2,v_3$
of the convex polygon, and apply the lemma to the variable $x_1 =
|v_2-v_1|^2$ of the simplex $S=\{v_0,v_1,v_2,v_3\}$. We deform the simplex,
increasing $f$.  If the deformation produces flattens out the simplex, 
so that some
dihedral angle is $\pi$, then the arguments for nonconvex components bring
us eventually back to the convex situation. Eventually $y_1$ is $2$ or
$2t_0$.  Applying the lemma at each corner, we may assume that the
height of every corner is $2$ or $2t_0$.   (There are a few cases where
the hypotheses of the lemma are not met, and these are discussed in
Sections~\ref{x-5.7} and \ref{x-5.8}.)





\section{Main Estimate} %DCG 12.1, p125
    \label{sec:the-main-theorem}
    \oldlabel{4.4}

This section turns turns to the main estimate of the book.
The main estimate gives bounds on $\sigma(\Lambda,v_0,U)$ and
$\tau(\Lambda,v_0,U)$ when $U$ is a standard component of 
a centered packing $(\Lambda,v_0)$.  The bounds depends only
on the combinatorial properties of set of darts in the standard
hypermap that lead into $U$.  By giving a combinatorial bound
on a geometric quantity, the main estimate 
marks a transition from geometry to combinatorics.  It
marks the turning point of the solution.

In the main estimate, we confront one of the central difficulties of
the packing problem.  The difficulty is that a general
packing has little mathematical structure.  There
are myriads of indescript packings.  There is no uniform
shape to them that bundles them neatly into a package.  The
main estimate is the result that
caps the complexity of this unruly collection
of packings.

When a small number of darts lead into the standard component,
the main estimate is readily obtained by interval arithmetic.  The
main estimate for components with many darts presents significant
challenges.  If we look for guidance in Leech's argument,
we might try triangulating the hypermap and inserting corresponding
blades into the fan.  Triangulation brings us back to a low-dimensional
situation.  This helps to a certain extent.  However, unless
we impose an upper bound on the length $|u-v|$ of
the new edges $\{u,v\}\in E$ of a fan, the
functions $\tau$ and $\sigma$ on these triangles become numerically
unstable and poorly behaved in many ways. 
Numerical experiments show
that we can insert edges $\{u,v\}$ of length up to $3.2$.  Beyond that
length, instability prevails.
In fact, experiments suggest that
we need an even tighter upper bound in a special situation.  (These
are called {\it special simplices}.)

Because of the upper bound $3.2$ on edge lengths, we are not always
able to triangulate.  In this case, we adopt a dual strategy (vaguely
reminiscent of the duality between the Delaunay triangulation and
Voronoi cells).  When the triangulation does not succeed, we define
a cell around each dart that leads into $U$.  These are the truncated
corner cells, truncated Voronoi cells of sorts.  By adding up the 
contributions of each cell, we get bounds on the functions $\sigma$ and
$\tau$.

There are a number of preliminary reductions that lead up to the
main estimate. 

First of all, the combinatorics undergo a preliminary simplification.
When the set of darts that lead into a component $U$ lie in
two or more group orbits of the hypermap, we show that it is possible
to deform the centered packing $(\Lambda,v_0)$ in a way that
reduces the main estimate to the analysis of a component tagged
by a single simple face of the hypermap.

Next, after reducing to a single simple face is made, we investigate
how the functions $\sigma$ and $\tau$ vary when a single vertex
of the packing is moved.  When that vertex lies at a concave dart
leading into the component $U$, it turns out that the functions $\sigma$ and
$\tau$ are monotonic. This allows us to deform the region at each
concave dart to bring the region into simpler form.  Eventually 
we reduce to the case in which every dart leading into $U$ 
is convex.  It is at this stage of the argument that the truncated
corner cells are introduced to make the estimates.

\subsection{statement}

Let $(\Lambda,v_0)$ be a centered packing with standard component
$U$.  Assume that $U$ is exceptional; that is, it is not tagged
by a triangle or quadrilateral.  Let $\CalQ_U$ be the set of
simplices $\{v_0,v_1,v_2,v_3\}$ in the $Q$-system such that
$$
\op{aff}_+^0(v_0,\{v_1,v_2,v_3\})\subset U.
$$
Let $\Lambda_U$ be the set of vertices at darts that lead into $U$,
together with the set of vertices of simplices in $\CalQ_U$.
We have 
   $$U\in[Y(v_0,V_{std}(\Lambda,v_0),E_{std}(\Lambda_U,v_0))].$$
That is, $U$ is a standard component with respect to $(\Lambda,v_0)$
and a standard component with respect to the packing $(\Lambda_U,v_0)$.

By the Decoupling Lemma~\ref{XX}, the functions $\sigma(\Lambda,v_0,U)$
and $\tau(\Lambda,v_0,U)$ depend only on the set $\CalQ_U$ 
and $\Lambda_U$.  Thus, if we show the dependence of $\tau$
on $\CalQ$ explicitly in the notation, we have
  $$\tau(\CalQ,\Lambda,v_0,U) = \tau(\CalQ_U,\Lambda_U,v_0,U),$$
etc.  

Let $n_1$ be the number of darts that lead into $U$.  Let $c$ be
the number of group orbits of the standard hypermap $\op{hyp}(\Lambda_U,v_0)$.
Let $n(U) = n_1 + 2 (c-1)$.   Note that $n(U)$ is the number of darts
that lead into $U$ after an application of reverse double
walkups to join the darts leading into $U$ into a single group orbit.
If the set of darts that lead into $U$ is a simple polygon, then
$n(U)$ is the size of that polygon.  The assumption that $U$ is
exceptional means that $n(U)\ge 5$.

\begin{theorem}
    \label{thm:the-main-theorem}
    Let $(\Lambda,v_0)$ be a centered packing  with
standard component $U$.  Assume that $n(U)\ge 5$.
Then
$\tau(\Lambda,v_0,U) > t_n$, where $n=n(R)$ and
    $$
    \begin{array}{lll}
    t_4&=0.1317,\quad t_5=0.27113,\quad
    t_6=0.41056,\\
    t_7&=0.54999,\quad t_8=0.6045.
    \end{array}
    $$
The centered packing scores less than $8\,\pt$, if $n(R)\ge 9$,
for some standard cluster $R$. The scores satisfy
$\sigma_R(\Lambda,v)<s_n$, for $5\le n\le 8$, where
    $$
    s_5=-0.05704,\quad s_6=-0.11408,\quad
    s_7=-0.17112,\quad s_8=-0.22816.
    $$
\end{theorem}

Sometimes, it is convenient to calculate these bounds as a multiple
of $\pt$.  We have
    $$
    \begin{array}{lll}
    t_4&>2.378\,\pt,\quad t_5>4.896\,\pt,\quad
    t_6>7.414\,\pt,\\
    t_7&>9.932\,\pt,\quad
    t_8>10.916\,\pt.
    \end{array}
    $$
    %
    $$
    s_5 < -1.03\,\pt,\quad s_6<-2.06\,\pt,\quad
    s_7<-3.09\,\pt,\quad s_8<-4.12\,\pt.
    $$




\begin{corollary}
    \label{cor:std-aggregate-list}
Every standard component is a either a polygon or one shown in
Figure~\ref{fig:std-aggregates}
\end{corollary}


%\gram|2.2||diag7.1.ps|
%\gram|0.5||SAMF/samfigp20.eps|

\begin{figure}[htb]
  \centering
  \myincludegraphics{\ps/diag7.1.ps}
  \caption{}
  \label{fig:std-aggregates}
\end{figure}


In the cases that are not (simple) polygons, we call the {\it polygonal
hull\/} the polygon obtained by removing the internal edges and
vertices. We have $m(R)\le n(R)$, where the constant $m(R)$ is the
number of sides of the polygonal hull.

\begin{proof}
By the theorem, if the standard component is not a polygon, then $8\ge
n_1\ge m\ge 5$. (Quad clusters and quasi-regular tetrahedra have no
enclosed vertices. See Lemma~\ref{lemma:no-enclosed-tri} and
Tarski arithmetic\tarf{at-most-one-negative}.) If $c>1$, then $8\ge
n=n_1+2(c-1)\ge 5+2(c-1)$, so $c=2$, and $n_1=5,6$ (frames $2$ and $5$
of the figure).

Now take $c=1$.    Then $8\ge n\ge 5+(n-m)$, so $n-m\le 3$.  If $n-m=3$,
we get frame $3$. If $n-m=2$, we have $8\ge m+2\ge 5+2$, so $m=5,6$
(frames $1$, $4$).

But $n-m=1$ cannot occur, because a single edge that does not bound the
polygonal hull has even multiplicity.  Finally, if $n-m=0$, we have a
polygon.
\end{proof}

\begin{corollary} \label{lemma:70}
If the type of a vertex of a centered packing is $\pqr{(7,0,0)}$, then it
does not contravene.
\end{corollary}

\begin{proof} By Theorem~\ref{thm:the-main-theorem},
if there is a non-triangular component, we have
    $$\tau(\Lambda,v)\ge\tlp(\pqr{(7,0,0)})+t_4>\squander.$$
Assume that all standard components are triangular.  If there is a
vertex that does not lie on one of seven triangles, we have by
Lemma~\ref{lemma:pq}:
    $$\tau(\Lambda,v)\ge\tlp(\pqr{(7,0,0)})+0.55\,\pt>\squander.$$
Thus, all vertices lie on one of the seven triangles.  The
complement of these seven triangles is a  triangulation by
five standard components.  There is some vertex of these five that does
not lie on any of the other four standard components in the complement.
That vertex has type $\pqr{(3,0,0)}$, which is contrary to
Lemma~\ref{lemma:pq-impossible}.
%By the results of Part I, which
%treats the case in which all standard components are triangles, we
%may assume that the centered packing has at least one quadrilateral.  We then
%have $\tau(\Lambda,v)\ge\tlp(\pqr{(7,0,0)}) + t_4
%>\squander$.  The result follows.
\end{proof}



\subsection{nonagon} %DCG 12.2 p127
    \label{sec:nonagon}
    \oldlabel{4.6}

A few additional comments are needed to eliminate $n=9$ and $10$,
even after the bounds $t_9$, $t_{10}$ are established.

\begin{lemma} \label{lemma:s9-t9}
Let $F$ be a set of one or more standard components bounded by a simple
polygon with at most nine edges.  Assume  that
    $$\sigma_F(\Lambda,v) \le s_9\quad\text{and }\tau_F(\Lambda,v)\ge t_9,$$
where $s_9=-0.1972$ and $t_9=0.6978$.  Then $(\Lambda,v)$ does not
contravene.
\end{lemma}

\begin{proof} This is the proof that was used as an illustration
of  assembly problems.  See section~\ref{lemma:nonagon}.
\end{proof}

\begin{proof}
Suppose that $n=9$, and that $R$ squanders at least $t_9$ and
scores less than $s_9$.  This bound is already sufficient to
conclude that there are no other standard clusters except
quasi-regular tetrahedra ($t_9+t_4>\squander$). There are no
vertices of type $\pqr{(4,0,0)}$ or $\pqr{(6,0,0)}$: $t_9+4.14\,\pt>\squander$ by
Lemma~\ref{lemma:pq}.   So all vertices not over the exceptional
cluster are of type $\pqr{(5,0,0)}$. Suppose that there are $\ell$
vertices of type $\pqr{(5,0,0)}$. The polygonal hull of $R$ has $m\le 9$
edges. There are $m-2+2\ell$ quasi-regular tetrahedra. If $\ell\le
3$, then by Lemma~\ref{lemma:0.55}, the score is less than
    $$s_9+ (m-2+2\ell)\,\pt -0.48 \ell\,\pt < \scoregoal.$$
If on the other hand, $\ell\ge 4$, the centered packing squanders
more than
    $$t_9+ 4(0.55)\,\pt > \squander.$$
\end{proof}


The bound $s_9$ will be established as part of the proof of
Theorem~\ref{thm:the-main-theorem}.

The case $n=10$ is similar.  If $\ell=0$, the score is less than
    $(m-2)\,\pt\le \scoregoal$,
because the score of an exceptional cluster is strictly negative,
Theorem~\ref{lemma:quad0}.  If $\ell>0$, we squander at least
    $t_{10}+ 0.55\,\pt > \squander$ (Lemma~\ref{lemma:0.55}).



\subsection{scoring subcluster} %DCG 12.4, p128
    \oldlabel{4.3}

\FIXX{Move this entire section much earlier to a general discussion
of components (standard or otherwise).}

The terms of Formula~\ref{eqn:3.7} defining
$\op{svR}(v,P,\Lambda,t_0)$ have a clear geometric
interpretation as quoins, wedges of $t_0$-cones, and solid angles
(see Section~\ref{sec:scoring}). There is a quoin for each Rogers
simplex. There is a somewhat delicate point that arises in
connection with the geometry of subclusters.  It is not true in
general that the Rogers simplices entering into the truncation
$(v,P,\Lambda,t_0)$ of $(P,D)$ lie in the cone over $P$.
Formula~\ref{eqn:3.7} should be viewed as an analytic continuation
that has a nice geometric interpretation when things are nice, and
which always gives the right answer when summed over all the
subclusters in the cluster, but which may exhibit unusual behavior
in general. The following lemma shows that the simple geometric
interpretation of Formula~\ref{eqn:3.7} is valid when the
substandard component is not triangular.



\begin{lemma}
    \label{lemma:no-cross}
If a substandard component is not a triangle and is not  the substandard component
containing the slices around an upright diagonal, then
   $$\op{cone}^0(v_0,v,|v-v_0|/(2t_0)),$$
where $v$ is a corner of the subcluster,
does not cross out of the substandard component.
\FIXX{At various places, we use a version of the lemma
for $\sqrt2$-truncation
and also for $t_0$-truncation with barriers other than qrt.}

\end{lemma}

\begin{proof}
For a contradiction, let $\{v_1,v_2\}$ be a distinguished edge that
the cone crosses. If both edges $\{v,v_1\}$ and $\{v,v_2\}$ have
length less than $2t_0$, by Tarski arithmetic\tarfE{E:part4:4},
there can be no enclosed vertex $w$ of
height at most $2t_0$, unless its distance from $v_1$ and $v_2$ is
less than $2t_0$.
In this case, we can replace $\{v_1,v_2\}$ by an edge of the
substandard component closer to $v$, so without loss of generality we may
assume that there are no enclosed vertices when both edges
$\{v,v_1\}$ and $\{v,v_2\}$ have length less than $2t_0$.

The substandard component is not a triangle, so $|v-v_1|\ge 2t_0$, or
$|v-v_2|\ge 2t_0$, say $|v-v_1|\ge 2t_0$.  The result now follows
from Tarski arithmetic\tarf{beta:dcg-p129}.
\end{proof}

As a consequence, in nonspecial standard components, the terms in the
Formula~\ref{eqn:3.7} for $\op{svR}_0$ retain their interpretations as
quoins, Rogers simplices, $t_0$-cones, and solid angles, all lying
in the cone over the standard component.


\subsection{proof} %DCG 12.5, p 129
    \oldlabel{4.5}

The proof of the theorem occupies the rest of the chapter. The
inequalities for triangular and quadrilateral components have already
been proved. The bounds on $t_3$, $t_4$, $s_3$, and $s_4$ are
found in Lemma~\ref{lemma:roger0}, Section~\ref{x-3.2},
Lemma~\ref{lemma:1pt}, and Theorem~\ref{lemma:quad0},
respectively. Thus, we may assume throughout the proof that the
standard component is exceptional

We begin with a slightly simplified account of the method of
proof. Set $t_9=0.6978$, $t_{10}= 0.7891$, $t_n=\squander$, for
$n\ge 11$. Set $D(\y{(n,k)}) = t_{n+k} - 0.06585\,k$, for $0\le k\le n$,
and $n+k\ge 4$. This function satisfies
    \begin{equation}
    D(n_1,k_1)+D(n_2,k_2)\ge D(n_1+n_2-2,k_1+k_2-2).
    \label{eqn:D-superadd}
    %\oldlabel{eqn:4.5.1}
    \end{equation}
In fact, this inequality unwinds to $t_r+0.13943\ge t_{r+1}$,
$D(\y{(3,2)})=0.13943$, and $t_n =(0.06585)2+(n-4)D(\y{(3,2)})$, for $n=4,5,6,7$.
These hold  by inspection.

Call an edge between two vertices of height at most $2t_0$ {\it long\/}
if it has length greater than $2t_0$. Add the distinguished edges to
break the standard components into substandard components. We say that a substandard component has
{\it edge parameters} $\y{(n,k)}$ if there are $n$ bounding edges, where $k$
of them are long. (We count edges with multiplicities as in
Section~\ref{sec:the-main-theorem}, if the substandard component is not a polygon.)
Combining two substandard components of edge parameters $(n_1,k_1)$ and $(n_2,k_2)$
along a long edge $e$ gives a union with edge parameters
$(n_1+n_2-2,k_1+k_2-2)$, where we agree not to count the internal edge
$e$ that no longer bounds. Inequality~\ref{eqn:D-superadd} localizes the
main theorem to what is squandered by subclusters. Suppose we break the
standard cluster into groups of substandard components such that if the group has
edge parameters $\y{(n,k)}$, it squanders at least $D(\y{(n,k)})$. Then by
superadditivity (Sec.~\ref{x-4.5}, Formula~\ref{eqn:D-superadd}), the
full standard cluster $R$ must squander $D(\y{(n,0)}) = t_n$, $n=n(R)$, giving
the result.

Similarly, define constants $s_4=0$, $s_9 = -0.1972$, $s_{n}=0$, for
$n\ge10$.  Set $Z(\y{(n,k)}) = s_{n+k}-k\epsilon$, for $\y{(n,k)}\ne \y{(3,1)}$, and
$Z(\y{(3,1)})=\epsilon$, where\footnote{Compare \calc{193836552}.} %A1
 $\epsilon=0.00005$. The function
$Z(\y{(n,k)})$ is subadditive:
    $$Z(n_1,k_1)+Z(n_2,k_2) \le Z(n_1+n_2-2,k_1+k_2-2).$$
In fact, this easily follows from $s_a+s_b\le s_{a+b-4}$, for $a,b\ge
4$, and $\epsilon>0$. It will be enough in the proof of
Theorem~\ref{thm:the-main-theorem} to show that the score of a union of
substandard components with edge parameters $\y{(n,k)}$ is at most $Z(\y{(n,k)})$.


\subsection{preparation of a standard cluster} %DCG 12.6, p 130
   \label{sec:prep-cluster}
    \oldlabel{4.7}

Fix a standard cluster.  We return to the construction of
substandard components and distinguished edges, to describe the penalties.
Take the penalty of $0.008$ for each  upright
diagonal in context $\xtazimlt$. 
Take the penalty $0.03344 = 3\xiG+\xikG$ for $\xfgap$
upright diagonals. Take the penalty $0.04683=3\xiG$ for
$\xtazimge$ upright diagonals. Set $\maxpi=0.06688$. The penalty
in the next lemma refers to the combined penalty from erasing all
diagonals in context $\xtazimlt$, $\xtazimge$, and $\xfgap$ upright diagonals in
the centered packing. The upright quarters that completely
surround an upright diagonal (loops) are not erased.

\begin{lemma}
The total penalty from a contravening centered packing is at most
$\maxpi$.
\end{lemma}

\begin{proof}
Before any upright quarters are erased, each quarter
squanders\footnote{\calc{148776243}} %A13
$>0.033$, so the centered packing squanders $>\squander$ if there
are $\ge25$ quarters.  Assume there are at most $24$ quarters. If
the only penalties are $0.008$, we have $8(0.008)<\maxpi$. If we
have the penalty $0.04683$, there are at most seven other quarters
($0.5606+8(0.033)>\squander$) (Lemma~\ref{x-3.7}), and no other
penalties from this type or from $\xfgap$ upright diagonals, so
the total penalty is at most $2(0.008)+ 0.04683 < \maxpi$.
Finally, if there is one $\xfgap$ upright diagonal, there are
at most twelve other quarters (Section~\ref{x-3.8}), and erasing
gives the penalty $0.03344+4 (0.008)<\maxpi$.
\end{proof}

The remaining upright diagonals are surrounded by slices. If
the edge opposite the diagonal in a slice has length
$\ge2\sqrt2$, then there may be an adjacent special simplex whose
diagonal is that edge.  Section~\ref{x-5.11} will give bounds on the
aggregate of these slices and special simplices.  In all
other contexts, the upright quarters have been erased with penalties.

Break the standard cluster into subclusters as in Section~\ref{x-4.2}.
If the substandard component is a triangle, we refer to the bounds of \ref{x-5.7}.
Sections~\ref{x-4.8}--\ref{x-5.10} give bounds for substandard components that are
not triangles in which all the upright quarters have been erased. We
follow the strategy outlined in Section~\ref{x-4.5}, although the
penalties will add certain complications.

We now assume that we have a subcluster without quarters and whose
component is not triangular.  The truncated function $\op{svR}_0$ is an
upper bound on the score.  Penalties are largely disregarded until
Section~\ref{x-5.4}.

We describe a series of deformations of the subcluster that
increase $\op{svR}(v,P,\Lambda,t_0)$ and decrease $\tau_{0,P}(\Lambda,v)$.  These
deformations disregard the broader geometric context of the
subcluster. Consequently, we cannot claim that the deformed
subcluster exists in any centered packing $(\Lambda,v)$.  As the deformation
progresses, an edge $\{v_1,v_2\}$, not previously distinguished,
can emerge with the properties of a distinguished edge. If so, we
add it to the collection of distinguished edges, use it if
possible to divide the subcluster into smaller subclusters, and
continue to deform the smaller pieces.  When triangular components
are obtained, they are set aside until Section~\ref{x-5.7}.

\subsection{reduction to polygon} %DCG 12.7, p131
    \oldlabel{4.8}
    % text moved to hypermaap and geometry chapter.


%% MOVED DCG 12.7 (visibility) to hypermap.

%% MOVED DCG 12.8 TO reduction.tex

%% MOVED DCG 12.9, DCG 12.10. pp.134--136.

\begin{definition}[penalty~free]\indy{Index}{penalty-free}\indy{Index}{penalty-inclusive}
(By {\it penalty-free\/} score, we mean the part of the scoring
bound that does not include any of the penalty terms.  We will
sometimes call the full score, including the penalty terms, the
{\it penalty-inclusive\/} score.)
\end{definition}

Lemma~\ref{x-4.3} was stated in the context of a substandard component before
deformation, but a cursory inspection of the proof shows that the
geometric conditions required for the proof remain valid by our
deformations. (This assumes that the substandard component is not a triangle, which
we assumed at the beginning of Section~\ref{XX}.) In more detail,
there is a solid $\op{CP}_0$ contained in the ball of radius of $t_0$ at the
origin, and lying over the cone of the substandard component $P$ such that a bound
on the penalty-free subcluster score is 
$\op{svR}^g_0(\op{CP}_0)$ and squander $\tau^g_0(\op{CP}_0)$.\FIXX{What are these?}

Let $\{y_1,\ldots,y_r\}$ be a decomposition of the substandard component into
disjoint components whose union is $X$. Then if we let $\op{CP}_0(y_i)$ denote
the intersection of $\op{CP}_0(y_i)$ with the cone over $y_i$, we can write
    $$\tau^g_0(\op{CP}_0) =\sum_i \tau^g_0(\op{CP}_0(y_i)).$$

These lemmas allow us to express bounds on the score (and
squander) of a subcluster as a sum of terms associated with
individual (truncated) corner cells. By Lemmas~\ref{XX} %% \ref{x-4.12.1}
through \ref{lemma:4.12.5}, these objects do not meet at interior
points under suitable conditions. Moreover, by the interpretation
of terms provided by Section~\ref{x-4.3}, the cones over these
objects do not meet at interior points, when the objects
themselves do not. In other words, under the various conditions,
we can take the (truncated) corner cells to be among the sets
$\op{CP}_0(y_i)$.

To work a typical example, let us place a truncated corner cell with
parameter $\lambda=1.6$ at each concave corner.  Place a $t_0$-cone
wedge $X_0$ at each convex corner. The cone over each object lies in the
cone over the substandard component. By Lemma~\ref{lemma:no-cross} and
Lemma~\ref{lemma:tau-positive} (see the proof), the $t_0$-cone wedge
$X_0$ squanders a positive amount.  The part $P'$ of the substandard component
outside all truncated corner cells and outside the $t_0$-cone wedges
squanders
    $$\sol(P')(\zeta\pt-\phi_0) > 0.$$
where $\sol(P')$ is the part of the solid angle of the substandard component
lying outside the tccs. Dropping these positive terms, we obtain a
lower bound on the penalty-free squander:
    $$\tau^g_0(\op{CP}_0) \ge \sum_{C_0} \tau^g_0(C_0).$$
There is one summand for each concave corner of the substandard component.
Other cases proceed similarly.


\subsection{convexity} %DCG 12.12, p139
    \oldlabel{4.13}

\begin{lemma}
    \oldlabel{4.13.1}
There are at most two concave corners.
\end{lemma}

\begin{proof}
Use the parameter $\lambda=1.6$ and place a truncated corner cell $C_0$
at each concave corner $v$. Let $C_0^u(|v-v_0|,\dih)$ denote the
corresponding untruncated cell.  By Lemma~\ref{lemma:tcc-est},
$\tau_0(C_0) > 0.297$ for each corner cell at a concave corner.
If there are three or more concave corners, then the penalty-free corner
cells squander at least $3(0.297)$. The penalty is at most $\maxpi$
(Section~\ref{x-4.7}). So the penalty-inclusive squander is more than
    $3(0.297) - \maxpi >\squander$.
\end{proof}

\begin{lemma}
    \oldlabel{4.13.2}
There are no concave corners of height at most $2.2$.
\end{lemma}

\begin{proof}
Suppose there is a corner of height at most $2.2$. Place an
untruncated corner cell $C^u_0(|v-v_0|,\dih)$ with parameter $\lambda
=1.815$ at that corner and a $t_0$-cone wedge at every other corner. 
The
subcluster squanders at least
    $\tau_0(C^u_0(|v-v_0|,\pi))-\maxpi$.
By Lemma~\ref{XX}, this is at least $\squander$.
%% was lemma:tcc-1815. Missing ref.
\end{proof}

By the assumptions at the beginning of Section~\ref{XX}, the lemma
implies that each concave corner has distance at least $3.2$ from every
other visible corner.

If there are two concave corners, we may put a corner cell at
each corner, with parameter $\lambda=1.945$.  By Lemma~\ref{lemma:2tcc},
they give $\tau > \squander + \maxpi$.
We conclude that there is at most one concave corner. 

Let $v$ be such a
corner.   
If we push $v$ toward the origin, the solid angle is unchanged
and $\op{svR}_0$ is increased.  Following this by the deformation of
Section~\ref{x-4.9}, we maintain the constraints $|v-w|=3.2$, for
adjacent corners $w$, while moving $v$ toward the origin. Eventually
$|v-v_0|=2.2$. This is impossible by Lemma~\ref{x-4.13.2}.

We verify that this deformation preserves the constraint
$|v-w|\ge2$, for all corners $w$ such that $\{v,w\}$ lies entirely
outside the substandard component.  
By Lemma~\ref{lemma:details}, every other vertex $w$
is visible to $v$.  Thus, if a length drops below $2\sqrt2$ we may
add a distinguished edge and continue recursively.

We conclude that all substandard components can be deformed into convex polygons.





\section{Main Estimate (continued)}%DCG Sec.13,p.143.
    \oldlabel{5}




\subsection{penalty} %DCG 13.4, p145
    \oldlabel{5.4}
    \label{sec:penalty1}

In Section~\ref{x-4.7}, we determined the bound of
$\maxpi=0.06688$ on penalties. In this section, we give a more
thorough treatment of penalties. Until now a penalty has been
associated with a given standard component, but by taking the worst
case on each substandard component, we can move the penalties to the level of
substandard components.   Roughly, each substandard component should incur the penalties
from the upright quarters that were erased along edges of that
substandard component.  Each upright quarter of the original standard component
is attached at an edge between adjacent corners of the standard
cluster. The edges have lengths between $2$ and $2t_0$.  The
deformations shrink the edges to length $2$.  We attach the
penalty from the upright quarter to this edge of this substandard component.
In general, we divide the penalty evenly among the upright
quarters along a common diagonal, without trying to determine a
more detailed accounting. For example, the penalty $0.008$ in
Lemma~\ref{lemma:0.008} comes from three upright quarters.  Thus,
we give each of three edges a penalty of $0.008/3$. Or, if there
are only two upright quarters around the  upright
diagonal in context $\xtazimlt$, 
then each of the two upright quarters is assigned the
penalty $0.00222/2$ (see Lemma~\ref{x-3.9.2}).

The penalty $0.04683 = 3\xiG$ in Section~\ref{x-4.7} comes from
three upright quarters around a $\xtazimge$ upright diagonal. Each
of three edges is assigned a penalty of $\xiG$.  The penalty
$0.03344=3\xiG+\xikG$ comes from a $\xfgap$ upright diagonal of
Section~\ref{x-3.8}. It is divided among $4$ edges. These are the
only upright quarters that take a penalty when erased. (The case
of two upright quarters over a flat quarter as in
Lemma~\ref{lemma:unerased}, are treated by a separate argument in
Section~\ref{x-5.7}. Loops will be discussed in
Section~\ref{x-5.11}.)

The penalty can be reduced in various situations involving a
masked flat quarter.  For example, around a $\xtazimge$ upright
diagonal, if there is a masked flat quarter, two of the upright
quarters are scored by the analytic  function $\op{svan}$, so that the
penalty plus adjustment is only%
\footnote{\calc{73974037}} %A10
\footnote{\calc{764978100}} %A11
 $0.034052=2\xiV+\xiG+0.0114$.
The adjustment $0.0114$ reflects the scoring
rules for masked flat quarters (Lemma~\ref{lemma:0.008}).  This we
divide evenly among the three edges that carried the upright
quarters. If $e$ is an edge of the substandard component $R$, let $\pi_0(R,e)$
denote the penalty and score adjustment along edge $e$ of $R$.

In summary, we have the penalties,
    $$\xik,\xiV,\xiG,\ 0.008,$$
combined in various ways in the upright diagonals that have context
$\xtazimlt$, $\xtazimge$, or $\xfgap$.  There are score
adjustments
    $$0.0114\quad \text{ and }\quad 0.0063$$
from Section~\ref{x-3.10} for masked flat quarters.  If the sum of these
contributions is $s$, we set $\pi_0(R,e)=s/n$, for each edge $e$ of $R$
originating from an erased upright quarter of
    $\mathcal{\mathbf S}_n^\pm$.

\subsection{penalty bound} %DCG 13.5, p146
    \oldlabel{5.5}

Recall that the bounds for flat quarters we wish to establish from
Section~\ref{x-4.5} are $Z(\y{(3,1)})=0.00005$ and $D(\y{(3,1)})=0.06585$. Flat
quarters arise in two different ways.  Some flat quarters are present
before the deformations begin.  They are scored by the rules of
Section~\ref{x-3.10}. Others are formed by the deformations.  In this
case, they are scored by $\op{svR}_0$. Since the flat quarter is broken away
from the substandard component as soon as the diagonal reaches $2\sqrt{2}$, and then
is not deformed further, the diagonal is fixed at $2\sqrt{2}$.  Such
flat quarters can violate our desired inequalities. For example,
if $S$ has edge lengths $(2,2,2,,2\sqrt{2},2,2)$ indexed by the usual
edge conventions, then
    $$
    Z(\y{(3,1)})<\op{sovo}_0(S,\lambda_{oct}) 
      \approx 0.00898,\quad
        \op{sovo}_0(S,\lambda_{sq})\approx 0.0593.
    $$
On the other hand, as we will see, the adjacent substandard component satisfies the
inequality by a comfortable margin.  Therefore, we define a transfer
$\epsilon$ from flat quarters to the adjacent substandard component. (In an
exceptional component, the substandard component next to a flat quarter along the
diagonal is not a flat quarter.)

For a flat quarter $Q$, set
    $$
    \epsilon_\tau(Q) =
        \begin{cases} 0.0066,&\text{(deformation),}\\
            0,&\text{(otherwise)}.
        \end{cases}
    $$
    %
    $$
    \epsilon_\sigma(Q) =
        \begin{cases}
         0.009,&\text{(deformation),}\\
            0,&\text{(otherwise)}.
        \end{cases}
    $$
The nonzero value occurs when the flat quarter $Q$ is obtained by
deformation from an initial configuration in which $Q$ is not a quarter.
The value is zero when the flat quarter $Q$ appears already in the
undeformed standard cluster. Set
    $$
    \begin{array}{lll}
    \pi_\tau(R) &= \sum_e \pi_0(R,e) +
    \sum_e\pi_0(Q,e)+\sum_Q \epsilon_\tau(Q),\\
    \pi_\sigma(R)&=\sum_e \pi_0(R,e) +
    \sum_e\pi_0(Q,e)+\sum_Q \epsilon_\sigma(Q).
    \end{array}
    $$
The first sum runs over the edges of a substandard component $R$.  The second sum
runs over the edges of the flat quarters $Q$ that lie adjacent to $R$
along the diagonal of $Q$.

The edges between corners of the polygon have lengths $2$, $2t_0$, or
$2\sqrt{2}$.  Let $k_0$, $k_1$, and $k_2$ be the number of edges of
these three lengths respectively.  By Lemma~\ref{lemma:7-sides}, we have
$k_0+k_1+k_2\le7$. Let $\tilde\sigma$ denote any of the functions of
Section~\ref{x-3.10}.2(a)--(f). Let $\tilde\tau = \sol\zeta\pt -
\tilde\sigma$.

To prove Theorem~\ref{thm:the-main-theorem}, refining the strategy
proposed in Section~\ref{x-4.5}, we must show that for each flat quarter
$Q$ and each substandard component $R$ that is not a flat quarter, we have
    \begin{equation}
    \begin{array}{lll}
    \tilde\tau(Q) &> D(\y{(3,1)}) - \epsilon_\tau(Q),\\
    \tau_0(Q) &> D(\y{(3,1)})-\epsilon_\tau(Q),\quad\text{if }y_4(Q)=2\sqrt2,\\
    \tau_V(R) &> D(\y{(3,2)}),\quad\text{(type $\SA$)},\\
    \tau_0(R) &> D(k_0+k_1+k_2,k_1+k_2)+\pi_\tau(R),
    %oldtag 5.5.1
    \label{eqn:tau>D(n,k)}
    \end{array}
    \end{equation}
where $D(\y{(n,k)})$ is the function defined in Section~\ref{x-4.5}. The first
of these inequalities follows.%
% from $\A_{1},\A_{13},\A_{16}$.
\footnote{\calc{193836552}} %A1
\footnote{\calc{148776243}} %A13
\footnote{\calc{163548682}} %A16
In general,
we are given a substandard component without explicit information about what the
adjacent substandard components are.  Similarly, we have discarded all information
about what upright quarters have been erased.  Because of this, we
assume the worst, and use the largest feasible values of $\pi_\tau$.

\begin{lemma}
We have
    $\pi_\tau(R)\le 0.04683 + (k_0+2k_2-3)0.008/3 +0.0066k_2$.
\end{lemma}

\begin{proof}
The worst penalty $0.04683=3\xiG$ per edge comes from a
$\xtazimge$ upright diagonal. The number of penalized edges not on
a simplex around a $\xtazimge$ upright diagonal is at most
$k_0+2k_2-3$. For every three edges, we might have one
 upright diagonal in context $\xtazimlt$. The other cases such as
$\xfgap$ upright diagonals or situations with a masked flat
quarter are readily seen to give smaller penalties.
\end{proof}

For bounds on the score, the situation is similar.  The only
penalties we need to consider are $0.008$ from
Lemma~\ref{lemma:0.008}. If either of the other configurations of
$\xtazimge$ or $\xfgap$ upright diagonals occur, then the score
of the standard cluster is less than $s_8=-0.228$, by
Sections~\ref{x-3.7} and \ref{x-3.8}. This is the desired bound.
So it is enough to consider substandard components that do not have these
upright configurations. Moreover, the penalty $0.008$ does not
occur in connection with masked flats. So we can take
$\pi_\sigma(R)$ to be
    $$(k_0+2k_2)0.008/3 + 0.009 k_2.$$
If $k_0+2k_2<3$, we can strengthen this to
    $\pi_\sigma(R)=0.009 k_2$.
Let $\tilde\sigma$ be any of the functions of Section~\ref{x-3.10}.2
parts (a)--(f). To prove Theorem~\ref{thm:the-main-theorem}, we will
show
    \begin{equation}
    \begin{array}{lll}
    \tilde\sigma(Q)&< Z(\y{(3,1)})+\epsilon_\sigma(Q),\\
    \op{sovo}_0(Q,\lambda_{oct})
    &< Z(\y{(3,1)})+\epsilon_\sigma(Q),\quad\text{if }y_4(Q)=2\sqrt2,\\
    \op{svR}_0(R)&< Z(\y{(3,2)}),\quad\text{(type $\SA$)},\\
    \op{svR}_0(R) &< Z(k_0+k_1+k_2,k_1+k_2) - \pi_\sigma(R).
    %oldtag 5.5.2
    \label{eqn:sigma<Z(n,k)}
    \end{array}
    \end{equation}
The first of these inequalities follows.%
\footnote{\calc{193836552}} %A1
\footnote{\calc{148776243}} %A13
\footnote{\calc{163548682}} %A16
% form $\A_1,\A_{13},\A_{16}$.


\subsection{small dihedral angle} %DCG 14.1, p157
\label{sec:small-dih}

Recall that Section~\ref{sec:the-main-theorem} defines an integer $n(R)$
that is equal to the number of sides if the component is a polygon.  Recall
that if the dihedral angle along an edge of a standard cluster is at
most $1.32$, then there is a flat quarter along that edge
(Lemma~\ref{x-3.11.4}).



\begin{lemma}\tlabel{lemma:1.47}
    \oldlabel{5.12.1}\dcg{Lemma~14.1}{157}
Let $R$ be an exceptional cluster with a dihedral angle
$\le1.32$ at a vertex $v$. Then $R$ squanders $>t_n+1.47\,\pt$, where
$n=n(R)$.
\end{lemma}

\begin{proof}
In most cases we establish the stronger bound $t_n+1.5\,\pt$. In the
proof of Theorem~\ref{thm:the-main-theorem}, we erase all upright
diagonals, except those completely surrounded by slices. The
contribution to $t_n$ from the flat quarter $Q$ at $v$ in that proof is
$D(\y{(3,1)})$ (Sections~\ref{x-4.5} and Inequalities~\ref{eqn:tau>D(n,k)}).
Note that $\epsilon_\tau(Q)=0$ here because there are no deformations.
If we replace $D(\y{(3,1)})$ with $3.07\,\pt$ from Lemma~\ref{x-3.11.4}, then
we obtain the bound. Now suppose the upright diagonal is completely
surrounded by slices. Analyzing the constants of
Section~\ref{x-5.11}, we see that $\DLP(\y{(n,k)})-D(\y{(n,k)})>1.5\,\pt$ except
when $\y{(n,k)}=\y{(4,1)}$.

Here we have four slices around an upright diagonal. Three
of them are quarters.  We erase and take a penalty. Two possibilities
arise.  If the upright diagonal is enclosed over the flat quarter, its
height is $\ge2.6$ by Tarski arithmetic\tarfE{last:E} and the top face of the
flat quarter has circumradius at least $\sqrt2$.  The penalty is
$2\xiG'+\xiV$, so the bound holds by the last statement of
Lemma~\ref{x-3.11.4}.

If, on the other hand, the upright diagonal is not enclosed over the
flat diagonal, the penalty is $\xiG+2\xiV$.  In this case, we obtain the
weaker bound $1.47\,\pt+t_n$:
    $$3.07\,\pt > D(\y{(3,1)}) + 1.47\,\pt +\xiG+2\xiV.$$
\end{proof}

\begin{remark} \label{remark:1.47}
If there are $r$ nonadjacent vertices with dihedral angles
$\le1.32$, we find that $R$ squanders $t_n+r(1.47)\,\pt$.
\end{remark}

In fact, in the proof of the lemma, each $D(\y{(3,1)})$ is replaced with
$3.07\,\pt$ from Lemma~\ref{x-3.11.4}.  The only questionable case
occurs when two or more of the vertices are anchors of the same upright
diagonal (a loop). Referring to Section~\ref{x-5.11}, we have the
following observations about various contexts $\x{(p,r)}$.

\begin{itemize}
    \item $\x{(3,1)}$ can mask only one flat quarter and it is treated in the
lemma.
    \item $\x{(2,2)}$ can mask only one flat quarter and
    $\DLP(\y{(4,2)})-D(\y{(4,2)})>1.47\,\pt$.
    \item $\x{(5,0)}$ can mask two flat quarters.  Erase the five upright quarters,
        and take a penalty $4\xiV+\xiG$.  We get
    $$D(\y{(3,2)})+2(3.07)\,\pt > t_5+4\xiV+\xiG+2(1.47)\,\pt.$$
    \item $\x{(4,1)}$ can mask two flat quarters, and $\DLP(\y{(5,1)})-D(\y{(5,1)})>2(1.47)\,\pt$.
\end{itemize}




\begin{lemma}\dcg{Lemma~14.6}{165}\label{lemma:excess-1}
Let $R$ be an exceptional standard component.  Let $V$
be a set of vertices of $R$.  If $v\in V$, let $p_v$ be the number
of triangular components at $v$ and let $q_v$ be the number of
quadrilateral components at $v$.  Assume that $V$ has the following
properties:
    \begin{enumerate}
        \item No two
        vertices in $V$ are adjacent.
        \item No two vertices
        in $V$ lie on a common quadrilateral.
        \item If $v\in V$, then there are five standard components at
        $v$.
        \item If $v\in V$, then the corner over $v$ is a central
        vertex of a flat quarter in the cone over $R$.
        \item If $v\in V$, then $p_v\ge 3$.  That is, at least
        three of the five standard components at $v$ are triangular.
        \item If $R'\ne R$ is an exceptional component at $v$, and if $R$
        has interior angle at least $1.32$ at $v$, then $R'$ also has interior
        angle at least $1.32$ at $v$.
        \item If $\pqr{(p_v,q_v,0)}=\pqr{(3,1,0)}$, then the internal angle at $v$ of the exceptional
        component is at most $1.32$.
    \end{enumerate}
  Define $a:\N\to \R$ by
  $$a(n) = \begin{cases}
    14.8 &n=0,1,2,\\
    1.4 & n=3,\\
    1.5 & n=4,\\
    0 & \text{otherwise.}
  \end{cases}
  \indy{Index}{aZ@$a(n)$}
  $$
Let $\{F\}$ be the union of $\{R\}$ with the set of triangular and
quadrilateral components that have a vertex at some $v\in V$. Then
    $$\sum_F\tau_F(\Lambda,v) > \sum_{v\in V} (p_v d(3) + q_v d(4) + a
    (p_v))\,\pt.$$
\end{lemma}

\begin{proof}   We erase all upright diagonals in the
$Q$-system, except for those that carry a penalty: loops,
context $\xtazimlt$, $\xtazimge$, and $\xfgap$ diagonals.

We assume that if $\pqr{(p_v,q_v,0)}=\pqr{(3,1,0)}$, then the internal angle is at
most $1.32$. Because of this, if we score the flat quarter by
$\op{svR}_0$, then the flat quarter $Q$ satisfies
(Lemma~\ref{lemma:1.32})
   \begin{equation}
   \op{svR}_0(Q) > 3.07\,\pt > 1.4\,\pt + D(\y{(3,1)}) + 2\xiV + \xiG.
   \label{eqn:307}
   \end{equation}



Every flat quarter that is masked by a remaining upright quarter
in the $Q$-system has $y_4\ge2.6$.  Moreover, $y_1\ge2.2$ or
$y_4\ge2.7$.  Let $\pi_v = 2\xiV + \xiG$ if the flat quarter is
masked, and $\pi_v = 0$ otherwise.

We claim that the flat quarter (scored by $\op{svR}_0$) together with
the triangles and quadrilaterals at a given vertex $v$ squander at
least
   \begin{equation}
   (p_v d(3) + q_v d(4) + a(p_v))\,\pt + D(\y{(3,1)}) + \pi_v
   \label{eqn:one-v}
   \end{equation}
If $p_v=4$, this is \calc{314974315}.  If $p_v=3$, we may assume
by the preceding remarks that there are two exceptional components at
$v$.  If the internal angle of $R$ at $v$ is at most $1.32$, then
we use Inequality~\ref{eqn:307}.  If the angle is at least $1.32$,
then by hypothesis, the angle $R'$ at $v$ is at least $1.32$.  We
then appeal to the calculations \calc{675785884} and
\calc{193592217}.

To complete the proof of the lemma, it is enough to show that we
can erase the upright quarters masking a flat quarter at $v$
without incurring a penalty greater than $\pi_v$.  For then, by
summing the Inequality~\ref{eqn:one-v} over $v$, we obtain the
result.

If the upright diagonal is enclosed over the masked flat quarter,
then the upright quarters can be erased with penalty at most
$\xiV$ (by Remark~\ref{remark:3rd-quarter}). Assume the upright
diagonal is not enclosed over the masked flat quarter.

If there are at most three upright quarters, the penalty is at
most $2\xiV + \xiG$.  Assume four or more upright quarters.  If
the upright diagonal is not a loop, then it must be $\xfgap$.
This can be erased with penalty
   $$2\xiV + 2\xiG - \kappa < 2\xiV + \xiG.$$

Finally, assume that the upright quarter is a loop with four or
more upright quarters.  Lemma~\ref{lemma:loop} limits the
possibilities to parameters $\y{(5,0)}$ or $\y{(5,1)}$.  In the case of a
loop $\y{(5,1)}$, there is no need to erase because $|V|\le3$ and by
Lemma~\ref{lemma:loop}, the hexagonal standard component squanders at
least
   $$t_6 + 3 a(p_v)\,\pt$$
as required by the lemma.  In the case of a loop $\y{(5,0)}$ in a
pentagonal component, if $|V|=1$ then there is no need to erase
(again we appeal to Lemma~\ref{lemma:loop}).  If $|V| =2$, then
the two vertices share a penalty of $4\xiV + \xiG$, with each
receiving
   $$2\xiV + \xiG/2 < 2\xiV +\xiG.$$
\end{proof}


%\chapter{Local Bounds in Exceptional Regions}% DCG Sec.12. p. 125
%    \oldlabel{4}
%    \label{sec:BER}

%\section{Positivity}
%    \oldlabel{4.1}









\subsection{hypermap is not empty}

%% Proof that the hypermap is not empty.



\begin{lemma}\label{prop:nonempty} 
Let $(\Lambda,v_0)$ be a centered packing such that $\sigma(\Lambda,v_0)>0$.
Then its standard hypermap has at least two faces.
%The construction of Section
%\ref{sec:stargraph} associates a nonempty hypermap with at least
%two faces to every centered packing $(\Lambda,v_0)$ with $\sigma(\Lambda,v_0)>0%$.
%In particular, the hypermap of a contravening centered packing is not empty.
\end{lemma}

\begin{proof}
First we show that centered packings with $\sigma(D)>0$ have
nonempty vertex sets $U$. (Recall that $U$ is the set of vertices
of distance at most $2t_0$ from the center).  The vertices of $U$
are used in Chapters~\ref{sec:construction} and \ref{sec:vcells} to
create all of the structural features of the centered packing:
quasi-regular tetrahedra, quarters, and so forth. If $U$ is empty,
the $V$-cell is a solid containing the ball $B(t_0)$ of radius
$t_0$, and $\sigma(D)$ satisfies
    $$
    \begin{array}{lll}
    \sigma(\Lambda,v) &= \op{sovo}(v,VC(\Lambda,v),\lambda_{oct})\\
              &< \op{sovo}(v,B(v,t_0),\lambda_{oct})\\
              &= \sol(B(v,t_0))\phi(t,t,\lambda_{oct})\\
              &< 0.
    \end{array}
    $$
By hypothesis, $\sigma(D)>0$.  So $U$ is not empty.\FIXX{The proof of making each standard component a simple polygon, assumes a
certain amount of nondegeneracy that isn't covered here.}

Equation~\ref{XX} shows that the function $\sigma$ can be
expressed as a sum of terms $\sigma_R$ indexed by the standard
components $R$. It is proved in Lemma~\ref{XX} that
%Theorem~\ref{lemma:quad0} that
$\sigma_R\le0$, unless $R$ is a triangle. Thus, a centered packing
with positive $\sigma(D)$ must have at least one triangle. Its
complement contains a second standard component. 
%Even after we form
%aggregates of distinct standard components to form the simplified
%hypermap (Remarks \ref{remark:tri-pent} and \ref{remark:degree6}),
%there certainly remain at least two faces.
\end{proof}
