\chapter{Preface}

In 1611, Kepler wrote a small booklet in which he asserted that the familiar cannonball arrangement of congruent balls in space achieves the highest possible density.  No other arrangement can fill a larger fraction of space.  This statement is the packing problem, or the Kepler conjecture.  In 1900, Hilbert made this part of his eighteenth problem.  This book presents a solution to the packing problem.

\section{Blueprint for Formal Proofs}

Ten years have passed since a proof was first
obtained. Why give a new presentation of the proof?

The original proof was long and complex.  The complexity was not
because of conceptual challenges.  In fact, the proof makes only
modest demands on the theoretical training of the reader.  It is
possible to read and understand the proof with a knowledge of a
limited body of mathematics, such as basic calculus and elementary
Euclidean geometry.

Nevertheless, the proof involves many  calculation that are routine
and yet sometimes long and tedious.  The proof relies on computer calculations.  An error in any calculation or a bug in the
computer code has the potential of toppling the entire proof.

The referees were conscientious and checked many of the
calculations.  However, for the most part, the computer code lay beyond the scope of the referees' review, and even careful quality control can let a occasional bug slip through undetected.


After all is said and done, no proof is more reliable than the
reliability of the processes that are used to verify its
correctness.  These processes include the checking that the author
makes before releasing the proof for public scrutiny, the checking
of the referees, and the checking done by readers after publication.

In recent years, I have been increasingly preoccupied by the
processes that we rely on to insure the correctness of complex
proofs. Researchers from Frege to G\"odel, who solved a problem of
rigor in mathematics, found a theoretical solution but did not
extinguish the burning fire at the foundations of mathematics,
because they omitted the practical implementation. Some, such as
Bourbaki, have even gone so far as to claim that ``formalized
mathematics cannot in practice be written down in full'' and call
such a project
``absolutely unrealizable'' \cite[p 10,11]{Bour:68:Sets}. % Theory of Sets, page 10,11.

While it is true that formal proofs may be too long to print,
computers -- which do not have the same limitations as paper -- have
become the natural host of formal mathematics. In recent decades,
logicians and computer scientists have reworked the foundations of
mathematics, putting them in an efficient form designed for real use
on real computers.

For the first time in history, it is possible to generate and verify
every single logical inference of major mathematical theorems.  This
has now been done for the four-color theorem, the prime number
theorem, the Jordan curve theorem, the Brouwer fixed point theorem,
the fundamental theorem of calculus, and many other theorems.  Freek
Wiedijk reports that 82\% of a list of 100 famous theorems have now
been checked formally \cite{wiedijk:100}.  The list contains two particular challenges: the independence of the Continuum Hypothesis and Fermat's Last theorem.

Some mathematicians remain skeptical of the process because
computers have been used to generate and verify the logical
inferences.  Computers are notoriously imperfect, with flaws ranging
from software bugs to defective chips.  Even if a computer verifies
the inferences, who will verify the verifier, or then verify the
verifier of the verifier?  Indeed, it would be unscientific of us to
place an unmerited trust in computers.

The choice comes down to two competing verification processes.  The first is the traditional
process of referees, which depends largely on the luck of the draw
-- some referees are meticulous, others are careless.   The second
process is formal computer verification. In this case, the process
is less dependent on the whims of a particular referee.
In my view, the choice between the conventional referee process and
computer verification is as blatent as the choice between an
hourglass and an atomic clock as the scientific standard of time.

The standard of proof I have adopted is the highest scientific standard
available by current technology.  That 
standard is formal verification by computer.  This standard will
continue to evolve with the advancement of technology.

My dream is to have some day a fully formally verified solution to
the packing problem.
This has not been done, but significant progress is being
made.  This book is an attempt to rearrange the proof
in such a way to make the formal verification easier.  The book is called {\it a blueprint for formal proofs} because it is the text that gives the design of the formal proof to be constructed.  My decisions about what to include in this book has been shaped by the list of theorems already available in the library of proof assistants such as {\tt HOL Light}.  For example, book assumes basic point-set topology and measure theory, because these topics have been formalized by John Harrison~\cite{XX}.  

The style of formal proofs is different from that of
conventional proofs.  It is better to have a large number of short
snappy proofs, rather than a few ingenious ones.  Humans enjoy
surprising new perspectives, but computers prefer standardization.
Despite these differences, I have worked to make proofs that
will bring pleasure both to humans and to our silicon friends.

This text presents a substantial simplification of the original proof of the Kepler conjecture.  The credit for many simplifications is due to others.  G. Gonthier expresses his formal proof of the four-color theorem in terms of hypermaps.  He reworks the proofs of the four-color theorem to avoid the use of the Jordan curve theorem, using instead the much simpler notion of M\"obius contour.  I have followed Gonthier's lead in these respects.  (Nevertheless, there is a version of the Jordan curve theorem for convex spherical polygons hidden in Chapter~\ref{sec:fan}.)  

The packing problem gives an assertion about packings of spheres in all of $\ring{R}^3$.  There are many ways to reduce the packing problem to a minimization problem in a finite number of variables, using what I call {\it correction terms}.  In a discussion of the solution of the packing problem, I wrote that ``correction terms are extremely flexible and easy to construct, and soon Samuel Ferguson and I realized that every time we encountered difficulties in solving the minimization problem, we could adjust $f$ [the correction term] to skirt the difficulty. $\ldots$  The correction function did not become fixed until it came time for Ferguson to defend his thesis, and we finally felt obligated to stop tampering with it.  However, if I were to revise the proof to produce a simpler one, the first thing I would do would be to change the correction function once again.  It is the key to a simpler proof.''  I never produced a simpler correction.  C. Marchal did~\cite{XX}.  His construction of a much simpler function has become the key to the simpler proof presented in this book.  I gratefully acknowledge his contributions to this project.


\section{Structure of this Book}

\begin{note}%XX
This section will be rewritten.
\end{note}

Because of the complexity of the solution to this problem, it is particularly important for the reader to maintain a clear view of the structure and organization of this book. 


The introductory essays describe the major ideas,  methods, and organization of the proof.  There is an essay on each major computer component of the proof. The purpose is to provide a panoramic view of proof, to provide intuition about proof strategies.  After reading this part of the book, the reading should understand what the proof is all about, without yet dipping into technical details.  

The part on foundations provides background material about constructions in discrete geometry that have relevance beyond the packing problem.  There are four chapters in this part.  The first covers trigonometric identities and basic vector geometry.  The second treats volume from an elementary point of view.  The third chapter covers planar graph theory from a purely combinatorial point of view.  The fourth chapter covers fans, which gives planar graphs from a more geometric point of view.

The next part of the book gives the solution to the packing problem.  The first chapter in this part gives a top-level overview of the major steps of the proof.  It describes how the problem can be reduced from a problem in infinitely many variables to a problem in finitely many variables.  The remaining chapters in this part flesh out that skeleton.






\section{Thanks}

I am particularly grateful to Sam Ferguson, for the years that
he spent working on this problem with me.  I also thank the early editors
R. MacPherson, G. Fejes T\'oth, and J. Lagarias for their work
to improve a technically challenging piece of mathematics.  

Many colleagues in the formal theorem proving community have helped me to learn the theory and the tools.  Others have made significant contributions to the flyspeck formalization project.  I wish to thank 
Nguyen Quang Truong, % fix accents. (he found a mistake)
Nguyen Tat Thang, % fix accents. (he found a mistake),
Trieu Thi Diep, Dang Tat Dat, Nguyen Duc Tam, Vu Quang Thanh, Nguyen Duc Thinh, Tran Nam Trung, Hoang Le Truong,
Erin Susick, Laurel Beth Martin, Catalin Anghel,
Jeremy Avigad, Mark Adams, Freek Wiedijk,  Tobias Nipkow, John Harrison, Sean McLaughlin, Gertrud Bauer, Steven Obua, and Roland Zumkeller.   Much of the material from this book was covered in a course on discrete geometry and computers at the University of Pittsburgh, and then later at a workshop on formal proof and the Flyspeck project in Hanoi.  I would like to thank the members of these groups for assisting in the preparation of the text.

\begin{note}%XX
There are more to thank that will be inserted here.
\end{note}

This book has been written in part during a sabbatical leave from the University of Pittsburgh.  I wish to thank the many institutions that supported
me during this period: the Max Planck Institute in Bonn, the \'Ecole Normale Sup\'erieure,  the Institute of Math
in Hanoi, Radboud Univeristy in Nijmegen, and the University of Strasbourg.
I thank those that made the arrangements, including G. Mints, F. Loeser, F. Lecomte, H. Barendregt, Ha Huy Khoai and Ng\^o Vi\d{\^e}t Trung.


\bigskip
\hbox{}



\bigskip
\hbox{}

{
\parindent=0pt
\obeylines

Thomas C. Hales
Pittsburgh, PA
October, 2009

}







